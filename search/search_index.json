{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Welcome","text":"<p>Here you should find all related to apiv2 project that serves 4geeks.com and 4geeksacademy.com, I will recommend you that read these articles in order.</p>"},{"location":"4geeks-libraries/","title":"4Geeks libraries","text":"<ul> <li>Capy Core.</li> <li>Celery Task Manager.</li> <li>Linked Services.</li> </ul>"},{"location":"endpoints/","title":"Enpoints Documentation","text":"<ul> <li>Postman</li> <li>OpenApi</li> </ul>"},{"location":"registry-trusted-urls/","title":"Registry Trusted URLs System","text":"<p>The BreatheCode registry module includes a trusted URL system that allows skipping validation for specific domains and URLs that are known to be reliable but may have intermittent connectivity issues.</p>"},{"location":"registry-trusted-urls/#overview","title":"Overview","text":"<p>During asset validation, the system checks all URLs found in README files. Some external domains may have temporary connectivity issues, rate limiting, or other problems that cause validation to fail even though the URLs are valid and trusted.</p> <p>The trusted URL system provides a way to skip validation for these problematic but reliable URLs.</p>"},{"location":"registry-trusted-urls/#configuration","title":"Configuration","text":""},{"location":"registry-trusted-urls/#trusted-domains","title":"Trusted Domains","text":"<p>Add domains to the <code>TRUSTED_DOMAINS</code> set in <code>breathecode/registry/utils.py</code>:</p> <pre><code>TRUSTED_DOMAINS = {\n    'exploit-db.com',\n    'docs.python.org',\n    'developer.mozilla.org',\n    'stackoverflow.com',\n}\n</code></pre> <p>Any URL from these domains will be skipped during validation, regardless of the specific path.</p>"},{"location":"registry-trusted-urls/#trusted-urls","title":"Trusted URLs","text":"<p>Add specific URLs to the <code>TRUSTED_URLS</code> set in <code>breathecode/registry/utils.py</code>:</p> <pre><code>TRUSTED_URLS = {\n    'https://example.com/specific/path',\n    'https://another-site.com/another/path',\n}\n</code></pre> <p>Only these exact URLs (ignoring query strings and fragments) will be skipped during validation.</p>"},{"location":"registry-trusted-urls/#how-it-works","title":"How It Works","text":"<ol> <li>Domain Matching: The system extracts the domain from the URL and checks if it's in the trusted domains list</li> <li>www. Handling: The <code>www.</code> prefix is automatically removed for domain comparison</li> <li>URL Normalization: Query strings and fragments are removed when comparing against trusted URLs</li> <li>Case Insensitive: Domain comparison is case-insensitive</li> </ol>"},{"location":"registry-trusted-urls/#examples","title":"Examples","text":"<pre><code># These URLs will be trusted if 'exploit-db.com' is in TRUSTED_DOMAINS:\n'https://exploit-db.com/exploits/12345'\n'http://www.exploit-db.com/some/path?query=test#fragment'\n'https://exploit-db.com/'\n\n# These URLs will NOT be trusted:\n'https://untrusted-domain.com/path'\n'https://example.com/path'  # (unless specifically added)\n</code></pre>"},{"location":"registry-trusted-urls/#dynamic-configuration","title":"Dynamic Configuration","text":"<p>You can also add trusted domains and URLs at runtime:</p> <pre><code>from breathecode.registry.utils import add_trusted_domain, add_trusted_url\n\n# Add a domain\nadd_trusted_domain('new-trusted-domain.com')\n\n# Add a specific URL\nadd_trusted_url('https://example.com/special/path?param=value')\n</code></pre>"},{"location":"registry-trusted-urls/#validation-output","title":"Validation Output","text":"<p>When a trusted URL is encountered, you'll see this message in the validation output:</p> <pre><code>\u2705 Skipping validation for trusted URL: https://exploit-db.com/exploits/12345\n</code></pre>"},{"location":"registry-trusted-urls/#benefits","title":"Benefits","text":"<ul> <li>Reliability: Avoid false negatives from temporarily unreachable but valid URLs</li> <li>Performance: Skip time-consuming network requests for known good URLs</li> <li>Maintenance: Reduce manual intervention when trusted sites have temporary issues</li> </ul>"},{"location":"registry-trusted-urls/#security-considerations","title":"Security Considerations","text":"<ul> <li>Only add domains and URLs that you absolutely trust</li> <li>Regularly review the trusted lists to ensure they're still appropriate</li> <li>Consider the security implications of skipping validation for external content</li> </ul>"},{"location":"registry-trusted-urls/#usage-guidelines","title":"Usage Guidelines","text":"<ol> <li>Add domains sparingly: Only add domains that frequently cause validation issues but are known to be reliable</li> <li>Document additions: Add comments explaining why a domain/URL was added to the trusted list</li> <li>Monitor regularly: Periodically check if trusted domains are still necessary</li> <li>Prefer domains over URLs: When possible, trust entire domains rather than specific URLs for easier maintenance </li> </ol>"},{"location":"workers/","title":"Workers de Celery - Diagn\u00f3stico y Soluci\u00f3n de Problemas","text":""},{"location":"workers/#problema-identificado","title":"Problema Identificado","text":""},{"location":"workers/#sintomas","title":"S\u00edntomas","text":"<ul> <li>Los workers de Celery aparecen como \"up\" en <code>heroku ps</code> pero no procesan tareas</li> <li>Solo algunos workers (8-12) est\u00e1n procesando tareas activamente</li> <li>Otros workers (1-7) est\u00e1n inactivos mostrando solo logs de pgbouncer</li> <li>La cola de RabbitMQ se satura debido a la falta de capacidad de procesamiento</li> </ul>"},{"location":"workers/#diagnostico-visual","title":"Diagn\u00f3stico Visual","text":"<pre><code># Ver estado de todos los workers\nheroku ps --app breathecode\n\n# Ver logs de un worker espec\u00edfico (worker inactivo)\nheroku logs --tail --app breathecode --dyno=celeryworker.1\n\n# Ver logs de un worker espec\u00edfico (worker activo)\nheroku logs --tail --app breathecode --dyno=celeryworker.8\n</code></pre>"},{"location":"workers/#indicadores-de-workers-inactivos","title":"Indicadores de Workers Inactivos","text":"<ul> <li>Solo muestran logs de pgbouncer: <code>0 xacts/s, 0 queries/s</code></li> <li>No hay logs de Celery o procesamiento de tareas</li> <li>Workers aparecen como \"up\" pero sin actividad real</li> </ul>"},{"location":"workers/#comandos-de-diagnostico","title":"Comandos de Diagn\u00f3stico","text":""},{"location":"workers/#1-verificar-estado-de-workers","title":"1. Verificar Estado de Workers","text":"<pre><code># Ver todos los workers activos\nheroku ps --app breathecode\n\n# Ver workers espec\u00edficos\nheroku ps --app breathecode | grep celeryworker\n</code></pre>"},{"location":"workers/#2-ver-logs-de-workers-especificos","title":"2. Ver Logs de Workers Espec\u00edficos","text":"<pre><code># Ver logs de un worker espec\u00edfico\nheroku logs --tail --app breathecode --dyno=celeryworker.1\nheroku logs --tail --app breathecode --dyno=celeryworker.2\nheroku logs --tail --app breathecode --dyno=celeryworker.3\n\n# Ver logs de workers activos para comparar\nheroku logs --tail --app breathecode --dyno=celeryworker.8\nheroku logs --tail --app breathecode --dyno=celeryworker.9\n</code></pre>"},{"location":"workers/#3-verificar-conexion-al-broker","title":"3. Verificar Conexi\u00f3n al Broker","text":"<pre><code># Verificar si los workers pueden conectarse al broker\nheroku run \"celery -A breathecode.celery inspect ping\" --app breathecode\n\n# Ver tareas activas\nheroku run \"celery -A breathecode.celery inspect active\" --app breathecode\n\n# Ver estad\u00edsticas de workers\nheroku run \"celery -A breathecode.celery inspect stats\" --app breathecode\n</code></pre>"},{"location":"workers/#4-verificar-configuracion-del-broker","title":"4. Verificar Configuraci\u00f3n del Broker","text":"<pre><code># Ver variables de entorno relacionadas con el broker\nheroku config --app breathecode | grep -E \"(REDIS|RABBIT|BROKER|CLOUDAMQP)\"\n</code></pre>"},{"location":"workers/#proceso-de-solucion","title":"Proceso de Soluci\u00f3n","text":""},{"location":"workers/#paso-1-diagnostico-inicial","title":"Paso 1: Diagn\u00f3stico Inicial","text":"<pre><code># 1. Verificar estado de workers\nheroku ps --app breathecode\n\n# 2. Ver logs de workers inactivos\nheroku logs --tail --app breathecode --dyno=celeryworker.1\n\n# 3. Ver logs de workers activos para comparar\nheroku logs --tail --app breathecode --dyno=celeryworker.8\n</code></pre>"},{"location":"workers/#paso-2-verificar-conexion-al-broker","title":"Paso 2: Verificar Conexi\u00f3n al Broker","text":"<pre><code># Verificar conexi\u00f3n de todos los workers\nheroku run \"celery -A breathecode.celery inspect ping\" --app breathecode\n</code></pre>"},{"location":"workers/#paso-3-reiniciar-workers-inactivos","title":"Paso 3: Reiniciar Workers Inactivos","text":"<pre><code># Opci\u00f3n 1: Reiniciar workers espec\u00edficos\nheroku ps:restart celeryworker.1 --app breathecode\nheroku ps:restart celeryworker.2 --app breathecode\nheroku ps:restart celeryworker.3 --app breathecode\nheroku ps:restart celeryworker.4 --app breathecode\nheroku ps:restart celeryworker.5 --app breathecode\nheroku ps:restart celeryworker.6 --app breathecode\n\n# Opci\u00f3n 2: Reiniciar todos los workers (recomendado)\nheroku ps:restart celeryworker --app breathecode\n</code></pre>"},{"location":"workers/#paso-4-verificacion-post-solucion","title":"Paso 4: Verificaci\u00f3n Post-Soluci\u00f3n","text":"<pre><code># 1. Esperar 2-3 minutos para que los workers se estabilicen\n# 2. Verificar estado de workers\nheroku ps --app breathecode\n\n# 3. Verificar conexi\u00f3n al broker\nheroku run \"celery -A breathecode.celery inspect ping\" --app breathecode\n\n# 4. Ver logs de workers para confirmar que est\u00e1n procesando tareas\nheroku logs --tail --app breathecode --dyno=celeryworker.1\nheroku logs --tail --app breathecode --dyno=celeryworker.2\n\n# 5. Ver tareas activas\nheroku run \"celery -A breathecode.celery inspect active\" --app breathecode\n</code></pre>"},{"location":"workers/#comandos-de-monitoreo-continuo","title":"Comandos de Monitoreo Continuo","text":""},{"location":"workers/#monitoreo-de-workers-en-tiempo-real","title":"Monitoreo de Workers en Tiempo Real","text":"<pre><code># Ver logs de todos los workers\nheroku logs --tail --app breathecode\n\n# Ver solo logs de celery workers\nheroku logs --tail --app breathecode | grep celeryworker\n\n# Monitoreo de un worker espec\u00edfico\nheroku logs --tail --app breathecode --dyno=celeryworker.1\n</code></pre>"},{"location":"workers/#comandos-de-diagnostico-de-tareas","title":"Comandos de Diagn\u00f3stico de Tareas","text":"<pre><code># Ver tareas atascadas\npoetry run python manage.py check_task_status --hours=24 --check-execution --limit=10\n\n# Ver resumen de TaskManager\npoetry run python manage.py clear_task_manager_queue --show-summary\n\n# Ver tareas por estado\npoetry run python manage.py clear_task_manager_queue --status SCHEDULED --show-summary\npoetry run python manage.py clear_task_manager_queue --status PENDING --show-summary\npoetry run python manage.py clear_task_manager_queue --status ERROR --show-summary\n</code></pre>"},{"location":"workers/#causas-comunes-del-problema","title":"Causas Comunes del Problema","text":""},{"location":"workers/#1-problemas-de-conexion-al-broker","title":"1. Problemas de Conexi\u00f3n al Broker","text":"<ul> <li>Workers no pueden conectarse a Redis/RabbitMQ</li> <li>Configuraci\u00f3n incorrecta de variables de entorno</li> <li>Problemas de red entre Heroku y el broker</li> </ul>"},{"location":"workers/#2-configuracion-de-autoscaling","title":"2. Configuraci\u00f3n de Autoscaling","text":"<ul> <li>Workers en modo \"standby\"</li> <li>Configuraci\u00f3n incorrecta de <code>CELERY_MIN_WORKERS</code> y <code>CELERY_MAX_WORKERS</code></li> </ul>"},{"location":"workers/#3-problemas-de-memoria","title":"3. Problemas de Memoria","text":"<ul> <li>Workers que se reinician constantemente</li> <li>L\u00edmites de memoria alcanzados</li> </ul>"},{"location":"workers/#4-problemas-de-configuracion-de-colas","title":"4. Problemas de Configuraci\u00f3n de Colas","text":"<ul> <li>Workers asignados a colas espec\u00edficas</li> <li>Configuraci\u00f3n incorrecta de routing</li> </ul>"},{"location":"workers/#prevencion","title":"Prevenci\u00f3n","text":""},{"location":"workers/#monitoreo-regular","title":"Monitoreo Regular","text":"<pre><code># Script de monitoreo diario\nheroku run \"celery -A breathecode.celery inspect ping\" --app breathecode\nheroku ps --app breathecode\n</code></pre>"},{"location":"workers/#configuracion-recomendada","title":"Configuraci\u00f3n Recomendada","text":"<ul> <li>Mantener <code>CELERY_MIN_WORKERS</code> y <code>CELERY_MAX_WORKERS</code> balanceados</li> <li>Monitorear logs de workers regularmente</li> <li>Verificar conexi\u00f3n al broker peri\u00f3dicamente</li> </ul>"},{"location":"workers/#notas-importantes","title":"Notas Importantes","text":"<ul> <li>Los workers pueden aparecer como \"up\" en Heroku pero no estar procesando tareas</li> <li>Los logs de pgbouncer (0 queries/s) indican workers inactivos</li> <li>El reinicio de workers es la soluci\u00f3n m\u00e1s efectiva para problemas de conexi\u00f3n</li> <li>Siempre verificar la conexi\u00f3n al broker despu\u00e9s de reiniciar workers</li> </ul>"},{"location":"LLM-DOCS/ACADEMY_PLANS/","title":"Academy Plans Management API","text":"<p>This document provides comprehensive information about managing payment plans, services, and service items in BreatheCode. Plans are the foundation of the payment system, allowing academies to sell access to cohorts, mentorships, events, and other resources.</p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#overview","title":"Overview","text":""},{"location":"LLM-DOCS/ACADEMY_PLANS/#what-are-plans","title":"What are Plans?","text":"<p>Plans are subscription or financing packages that bundle multiple services together for purchase. They define: - What services students get access to - How much it costs - Payment frequency (monthly, quarterly, yearly) - Whether it's a subscription (renewable) or one-time financing - Trial periods and lifetime limits</p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#core-concepts","title":"Core Concepts","text":"<pre><code>Academy\n  \u251c\u2500\u2500 Plan\n  \u2502   \u251c\u2500\u2500 Service Items (what's included)\n  \u2502   \u2502   \u2514\u2500\u2500 Service (e.g., \"Mentorship\", \"AI Chat\", \"Code Reviews\")\n  \u2502   \u251c\u2500\u2500 Financing Options (installment plans)\n  \u2502   \u251c\u2500\u2500 Cohort Set (which cohorts)\n  \u2502   \u251c\u2500\u2500 Pricing (by time period and country)\n  \u2502   \u2514\u2500\u2500 Subscription/Financing (how customers pay)\n  \u2502\n  \u2514\u2500\u2500 Payment Methods (how customers can pay)\n      \u251c\u2500\u2500 Credit Cards (Stripe, etc.)\n      \u251c\u2500\u2500 Bank Transfers (regional)\n      \u251c\u2500\u2500 Third-party (PayPal, crypto, etc.)\n      \u2514\u2500\u2500 Internal (cash, scholarships, etc.)\n</code></pre>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#business-models","title":"Business Models","text":"<ol> <li>Subscription (<code>is_renewable=true</code>)</li> <li>Auto-renewing monthly/quarterly/yearly</li> <li>Continuous access as long as paid</li> <li>Can be canceled anytime</li> <li> <p>Example: Monthly SaaS subscription</p> </li> <li> <p>Plan Financing (<code>is_renewable=false</code>)</p> </li> <li>Fixed number of installments</li> <li>Access until completion</li> <li>Certificate after final payment</li> <li>Example: Bootcamp tuition in 12 monthly payments</li> </ol>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#plan-management-endpoints","title":"Plan Management Endpoints","text":""},{"location":"LLM-DOCS/ACADEMY_PLANS/#1-list-plans","title":"1. List Plans","text":"<p>Endpoint: <code>GET /v1/payments/academy/plan</code></p> <p>Authentication: Required - <code>read_subscription</code> capability</p> <p>Headers: - <code>Academy: {academy_id}</code> - Required - <code>Authorization: Token {your-token}</code> - Required</p> <p>Query Parameters: - <code>cohort={cohort_id}</code> - Filter by cohort - <code>syllabus={syllabus_slug}</code> - Filter by syllabus - <code>service_slug={slug}</code> - Filter by service - <code>currency__code={code}</code> - Filter by currency (e.g., \"USD\", \"EUR\") - <code>is_onboarding={true/false}</code> - Filter onboarding plans - <code>country_code={code}</code> - Get pricing adjusted for country (e.g., \"US\", \"ES\") - <code>status={status}</code> - Filter by status (DRAFT, ACTIVE, UNLISTED, DELETED) - <code>like={search_term}</code> - Search by slug or title (case-insensitive, partial match) - <code>limit={number}</code> - Results per page - <code>offset={number}</code> - Pagination offset</p> <p>Response: <pre><code>[\n  {\n    \"id\": 123,\n    \"slug\": \"premium-bootcamp\",\n    \"title\": \"Premium Web Development Bootcamp\",\n    \"status\": \"ACTIVE\",\n    \"is_renewable\": false,\n    \"is_onboarding\": true,\n    \"has_waiting_list\": false,\n    \"time_of_life\": 6,\n    \"time_of_life_unit\": \"MONTH\",\n    \"trial_duration\": 7,\n    \"trial_duration_unit\": \"DAY\",\n    \"price_per_half\": 3500.00,\n    \"price_per_month\": 299.00,\n    \"price_per_quarter\": 799.00,\n    \"price_per_year\": 2999.00,\n    \"currency\": {\n      \"code\": \"USD\",\n      \"name\": \"US Dollar\"\n    },\n    \"owner\": {\n      \"id\": 1,\n      \"name\": \"4Geeks Academy\",\n      \"slug\": \"4geeks\"\n    },\n    \"service_items\": [\n      {\n        \"id\": 45,\n        \"unit_type\": \"UNIT\",\n        \"how_many\": -1,\n        \"sort_priority\": 1,\n        \"service\": {\n          \"id\": 12,\n          \"slug\": \"course-certificates\",\n          \"title\": \"Earn course certificates\",\n          \"type\": \"COHORT_SET\",\n          \"consumer\": \"NO_SET\"\n        }\n      }\n    ],\n    \"financing_options\": [\n      {\n        \"id\": 10,\n        \"monthly_price\": 299.00,\n        \"how_many_months\": 12,\n        \"currency\": {\n          \"code\": \"USD\"\n        }\n      }\n    ],\n    \"cohort_set\": {\n      \"id\": 5,\n      \"slug\": \"full-stack-bootcamp\",\n      \"cohorts\": [...]\n    }\n  }\n]\n</code></pre></p> <p>Example Requests:</p> <p>Get all active plans: <pre><code>GET /v1/payments/academy/plan?status=ACTIVE\nHeaders:\n  Academy: 1\n  Authorization: Token {token}\n</code></pre></p> <p>Get plans for specific cohort: <pre><code>GET /v1/payments/academy/plan?cohort=123\nHeaders:\n  Academy: 1\n</code></pre></p> <p>Get pricing for Spain: <pre><code>GET /v1/payments/academy/plan?country_code=ES\nHeaders:\n  Academy: 1\n</code></pre></p> <p>Search plans by name: <pre><code>GET /v1/payments/academy/plan?like=bootcamp\n# Returns plans with \"bootcamp\" in slug or title\nHeaders:\n  Academy: 1\n</code></pre></p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#2-get-single-plan","title":"2. Get Single Plan","text":"<p>Endpoint: <code>GET /v1/payments/academy/plan/{plan_id}</code> Or: <code>GET /v1/payments/academy/plan/{plan_slug}</code></p> <p>Authentication: Required - <code>read_subscription</code> capability</p> <p>Response: Single plan object (same structure as list)</p> <p>Example: <pre><code>GET /v1/payments/academy/plan/premium-bootcamp\nHeaders:\n  Academy: 1\n  Authorization: Token {token}\n</code></pre></p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#3-create-plan","title":"3. Create Plan","text":"<p>Endpoint: <code>POST /v1/payments/academy/plan</code></p> <p>Authentication: Required - <code>crud_subscription</code> capability</p> <p>Headers: - <code>Academy: {academy_id}</code> - Required - <code>Authorization: Token {your-token}</code> - Required</p> <p>Request Body: <pre><code>{\n  \"slug\": \"premium-bootcamp-2025\",\n  \"title\": \"Premium Web Development Bootcamp 2025\",\n  \"currency\": \"USD\",\n  \"status\": \"DRAFT\",\n  \"is_renewable\": false,\n  \"is_onboarding\": true,\n  \"has_waiting_list\": false,\n  \"time_of_life\": 6,\n  \"time_of_life_unit\": \"MONTH\",\n  \"trial_duration\": 7,\n  \"trial_duration_unit\": \"DAY\",\n  \"price_per_half\": 3500.00,\n  \"price_per_month\": 299.00,\n  \"price_per_quarter\": 799.00,\n  \"price_per_year\": 2999.00,\n  \"cohort_set\": 5,\n  \"financing_options\": [10, 11],\n  \"consumption_strategy\": \"PER_SEAT\"\n}\n</code></pre></p> <p>Required Fields: - <code>slug</code> (string) - Unique identifier (letters, numbers, hyphens only) - <code>currency</code> (string) - Currency code (e.g., \"USD\", \"EUR\")</p> <p>Optional Fields: - <code>title</code> (string) - Display name - <code>status</code> (string) - DRAFT, ACTIVE, UNLISTED, DELETED (default: DRAFT) - <code>is_renewable</code> (boolean) - True for subscriptions, false for financing (default: true) - <code>is_onboarding</code> (boolean) - Onboarding plan flag (default: false) - <code>has_waiting_list</code> (boolean) - Enable waiting list (default: false) - <code>exclude_from_referral_program</code> (boolean) - Disable referral coupons (default: true) - <code>time_of_life</code> (integer) - How long plan lasts (default: 1) - <code>time_of_life_unit</code> (string) - DAY, WEEK, MONTH, YEAR (default: MONTH) - <code>trial_duration</code> (integer) - Trial period length (default: 1) - <code>trial_duration_unit</code> (string) - DAY, WEEK, MONTH, YEAR (default: MONTH) - <code>price_per_half</code> (float) - Semi-annual price - <code>price_per_month</code> (float) - Monthly price - <code>price_per_quarter</code> (float) - Quarterly price - <code>price_per_year</code> (float) - Annual price - <code>cohort_set</code> (integer) - CohortSet ID - <code>mentorship_service_set</code> (integer) - MentorshipServiceSet ID - <code>event_type_set</code> (integer) - EventTypeSet ID - <code>financing_options</code> (array) - Array of FinancingOption IDs - <code>consumption_strategy</code> (string) - PER_TEAM, PER_SEAT, BOTH (default: PER_SEAT) - <code>seat_service_price</code> (integer) - AcademyService ID for seat pricing - <code>pricing_ratio_exceptions</code> (object) - Country-specific pricing adjustments</p> <p>Response: Created plan object (201 status)</p> <p>Notes: - <code>owner</code> is automatically set to the academy from the header - Cannot set <code>owner</code> or <code>owner_id</code> manually - Plan starts in DRAFT status unless specified - Set status to ACTIVE when ready to sell</p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#4-update-plan","title":"4. Update Plan","text":"<p>Endpoint: <code>PUT /v1/payments/academy/plan/{plan_id}</code> Or: <code>PUT /v1/payments/academy/plan/{plan_slug}</code></p> <p>Authentication: Required - <code>crud_subscription</code> capability</p> <p>Request Body: Same fields as POST (partial updates supported)</p> <p>Example - Activate a Plan: <pre><code>PUT /v1/payments/academy/plan/premium-bootcamp-2025\nHeaders:\n  Academy: 1\n  Authorization: Token {token}\n\nBody:\n{\n  \"status\": \"ACTIVE\"\n}\n</code></pre></p> <p>Example - Update Pricing: <pre><code>PUT /v1/payments/academy/plan/123\nBody:\n{\n  \"price_per_month\": 349.00,\n  \"price_per_year\": 3499.00\n}\n</code></pre></p> <p>Restrictions: - Cannot change <code>owner</code> (plan remains with academy) - Can only update plans owned by your academy or global plans</p> <p>Response: Updated plan object (200 status)</p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#5-delete-plan-soft-delete","title":"5. Delete Plan (Soft Delete)","text":"<p>Endpoint: <code>DELETE /v1/payments/academy/plan/{plan_id}</code> Or: <code>DELETE /v1/payments/academy/plan/{plan_slug}</code></p> <p>Authentication: Required - <code>crud_subscription</code> capability</p> <p>Behavior: - Sets <code>status=\"DELETED\"</code> (soft delete) - Plan remains in database - No longer visible in active listings - Existing subscriptions continue</p> <p>Response: 204 No Content</p> <p>Example: <pre><code>DELETE /v1/payments/academy/plan/old-plan-2024\nHeaders:\n  Academy: 1\n  Authorization: Token {token}\n</code></pre></p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#service-items-management","title":"Service Items Management","text":""},{"location":"LLM-DOCS/ACADEMY_PLANS/#what-are-service-items","title":"What are Service Items?","text":"<p>Service Items define what's included in a plan: - How many units of a service (e.g., 5 mentorships, unlimited AI chats) - What service it provides (e.g., code reviews, live classes) - How it renews (if renewable)</p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#service-types","title":"Service Types","text":"Type Description Example <code>COHORT_SET</code> Access to cohorts/courses \"Full Stack Bootcamp\" <code>MENTORSHIP_SERVICE_SET</code> Mentorship sessions \"1-on-1 Expert Mentorship\" <code>EVENT_TYPE_SET</code> Event access \"Workshops &amp; Webinars\" <code>VOID</code> Feature flags/capabilities \"AI Chat\", \"Code Reviews\" <code>SEAT</code> Team seat pricing \"Team Member Seat\""},{"location":"LLM-DOCS/ACADEMY_PLANS/#consumer-types-how-services-are-used","title":"Consumer Types (How Services Are Used)","text":"Consumer Triggers When Example <code>ADD_CODE_REVIEW</code> Requesting code review Review on project <code>LIVE_CLASS_JOIN</code> Joining live class Class attendance <code>EVENT_JOIN</code> Joining event Workshop registration <code>JOIN_MENTORSHIP</code> Booking mentorship Schedule session <code>READ_LESSON</code> Opening lesson Lesson access <code>AI_INTERACTION</code> Using AI features Chat, generation <code>NO_SET</code> Not consumed Feature unlock"},{"location":"LLM-DOCS/ACADEMY_PLANS/#unit-quantities","title":"Unit Quantities","text":"<ul> <li><code>-1</code> = Unlimited/infinite</li> <li><code>0</code> = None/disabled</li> <li>Positive number = Specific quantity (e.g., <code>5</code> = 5 units)</li> </ul>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#creating-service-items","title":"Creating Service Items","text":"<p>Endpoint: <code>POST /v1/payments/academy/serviceitem</code></p> <p>Authentication: Required - <code>crud_service</code> capability</p> <p>Headers: - <code>Academy: {academy_id}</code> - Required - <code>Authorization: Token {your-token}</code> - Required</p> <p>Request Body: <pre><code>{\n  \"service\": 12,\n  \"how_many\": 100,\n  \"unit_type\": \"UNIT\",\n  \"sort_priority\": 1,\n  \"is_renewable\": false,\n  \"is_team_allowed\": false,\n  \"renew_at\": 1,\n  \"renew_at_unit\": \"MONTH\"\n}\n</code></pre></p> <p>Required Fields: - <code>service</code> (integer) - Service ID - <code>how_many</code> (integer) - Number of units (-1 for unlimited, must be &gt; 0)</p> <p>Optional Fields: - <code>unit_type</code> (string) - Default: \"UNIT\" - <code>sort_priority</code> (integer) - Display order (default: 1) - <code>is_renewable</code> (boolean) - Auto-renew consumables (default: false) - <code>is_team_allowed</code> (boolean) - Allow team seats (default: false, auto-set to true for SEAT type) - <code>renew_at</code> (integer) - Renewal interval (default: 1, only relevant if is_renewable=true) - <code>renew_at_unit</code> (string) - Renewal unit: DAY, WEEK, MONTH, YEAR (default: MONTH)</p> <p>Example - Create Unlimited Service Item: <pre><code>POST /v1/payments/academy/serviceitem\nHeaders:\n  Academy: 1\n  Authorization: Token {token}\n\nBody:\n{\n  \"service\": 12,\n  \"how_many\": -1,\n  \"sort_priority\": 1\n}\n</code></pre></p> <p>Example - Create Renewable Service Item: <pre><code>POST /v1/payments/academy/serviceitem\nBody:\n{\n  \"service\": 25,\n  \"how_many\": 5,\n  \"is_renewable\": true,\n  \"renew_at\": 1,\n  \"renew_at_unit\": \"MONTH\"\n}\n</code></pre></p> <p>Response: <code>201 CREATED</code> <pre><code>{\n  \"id\": 456,\n  \"service\": {\n    \"id\": 12,\n    \"slug\": \"mentorship-sessions\",\n    \"title\": \"Mentorship Sessions\",\n    \"type\": \"MENTORSHIP_SERVICE_SET\",\n    \"consumer\": \"JOIN_MENTORSHIP\"\n  },\n  \"unit_type\": \"UNIT\",\n  \"how_many\": 5,\n  \"sort_priority\": 1,\n  \"is_renewable\": true,\n  \"is_team_allowed\": false,\n  \"renew_at\": 1,\n  \"renew_at_unit\": \"MONTH\",\n  \"features\": []\n}\n</code></pre></p> <p>Important Notes: - \u26a0\ufe0f ServiceItems are immutable - Cannot be updated after creation (except <code>is_team_allowed</code>) - \u26a0\ufe0f Cannot be deleted - Create new one instead if configuration changes - \u2705 <code>how_many</code> must be -1 (unlimited) or &gt; 0 - \u2705 SEAT type services automatically set <code>is_team_allowed=true</code></p> <p>Why Immutable? ServiceItems define critical business logic for active subscriptions and financings. Changing <code>how_many</code>, <code>is_renewable</code>, or renewal settings after plans are sold could break active customer subscriptions.</p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#6-add-service-items-to-plan","title":"6. Add Service Items to Plan","text":"<p>Endpoint: <code>POST /v1/payments/academy/plan/serviceitem</code></p> <p>Authentication: Required - <code>crud_plan</code> capability</p> <p>Headers: - <code>Academy: {academy_id}</code> - Required - <code>Authorization: Token {your-token}</code> - Required</p> <p>Request Body: <pre><code>{\n  \"plan\": 123,  // Plan ID or slug\n  \"service_item\": 456  // ServiceItem ID, array, or comma-separated\n}\n</code></pre></p> <p>Variations:</p> <p>Single service item: <pre><code>{\n  \"plan\": \"premium-bootcamp\",\n  \"service_item\": 456\n}\n</code></pre></p> <p>Multiple service items (array): <pre><code>{\n  \"plan\": 123,\n  \"service_item\": [456, 789, 101]\n}\n</code></pre></p> <p>Multiple service items (comma-separated): <pre><code>{\n  \"plan\": 123,\n  \"service_item\": \"456,789,101\"\n}\n</code></pre></p> <p>Response: <pre><code>{\n  \"status\": \"ok\",\n  \"created_items\": [\n    {\n      \"plan_service_item_id\": 1,\n      \"service_item_id\": 456,\n      \"created\": true\n    },\n    {\n      \"plan_service_item_id\": 2,\n      \"service_item_id\": 789,\n      \"created\": false  // Already existed\n    },\n    {\n      \"plan_service_item_id\": 3,\n      \"service_item_id\": 101,\n      \"created\": true\n    }\n  ],\n  \"total_created\": 2\n}\n</code></pre></p> <p>Notes: - Uses <code>get_or_create()</code> - won't duplicate if already linked - <code>created: false</code> means the link already existed</p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#7-remove-service-items-from-plan","title":"7. Remove Service Items from Plan","text":"<p>Endpoint: <code>DELETE /v1/payments/academy/plan/serviceitem</code></p> <p>Authentication: Required - <code>crud_plan</code> capability</p> <p>Request Body: <pre><code>{\n  \"plan_service_item\": 123  // PlanServiceItem ID(s)\n}\n</code></pre></p> <p>Variations:</p> <p>Single item: <pre><code>{\n  \"plan_service_item\": 123\n}\n</code></pre></p> <p>Multiple items (array): <pre><code>{\n  \"plan_service_item\": [123, 456, 789]\n}\n</code></pre></p> <p>Multiple items (comma-separated): <pre><code>{\n  \"plan_service_item\": \"123,456,789\"\n}\n</code></pre></p> <p>Response: <pre><code>{\n  \"status\": \"ok\",\n  \"deleted_count\": 3\n}\n</code></pre></p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#7b-remove-service-item-from-plan-by-ids","title":"7b. Remove Service Item from Plan by IDs","text":"<p>Endpoint: <code>DELETE /v1/payments/academy/plan/&lt;plan_id&gt;/serviceitem/&lt;service_item_id&gt;</code></p> <p>Authentication: Required - <code>crud_plan</code> capability</p> <p>Path Params: - <code>plan_id</code> \u2013 Plan that owns the relation (must belong to the academy or be global) - <code>service_item_id</code> \u2013 Service item to detach</p> <p>Response: <pre><code>{\n  \"status\": \"ok\",\n  \"deleted\": true,\n  \"plan_id\": 123,\n  \"service_item_id\": 456,\n  \"plan_service_item_id\": 789\n}\n</code></pre></p> <p>Use this when you only know the plan and service item IDs; the API will locate and delete the matching <code>PlanServiceItem</code> internally.</p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#8-view-service-items","title":"8. View Service Items","text":"<p>Endpoint: <code>GET /v1/payments/serviceitem</code></p> <p>Authentication: Public (no auth required)</p> <p>Query Parameters: - <code>plan={plan_id or slug}</code> - Get items for specific plan - <code>service_slug={slug}</code> - Filter by service - <code>unit_type={type}</code> - Filter by unit type</p> <p>Response: <pre><code>[\n  {\n    \"id\": 456,\n    \"unit_type\": \"UNIT\",\n    \"how_many\": -1,\n    \"sort_priority\": 1,\n    \"is_renewable\": true,\n    \"renew_at\": 1,\n    \"renew_at_unit\": \"MONTH\",\n    \"is_team_allowed\": false,\n    \"service\": {\n      \"id\": 12,\n      \"slug\": \"ai-conversation-message\",\n      \"title\": \"AI Chat Messages\",\n      \"icon_url\": \"https://...\",\n      \"type\": \"VOID\",\n      \"consumer\": \"AI_INTERACTION\",\n      \"private\": true\n    },\n    \"features\": [\n      {\n        \"lang\": \"en\",\n        \"one_line_desc\": \"Chat with AI mentors\",\n        \"description\": \"Get unlimited AI assistance...\"\n      }\n    ]\n  }\n]\n</code></pre></p> <p>Example: <pre><code>GET /v1/payments/serviceitem?plan=premium-bootcamp\n</code></pre></p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#pricing-configuration","title":"Pricing Configuration","text":""},{"location":"LLM-DOCS/ACADEMY_PLANS/#price-fields","title":"Price Fields","text":"<p>Plans support multiple pricing periods:</p> Field Description Use Case <code>price_per_month</code> Monthly rate Monthly subscriptions <code>price_per_quarter</code> Quarterly rate (3 months) Quarterly billing <code>price_per_half</code> Semi-annual rate (6 months) Semi-annual billing <code>price_per_year</code> Annual rate (12 months) Yearly subscriptions <p>Example: <pre><code>{\n  \"price_per_month\": 299.00,\n  \"price_per_quarter\": 799.00,    // ~11% discount\n  \"price_per_half\": 1499.00,      // ~16% discount\n  \"price_per_year\": 2999.00       // ~17% discount\n}\n</code></pre></p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#country-specific-pricing","title":"Country-Specific Pricing","text":"<p>Use <code>pricing_ratio_exceptions</code> for regional pricing:</p> <pre><code>{\n  \"slug\": \"premium-bootcamp\",\n  \"price_per_month\": 299.00,\n  \"currency\": \"USD\",\n  \"pricing_ratio_exceptions\": {\n    \"ES\": 0.85,  // 15% discount for Spain\n    \"MX\": 0.70,  // 30% discount for Mexico\n    \"IN\": 0.50   // 50% discount for India\n  }\n}\n</code></pre> <p>How it works: - Base price: <code>$299/month</code> - Spain: <code>$299 \u00d7 0.85 = $254.15/month</code> - Mexico: <code>$299 \u00d7 0.70 = $209.30/month</code> - India: <code>$299 \u00d7 0.50 = $149.50/month</code></p> <p>Retrieving adjusted prices: <pre><code>GET /v1/payments/academy/plan?country_code=ES\n</code></pre></p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#financing-options","title":"Financing Options","text":""},{"location":"LLM-DOCS/ACADEMY_PLANS/#what-are-financing-options","title":"What are Financing Options?","text":"<p>Financing options allow customers to pay in installments instead of upfront. Each academy can create and manage their own financing options.</p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#ownership-model","title":"Ownership Model","text":"<ul> <li>Each financing option belongs to a specific academy</li> <li>Academies can only view, edit, and delete their own financing options</li> <li>Global financing options (academy=None) can be viewed by all but only managed by staff</li> </ul> <p>Model Structure: <pre><code>{\n  \"id\": 10,\n  \"academy\": {\n    \"id\": 1,\n    \"name\": \"4Geeks Academy\",\n    \"slug\": \"4geeks\"\n  },\n  \"monthly_price\": 299.00,\n  \"how_many_months\": 12,\n  \"currency\": {\n    \"code\": \"USD\",\n    \"name\": \"US Dollar\"\n  },\n  \"pricing_ratio_exceptions\": {\n    \"MX\": 0.70,\n    \"ES\": 0.85\n  }\n}\n</code></pre></p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#managing-financing-options","title":"Managing Financing Options","text":""},{"location":"LLM-DOCS/ACADEMY_PLANS/#list-financing-options","title":"List Financing Options","text":"<pre><code>GET /v1/payments/academy/financingoption\n  ?currency=USD           # Optional: filter by currency\n  &amp;how_many_months=12     # Optional: filter by months\nHeader: academy: 1\n</code></pre> <p>Required Capability: <code>read_subscription</code></p> <p>Response: Array of financing options (academy-owned + global)</p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#create-financing-option","title":"Create Financing Option","text":"<pre><code>POST /v1/payments/academy/financingoption\nHeader: academy: 1\nBody:\n{\n  \"monthly_price\": 299.00,\n  \"how_many_months\": 12,\n  \"currency\": \"USD\",\n  \"pricing_ratio_exceptions\": {\n    \"MX\": 0.70,\n    \"ES\": 0.85\n  }\n}\n</code></pre> <p>Required Capability: <code>crud_subscription</code></p> <p>Notes: - Academy is set automatically based on header - Currency must be a valid currency code</p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#update-financing-option","title":"Update Financing Option","text":"<pre><code>PUT /v1/payments/academy/financingoption/{financing_option_id}\nHeader: academy: 1\nBody:\n{\n  \"monthly_price\": 349.00\n}\n</code></pre> <p>Required Capability: <code>crud_subscription</code></p> <p>Notes: - Can only update financing options owned by your academy - Partial updates supported</p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#delete-financing-option","title":"Delete Financing Option","text":"<pre><code>DELETE /v1/payments/academy/financingoption/{financing_option_id}\nHeader: academy: 1\n</code></pre> <p>Required Capability: <code>crud_subscription</code></p> <p>Notes: - Can only delete financing options owned by your academy - Cannot delete if used by any plans (returns 400 error)</p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#common-configurations","title":"Common Configurations","text":"<p>6-month financing: <pre><code>{\n  \"monthly_price\": 499.00,\n  \"how_many_months\": 6,\n  \"currency\": \"USD\"\n}\n</code></pre></p> <p>12-month financing with country pricing: <pre><code>{\n  \"monthly_price\": 299.00,\n  \"how_many_months\": 12,\n  \"currency\": \"USD\",\n  \"pricing_ratio_exceptions\": {\n    \"MX\": 0.70,  // 30% discount for Mexico\n    \"ES\": 0.85   // 15% discount for Spain\n  }\n}\n</code></pre></p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#linking-financing-options-to-plan","title":"Linking Financing Options to Plan","text":"<p>Include in plan creation/update: <pre><code>{\n  \"slug\": \"premium-bootcamp\",\n  \"financing_options\": [10, 11, 12],\n  \"is_renewable\": false\n}\n</code></pre></p> <p>Customer selects at checkout: - System creates <code>PlanFinancing</code> record - Monthly charges scheduled automatically - Certificate issued after final payment</p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#complete-plan-creation-workflow","title":"Complete Plan Creation Workflow","text":""},{"location":"LLM-DOCS/ACADEMY_PLANS/#step-1-create-or-view-service-items","title":"Step 1: Create or View Service Items","text":""},{"location":"LLM-DOCS/ACADEMY_PLANS/#option-a-create-new-service-items","title":"Option A: Create New Service Items","text":"<p>If you need custom service items for your academy:</p> <pre><code>POST /v1/payments/academy/serviceitem\nHeaders:\n  Academy: 1\n  Authorization: Token {token}\n\nBody:\n{\n  \"service\": 12,\n  \"how_many\": -1,\n  \"is_renewable\": false\n}\n</code></pre> <p>Response: Returns created ServiceItem with ID <code>456</code></p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#option-b-use-existing-service-items","title":"Option B: Use Existing Service Items","text":"<p>View already-created service items:</p> <pre><code>GET /v1/payments/serviceitem\n</code></pre> <p>Response: Array of available service items to link to plans</p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#step-2-create-the-plan","title":"Step 2: Create the Plan","text":"<pre><code>POST /v1/payments/academy/plan\nHeaders:\n  Academy: 1\n  Authorization: Token {token}\n\nBody:\n{\n  \"slug\": \"web-dev-bootcamp-2025\",\n  \"title\": \"Web Development Bootcamp 2025\",\n  \"currency\": \"USD\",\n  \"status\": \"DRAFT\",\n  \"is_renewable\": false,\n  \"is_onboarding\": true,\n  \"time_of_life\": 6,\n  \"time_of_life_unit\": \"MONTH\",\n  \"trial_duration\": 0,\n  \"trial_duration_unit\": \"DAY\",\n  \"price_per_month\": 299.00,\n  \"price_per_quarter\": 799.00,\n  \"price_per_year\": 2499.00,\n  \"cohort_set\": 5,\n  \"consumption_strategy\": \"PER_SEAT\"\n}\n</code></pre>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#step-3-add-service-items-to-plan","title":"Step 3: Add Service Items to Plan","text":"<p>Link the service items (created in Step 1 or existing ones) to your plan:</p> <pre><code>POST /v1/payments/academy/plan/serviceitem\nHeaders:\n  Academy: 1\n\nBody:\n{\n  \"plan\": \"web-dev-bootcamp-2025\",\n  \"service_item\": [456, 52, 93, 106]  # Use IDs from Step 1\n}\n</code></pre> <p>Note: Service item <code>456</code> is the one you created in Step 1.</p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#step-4-link-financing-options-optional","title":"Step 4: Link Financing Options (Optional)","text":"<pre><code>PUT /v1/payments/academy/plan/web-dev-bootcamp-2025\nBody:\n{\n  \"financing_options\": [10, 11]\n}\n</code></pre>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#step-5-activate-the-plan","title":"Step 5: Activate the Plan","text":"<pre><code>PUT /v1/payments/academy/plan/web-dev-bootcamp-2025\nBody:\n{\n  \"status\": \"ACTIVE\"\n}\n</code></pre>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#step-6-add-students-with-plan","title":"Step 6: Add Students with Plan","text":"<pre><code>POST /v1/auth/academy/student\nHeaders:\n  Academy: 1\n\nBody:\n{\n  \"email\": \"student@example.com\",\n  \"first_name\": \"John\",\n  \"last_name\": \"Doe\",\n  \"cohort\": [1429],\n  \"invite\": true,\n  \"plans\": [123]  // Your plan ID\n}\n</code></pre>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#cohort-sets-resource-linking","title":"Cohort Sets &amp; Resource Linking","text":""},{"location":"LLM-DOCS/ACADEMY_PLANS/#what-are-cohort-sets","title":"What are Cohort Sets?","text":"<p>Cohort Sets group cohorts together so they can be sold as a package. They allow you to bundle multiple cohorts into a single offering that students can purchase through a plan.</p> <p>Example: - CohortSet: \"Full Stack Program\"   - Cohort: \"Web Development Fundamentals\"   - Cohort: \"Advanced JavaScript\"   - Cohort: \"React &amp; Backend\"</p> <p>Key Benefits: - Package multiple cohorts together - Sell as a single unit through plans - Automatically grant access to all cohorts when plan is purchased - Flexible management - add/remove cohorts anytime</p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#managing-cohort-sets","title":"Managing Cohort Sets","text":""},{"location":"LLM-DOCS/ACADEMY_PLANS/#create-a-cohort-set","title":"Create a Cohort Set","text":"<p>Endpoint: <code>POST /v1/payments/academy/cohortset</code></p> <p>Authentication: Required - <code>crud_plan</code> capability</p> <p>Headers: - <code>Academy: {academy_id}</code> - Required - <code>Authorization: Token {your-token}</code> - Required</p> <p>Request Body: <pre><code>{\n  \"slug\": \"full-stack-bootcamp-2025\"\n}\n</code></pre></p> <p>Required Fields: - <code>slug</code> (string) - Unique identifier for the cohort set (letters, numbers, hyphens only)</p> <p>Response: <code>201 CREATED</code> <pre><code>{\n  \"id\": 5,\n  \"slug\": \"full-stack-bootcamp-2025\",\n  \"academy\": {\n    \"id\": 1,\n    \"name\": \"4Geeks Academy\",\n    \"slug\": \"4geeks\"\n  },\n  \"cohorts\": []\n}\n</code></pre></p> <p>Example: <pre><code>POST /v1/payments/academy/cohortset\nHeaders:\n  Academy: 1\n  Authorization: Token {token}\n\nBody:\n{\n  \"slug\": \"full-stack-bootcamp-2025\"\n}\n</code></pre></p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#list-cohort-sets","title":"List Cohort Sets","text":"<p>Endpoint: <code>GET /v1/payments/academy/cohortset</code></p> <p>Authentication: Required - <code>crud_plan</code> capability</p> <p>Query Parameters: - <code>limit={number}</code> - Results per page - <code>offset={number}</code> - Pagination offset</p> <p>Response: Array of cohort sets <pre><code>[\n  {\n    \"id\": 5,\n    \"slug\": \"full-stack-bootcamp-2025\",\n    \"academy\": {\n      \"id\": 1,\n      \"name\": \"4Geeks Academy\",\n      \"slug\": \"4geeks\"\n    },\n    \"cohorts\": [\n      {\n        \"id\": 123,\n        \"name\": \"Web Development Fundamentals\",\n        \"slug\": \"web-dev-fundamentals\"\n      },\n      {\n        \"id\": 456,\n        \"name\": \"Advanced JavaScript\",\n        \"slug\": \"advanced-javascript\"\n      }\n    ]\n  }\n]\n</code></pre></p> <p>Example: <pre><code>GET /v1/payments/academy/cohortset\nHeaders:\n  Academy: 1\n  Authorization: Token {token}\n</code></pre></p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#get-a-single-cohort-set","title":"Get a Single Cohort Set","text":"<p>Endpoint: <code>GET /v1/payments/academy/cohortset/{cohort_set_id}</code> Or: <code>GET /v1/payments/academy/cohortset/{cohort_set_slug}</code></p> <p>Authentication: Required - <code>crud_plan</code> capability</p> <p>Response: Single cohort set object with all cohorts</p> <p>Example: <pre><code>GET /v1/payments/academy/cohortset/full-stack-bootcamp-2025\nHeaders:\n  Academy: 1\n  Authorization: Token {token}\n</code></pre></p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#update-a-cohort-set","title":"Update a Cohort Set","text":"<p>Endpoint: <code>PUT /v1/payments/academy/cohortset/{cohort_set_id}</code> Or: <code>PUT /v1/payments/academy/cohortset/{cohort_set_slug}</code></p> <p>Authentication: Required - <code>crud_plan</code> capability</p> <p>Request Body: <pre><code>{\n  \"slug\": \"updated-bootcamp-slug\"\n}\n</code></pre></p> <p>Example: <pre><code>PUT /v1/payments/academy/cohortset/full-stack-bootcamp-2025\nHeaders:\n  Academy: 1\n  Authorization: Token {token}\n\nBody:\n{\n  \"slug\": \"full-stack-bootcamp-2025-v2\"\n}\n</code></pre></p> <p>Note: Only the slug can be updated. To manage cohorts in the set, use the cohort management endpoints below.</p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#delete-a-cohort-set","title":"Delete a Cohort Set","text":"<p>Endpoint: <code>DELETE /v1/payments/academy/cohortset/{cohort_set_id}</code> Or: <code>DELETE /v1/payments/academy/cohortset/{cohort_set_slug}</code></p> <p>Authentication: Required - <code>crud_plan</code> capability</p> <p>Response: <code>204 No Content</code></p> <p>Example: <pre><code>DELETE /v1/payments/academy/cohortset/old-bootcamp-2024\nHeaders:\n  Academy: 1\n  Authorization: Token {token}\n</code></pre></p> <p>Warning: \u26a0\ufe0f Deleting a cohort set will remove it from all plans that reference it. Ensure no active plans are using this cohort set before deleting.</p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#managing-cohorts-in-a-cohort-set","title":"Managing Cohorts in a Cohort Set","text":""},{"location":"LLM-DOCS/ACADEMY_PLANS/#get-all-cohorts-in-a-cohort-set","title":"Get All Cohorts in a Cohort Set","text":"<p>Endpoint: <code>GET /v1/payments/academy/cohortset/{cohort_set_id}/cohort</code> Or: <code>GET /v1/payments/academy/cohortset/{cohort_set_slug}/cohort</code></p> <p>Authentication: Required - <code>crud_plan</code> capability</p> <p>Response: Array of cohorts <pre><code>[\n  {\n    \"id\": 123,\n    \"name\": \"Web Development Fundamentals\",\n    \"slug\": \"web-dev-fundamentals\"\n  },\n  {\n    \"id\": 456,\n    \"name\": \"Advanced JavaScript\",\n    \"slug\": \"advanced-javascript\"\n  },\n  {\n    \"id\": 789,\n    \"name\": \"React &amp; Backend\",\n    \"slug\": \"react-backend\"\n  }\n]\n</code></pre></p> <p>Example: <pre><code>GET /v1/payments/academy/cohortset/full-stack-bootcamp-2025/cohort\nHeaders:\n  Academy: 1\n  Authorization: Token {token}\n</code></pre></p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#add-cohorts-to-a-cohort-set","title":"Add Cohorts to a Cohort Set","text":"<p>Endpoint: <code>PUT /v1/payments/academy/cohortset/{cohort_set_id}/cohort</code> Or: <code>PUT /v1/payments/academy/cohortset/{cohort_set_slug}/cohort</code></p> <p>Authentication: Required - <code>crud_plan</code> capability</p> <p>Request Body (Query Parameters): <pre><code>{\n  \"id__in\": [123, 456, 789]  // Array of cohort IDs to add\n}\n</code></pre></p> <p>Or using slugs: <pre><code>{\n  \"slug__in\": [\"web-dev-fundamentals\", \"advanced-javascript\", \"react-backend\"]\n}\n</code></pre></p> <p>Supported Query Parameters: - <code>id__in</code> - Array of cohort IDs to add - <code>slug__in</code> - Array of cohort slugs to add</p> <p>Response: <pre><code>{\n  \"status\": \"ok\"\n}\n</code></pre></p> <p>Example with IDs: <pre><code>PUT /v1/payments/academy/cohortset/5/cohort\nHeaders:\n  Academy: 1\n  Authorization: Token {token}\n\nBody:\n{\n  \"id__in\": [123, 456, 789]\n}\n</code></pre></p> <p>Example with slugs: <pre><code>PUT /v1/payments/academy/cohortset/full-stack-bootcamp-2025/cohort\nHeaders:\n  Academy: 1\n  Authorization: Token {token}\n\nBody:\n{\n  \"slug__in\": [\"web-dev-fundamentals\", \"advanced-javascript\", \"react-backend\"]\n}\n</code></pre></p> <p>Notes: - Cohorts must belong to the same academy as the cohort set - Cohorts must have <code>available_as_saas=true</code> or belong to an academy with <code>available_as_saas=true</code> - Duplicate cohorts are automatically ignored (won't create duplicates) - Returns <code>201 CREATED</code> if cohorts were added, <code>200 OK</code> if all cohorts were already in the set</p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#remove-cohorts-from-a-cohort-set","title":"Remove Cohorts from a Cohort Set","text":"<p>Endpoint: <code>DELETE /v1/payments/academy/cohortset/{cohort_set_id}/cohort</code> Or: <code>DELETE /v1/payments/academy/cohortset/{cohort_set_slug}/cohort</code></p> <p>Authentication: Required - <code>crud_plan</code> capability</p> <p>Request Body (Query Parameters): <pre><code>{\n  \"id__in\": [123, 456]  // Array of cohort IDs to remove\n}\n</code></pre></p> <p>Or using slugs: <pre><code>{\n  \"slug__in\": [\"web-dev-fundamentals\", \"advanced-javascript\"]\n}\n</code></pre></p> <p>Response: <pre><code>{\n  \"status\": \"ok\"\n}\n</code></pre></p> <p>Example: <pre><code>DELETE /v1/payments/academy/cohortset/full-stack-bootcamp-2025/cohort\nHeaders:\n  Academy: 1\n  Authorization: Token {token}\n\nBody:\n{\n  \"slug__in\": [\"web-dev-fundamentals\"]\n}\n</code></pre></p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#complete-cohort-set-workflow","title":"Complete Cohort Set Workflow","text":"<p>Step 1: Create a cohort set <pre><code>POST /v1/payments/academy/cohortset\nBody: {\"slug\": \"full-stack-bootcamp-2025\"}\n# Response: { \"id\": 5, ... }\n</code></pre></p> <p>Step 2: Add cohorts to the set <pre><code>PUT /v1/payments/academy/cohortset/5/cohort\nBody: {\"id__in\": [123, 456, 789]}\n# Response: { \"status\": \"ok\" }\n</code></pre></p> <p>Step 3: Verify cohorts are added <pre><code>GET /v1/payments/academy/cohortset/5/cohort\n# Response: [{\"id\": 123, ...}, {\"id\": 456, ...}, {\"id\": 789, ...}]\n</code></pre></p> <p>Step 4: Link cohort set to a plan <pre><code>POST /v1/payments/academy/plan\nBody: {\n  \"slug\": \"bootcamp-plan\",\n  \"cohort_set\": 5,  // \u2190 Use the cohort set ID\n  ...\n}\n</code></pre></p> <p>Step 5: Students purchase plan \u2192 Automatically get access to all cohorts in the set</p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#cohort-set-validation-rules","title":"Cohort Set Validation Rules","text":"<ol> <li>\u2705 <code>slug</code> must be unique across all cohort sets</li> <li>\u2705 <code>slug</code> can only contain: letters, numbers, hyphens</li> <li>\u2705 Cohorts must belong to the same academy as the cohort set</li> <li>\u2705 Cohorts must have <code>available_as_saas=true</code> or academy must have <code>available_as_saas=true</code></li> <li>\u274c Cannot add cohorts from different academies</li> <li>\u274c Cannot remove cohort set if linked to active plans (delete the plans first)</li> </ol>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#use-cases","title":"Use Cases","text":""},{"location":"LLM-DOCS/ACADEMY_PLANS/#bootcamp-program","title":"Bootcamp Program","text":"<p>Bundle multiple cohorts into a single bootcamp program: <pre><code>{\n  \"slug\": \"full-stack-bootcamp-2025\",\n  \"cohorts\": [\n    \"html-css-fundamentals\",\n    \"javascript-basics\",\n    \"react-intro\",\n    \"backend-with-python\",\n    \"final-project\"\n  ]\n}\n</code></pre></p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#certification-path","title":"Certification Path","text":"<p>Group cohorts for a certification track: <pre><code>{\n  \"slug\": \"aws-cloud-practitioner-cert\",\n  \"cohorts\": [\n    \"aws-fundamentals\",\n    \"ec2-and-networking\",\n    \"databases-and-storage\",\n    \"security-and-compliance\"\n  ]\n}\n</code></pre></p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#multi-cohort-subscription","title":"Multi-Cohort Subscription","text":"<p>Offer access to multiple cohorts through a subscription: <pre><code>{\n  \"slug\": \"all-access-pass\",\n  \"cohorts\": [\"python-101\", \"python-102\", \"python-201\", \"python-202\"]\n}\n</code></pre></p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#service-management","title":"Service Management","text":"<p>BreatheCode uses a two-tier service system:</p> <ol> <li>Service - Base service definitions (what services exist)</li> <li>AcademyService - Academy-specific pricing and configuration (how to sell them)</li> </ol> <p>This separation allows services to be shared across academies while maintaining academy-specific pricing.</p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#creation-flow-important","title":"\ud83d\udd04 Creation Flow (Important!)","text":"<p>You must create Services BEFORE AcademyServices:</p> <pre><code>Step 1: Service exists\n   \u251c\u2500\u2500 Created by your academy (owner=your_academy)\n   \u251c\u2500\u2500 Created by another academy (owner=other_academy) \u2190 You can still use it!\n   \u2514\u2500\u2500 Global service (owner=None) \u2190 Shared across all academies\n        \u2193\nStep 2: Create AcademyService\n   \u2514\u2500\u2500 Links the Service to your academy with your pricing\n</code></pre> <p>Example: - Academy A creates Service \"AI Chat\" (owner=Academy A) - Academy B can create AcademyService using that same \"AI Chat\" service - Each academy sets their own price, bundle size, and discounts</p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#public-service-catalog","title":"Public Service Catalog","text":"<p>Endpoint: <code>GET /v1/payments/service</code></p> <p>This is a public, unauthenticated endpoint for browsing available services.</p> <p>Authentication: \u274c Not required (but capability affects results)</p> <p>Query Parameters: - <code>group</code> - Filter by permission group name - <code>cohort_slug</code> - Filter by cohort - <code>mentorship_service_slug</code> - Filter by mentorship service - <code>academy</code> - Optional academy ID (filters by owner + enables private service viewing with capability) - <code>like</code> - Search by slug or title (case-insensitive, partial match)</p> <p>Privacy Filtering: - Without auth or capability: Returns only <code>private=false</code> services - With <code>read_service</code> capability + academy ID: Returns all services (including private)</p> <p>Example - Public Access: <pre><code>GET /v1/payments/service\n# Returns only public services\n</code></pre></p> <p>Example - Filter by Academy: <pre><code>GET /v1/payments/service?academy=1\n# Returns services owned by academy 1 + global services (owner=None)\n</code></pre></p> <p>Example - With Capability: <pre><code>GET /v1/payments/service?academy=1\nAuthorization: Token {token}\n# Returns all services owned by academy 1 + global services\n# If user has read_service capability, also includes private services\n</code></pre></p> <p>Example - Search Services: <pre><code>GET /v1/payments/service?like=mentorship\n# Returns services with \"mentorship\" in slug or title\n</code></pre></p> <p>Response: <pre><code>[\n  {\n    \"title\": \"AI Chat Messages\",\n    \"slug\": \"ai-conversation-message\",\n    \"owner\": {\n      \"id\": 1,\n      \"name\": \"4Geeks Academy\",\n      \"slug\": \"4geeks\"\n    },\n    \"private\": false,\n    \"groups\": []\n  }\n]\n</code></pre></p> <p>Use Case: - Students browsing available features - Building public service catalogs - Checking which services exist before creating AcademyService</p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#part-1-service-management-base-services","title":"Part 1: Service Management (Base Services)","text":"<p>Services define what features or resources are available. They can be owned by an academy, another academy, or be global (owner=None).</p> <p>Key Points: - \u2705 Services can be reused across academies - \u2705 One Service \u2192 Many AcademyServices (different academies, different pricing) - \u2705 Academy B can use services created by Academy A - \u2705 Global services (owner=None) are available to all academies</p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#list-services","title":"List Services","text":"<p>Endpoint: <code>GET /v1/payments/academy/service</code></p> <p>Authentication: Required - <code>read_service</code> capability</p> <p>Query Parameters: - <code>group</code> - Filter by permission group name - <code>cohort_slug</code> - Filter by cohort - <code>mentorship_service_slug</code> - Filter by mentorship service - <code>like</code> - Search by slug or title (case-insensitive, partial match)</p> <p>Response: <pre><code>[\n  {\n    \"id\": 12,\n    \"slug\": \"code-review-service\",\n    \"title\": \"Code Review Service\",\n    \"icon_url\": \"https://...\",\n    \"type\": \"VOID\",\n    \"consumer\": \"ADD_CODE_REVIEW\",\n    \"private\": true,\n    \"session_duration\": null,\n    \"groups\": [\n      {\n        \"name\": \"Student\",\n        \"permissions\": [\n          {\n            \"codename\": \"can_request_code_review\",\n            \"name\": \"Can request code review\"\n          }\n        ]\n      }\n    ]\n  }\n]\n</code></pre></p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#get-single-service","title":"Get Single Service","text":"<p>Endpoint: <code>GET /v1/payments/academy/service/{service_slug}</code></p> <p>Authentication: Required - <code>read_service</code> capability</p> <p>Response: Single service object (same structure as list)</p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#create-service","title":"Create Service","text":"<p>Endpoint: <code>POST /v1/payments/academy/service</code></p> <p>Authentication: Required - <code>crud_service</code> capability</p> <p>Request Body: <pre><code>{\n  \"slug\": \"premium-mentorship\",\n  \"title\": \"Premium Mentorship Sessions\",\n  \"icon_url\": \"https://...\",\n  \"type\": \"MENTORSHIP_SERVICE_SET\",\n  \"consumer\": \"JOIN_MENTORSHIP\",\n  \"private\": true,\n  \"session_duration\": \"3600\"\n}\n</code></pre></p> <p>Notes: - <code>owner</code> is automatically set to the academy from the header - <code>slug</code> must be unique - Service types: <code>COHORT_SET</code>, <code>MENTORSHIP_SERVICE_SET</code>, <code>EVENT_TYPE_SET</code>, <code>VOID</code>, <code>SEAT</code></p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#update-service","title":"Update Service","text":"<p>Endpoint: <code>PUT /v1/payments/academy/service/{service_slug}</code></p> <p>Authentication: Required - <code>crud_service</code> capability</p> <p>Request Body: Same fields as POST (partial updates supported)</p> <p>Notes: - Can only update services owned by your academy or global services</p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#part-2-academyservice-management-pricing-configuration","title":"Part 2: AcademyService Management (Pricing Configuration)","text":"<p>AcademyService defines how an academy prices and sells a specific service. It includes pricing, bundle sizes, discounts, and availability.</p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#what-is-academyservice","title":"What is AcademyService?","text":"<p>AcademyService connects a Service to an Academy with specific pricing rules: - Price per unit - How much one unit costs - Bundle size - Minimum units that can be purchased - Max items - Maximum quantity limit - Discount ratio - Bulk purchase discounts - Country pricing - Regional price adjustments - Availability - Which mentorship/event/cohort sets can use it</p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#list-academy-services","title":"List Academy Services","text":"<p>Endpoint: <code>GET /v1/payments/academy/academyservice</code></p> <p>Authentication: Required - <code>read_academyservice</code> capability</p> <p>Query Parameters: - <code>currency__code</code> - Filter by currency code (e.g., \"USD\") - <code>mentorship_service_set</code> - Filter by mentorship set slug - <code>event_type_set</code> - Filter by event type set slug - <code>country_code</code> - Get country-adjusted pricing - <code>like</code> - Search by service slug or title (case-insensitive, partial match)</p> <p>Response: <pre><code>[\n  {\n    \"id\": 1,\n    \"academy\": {\n      \"id\": 1,\n      \"name\": \"4Geeks Academy\",\n      \"slug\": \"4geeks\"\n    },\n    \"service\": {\n      \"id\": 12,\n      \"slug\": \"ai-conversation-message\",\n      \"title\": \"AI Chat Messages\",\n      \"type\": \"VOID\",\n      \"consumer\": \"AI_INTERACTION\",\n      \"owner\": {\n        \"id\": 1,\n        \"name\": \"4Geeks Academy\",\n        \"slug\": \"4geeks\"\n      },\n      \"private\": false\n    },\n    \"currency\": {\n      \"code\": \"USD\",\n      \"name\": \"US Dollar\"\n    },\n    \"price_per_unit\": 0.10,\n    \"bundle_size\": 100,\n    \"max_items\": 10000,\n    \"max_amount\": 1000.00,\n    \"discount_ratio\": 0.90,\n    \"pricing_ratio_exceptions\": {\n      \"MX\": 0.70,\n      \"ES\": 0.85\n    },\n    \"available_mentorship_service_sets\": [\n      {\n        \"id\": 1,\n        \"slug\": \"standard-mentorship\",\n        \"name\": \"Standard Mentorship\"\n      }\n    ],\n    \"available_event_type_sets\": [],\n    \"available_cohort_sets\": []\n  }\n]\n</code></pre></p> <p>Understanding the Response: - <code>academy</code> - The academy that owns this pricing (AcademyService owner) - <code>service.owner</code> - The academy that created the Service definition - These can be different! You can price services created by other academies</p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#get-single-academy-service","title":"Get Single Academy Service","text":"<p>Endpoint: <code>GET /v1/payments/academy/academyservice/{service_slug}</code></p> <p>Authentication: Required - <code>read_academyservice</code> capability</p> <p>Query Parameters: - <code>currency__code</code> - Specify currency (required if service has multiple) - <code>country_code</code> - Get adjusted pricing for specific country</p> <p>Example: <pre><code>GET /v1/payments/academy/academyservice/ai-conversation-message\n  ?currency__code=USD\n  &amp;country_code=ES\nHeaders:\n  Academy: 1\n  Authorization: Token {token}\n</code></pre></p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#create-academy-service","title":"Create Academy Service","text":"<p>Endpoint: <code>POST /v1/payments/academy/academyservice</code></p> <p>Authentication: Required - <code>crud_academyservice</code> capability</p> <p>Request Body: <pre><code>{\n  \"service\": 12,\n  \"currency\": \"USD\",\n  \"price_per_unit\": 0.10,\n  \"bundle_size\": 100,\n  \"max_items\": 10000,\n  \"max_amount\": 1000.00,\n  \"discount_ratio\": 0.90,\n  \"pricing_ratio_exceptions\": {\n    \"MX\": 0.70,\n    \"ES\": 0.85\n  },\n  \"available_mentorship_service_sets\": [1, 2],\n  \"available_event_type_sets\": [5],\n  \"available_cohort_sets\": [10, 11]\n}\n</code></pre></p> <p>Field Descriptions:</p> Field Type Required Description <code>service</code> integer \u2705 Yes Service ID to price <code>currency</code> string \u2705 Yes Currency code (e.g., \"USD\") <code>price_per_unit</code> float \u2705 Yes Price per single unit <code>bundle_size</code> float No Minimum units (default: 1) <code>max_items</code> float No Max quantity limit (default: 1) <code>max_amount</code> float No Max price limit (default: 1) <code>discount_ratio</code> float No Discount multiplier (default: 1.0) <code>pricing_ratio_exceptions</code> object No Country-specific ratios <code>available_mentorship_service_sets</code> array No Mentorship set IDs <code>available_event_type_sets</code> array No Event type set IDs <code>available_cohort_sets</code> array No Cohort set IDs <p>Notes: - <code>academy</code> is automatically set from the header - Each academy can have only one AcademyService per Service (enforced by <code>unique_together</code> constraint) - Multiple academies can price the same Service differently</p> <p>Response: <code>201 CREATED</code> with created AcademyService object</p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#update-academy-service","title":"Update Academy Service","text":"<p>Endpoint: <code>PUT /v1/payments/academy/academyservice/{service_slug}</code></p> <p>Authentication: Required - <code>crud_academyservice</code> capability</p> <p>Request Body (partial updates supported): <pre><code>{\n  \"price_per_unit\": 0.12,\n  \"discount_ratio\": 0.85,\n  \"pricing_ratio_exceptions\": {\n    \"MX\": 0.65,\n    \"ES\": 0.80,\n    \"CO\": 0.75\n  }\n}\n</code></pre></p> <p>Example - Update Pricing: <pre><code>PUT /v1/payments/academy/academyservice/ai-conversation-message\nHeaders:\n  Academy: 1\n  Authorization: Token {token}\n\nBody:\n{\n  \"price_per_unit\": 0.15,\n  \"max_items\": 20000\n}\n</code></pre></p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#academyservice-pricing-examples","title":"AcademyService Pricing Examples","text":""},{"location":"LLM-DOCS/ACADEMY_PLANS/#example-1-ai-chat-messages-pay-per-use","title":"Example 1: AI Chat Messages (Pay-per-use)","text":"<p><pre><code>{\n  \"service\": 12,\n  \"currency\": \"USD\",\n  \"price_per_unit\": 0.01,\n  \"bundle_size\": 100,\n  \"max_items\": 50000,\n  \"max_amount\": 500.00,\n  \"discount_ratio\": 1.0\n}\n</code></pre> - Students buy in bundles of 100 messages - Each message costs $0.01 - 100 messages = $1.00 - Maximum 50,000 messages ($500 limit)</p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#example-2-mentorship-sessions-bulk-discount","title":"Example 2: Mentorship Sessions (Bulk Discount)","text":"<p><pre><code>{\n  \"service\": 25,\n  \"currency\": \"USD\",\n  \"price_per_unit\": 50.00,\n  \"bundle_size\": 1,\n  \"max_items\": 20,\n  \"max_amount\": 800.00,\n  \"discount_ratio\": 0.90\n}\n</code></pre> - Each session: $50 - Buy 10 sessions: $500 \u00d7 0.90 = $450 (10% discount) - Maximum 20 sessions</p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#example-3-regional-pricing","title":"Example 3: Regional Pricing","text":"<p><pre><code>{\n  \"service\": 12,\n  \"currency\": \"USD\",\n  \"price_per_unit\": 1.00,\n  \"bundle_size\": 10,\n  \"pricing_ratio_exceptions\": {\n    \"MX\": 0.70,\n    \"ES\": 0.85,\n    \"IN\": 0.50,\n    \"BR\": 0.60\n  }\n}\n</code></pre> - Base: $1.00 per unit - Mexico: $0.70 (30% off) - Spain: $0.85 (15% off) - India: $0.50 (50% off) - Brazil: $0.60 (40% off)</p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#three-endpoints-comparison","title":"Three Endpoints Comparison","text":"Aspect Public <code>/service</code> Academy <code>/academy/service</code> Academy <code>/academy/academyservice</code> Purpose Browse available services Manage service definitions Configure academy pricing Auth Required \u274c No \u2705 Yes \u2705 Yes Capability Optional: <code>read_service</code> <code>read_service</code> / <code>crud_service</code> <code>read_academyservice</code> / <code>crud_academyservice</code> Shows Private Only with capability \u2705 Yes N/A Has Pricing \u274c No \u274c No \u2705 Yes Has Discounts \u274c No \u274c No \u2705 Yes Can Create \u274c No \u2705 Yes \u2705 Yes Ownership Shows all public Academy-owned or global Always academy-specific Use Case Public catalog Define services Price services"},{"location":"LLM-DOCS/ACADEMY_PLANS/#service-academyservice-relationship","title":"Service \u2192 AcademyService Relationship","text":"<pre><code>Service (Platform-wide)\n\u251c\u2500\u2500 ID: 12\n\u251c\u2500\u2500 Slug: \"ai-conversation-message\"\n\u251c\u2500\u2500 Owner: Academy A (or None for global)\n\u251c\u2500\u2500 Private: false\n\u2502\n\u251c\u2500\u2500 AcademyService (Academy A)\n\u2502   \u251c\u2500\u2500 Price: $0.01/unit\n\u2502   \u251c\u2500\u2500 Bundle: 100\n\u2502   \u2514\u2500\u2500 Currency: USD\n\u2502\n\u251c\u2500\u2500 AcademyService (Academy B)\n\u2502   \u251c\u2500\u2500 Price: \u20ac0.015/unit\n\u2502   \u251c\u2500\u2500 Bundle: 50\n\u2502   \u2514\u2500\u2500 Currency: EUR\n\u2502\n\u2514\u2500\u2500 AcademyService (Academy C)\n    \u251c\u2500\u2500 Price: $0.02/unit\n    \u251c\u2500\u2500 Bundle: 200\n    \u2514\u2500\u2500 Currency: USD\n</code></pre> <p>Key Points: - One Service can have multiple AcademyServices (one per academy), each with different pricing - This enables cross-academy service sharing where Academy A creates a service, and Academy B can price it differently for their students - The <code>unique_together</code> constraint on <code>(academy, service)</code> prevents duplicate pricing entries</p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#complete-workflow","title":"Complete Workflow","text":"<p>Scenario: Sell AI chat messages at your academy</p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#option-a-using-existing-service-recommended","title":"Option A: Using Existing Service (Recommended)","text":"<ol> <li> <p>Browse available services (public endpoint): <pre><code>GET /v1/payments/service\n# Check if \"ai-conversation-message\" already exists\n</code></pre></p> </li> <li> <p>If service exists, create AcademyService with your pricing: <pre><code>POST /v1/payments/academy/academyservice\nHeaders:\n  Academy: 1\n  Authorization: Token {token}\n\nBody: {\n  \"service\": 12,  // Use existing service ID\n  \"currency\": \"USD\",\n  \"price_per_unit\": 0.01,\n  \"bundle_size\": 100,\n  \"max_items\": 50000\n}\n</code></pre></p> </li> </ol> <p>Note: The service can be owned by ANY academy or be global. You're just setting YOUR pricing!</p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#option-b-creating-new-service","title":"Option B: Creating New Service","text":"<ol> <li> <p>Check if Service exists: <pre><code>GET /v1/payments/academy/service/ai-conversation-message\nHeaders:\n  Academy: 1\n  Authorization: Token {token}\n</code></pre></p> </li> <li> <p>Create Service if it doesn't exist: <pre><code>POST /v1/payments/academy/service\nHeaders:\n  Academy: 1\n  Authorization: Token {token}\n\nBody: {\n  \"slug\": \"ai-conversation-message\",\n  \"title\": \"AI Chat Messages\",\n  \"type\": \"VOID\",\n  \"consumer\": \"AI_INTERACTION\",\n  \"private\": false  // Make it available to other academies\n}\n</code></pre></p> </li> </ol> <p>Important: <code>owner</code> is automatically set to YOUR academy, but other academies can still use it!</p> <ol> <li>Now create AcademyService (your pricing): <pre><code>POST /v1/payments/academy/academyservice\nBody: {\n  \"service\": 12,  // ID from service you just created\n  \"currency\": \"USD\",\n  \"price_per_unit\": 0.01,\n  \"bundle_size\": 100,\n  \"max_items\": 50000\n}\n</code></pre></li> </ol>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#remaining-steps-both-options","title":"Remaining Steps (Both Options)","text":"<ol> <li> <p>Create ServiceItem (define quantity): <pre><code># ServiceItems define \"how many\" units in a plan\n# Typically created by platform staff via Django admin\n# Links Service \u2192 Plan with quantity (-1 = unlimited)\n</code></pre></p> </li> <li> <p>Add ServiceItem to Plan: <pre><code>POST /v1/payments/academy/plan/serviceitem\nBody: {\n  \"plan\": \"premium-plan\",\n  \"service_item\": [45, 93]\n}\n</code></pre></p> </li> <li> <p>Students purchase plan \u2192 Get consumables</p> </li> </ol>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#cross-academy-service-sharing-example","title":"Cross-Academy Service Sharing Example","text":"<p>Academy A creates a service: <pre><code># Academy A\nPOST /v1/payments/academy/service\nHeaders: {Academy: 1}\nBody: {\n  \"slug\": \"live-code-review\",\n  \"title\": \"Live Code Review Sessions\",\n  \"type\": \"VOID\",\n  \"consumer\": \"ADD_CODE_REVIEW\",\n  \"private\": false\n}\n# \u2192 Service ID: 50, owner: Academy A\n</code></pre></p> <p>Academy B uses the same service with different pricing: <pre><code># Academy B (different academy!)\nPOST /v1/payments/academy/academyservice\nHeaders: {Academy: 2}\nBody: {\n  \"service\": 50,  // \u2190 Using Academy A's service!\n  \"currency\": \"EUR\",\n  \"price_per_unit\": 25.00,\n  \"bundle_size\": 1\n}\n</code></pre></p> <p>Response shows service ownership: <pre><code>{\n  \"id\": 2,\n  \"academy\": {\n    \"id\": 2,\n    \"name\": \"Academy B\",\n    \"slug\": \"academy-b\"\n  },\n  \"service\": {\n    \"id\": 50,\n    \"slug\": \"live-code-review\",\n    \"title\": \"Live Code Review Sessions\",\n    \"owner\": {\n      \"id\": 1,\n      \"name\": \"Academy A\",\n      \"slug\": \"academy-a\"\n    },\n    \"private\": false\n  },\n  \"price_per_unit\": 25.00,\n  \"currency\": {\"code\": \"EUR\"}\n}\n</code></pre></p> <p>Notice: - <code>academy</code> (id: 2) = Who owns THIS pricing config - <code>service.owner</code> (id: 1) = Who created the service definition - Different academies! Academy B is using Academy A's service \u2705</p> <p>Academy C also uses it: <pre><code># Academy C\nPOST /v1/payments/academy/academyservice\nHeaders: {Academy: 3}\nBody: {\n  \"service\": 50,  // \u2190 Same service, different academy pricing\n  \"currency\": \"USD\",\n  \"price_per_unit\": 30.00,\n  \"bundle_size\": 1\n}\n</code></pre></p> <p>Result: - One Service (ID: 50, <code>owner</code>=Academy A) - Three AcademyServices:   - Academy A's pricing: \u20ac25.00/unit   - Academy B's pricing: \u20ac25.00/unit   - Academy C's pricing: $30.00/unit - Students at each academy pay their academy's rate - All three academies using the same service created by Academy A!</p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#plan-status-lifecycle","title":"Plan Status Lifecycle","text":""},{"location":"LLM-DOCS/ACADEMY_PLANS/#status-flow","title":"Status Flow","text":"<pre><code>DRAFT \u2192 ACTIVE \u2192 UNLISTED \u2192 DELETED\n  \u2193       \u2193\n  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n(can publish anytime)\n</code></pre>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#status-definitions","title":"Status Definitions","text":"Status Visible to Customers Can Purchase Use Case <code>DRAFT</code> \u274c No \u274c No Work in progress <code>ACTIVE</code> \u2705 Yes \u2705 Yes Currently selling <code>UNLISTED</code> \u274c No (direct link only) \u2705 Yes Private offers <code>DELETED</code> \u274c No \u274c No Discontinued <code>DISCONTINUED</code> \u274c No \u274c No Deprecated"},{"location":"LLM-DOCS/ACADEMY_PLANS/#workflow-examples","title":"Workflow Examples","text":"<p>Launch new plan: <pre><code># 1. Create in DRAFT\nPOST /v1/payments/academy/plan\nBody: {\"slug\": \"...\", \"status\": \"DRAFT\"}\n\n# 2. Add service items, test\n\n# 3. Activate when ready\nPUT /v1/payments/academy/plan/123\nBody: {\"status\": \"ACTIVE\"}\n</code></pre></p> <p>Limited time offer: <pre><code># 1. Create ACTIVE plan\n# 2. After promotion ends:\nPUT /v1/payments/academy/plan/black-friday-2025\nBody: {\"status\": \"UNLISTED\"}  // Existing customers keep access\n</code></pre></p> <p>Retire old plan: <pre><code>DELETE /v1/payments/academy/plan/old-plan-2024\n# Sets status=\"DELETED\"\n</code></pre></p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#consumption-strategies","title":"Consumption Strategies","text":""},{"location":"LLM-DOCS/ACADEMY_PLANS/#what-is-consumption-strategy","title":"What is Consumption Strategy?","text":"<p>Defines how service items are consumed in team scenarios.</p> Strategy Behavior Use Case <code>PER_SEAT</code> Each team member consumes separately Individual student plans <code>PER_TEAM</code> Entire team shares consumables Corporate team plans <code>BOTH</code> Mix of shared and individual Hybrid plans <p>Example - Per Seat: <pre><code>{\n  \"consumption_strategy\": \"PER_SEAT\",\n  \"service_items\": [\n    {\"service\": \"ai-chat\", \"how_many\": 1000}\n  ]\n}\n</code></pre> - 5 team members = 5,000 total messages (1,000 each)</p> <p>Example - Per Team: <pre><code>{\n  \"consumption_strategy\": \"PER_TEAM\",\n  \"service_items\": [\n    {\"service\": \"mentorship\", \"how_many\": 10}\n  ]\n}\n</code></pre> - 5 team members = 10 total mentorships (shared pool)</p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#trial-periods","title":"Trial Periods","text":""},{"location":"LLM-DOCS/ACADEMY_PLANS/#configuring-trials","title":"Configuring Trials","text":"<pre><code>{\n  \"trial_duration\": 14,\n  \"trial_duration_unit\": \"DAY\"\n}\n</code></pre> <p>Common configurations: - 7-day trial: <code>{\"trial_duration\": 7, \"trial_duration_unit\": \"DAY\"}</code> - 1-month trial: <code>{\"trial_duration\": 1, \"trial_duration_unit\": \"MONTH\"}</code> - No trial: <code>{\"trial_duration\": 0, \"trial_duration_unit\": \"DAY\"}</code></p> <p>How trials work: 1. Customer subscribes without immediate charge 2. Trial period begins 3. First charge occurs after trial ends 4. Can cancel during trial with no charge</p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#plan-lifetime-configuration","title":"Plan Lifetime Configuration","text":""},{"location":"LLM-DOCS/ACADEMY_PLANS/#time-of-life","title":"Time of Life","text":"<p>Defines how long a plan provides access:</p> <pre><code>{\n  \"time_of_life\": 6,\n  \"time_of_life_unit\": \"MONTH\"\n}\n</code></pre> <p>Use Cases:</p> <p>Bootcamp (6 months): <pre><code>{\n  \"is_renewable\": false,\n  \"time_of_life\": 6,\n  \"time_of_life_unit\": \"MONTH\"\n}\n</code></pre></p> <p>Ongoing subscription (infinite): <pre><code>{\n  \"is_renewable\": true,\n  \"time_of_life\": 1,\n  \"time_of_life_unit\": \"MONTH\"  // Renews monthly\n}\n</code></pre></p> <p>Annual plan: <pre><code>{\n  \"is_renewable\": true,\n  \"time_of_life\": 1,\n  \"time_of_life_unit\": \"YEAR\"  // Renews yearly\n}\n</code></pre></p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#complete-examples","title":"Complete Examples","text":""},{"location":"LLM-DOCS/ACADEMY_PLANS/#example-1-monthly-saas-subscription","title":"Example 1: Monthly SaaS Subscription","text":"<pre><code>{\n  \"slug\": \"4geeks-plus-monthly\",\n  \"title\": \"4Geeks Plus - Monthly\",\n  \"currency\": \"USD\",\n  \"status\": \"ACTIVE\",\n  \"is_renewable\": true,\n  \"is_onboarding\": false,\n  \"time_of_life\": 1,\n  \"time_of_life_unit\": \"MONTH\",\n  \"trial_duration\": 7,\n  \"trial_duration_unit\": \"DAY\",\n  \"price_per_month\": 39.00,\n  \"cohort_set\": 5,\n  \"consumption_strategy\": \"PER_SEAT\"\n}\n</code></pre> <p>Then add service items: <pre><code>{\n  \"plan\": \"4geeks-plus-monthly\",\n  \"service_item\": [\n    45,  // Unlimited cohort access\n    93,  // 5000 AI chat messages\n    52   // 2 mentorship sessions\n  ]\n}\n</code></pre></p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#example-2-bootcamp-with-financing","title":"Example 2: Bootcamp with Financing","text":"<pre><code>{\n  \"slug\": \"full-stack-bootcamp-2025\",\n  \"title\": \"Full Stack Development Bootcamp\",\n  \"currency\": \"USD\",\n  \"status\": \"ACTIVE\",\n  \"is_renewable\": false,\n  \"is_onboarding\": true,\n  \"has_waiting_list\": true,\n  \"time_of_life\": 6,\n  \"time_of_life_unit\": \"MONTH\",\n  \"trial_duration\": 0,\n  \"trial_duration_unit\": \"DAY\",\n  \"price_per_month\": 8999.00,  // Full price upfront\n  \"financing_options\": [10, 11],  // Or pay in installments\n  \"cohort_set\": 8,\n  \"consumption_strategy\": \"PER_SEAT\"\n}\n</code></pre> <p>Financing options: - Option 10: <code>$799/month \u00d7 12 months</code> ($9,588 total) - Option 11: <code>$1,599/month \u00d7 6 months</code> ($9,594 total)</p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#example-3-teamcorporate-plan","title":"Example 3: Team/Corporate Plan","text":"<pre><code>{\n  \"slug\": \"corporate-training-team\",\n  \"title\": \"Corporate Team Training\",\n  \"currency\": \"USD\",\n  \"status\": \"ACTIVE\",\n  \"is_renewable\": true,\n  \"time_of_life\": 1,\n  \"time_of_life_unit\": \"MONTH\",\n  \"price_per_month\": 2999.00,  // Base team price\n  \"consumption_strategy\": \"BOTH\",\n  \"seat_service_price\": 456,  // $199 per additional seat\n  \"cohort_set\": 12\n}\n</code></pre> <p>Pricing: - Base: $2,999/month (includes 5 seats) - Each additional seat: $199/month - 10 seats total = $2,999 + (5 \u00d7 $199) = $3,994/month</p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#example-4-free-community-plan","title":"Example 4: Free Community Plan","text":"<pre><code>{\n  \"slug\": \"community-free\",\n  \"title\": \"Free Community Access\",\n  \"currency\": \"USD\",\n  \"status\": \"ACTIVE\",\n  \"is_renewable\": true,\n  \"time_of_life\": 1,\n  \"time_of_life_unit\": \"MONTH\",\n  \"price_per_month\": 0.00,\n  \"price_per_year\": 0.00,\n  \"cohort_set\": 15,\n  \"consumption_strategy\": \"PER_SEAT\"\n}\n</code></pre> <p>Service items (limited): - 50 AI chat messages/month - 1 mentorship session/month - Access to free courses only</p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#validation-rules","title":"Validation Rules","text":""},{"location":"LLM-DOCS/ACADEMY_PLANS/#plan-validation","title":"Plan Validation","text":"<ol> <li>\u2705 <code>slug</code> must be unique across all plans</li> <li>\u2705 <code>slug</code> can only contain: letters, numbers, hyphens</li> <li>\u2705 <code>currency</code> must be valid currency code</li> <li>\u2705 At least one price field should be set</li> <li>\u2705 <code>time_of_life</code> and <code>time_of_life_unit</code> must be together</li> <li>\u2705 <code>trial_duration</code> must be \u2265 0</li> <li>\u274c Cannot change <code>owner</code> after creation</li> <li>\u274c Cannot delete plan with active subscriptions (use UNLISTED)</li> </ol>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#service-item-validation","title":"Service Item Validation","text":"<ol> <li>\u2705 <code>service</code> must exist (valid Service ID)</li> <li>\u2705 <code>how_many</code> must be -1 (unlimited) or positive integer (&gt; 0)</li> <li>\u274c <code>how_many</code> cannot be 0 or less than -1</li> <li>\u2705 <code>sort_priority</code> determines display order</li> <li>\u274c Cannot change core fields after creation (immutable):</li> <li><code>unit_type</code></li> <li><code>how_many</code></li> <li><code>service</code></li> <li><code>is_renewable</code></li> <li><code>renew_at</code></li> <li><code>renew_at_unit</code></li> <li>\u2705 CAN change: <code>is_team_allowed</code></li> <li>\u2705 SEAT type services automatically set <code>is_team_allowed=true</code></li> <li>\u274c Cannot delete service items (no DELETE endpoint)</li> </ol>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#error-handling","title":"Error Handling","text":""},{"location":"LLM-DOCS/ACADEMY_PLANS/#common-errors","title":"Common Errors","text":"<p>404 - Plan Not Found <pre><code>{\n  \"detail\": \"Plan not found\",\n  \"slug\": \"not-found\",\n  \"status_code\": 404\n}\n</code></pre></p> <p>400 - Currency Not Found <pre><code>{\n  \"detail\": \"Currency not found\",\n  \"slug\": \"currency-not-found\",\n  \"status_code\": 400\n}\n</code></pre></p> <p>400 - Service Item Not Found <pre><code>{\n  \"detail\": \"Service items not found: [456, 789]\",\n  \"slug\": \"service-item-not-found\",\n  \"status_code\": 404\n}\n</code></pre></p> <p>400 - Cannot Add Plans to Existing User <pre><code>{\n  \"detail\": \"cannot-add-plans-to-existing-user\",\n  \"status_code\": 400\n}\n</code></pre></p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#integration-with-student-enrollment","title":"Integration with Student Enrollment","text":""},{"location":"LLM-DOCS/ACADEMY_PLANS/#adding-students-with-plans","title":"Adding Students with Plans","text":"<p>When inviting new students, attach payment plans:</p> <pre><code>POST /v1/auth/academy/student\nHeaders:\n  Academy: 1\n\nBody:\n{\n  \"email\": \"student@example.com\",\n  \"first_name\": \"John\",\n  \"last_name\": \"Doe\",\n  \"cohort\": [1429],\n  \"invite\": true,\n  \"plans\": [123]  // Plan ID\n}\n</code></pre> <p>What happens: 1. <code>UserInvite</code> created with linked plan 2. Student receives invitation email 3. When accepted:    - Free <code>Bag</code> created (type: INVITED)    - <code>$0</code> invoice generated    - <code>PlanFinancing</code> or <code>Subscription</code> created    - Student gets access to all service items    - Capabilities granted automatically</p> <p>Important: - \u274c Cannot add plans to existing users - \u2705 Only works with <code>invite: true</code> - \u2705 Cohort must have <code>available_as_saas=true</code> - \u2705 Academy must have <code>main_currency</code> set</p> <p>See ADD_STUDENT.md for full enrollment documentation.</p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#query-examples","title":"Query Examples","text":""},{"location":"LLM-DOCS/ACADEMY_PLANS/#get-all-active-plans","title":"Get All Active Plans","text":"<pre><code>GET /v1/payments/academy/plan?status=ACTIVE&amp;limit=50\nHeaders:\n  Academy: 1\n</code></pre>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#get-plans-for-specific-cohort","title":"Get Plans for Specific Cohort","text":"<pre><code>GET /v1/payments/academy/plan?cohort=1429\nHeaders:\n  Academy: 1\n</code></pre>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#get-onboarding-plans-only","title":"Get Onboarding Plans Only","text":"<pre><code>GET /v1/payments/academy/plan?is_onboarding=true\nHeaders:\n  Academy: 1\n</code></pre>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#get-plans-with-financing-options","title":"Get Plans with Financing Options","text":"<pre><code>GET /v1/payments/academy/plan?status=ACTIVE\n# Filter response where financing_options.length &gt; 0\n</code></pre>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#get-service-items-for-plan","title":"Get Service Items for Plan","text":"<pre><code>GET /v1/payments/serviceitem?plan=premium-bootcamp\n</code></pre>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#field-reference","title":"Field Reference","text":""},{"location":"LLM-DOCS/ACADEMY_PLANS/#plan-model-fields","title":"Plan Model Fields","text":"Field Type Required Description <code>slug</code> String(60) \u2705 Yes Unique identifier <code>title</code> String(100) No Display name <code>currency</code> ForeignKey \u2705 Yes Currency code <code>status</code> String No DRAFT, ACTIVE, UNLISTED, DELETED <code>owner</code> ForeignKey Auto Academy (set automatically) <code>is_renewable</code> Boolean No True=Subscription, False=Financing <code>is_onboarding</code> Boolean No Onboarding plan flag <code>has_waiting_list</code> Boolean No Enable waiting list <code>exclude_from_referral_program</code> Boolean No Disable referrals <code>time_of_life</code> Integer No Plan lifetime value <code>time_of_life_unit</code> String No DAY, WEEK, MONTH, YEAR <code>trial_duration</code> Integer No Trial period length <code>trial_duration_unit</code> String No DAY, WEEK, MONTH, YEAR <code>price_per_half</code> Float No 6-month price <code>price_per_month</code> Float No Monthly price <code>price_per_quarter</code> Float No 3-month price <code>price_per_year</code> Float No 12-month price <code>consumption_strategy</code> String No PER_SEAT, PER_TEAM, BOTH <code>cohort_set</code> ForeignKey No Linked cohort set <code>mentorship_service_set</code> ForeignKey No Linked mentorship set <code>event_type_set</code> ForeignKey No Linked event type set <code>financing_options</code> ManyToMany No Available financing <code>service_items</code> ManyToMany No Included services <code>seat_service_price</code> ForeignKey No Seat pricing service <code>add_ons</code> ManyToMany No Optional add-ons <code>pricing_ratio_exceptions</code> JSON No Country pricing adjustments"},{"location":"LLM-DOCS/ACADEMY_PLANS/#service-model-fields","title":"Service Model Fields","text":"Field Type Description <code>slug</code> String Unique identifier <code>title</code> String Display name <code>icon_url</code> URL Service icon <code>type</code> String COHORT_SET, MENTORSHIP_SERVICE_SET, etc. <code>consumer</code> String How it's consumed <code>private</code> Boolean Private/public service <code>groups</code> ManyToMany Django groups granted access <code>session_duration</code> Duration Session time limit"},{"location":"LLM-DOCS/ACADEMY_PLANS/#serviceitem-model-fields","title":"ServiceItem Model Fields","text":"Field Type Immutable Description <code>service</code> ForeignKey \u2705 Yes Parent service <code>unit_type</code> String \u2705 Yes Always \"UNIT\" <code>how_many</code> Integer \u2705 Yes -1=unlimited, N=quantity <code>sort_priority</code> Integer No Display order <code>is_renewable</code> Boolean \u2705 Yes Auto-renew consumables <code>renew_at</code> Integer \u2705 Yes Renewal interval <code>renew_at_unit</code> String \u2705 Yes Renewal unit <code>is_team_allowed</code> Boolean No Team seat eligibility"},{"location":"LLM-DOCS/ACADEMY_PLANS/#financingoption-model-fields","title":"FinancingOption Model Fields","text":"Field Type Description <code>monthly_price</code> Float Monthly payment amount <code>how_many_months</code> Integer Number of installments <code>currency</code> ForeignKey Payment currency <code>pricing_ratio_exceptions</code> JSON Country adjustments"},{"location":"LLM-DOCS/ACADEMY_PLANS/#best-practices","title":"Best Practices","text":""},{"location":"LLM-DOCS/ACADEMY_PLANS/#plan-design","title":"Plan Design","text":"<ol> <li>\u2705 Start with DRAFT status - test before activating</li> <li>\u2705 Use clear slugs - e.g., <code>web-dev-monthly-2025</code></li> <li>\u2705 Set meaningful titles - shown to customers</li> <li>\u2705 Include trial for subscriptions - increases conversions</li> <li>\u2705 Offer multiple payment periods - flexibility drives sales</li> <li>\u274c Don't delete active plans - use UNLISTED instead</li> </ol>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#service-item-strategy","title":"Service Item Strategy","text":"<ol> <li>\u2705 Create via API - Academies can now create their own service items</li> <li>\u2705 Use -1 for core features - unlimited access</li> <li>\u2705 Set limits for premium features - e.g., 100 AI chats</li> <li>\u2705 Prioritize sorting - most important features first</li> <li>\u2705 Enable team sharing selectively - not all items need team access</li> <li>\u2705 Plan ahead - ServiceItems are immutable, think through quantities before creation</li> <li>\u274c Don't modify after creation - create new instead if you need different configuration</li> </ol>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#pricing-strategy","title":"Pricing Strategy","text":"<ol> <li>\u2705 Offer annual discount - typically 15-20% off</li> <li>\u2705 Use country pricing - adjust for local markets</li> <li>\u2705 Round to clean numbers - $299 not $297.84</li> <li>\u2705 Multiple financing options - flexibility for customers</li> <li>\u2705 Price in academy's main currency - consistent billing</li> </ol>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#student-enrollment","title":"Student Enrollment","text":"<ol> <li>\u2705 Only assign plans to new students - validation enforced</li> <li>\u2705 Use for SaaS cohorts only - <code>available_as_saas=true</code></li> <li>\u2705 Set main_currency first - required for plan financings</li> <li>\u2705 Link cohort to plan's cohort_set - automatic access</li> <li>\u274c Don't add plans to existing users - use payment system directly</li> </ol>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#security-permissions","title":"Security &amp; Permissions","text":""},{"location":"LLM-DOCS/ACADEMY_PLANS/#required-capabilities","title":"Required Capabilities","text":"Operation Capability Description View plans <code>read_subscription</code> Read-only access Create plan <code>crud_subscription</code> Full CRUD on plans Update plan <code>crud_subscription</code> Modify existing plans Delete plan <code>crud_subscription</code> Soft delete plans Link service items to plans <code>crud_plan</code> Link/unlink services Create service items <code>crud_service</code> Create new service items Manage cohort sets <code>crud_plan</code> Configure cohorts View services <code>read_service</code> Read services Manage services <code>crud_service</code> CRUD services View payment methods <code>read_paymentmethod</code> Read payment methods Manage payment methods <code>crud_paymentmethod</code> CRUD payment methods View consumables <code>read_consumable</code> View usage View invoices <code>read_invoice</code> Access billing"},{"location":"LLM-DOCS/ACADEMY_PLANS/#recommended-roles","title":"Recommended Roles","text":"<p>Billing Administrator: - <code>read_subscription</code> - <code>crud_subscription</code> - <code>crud_plan</code> - <code>read_paymentmethod</code> - <code>crud_paymentmethod</code> - <code>read_invoice</code></p> <p>Academy Admin (Full Access): - All payment capabilities - All payment method capabilities - Plus academy management capabilities</p> <p>Support Staff (Read-Only): - <code>read_subscription</code> - <code>read_paymentmethod</code> - <code>read_invoice</code> - <code>read_consumable</code></p> <p>Accountant: - <code>read_subscription</code> - <code>read_paymentmethod</code> - <code>crud_paymentmethod</code> - <code>read_invoice</code></p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#advanced-features","title":"Advanced Features","text":""},{"location":"LLM-DOCS/ACADEMY_PLANS/#add-ons","title":"Add-Ons","text":"<p>Plans can have optional add-ons purchasable during checkout:</p> <pre><code>{\n  \"slug\": \"basic-plan\",\n  \"add_ons\": [15, 16]  // AcademyService IDs\n}\n</code></pre> <p>Customer can add: - Extra mentorship sessions - Additional storage - Premium support</p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#seat-based-pricing","title":"Seat-Based Pricing","text":"<p>For team plans with per-seat charges:</p> <pre><code>{\n  \"consumption_strategy\": \"PER_TEAM\",\n  \"seat_service_price\": 20  // AcademyService with seat pricing\n}\n</code></pre>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#waiting-lists","title":"Waiting Lists","text":"<p>Enable for high-demand plans:</p> <pre><code>{\n  \"has_waiting_list\": true\n}\n</code></pre> <p>When plan at capacity: - New purchasers added to waiting list - Notified when spots available</p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#referral-program","title":"Referral Program","text":"<p>Control referral coupon eligibility:</p> <pre><code>{\n  \"exclude_from_referral_program\": false  // Allow referrals\n}\n</code></pre>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#troubleshooting","title":"Troubleshooting","text":""},{"location":"LLM-DOCS/ACADEMY_PLANS/#plan-not-showing-for-students","title":"Plan Not Showing for Students","text":"<p>Checklist: 1. \u2705 Status is <code>ACTIVE</code> 2. \u2705 Cohort is in plan's <code>cohort_set</code> 3. \u2705 Cohort has <code>available_as_saas=true</code> 4. \u2705 Academy has <code>main_currency</code> set 5. \u2705 Service items are linked</p> <p>Solution: <pre><code># Check plan details\nGET /v1/payments/academy/plan/{slug}\n\n# Verify cohort in set\nGET /v1/payments/academy/cohortset/{id}/cohort\n</code></pre></p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#cannot-add-plan-to-student","title":"Cannot Add Plan to Student","text":"<p>Error: <code>cannot-add-plans-to-existing-user</code></p> <p>Cause: Trying to add plan to user that already exists</p> <p>Solution: - Only add plans when inviting NEW students - For existing users, they must purchase through checkout - See BC_CHECKOUT.md for purchase flow</p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#service-items-not-appearing","title":"Service Items Not Appearing","text":"<p>Checklist: 1. \u2705 Service items are linked to plan 2. \u2705 Service is not <code>private=true</code> (or customer has permission) 3. \u2705 <code>how_many</code> is not <code>0</code></p> <p>Solution: <pre><code># Check linked items\nGET /v1/payments/serviceitem?plan={plan_slug}\n\n# Add missing items\nPOST /v1/payments/academy/plan/serviceitem\nBody: {\"plan\": 123, \"service_item\": [45, 52]}\n</code></pre></p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#financing-not-creating","title":"Financing Not Creating","text":"<p>Checklist: 1. \u2705 Plan has <code>is_renewable=false</code> 2. \u2705 Plan has financing options linked 3. \u2705 Academy has <code>main_currency</code> set 4. \u2705 Invoice status is <code>FULFILLED</code> 5. \u2705 Bag status is <code>PAID</code> 6. \u2705 Celery workers are running</p> <p>Solution: <pre><code># Check if task failed\n# View logs for build_plan_financing task\npoetry run python manage.py check_task_status\n</code></pre></p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#payment-method-management","title":"Payment Method Management","text":""},{"location":"LLM-DOCS/ACADEMY_PLANS/#what-are-payment-methods","title":"What are Payment Methods?","text":"<p>Payment Methods define the different ways customers can pay for plans and services at your academy. Each academy can create and manage their own payment methods while also having access to global payment methods.</p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#ownership-model_1","title":"Ownership Model","text":"<ul> <li>Each payment method can belong to a specific academy or be global (academy=null)</li> <li>Academies can only create, update, and delete their own payment methods</li> <li>Global payment methods can be viewed by all but only managed by platform staff</li> <li>GET requests return both academy-specific and global payment methods</li> </ul> <p>Model Structure: <pre><code>{\n  \"id\": 1,\n  \"title\": \"Credit Card\",\n  \"description\": \"Pay with Visa, Mastercard, or Amex\",\n  \"is_backed\": true,\n  \"is_credit_card\": true,\n  \"currency\": {\n    \"code\": \"USD\",\n    \"name\": \"US Dollar\"\n  },\n  \"academy\": {\n    \"id\": 55,\n    \"name\": \"My Academy\",\n    \"slug\": \"my-academy\"\n  },\n  \"lang\": \"en-US\",\n  \"third_party_link\": \"https://stripe.com/...\",\n  \"included_country_codes\": \"US,CA,MX\",\n  \"visibility\": \"PUBLIC\",\n  \"deprecated\": false\n}\n</code></pre></p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#visibility-levels","title":"Visibility Levels","text":"Visibility Description Use Case <code>PUBLIC</code> Shown to all customers Standard payment methods <code>INTERNAL</code> Shown only to staff/admin Internal tracking <code>HIDDEN</code> Not displayed anywhere Deprecated methods"},{"location":"LLM-DOCS/ACADEMY_PLANS/#managing-payment-methods","title":"Managing Payment Methods","text":""},{"location":"LLM-DOCS/ACADEMY_PLANS/#list-payment-methods","title":"List Payment Methods","text":"<p>Endpoint: <code>GET /v1/payments/academy/paymentmethod</code></p> <p>Authentication: Required - <code>read_paymentmethod</code> capability</p> <p>Headers: - <code>Academy: {academy_id}</code> - Required - <code>Authorization: Token {your-token}</code> - Required</p> <p>Query Parameters: - <code>visibility={PUBLIC|INTERNAL|HIDDEN}</code> - Filter by visibility - <code>currency_code={code}</code> - Filter by currency (e.g., \"USD\") - <code>lang={lang_code}</code> - Filter by language (e.g., \"en-US\") - <code>deprecated={true|false}</code> - Filter by deprecated status - Standard pagination: <code>limit</code>, <code>offset</code></p> <p>Response: <pre><code>[\n  {\n    \"id\": 1,\n    \"title\": \"Credit Card\",\n    \"description\": \"Pay with Visa, Mastercard, or Amex via Stripe\",\n    \"is_backed\": true,\n    \"is_credit_card\": true,\n    \"currency\": {\n      \"code\": \"USD\",\n      \"name\": \"US Dollar\"\n    },\n    \"academy\": {\n      \"id\": 55,\n      \"name\": \"My Academy\",\n      \"slug\": \"my-academy\"\n    },\n    \"lang\": \"en-US\",\n    \"third_party_link\": \"https://checkout.stripe.com/...\",\n    \"included_country_codes\": \"US,CA,MX,BR\",\n    \"visibility\": \"PUBLIC\",\n    \"deprecated\": false\n  },\n  {\n    \"id\": 2,\n    \"title\": \"Bank Transfer - BCP\",\n    \"description\": \"Wire transfer to Banco de Cr\u00e9dito del Per\u00fa\",\n    \"is_backed\": true,\n    \"is_credit_card\": false,\n    \"currency\": {\n      \"code\": \"PEN\",\n      \"name\": \"Peruvian Sol\"\n    },\n    \"academy\": {\n      \"id\": 55,\n      \"name\": \"My Academy\",\n      \"slug\": \"my-academy\"\n    },\n    \"lang\": \"es-PE\",\n    \"third_party_link\": null,\n    \"included_country_codes\": \"PE\",\n    \"visibility\": \"PUBLIC\",\n    \"deprecated\": false\n  }\n]\n</code></pre></p> <p>Example Requests:</p> <p>List all payment methods (academy + global): <pre><code>GET /v1/payments/academy/paymentmethod\nHeaders:\n  Academy: 1\n  Authorization: Token {token}\n</code></pre></p> <p>Filter by visibility: <pre><code>GET /v1/payments/academy/paymentmethod?visibility=PUBLIC\nHeaders:\n  Academy: 1\n</code></pre></p> <p>Filter by currency: <pre><code>GET /v1/payments/academy/paymentmethod?currency_code=USD\nHeaders:\n  Academy: 1\n</code></pre></p> <p>Get only active (non-deprecated) methods: <pre><code>GET /v1/payments/academy/paymentmethod?deprecated=false\nHeaders:\n  Academy: 1\n</code></pre></p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#get-single-payment-method","title":"Get Single Payment Method","text":"<p>Endpoint: <code>GET /v1/payments/academy/paymentmethod/{paymentmethod_id}</code></p> <p>Authentication: Required - <code>read_paymentmethod</code> capability</p> <p>Response: Single payment method object (same structure as list)</p> <p>Example: <pre><code>GET /v1/payments/academy/paymentmethod/123\nHeaders:\n  Academy: 1\n  Authorization: Token {token}\n</code></pre></p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#create-payment-method","title":"Create Payment Method","text":"<p>Endpoint: <code>POST /v1/payments/academy/paymentmethod</code></p> <p>Authentication: Required - <code>crud_paymentmethod</code> capability</p> <p>Headers: - <code>Academy: {academy_id}</code> - Required - <code>Authorization: Token {your-token}</code> - Required</p> <p>Request Body: <pre><code>{\n  \"title\": \"Bank Transfer - BCP\",\n  \"description\": \"Wire transfer to Banco de Cr\u00e9dito del Per\u00fa. Account: 123-456-789\",\n  \"is_backed\": true,\n  \"is_credit_card\": false,\n  \"currency\": \"PEN\",\n  \"lang\": \"es-PE\",\n  \"third_party_link\": \"https://bcp.com.pe/empresas/\",\n  \"included_country_codes\": \"PE\",\n  \"visibility\": \"PUBLIC\",\n  \"deprecated\": false\n}\n</code></pre></p> <p>Field Details:</p> Field Type Required Description <code>title</code> String \u2705 Yes Payment method name (max 120 chars) <code>description</code> String \u2705 Yes Description shown to customers (max 480 chars) <code>is_backed</code> Boolean No If true, represents real income (default: false) <code>is_credit_card</code> Boolean No Credit card flag (default: false) <code>currency</code> String No Currency code (e.g., \"USD\", \"PEN\") <code>lang</code> String \u2705 Yes Language code (e.g., \"en-US\", \"es-PE\") <code>third_party_link</code> URL No Link to external payment processor <code>included_country_codes</code> String No Comma-separated country codes (e.g., \"PE,CO,CL\") <code>visibility</code> String No PUBLIC, INTERNAL, or HIDDEN (default: PUBLIC) <code>deprecated</code> Boolean No Mark as deprecated (default: false) <p>Notes: - <code>academy</code> is automatically set from the Academy header - Cannot manually set <code>academy</code> or <code>academy_id</code> - <code>is_backed=true</code> means this payment represents confirmed revenue</p> <p>Response: <code>201 CREATED</code> <pre><code>{\n  \"id\": 123,\n  \"title\": \"Bank Transfer - BCP\",\n  \"description\": \"Wire transfer to Banco de Cr\u00e9dito del Per\u00fa. Account: 123-456-789\",\n  \"is_backed\": true,\n  \"is_credit_card\": false,\n  \"currency\": \"PEN\",\n  \"academy\": 55,\n  \"lang\": \"es-PE\",\n  \"third_party_link\": \"https://bcp.com.pe/empresas/\",\n  \"included_country_codes\": \"PE\",\n  \"visibility\": \"PUBLIC\",\n  \"deprecated\": false\n}\n</code></pre></p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#update-payment-method","title":"Update Payment Method","text":"<p>Endpoint: <code>PUT /v1/payments/academy/paymentmethod/{paymentmethod_id}</code></p> <p>Authentication: Required - <code>crud_paymentmethod</code> capability</p> <p>Request Body: (partial updates supported) <pre><code>{\n  \"description\": \"Updated wire transfer instructions. New account: 987-654-321\",\n  \"third_party_link\": \"https://bcp.com.pe/new-link\",\n  \"deprecated\": false\n}\n</code></pre></p> <p>Example - Mark as Deprecated: <pre><code>PUT /v1/payments/academy/paymentmethod/123\nHeaders:\n  Academy: 1\n  Authorization: Token {token}\n\nBody:\n{\n  \"deprecated\": true,\n  \"visibility\": \"HIDDEN\"\n}\n</code></pre></p> <p>Example - Update Description: <pre><code>PUT /v1/payments/academy/paymentmethod/123\nBody:\n{\n  \"description\": \"Updated payment instructions: New bank account 999-888-777\"\n}\n</code></pre></p> <p>Restrictions: - \u274c Can ONLY update payment methods owned by your academy - \u274c Cannot update global payment methods (where academy=null) - \u2705 Partial updates supported - only send fields you want to change</p> <p>Response: <code>200 OK</code> with updated payment method object</p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#delete-payment-method","title":"Delete Payment Method","text":"<p>Endpoint: <code>DELETE /v1/payments/academy/paymentmethod/{paymentmethod_id}</code></p> <p>Authentication: Required - <code>crud_paymentmethod</code> capability</p> <p>Headers: - <code>Academy: {academy_id}</code> - Required - <code>Authorization: Token {your-token}</code> - Required</p> <p>Behavior: - Permanently deletes the payment method - Can only delete payment methods owned by your academy - No cascade deletion (existing invoices/transactions remain)</p> <p>Response: <code>204 No Content</code></p> <p>Example: <pre><code>DELETE /v1/payments/academy/paymentmethod/123\nHeaders:\n  Academy: 1\n  Authorization: Token {token}\n</code></pre></p> <p>Restrictions: - \u274c Can ONLY delete payment methods owned by your academy - \u274c Cannot delete global payment methods</p> <p>Error Response: <pre><code>{\n  \"detail\": \"Payment method not found for this academy\",\n  \"slug\": \"payment-method-not-found\",\n  \"status_code\": 404\n}\n</code></pre></p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#payment-method-examples","title":"Payment Method Examples","text":""},{"location":"LLM-DOCS/ACADEMY_PLANS/#example-1-credit-card-stripe","title":"Example 1: Credit Card (Stripe)","text":"<pre><code>{\n  \"title\": \"Credit Card\",\n  \"description\": \"Pay securely with Visa, Mastercard, American Express, or Discover\",\n  \"is_backed\": true,\n  \"is_credit_card\": true,\n  \"currency\": \"USD\",\n  \"lang\": \"en-US\",\n  \"third_party_link\": \"https://checkout.stripe.com/pay/cs_...\",\n  \"included_country_codes\": \"US,CA,MX,BR,AR,CL,CO,PE\",\n  \"visibility\": \"PUBLIC\",\n  \"deprecated\": false\n}\n</code></pre> <p>Use Case: Standard online payment processing</p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#example-2-bank-transfer-regional","title":"Example 2: Bank Transfer (Regional)","text":"<pre><code>{\n  \"title\": \"Transferencia Bancaria - BCP\",\n  \"description\": \"Transferencia a Banco de Cr\u00e9dito del Per\u00fa. Cuenta Corriente: 193-123456789-0-00. CCI: 002-193-123456789000-00\",\n  \"is_backed\": true,\n  \"is_credit_card\": false,\n  \"currency\": \"PEN\",\n  \"lang\": \"es-PE\",\n  \"third_party_link\": null,\n  \"included_country_codes\": \"PE\",\n  \"visibility\": \"PUBLIC\",\n  \"deprecated\": false\n}\n</code></pre> <p>Use Case: Local bank transfers in Peru</p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#example-3-paypal","title":"Example 3: PayPal","text":"<pre><code>{\n  \"title\": \"PayPal\",\n  \"description\": \"Pay with your PayPal account or debit/credit card through PayPal\",\n  \"is_backed\": true,\n  \"is_credit_card\": false,\n  \"currency\": \"USD\",\n  \"lang\": \"en-US\",\n  \"third_party_link\": \"https://www.paypal.com/paypalme/youracademy\",\n  \"included_country_codes\": \"US,CA,MX,GB,DE,FR,ES,IT\",\n  \"visibility\": \"PUBLIC\",\n  \"deprecated\": false\n}\n</code></pre> <p>Use Case: Alternative payment processor</p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#example-4-cashin-person-internal","title":"Example 4: Cash/In-Person (Internal)","text":"<pre><code>{\n  \"title\": \"Cash Payment\",\n  \"description\": \"Pay in cash at academy office. Receipt will be provided.\",\n  \"is_backed\": true,\n  \"is_credit_card\": false,\n  \"currency\": \"USD\",\n  \"lang\": \"en-US\",\n  \"third_party_link\": null,\n  \"included_country_codes\": \"\",\n  \"visibility\": \"INTERNAL\",\n  \"deprecated\": false\n}\n</code></pre> <p>Use Case: In-person payments, internal tracking</p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#example-5-scholarshipgrant-not-backed","title":"Example 5: Scholarship/Grant (Not Backed)","text":"<pre><code>{\n  \"title\": \"Scholarship Award\",\n  \"description\": \"Payment covered by scholarship or grant program\",\n  \"is_backed\": false,\n  \"is_credit_card\": false,\n  \"currency\": \"USD\",\n  \"lang\": \"en-US\",\n  \"third_party_link\": null,\n  \"included_country_codes\": \"\",\n  \"visibility\": \"INTERNAL\",\n  \"deprecated\": false\n}\n</code></pre> <p>Use Case: Tracking non-revenue payments</p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#country-specific-payment-methods","title":"Country-Specific Payment Methods","text":"<p>Use <code>included_country_codes</code> to control visibility:</p> <p>Example - Latin America Bank Transfers: <pre><code>[\n  {\n    \"title\": \"Transferencia Bancaria - BCP (Per\u00fa)\",\n    \"included_country_codes\": \"PE\",\n    \"lang\": \"es-PE\",\n    \"currency\": \"PEN\"\n  },\n  {\n    \"title\": \"Transferencia Bancaria - Bancolombia\",\n    \"included_country_codes\": \"CO\",\n    \"lang\": \"es-CO\",\n    \"currency\": \"COP\"\n  },\n  {\n    \"title\": \"Transferencia Bancaria - Santander (Chile)\",\n    \"included_country_codes\": \"CL\",\n    \"lang\": \"es-CL\",\n    \"currency\": \"CLP\"\n  }\n]\n</code></pre></p> <p>Frontend Usage: <pre><code>GET /v1/payments/academy/paymentmethod?included_country_codes=PE\n# Returns only methods available in Peru\n</code></pre></p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#payment-method-best-practices","title":"Payment Method Best Practices","text":"<ol> <li>\u2705 Clear Titles - Use recognizable names (\"Credit Card\", \"PayPal\", \"Bank Transfer\")</li> <li>\u2705 Detailed Descriptions - Include account numbers, instructions, processing times</li> <li>\u2705 Set is_backed=true - For real payment methods that represent revenue</li> <li>\u2705 Use included_country_codes - Show relevant methods per region</li> <li>\u2705 Match language to region - Use <code>es-PE</code> for Peru, <code>es-MX</code> for Mexico</li> <li>\u2705 Deprecate instead of delete - Set <code>deprecated=true</code> for old methods</li> <li>\u2705 Link third-party processors - Provide URLs for external payment pages</li> <li>\u274c Don't delete active methods - Use <code>deprecated=true</code> and <code>visibility=HIDDEN</code> instead</li> </ol>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#payment-method-workflow","title":"Payment Method Workflow","text":"<p>Step 1: Create payment method for your region <pre><code>POST /v1/payments/academy/paymentmethod\nHeaders:\n  Academy: 55\n  Authorization: Token {token}\n\nBody:\n{\n  \"title\": \"Transferencia Bancaria - BCP\",\n  \"description\": \"Transferir a: Banco de Cr\u00e9dito del Per\u00fa\\nCuenta Corriente: 193-123456789-0-00\\nCCI: 002-193-123456789000-00\\nBeneficiario: Academia Ejemplo SAC\",\n  \"is_backed\": true,\n  \"is_credit_card\": false,\n  \"currency\": \"PEN\",\n  \"lang\": \"es-PE\",\n  \"included_country_codes\": \"PE\",\n  \"visibility\": \"PUBLIC\"\n}\n</code></pre></p> <p>Step 2: Verify it appears in the list <pre><code>GET /v1/payments/academy/paymentmethod?visibility=PUBLIC\nHeaders:\n  Academy: 55\n</code></pre></p> <p>Step 3: Customers see it at checkout <pre><code>GET /v1/payments/methods?academy_id=55&amp;country_code=PE\n# Public endpoint - no auth required\n# Returns payment methods for Peru at academy 55\n</code></pre></p> <p>Step 4: Update if needed <pre><code>PUT /v1/payments/academy/paymentmethod/123\nBody:\n{\n  \"description\": \"Updated bank account information...\"\n}\n</code></pre></p> <p>Step 5: Deprecate when no longer used <pre><code>PUT /v1/payments/academy/paymentmethod/123\nBody:\n{\n  \"deprecated\": true,\n  \"visibility\": \"HIDDEN\"\n}\n</code></pre></p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#public-vs-academy-endpoints","title":"Public vs Academy Endpoints","text":""},{"location":"LLM-DOCS/ACADEMY_PLANS/#public-endpoint-no-auth","title":"Public Endpoint (No Auth)","text":"<p>Endpoint: <code>GET /v1/payments/methods</code></p> <p>Purpose: Used by checkout pages to show available payment methods</p> <p>Query Parameters: - <code>academy_id</code> - Filter by academy - <code>currency_code</code> - Filter by currency - <code>lang</code> - Filter by language - <code>country_code</code> - Filter by country availability - <code>visibility</code> - Filter by visibility level</p> <p>Example: <pre><code>GET /v1/payments/methods?academy_id=55&amp;country_code=PE&amp;currency_code=PEN\n# Returns public payment methods available in Peru for academy 55\n</code></pre></p> <p>Response: Same structure as academy endpoint</p> <p>Use Case: - Displaying payment options on public checkout pages - Showing methods to unauthenticated users - Building payment selection UI</p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#academy-endpoint-authenticated","title":"Academy Endpoint (Authenticated)","text":"<p>Endpoint: <code>GET /v1/payments/academy/paymentmethod</code></p> <p>Purpose: Management interface for academy staff</p> <p>Requires: <code>read_paymentmethod</code> capability</p> <p>Features: - \u2705 Full CRUD operations - \u2705 Create new payment methods - \u2705 Update existing methods - \u2705 Delete methods - \u2705 View all visibility levels (including INTERNAL/HIDDEN)</p> <p>Use Case: - Academy admin dashboard - Payment method configuration - Managing regional payment options</p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#common-payment-method-configurations","title":"Common Payment Method Configurations","text":""},{"location":"LLM-DOCS/ACADEMY_PLANS/#stripecredit-card-processing","title":"Stripe/Credit Card Processing","text":"<pre><code>{\n  \"title\": \"Credit/Debit Card\",\n  \"description\": \"Secure payment processing via Stripe. We accept Visa, Mastercard, American Express, and Discover.\",\n  \"is_backed\": true,\n  \"is_credit_card\": true,\n  \"currency\": \"USD\",\n  \"lang\": \"en-US\",\n  \"third_party_link\": \"https://dashboard.stripe.com/...\",\n  \"included_country_codes\": \"\",\n  \"visibility\": \"PUBLIC\"\n}\n</code></pre> <p>Notes: - Empty <code>included_country_codes</code> = available worldwide - <code>is_backed=true</code> = confirmed revenue - <code>is_credit_card=true</code> = enables credit card specific logic</p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#regional-bank-transfer","title":"Regional Bank Transfer","text":"<pre><code>{\n  \"title\": \"Transferencia Bancaria\",\n  \"description\": \"Transferir a:\\n\\nBanco: BCP\\nCuenta: 193-123456789\\nCCI: 002-193-123456789000-00\\nBeneficiario: Academia SAC\\nRUC: 20123456789\\n\\nEnviar comprobante a: pagos@academy.com\",\n  \"is_backed\": true,\n  \"is_credit_card\": false,\n  \"currency\": \"PEN\",\n  \"lang\": \"es-PE\",\n  \"third_party_link\": null,\n  \"included_country_codes\": \"PE\",\n  \"visibility\": \"PUBLIC\"\n}\n</code></pre> <p>Tips: - Use <code>\\n</code> for line breaks in description - Include all payment details - Provide email for receipt submission - Match language to country</p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#paypalalternative-processors","title":"PayPal/Alternative Processors","text":"<pre><code>{\n  \"title\": \"PayPal\",\n  \"description\": \"Pay with PayPal balance, bank account, or card through PayPal secure checkout\",\n  \"is_backed\": true,\n  \"is_credit_card\": false,\n  \"currency\": \"USD\",\n  \"lang\": \"en-US\",\n  \"third_party_link\": \"https://www.paypal.com/paypalme/youracademy\",\n  \"included_country_codes\": \"US,CA,MX,GB,DE,FR,ES,IT,BR,AR\",\n  \"visibility\": \"PUBLIC\"\n}\n</code></pre>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#mobile-payment-country-specific","title":"Mobile Payment (Country-Specific)","text":"<pre><code>{\n  \"title\": \"Yape - BCP\",\n  \"description\": \"Paga con Yape escaneando el c\u00f3digo QR o enviando a: 987-654-321. Incluye tu nombre completo en la descripci\u00f3n.\",\n  \"is_backed\": true,\n  \"is_credit_card\": false,\n  \"currency\": \"PEN\",\n  \"lang\": \"es-PE\",\n  \"third_party_link\": \"https://www.yape.com.pe/\",\n  \"included_country_codes\": \"PE\",\n  \"visibility\": \"PUBLIC\"\n}\n</code></pre> <p>Use Case: Peru-specific mobile payment app</p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#cryptocurrency-if-accepted","title":"Cryptocurrency (if accepted)","text":"<pre><code>{\n  \"title\": \"Bitcoin/Crypto\",\n  \"description\": \"Pay with Bitcoin, Ethereum, or USDT. Contact accounting@academy.com for wallet address.\",\n  \"is_backed\": true,\n  \"is_credit_card\": false,\n  \"currency\": \"USD\",\n  \"lang\": \"en-US\",\n  \"third_party_link\": \"https://commerce.coinbase.com/...\",\n  \"included_country_codes\": \"\",\n  \"visibility\": \"INTERNAL\"\n}\n</code></pre> <p>Note: Use INTERNAL visibility for less common methods</p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#deprecation-strategy","title":"Deprecation Strategy","text":"<p>Don't delete payment methods that have historical data. Instead, deprecate them:</p> <pre><code># Step 1: Mark as deprecated\nPUT /v1/payments/academy/paymentmethod/123\nBody:\n{\n  \"deprecated\": true\n}\n\n# Step 2: Hide from customers\nPUT /v1/payments/academy/paymentmethod/123\nBody:\n{\n  \"visibility\": \"HIDDEN\"\n}\n</code></pre> <p>Why not delete? - Historical invoices reference the payment method - Transaction records need the method for reporting - Audit trails require complete payment history</p> <p>Effect of deprecation: - \u274c Not shown in checkout - \u2705 Still visible in historical invoices - \u2705 Admin can still view it - \u2705 Reports still accurate</p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#multi-currency-support","title":"Multi-Currency Support","text":"<p>Create payment methods for each currency:</p> <pre><code># USD for North America\nPOST /v1/payments/academy/paymentmethod\nBody:\n{\n  \"title\": \"Credit Card\",\n  \"currency\": \"USD\",\n  \"lang\": \"en-US\",\n  \"included_country_codes\": \"US,CA,MX\"\n}\n\n# EUR for Europe\nPOST /v1/payments/academy/paymentmethod\nBody:\n{\n  \"title\": \"Tarjeta de Cr\u00e9dito\",\n  \"currency\": \"EUR\",\n  \"lang\": \"es-ES\",\n  \"included_country_codes\": \"ES,FR,DE,IT\"\n}\n\n# PEN for Peru\nPOST /v1/payments/academy/paymentmethod\nBody:\n{\n  \"title\": \"Tarjeta de Cr\u00e9dito\",\n  \"currency\": \"PEN\",\n  \"lang\": \"es-PE\",\n  \"included_country_codes\": \"PE\"\n}\n</code></pre> <p>Checkout displays the right method based on: 1. User's country 2. Selected currency 3. Language preference</p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#error-handling_1","title":"Error Handling","text":"<p>404 - Payment Method Not Found: <pre><code>{\n  \"detail\": \"Payment method not found for this academy\",\n  \"slug\": \"payment-method-not-found\",\n  \"status_code\": 404\n}\n</code></pre></p> <p>Causes: - Payment method doesn't exist - Payment method belongs to different academy - Trying to modify global payment method</p> <p>Solution: Verify the payment method ID and academy ownership</p> <p>400 - Currency Not Found: <pre><code>{\n  \"detail\": \"Currency not found\",\n  \"slug\": \"currency-not-found\",\n  \"status_code\": 400\n}\n</code></pre></p> <p>Cause: Invalid currency code</p> <p>Solution: Use valid ISO currency codes (USD, EUR, PEN, etc.)</p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#integration-with-invoices","title":"Integration with Invoices","text":"<p>When students make payments, they select a payment method:</p> <p>Invoice Creation: <pre><code>{\n  \"user\": 123,\n  \"amount\": 299.00,\n  \"currency\": \"USD\",\n  \"payment_method_id\": 1,  // Links to PaymentMethod\n  \"status\": \"FULFILLED\"\n}\n</code></pre></p> <p>Benefits: - Track which payment methods are most popular - Generate reports by payment type - Understand revenue sources - Regional payment preferences</p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#related-documentation","title":"Related Documentation","text":"<ul> <li>BC_CHECKOUT.md - Customer purchase flow</li> <li>BC_INVOICE.md - Invoice management</li> <li>BC_COUPONS.md - Discount coupons</li> <li>ADD_STUDENT.md - Student enrollment with plans</li> <li>BC_CHECKOUT_CONSUMABLE.md - Consumable purchases</li> </ul>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#quick-reference","title":"Quick Reference","text":""},{"location":"LLM-DOCS/ACADEMY_PLANS/#common-workflows","title":"Common Workflows","text":"<p>Create basic monthly plan: <pre><code># 1. Create service item (if needed)\nPOST /v1/payments/academy/serviceitem\nBody: {\n  \"service\": 12,\n  \"how_many\": -1\n}\n# Response: { \"id\": 456, ... }\n\n# 2. Create plan\nPOST /v1/payments/academy/plan\nBody: {\n  \"slug\": \"basic-monthly\",\n  \"currency\": \"USD\",\n  \"price_per_month\": 39.00,\n  \"is_renewable\": true\n}\n\n# 3. Add services\nPOST /v1/payments/academy/plan/serviceitem\nBody: {\"plan\": \"basic-monthly\", \"service_item\": [456, 93]}\n\n# 4. Activate\nPUT /v1/payments/academy/plan/basic-monthly\nBody: {\"status\": \"ACTIVE\"}\n</code></pre></p> <p>Create bootcamp with financing: <pre><code># 1. Create custom service items\nPOST /v1/payments/academy/serviceitem\nBody: {\"service\": 12, \"how_many\": 10, \"is_renewable\": false}\n# Response: { \"id\": 450, ... }\n\nPOST /v1/payments/academy/serviceitem\nBody: {\"service\": 25, \"how_many\": 5, \"is_renewable\": false}\n# Response: { \"id\": 451, ... }\n\n# 2. Create plan\nPOST /v1/payments/academy/plan\nBody: {\n  \"slug\": \"bootcamp-2025\",\n  \"currency\": \"USD\",\n  \"is_renewable\": false,\n  \"time_of_life\": 6,\n  \"time_of_life_unit\": \"MONTH\",\n  \"financing_options\": [10, 11],\n  \"cohort_set\": 8\n}\n\n# 3. Add service items to plan\nPOST /v1/payments/academy/plan/serviceitem\nBody: {\"plan\": \"bootcamp-2025\", \"service_item\": [450, 451, 93, 106]}\n\n# 4. Activate\nPUT /v1/payments/academy/plan/bootcamp-2025\nBody: {\"status\": \"ACTIVE\"}\n</code></pre></p> <p>Enroll student with plan: <pre><code>POST /v1/auth/academy/student\nBody: {\n  \"email\": \"new.student@example.com\",\n  \"first_name\": \"Jane\",\n  \"last_name\": \"Doe\",\n  \"cohort\": [1429],\n  \"invite\": true,\n  \"plans\": [123]\n}\n</code></pre></p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#summary","title":"Summary","text":"<p>Academy Plans provide a flexible payment system for selling educational services:</p> <ol> <li>Create plans with pricing, trial periods, and lifetime</li> <li>Add service items to define what's included</li> <li>Configure financing for installment payments</li> <li>Set up payment methods for regional and payment processor options</li> <li>Link cohort sets to grant course access</li> <li>Activate and sell through invitation or checkout</li> <li>Track subscriptions and financings automatically</li> </ol> <p>The system handles automatic renewals, consumable allocation, capability grants, and certificate issuance - you just define the packages! \ud83c\udfaf</p>"},{"location":"LLM-DOCS/ACADEMY_PLANS/#quick-reference-payment-methods","title":"Quick Reference - Payment Methods","text":"<p>List payment methods: <pre><code>GET /v1/payments/academy/paymentmethod\nHeaders: {Academy: 1, Authorization: Token ...}\n</code></pre></p> <p>Create payment method: <pre><code>POST /v1/payments/academy/paymentmethod\nBody: {\n  \"title\": \"Bank Transfer\",\n  \"description\": \"Account details...\",\n  \"currency\": \"USD\",\n  \"lang\": \"en-US\",\n  \"is_backed\": true,\n  \"visibility\": \"PUBLIC\"\n}\n</code></pre></p> <p>Update payment method: <pre><code>PUT /v1/payments/academy/paymentmethod/123\nBody: {\"description\": \"Updated details...\"}\n</code></pre></p> <p>Deprecate payment method: <pre><code>PUT /v1/payments/academy/paymentmethod/123\nBody: {\"deprecated\": true, \"visibility\": \"HIDDEN\"}\n</code></pre></p>"},{"location":"LLM-DOCS/ADD_STUDENT/","title":"Add Students to Academy and Cohorts","text":"<p>This document explains how to add students individually or in bulk to an academy and cohort.</p> <p>Note: As of October 2024, the <code>/v1/auth/academy/student</code> endpoint now properly supports bulk student creation by sending an array of student objects.</p>"},{"location":"LLM-DOCS/ADD_STUDENT/#search-for-existing-users","title":"Search for Existing Users","text":"<p>Before adding students, check if they already exist in the database:</p> <p>Endpoint: <code>GET /v1/auth/user/?like={email}</code></p> <p>Example: <pre><code>GET https://breathecode.herokuapp.com/v1/auth/user/?like=aalejo@gmail.com\n</code></pre></p> <p>Response: <pre><code>[\n    {\n        \"id\": 1,\n        \"email\": \"aalejo@gmail.com\",\n        \"first_name\": \"Alejandro\",\n        \"last_name\": \"Sanchez\",\n        \"github\": {\n            \"avatar_url\": \"https://avatars.githubusercontent.com/u/426452?v=4\",\n            \"name\": \"Alejandro Sanchez\",\n            \"username\": \"alesanchezr\"\n        },\n        \"profile\": {\n            \"avatar_url\": \"https://techhubsouthflorida.org/wp-content/uploads/2023/09/Alejandro-Sanchez.jpeg\"\n        }\n    }\n]\n</code></pre></p>"},{"location":"LLM-DOCS/ADD_STUDENT/#option-a-add-students-to-academy-new-users","title":"Option A: Add Students to Academy (New Users)","text":"<p>Use this when students don't exist in the system yet. This will create both the user and add them to the academy/cohort.</p>"},{"location":"LLM-DOCS/ADD_STUDENT/#single-student","title":"Single Student","text":"<p>Endpoint: <code>POST /v1/auth/academy/student</code></p> <p>Headers: - <code>Authorization: Token {your-token}</code> - <code>Academy: {academy_id}</code></p> <p>Request Body: <pre><code>{\n    \"cohort\": [1429],\n    \"email\": \"christianalopez@bcp.com.pe\",\n    \"first_name\": \"CHRISTIAN\",\n    \"last_name\": \"L\u00d3PEZ\",\n    \"phone\": \"0000000000\",\n    \"invite\": true\n}\n</code></pre></p> <p>Important Field Notes: - <code>cohort</code>: Array of valid cohort IDs. Use <code>[]</code> for no cohorts, or omit entirely. Never use <code>[null]</code> - <code>plans</code>: Array of valid plan IDs. Use <code>[]</code> for no plans, or omit entirely. Never use <code>[null]</code>   - \u26a0\ufe0f RESTRICTION: Plans can ONLY be added for new users (<code>invite: true</code> with non-existent email)   - \u274c CANNOT add plans to existing users - will return <code>cannot-add-plans-to-existing-user</code> error   - Plans are linked to the <code>UserInvite</code> and processed when invitation is accepted - <code>email</code>: Required, will be converted to lowercase - <code>first_name</code>, <code>last_name</code>: Required for new students - <code>phone</code>: Optional, defaults to empty string - <code>invite</code>: Set to <code>true</code> to send invitation email</p> <p>Response: <pre><code>{\n    \"id\": 18396,\n    \"first_name\": \"CHRISTIAN\",\n    \"last_name\": \"L\u00d3PEZ\",\n    \"user\": {\n        \"id\": 18731,\n        \"email\": \"christianalopez@bcp.com.pe\",\n        \"first_name\": \"CHRISTIAN\",\n        \"last_name\": \"L\u00d3PEZ\",\n        \"profile\": null\n    },\n    \"academy\": {\n        \"id\": 55,\n        \"name\": \"Banco de Cr\u00e9dito del Per\u00fa\",\n        \"slug\": \"bcp\"\n    },\n    \"role\": {\n        \"id\": \"student\",\n        \"slug\": \"student\",\n        \"name\": \"Student\"\n    },\n    \"created_at\": \"2025-10-20T18:27:46.722458Z\",\n    \"email\": \"christianalopez@bcp.com.pe\",\n    \"address\": null,\n    \"phone\": \"0000000000\",\n    \"status\": \"INVITED\"\n}\n</code></pre></p>"},{"location":"LLM-DOCS/ADD_STUDENT/#bulk-students","title":"Bulk Students","text":"<p>Add multiple students at once by sending an array:</p> <p>Endpoint: <code>POST /v1/auth/academy/student</code></p> <p>Headers: - <code>Authorization: Token {your-token}</code> - <code>Academy: {academy_id}</code></p> <p>Request Body (Array): <pre><code>[\n    {\n        \"cohort\": [1429],\n        \"email\": \"student1@example.com\",\n        \"first_name\": \"John\",\n        \"last_name\": \"Doe\",\n        \"phone\": \"1234567890\",\n        \"invite\": true\n    },\n    {\n        \"cohort\": [1429],\n        \"email\": \"student2@example.com\",\n        \"first_name\": \"Jane\",\n        \"last_name\": \"Smith\",\n        \"phone\": \"0987654321\",\n        \"invite\": true\n    },\n    {\n        \"cohort\": [1429, 1430],\n        \"email\": \"student3@example.com\",\n        \"first_name\": \"Bob\",\n        \"last_name\": \"Johnson\",\n        \"phone\": \"5555555555\",\n        \"invite\": true\n    }\n]\n</code></pre></p> <p>Response (Array): <pre><code>[\n    {\n        \"id\": 18396,\n        \"first_name\": \"John\",\n        \"last_name\": \"Doe\",\n        \"email\": \"student1@example.com\",\n        \"status\": \"INVITED\",\n        ...\n    },\n    {\n        \"id\": 18397,\n        \"first_name\": \"Jane\",\n        \"last_name\": \"Smith\",\n        \"email\": \"student2@example.com\",\n        \"status\": \"INVITED\",\n        ...\n    },\n    {\n        \"id\": 18398,\n        \"first_name\": \"Bob\",\n        \"last_name\": \"Johnson\",\n        \"email\": \"student3@example.com\",\n        \"status\": \"INVITED\",\n        ...\n    }\n]\n</code></pre></p> <p>Notes: - \u2705 The endpoint automatically detects bulk requests by checking if data is an array - <code>cohort</code> is an array of cohort IDs - students will be added to all specified cohorts - <code>invite: true</code> will send invitation emails to the students - All students will be created with <code>INVITED</code> status - The system automatically creates user accounts and ProfileAcademy records - Uses <code>StudentPOSTListSerializer</code> internally for efficient bulk creation</p> <p>Common Errors:</p> <ol> <li><code>\"Invalid data. Expected a dictionary, but got list.\"</code></li> <li>Cause: Outdated API version (pre-October 2024)</li> <li> <p>Solution: Ensure you're using the latest API version</p> </li> <li> <p><code>\"Cohort not found\"</code></p> </li> <li>Cause: Invalid cohort ID in the <code>cohort</code> array</li> <li> <p>Solution: Verify cohort IDs exist and academy has access</p> </li> <li> <p>Validation fails with <code>cohort</code> field</p> </li> <li>Cause: Using <code>\"cohort\": [null]</code> instead of <code>\"cohort\": []</code></li> <li>Solution: Use empty array <code>[]</code> or omit field entirely if no cohorts</li> </ol>"},{"location":"LLM-DOCS/ADD_STUDENT/#adding-students-with-payment-plans","title":"Adding Students with Payment Plans","text":"<p>When adding new students (not existing users), you can specify payment plans using the <code>plans</code> array field.</p> <p>Single Student with Plans: <pre><code>{\n    \"cohort\": [1429],\n    \"email\": \"student@example.com\",\n    \"first_name\": \"John\",\n    \"last_name\": \"Doe\",\n    \"phone\": \"1234567890\",\n    \"invite\": true,\n    \"plans\": [5, 12]  // Array of Plan IDs\n}\n</code></pre></p> <p>Bulk Students with Plans: <pre><code>[\n    {\n        \"cohort\": [1429],\n        \"email\": \"student1@example.com\",\n        \"first_name\": \"John\",\n        \"last_name\": \"Doe\",\n        \"invite\": true,\n        \"plans\": [5]\n    },\n    {\n        \"cohort\": [1429],\n        \"email\": \"student2@example.com\",\n        \"first_name\": \"Jane\",\n        \"last_name\": \"Smith\",\n        \"invite\": true,\n        \"plans\": [5, 12]  // Different student can have different plans\n    },\n    {\n        \"cohort\": [1429],\n        \"email\": \"student3@example.com\",\n        \"first_name\": \"Bob\",\n        \"last_name\": \"Johnson\",\n        \"invite\": true,\n        \"plans\": []  // Or no plans at all\n    }\n]\n</code></pre></p> <p>How It Works: 1. Plans are linked to the <code>UserInvite</code> record (lines 1181-1182 in serializer) 2. Each plan in the array is validated to exist (error if plan not found) 3. When the student accepts the invitation:    - A free <code>Bag</code> is created (type <code>INVITED</code>, status <code>PAID</code>)    - A <code>$0</code> invoice is generated (status <code>FULFILLED</code>)    - <code>build_plan_financing</code> task creates the subscription    - Student capabilities are automatically granted based on plan</p> <p>Requirements: - \u2705 Plans can only be added for new students (when <code>invite: true</code> and user doesn't exist) - \u2705 Cohort must have <code>available_as_saas=true</code> (or inherit from academy) - \u2705 Academy must have <code>main_currency</code> set - \u2705 Plan must include the cohort in its <code>cohort_set</code> - \u2705 Each plan ID must exist, otherwise returns <code>plan-not-found</code> error - \u274c Cannot add plans to existing users - will return 400 error</p> <p>Error Responses:</p> <p>If trying to add plans to existing user: <pre><code>{\n    \"detail\": \"Cannot add payment plans when user already exists. User 123 (user@example.com) should be enrolled through their existing account or payment system.\",\n    \"status_code\": 400,\n    \"slug\": \"cannot-add-plans-to-existing-user\"\n}\n</code></pre></p> <p>If plan doesn't exist: <pre><code>{\n    \"detail\": \"Plan not found\",\n    \"status_code\": 400,\n    \"slug\": \"plan-not-found\"\n}\n</code></pre></p> <p>To Find Available Plans: <pre><code>GET /v1/payments/academy/plan?cohort={cohort_id}\nHeaders:\n  Authorization: Token {your-token}\n  Academy: {academy_id}\n</code></pre></p> <p>Example Response: <pre><code>[\n    {\n        \"id\": 5,\n        \"slug\": \"basic-bootcamp\",\n        \"title\": \"Basic Bootcamp Plan\",\n        \"price_per_month\": 299.00,\n        \"cohort_set\": [1429, 1430]\n    },\n    {\n        \"id\": 12,\n        \"slug\": \"premium-bootcamp\",\n        \"title\": \"Premium Bootcamp Plan\",\n        \"price_per_month\": 499.00,\n        \"cohort_set\": [1429, 1430, 1431]\n    }\n]\n</code></pre></p>"},{"location":"LLM-DOCS/ADD_STUDENT/#option-b-add-existing-users-to-cohort","title":"Option B: Add Existing Users to Cohort","text":"<p>Use this when users already exist in the system and you just need to add them to a cohort.</p>"},{"location":"LLM-DOCS/ADD_STUDENT/#single-user","title":"Single User","text":"<p>Endpoint: <code>POST /v1/admissions/cohort/{cohort_id}/user</code></p> <p>Request Body: <pre><code>{\n    \"user\": 1,\n    \"role\": \"STUDENT\",\n    \"finantial_status\": null,\n    \"educational_status\": \"ACTIVE\"\n}\n</code></pre></p> <p>Response: <pre><code>{\n    \"id\": 42487,\n    \"user\": {\n        \"id\": 1,\n        \"first_name\": \"Alejandro\",\n        \"last_name\": \"Sanchez\",\n        \"email\": \"aalejo@gmail.com\",\n        \"last_login\": \"2025-09-17T16:52:08.171695Z\",\n        \"profile\": {\n            \"id\": 2,\n            \"avatar_url\": \"https://techhubsouthflorida.org/wp-content/uploads/2023/09/Alejandro-Sanchez.jpeg\",\n            \"show_tutorial\": false,\n            \"github_username\": null\n        }\n    },\n    \"cohort\": {\n        \"id\": 1429,\n        \"slug\": \"bcp-react-native-1\",\n        \"name\": \"bcp-react-native-1\",\n        \"kickoff_date\": \"2025-10-22T20:00:00Z\",\n        \"ending_date\": \"2025-12-10T22:00:00Z\",\n        \"stage\": \"PREWORK\",\n        \"available_as_saas\": false,\n        \"shortcuts\": null\n    },\n    \"role\": \"STUDENT\",\n    \"finantial_status\": null,\n    \"educational_status\": \"ACTIVE\",\n    \"watching\": false,\n    \"created_at\": \"2025-10-20T18:32:22.713896Z\",\n    \"updated_at\": \"2025-10-20T18:32:22.713914Z\",\n    \"profile_academy\": {\n        \"id\": 18388,\n        \"first_name\": \"Alejandro\",\n        \"last_name\": \"Sanchez\",\n        \"email\": \"aalejo@gmail.com\",\n        \"phone\": \"\"\n    }\n}\n</code></pre></p>"},{"location":"LLM-DOCS/ADD_STUDENT/#bulk-add-users-to-cohort","title":"Bulk Add Users to Cohort","text":"<p>Add multiple existing users to a cohort at once:</p> <p>Endpoint: <code>POST /v1/admissions/cohort/{cohort_id}/user</code></p> <p>Request Body (Array): <pre><code>[\n    {\n        \"user\": 1,\n        \"role\": \"STUDENT\",\n        \"finantial_status\": null,\n        \"educational_status\": \"ACTIVE\"\n    },\n    {\n        \"user\": 2,\n        \"role\": \"STUDENT\",\n        \"finantial_status\": \"FULLY_PAID\",\n        \"educational_status\": \"ACTIVE\"\n    },\n    {\n        \"user\": 3,\n        \"role\": \"STUDENT\",\n        \"finantial_status\": \"UP_TO_DATE\",\n        \"educational_status\": \"ACTIVE\"\n    }\n]\n</code></pre></p> <p>Response (Array): <pre><code>[\n    {\n        \"id\": 42487,\n        \"user\": {...},\n        \"cohort\": {...},\n        \"role\": \"STUDENT\",\n        \"educational_status\": \"ACTIVE\",\n        ...\n    },\n    {\n        \"id\": 42488,\n        \"user\": {...},\n        \"cohort\": {...},\n        \"role\": \"STUDENT\",\n        \"educational_status\": \"ACTIVE\",\n        ...\n    },\n    {\n        \"id\": 42489,\n        \"user\": {...},\n        \"cohort\": {...},\n        \"role\": \"STUDENT\",\n        \"educational_status\": \"ACTIVE\",\n        ...\n    }\n]\n</code></pre></p> <p>Field Options: - <code>role</code>: <code>STUDENT</code>, <code>TEACHER</code>, <code>ASSISTANT</code>, <code>REVIEWER</code> - <code>educational_status</code>: <code>ACTIVE</code>, <code>POSTPONED</code>, <code>SUSPENDED</code>, <code>GRADUATED</code>, <code>DROPPED</code>, <code>NOT_COMPLETING</code> - <code>finantial_status</code>: <code>FULLY_PAID</code>, <code>UP_TO_DATE</code>, <code>LATE</code>, or <code>null</code></p>"},{"location":"LLM-DOCS/ADD_STUDENT/#unified-bulk-upload-recommended","title":"Unified Bulk Upload (Recommended)","text":"<p>A single endpoint handles all five bulk-upload scenarios server-side. You send a list of students; each student has their own <code>cohort_id</code> (and optional <code>payment_method</code>, <code>plans</code>). The backend classifies each row (new user, already in cohort, same academy different cohort, etc.) and creates/skips as needed. Job state is stored in Redis so you can poll for progress.</p> <p>Warning \u2014 Batch size: There is no hard server-side limit on how many students you can send in one request, but very large payloads can hit HTTP request body size limits, Redis storage limits, or timeouts. For reliability, keep batches to 500 students or fewer per request. For larger lists, split into multiple bulk requests and poll each <code>job_id</code> separately.</p> <p>Endpoints: - <code>POST /v1/auth/academy/student/invite/bulk</code> \u2013 Start bulk upload (returns <code>job_id</code>). With <code>?soft=true</code>: validate only, no DB writes (200 + results). - <code>GET /v1/auth/academy/student/invite/bulk/&lt;job_id&gt;</code> \u2013 Return job status and per-row results from Redis.</p> <p>Headers: <code>Authorization: Token {token}</code>, <code>Academy: {academy_id}</code></p> <p>POST request body: <pre><code>{\n    \"students\": [\n        { \"email\": \"a@example.com\", \"first_name\": \"A\", \"last_name\": \"B\", \"phone\": \"\", \"cohort_id\": 1429, \"payment_method\": 1, \"plans\": [5] },\n        { \"email\": \"b@example.com\", \"first_name\": \"B\", \"last_name\": \"C\", \"cohort_id\": 1429 }\n    ]\n}\n</code></pre> - <code>students</code> (required): array of student objects. Each student has:   - <code>email</code> (required), <code>first_name?</code>, <code>last_name?</code>, <code>phone?</code>   - <code>cohort_id</code> (required): target cohort for this student (must belong to academy).   - <code>payment_method</code> (optional): academy payment method ID; applied only when creating new users (Scenario 1).   - <code>plans</code> (optional): array of plan IDs; applied only when creating new users. Cannot be used for existing users. - Invitations are always sent for new users; no <code>invite</code> field in the payload.</p> <p>POST response (normal): 202 Accepted <pre><code>{\n    \"job_id\": \"uuid\",\n    \"status\": \"pending\",\n    \"total\": 2,\n    \"message\": \"Bulk upload started. Poll GET /v1/auth/academy/student/invite/bulk/{job_id} for status.\"\n}\n</code></pre></p> <p>POST response (soft run, <code>?soft=true</code>): 200 OK <pre><code>{\n    \"total\": 2,\n    \"results\": [\n        { \"index\": 0, \"email\": \"a@example.com\", \"first_name\": \"A\", \"last_name\": \"B\", \"phone\": \"\", \"classification\": \"NEW_USER\", \"status\": \"created\" },\n        { \"index\": 1, \"email\": \"b@example.com\", \"classification\": \"ALREADY_IN_COHORT\", \"status\": \"skipped\", \"message\": \"User is already in this cohort\" }\n    ]\n}\n</code></pre> Each result includes student fields from the request, <code>classification</code> (NEW_USER, ALREADY_IN_COHORT, SAME_ACADEMY_DIFFERENT_COHORT, DIFFERENT_ACADEMY_NO_PROFILE, DIFFERENT_ACADEMY_HAS_PROFILE), and <code>status</code> (created/skipped/failed).</p> <p>GET response (job status): 200 OK \u2013 same shape as Redis state: <code>status</code>, <code>total</code>, <code>processed</code>, <code>results[]</code>, <code>created_at</code>, <code>updated_at</code>, optional <code>error</code>. Each result includes <code>index</code>, student fields, <code>classification</code>, <code>status</code>, <code>message?</code>, <code>slug?</code>, <code>profile_academy_id?</code>, <code>cohort_user_id?</code>.</p> <p>Client flow: 1. Optional: <code>POST .../invite/bulk?soft=true</code> with same body to preview results without persisting. 2. <code>POST .../invite/bulk</code> (no querystring) \u2192 202 + <code>job_id</code>. 3. Poll <code>GET .../invite/bulk/{job_id}</code> until <code>status === \"completed\"</code>. 4. Use <code>results</code> (student fields + classification + status) to show success/skip/failure. For failed rows, fix data and retry via a new <code>POST .../invite/bulk</code> or single-student endpoints.</p>"},{"location":"LLM-DOCS/ADD_STUDENT/#summary","title":"Summary","text":""},{"location":"LLM-DOCS/ADD_STUDENT/#when-to-use-each-method","title":"When to Use Each Method","text":"Scenario Endpoint Method New student(s) not in system <code>/v1/auth/academy/student</code> Option A Existing user(s) \u2192 add to cohort <code>/v1/admissions/cohort/{cohort_id}/user</code> Option B Bulk import new students <code>/v1/auth/academy/student</code> (array) Option A Bulk Bulk add existing users <code>/v1/admissions/cohort/{cohort_id}/user</code> (array) Option B Bulk"},{"location":"LLM-DOCS/ADD_STUDENT/#tips-for-bulk-operations","title":"Tips for Bulk Operations","text":"<ol> <li>Validation: All items in the array must be valid or the entire request fails</li> <li>Performance: Bulk operations use <code>bulk_create()</code> internally for better performance</li> <li>Error Handling: If one item fails validation, check the error response for details</li> <li>Size Limits: Consider breaking very large imports (500+ students) into smaller batches</li> <li>Invitations: When using Option A with <code>invite: true</code>, invitation emails are sent to all students</li> <li>Multiple Cohorts: In Option A, you can add students to multiple cohorts by providing an array of cohort IDs</li> </ol>"},{"location":"LLM-DOCS/ADD_STUDENT/#best-practices-troubleshooting","title":"Best Practices &amp; Troubleshooting","text":""},{"location":"LLM-DOCS/ADD_STUDENT/#common-pitfall-null-values-in-arrays","title":"\u26a0\ufe0f Common Pitfall: Null Values in Arrays","text":"<p>This is a VERY common mistake across multiple endpoints!</p> <p>Many API endpoints accept arrays (like <code>cohort</code>, <code>plans</code>, <code>service_item</code>, etc.) and will crash if you send <code>null</code> values inside the array:</p> <pre><code>// \u274c NEVER DO THIS - Will cause 500 errors\n{\n  \"cohort\": [null],\n  \"plans\": [null],\n  \"service_item\": [null]\n}\n\n// \u2705 CORRECT - Use empty arrays or omit the field\n{\n  \"cohort\": [],\n  \"plans\": []\n}\n// Or simply omit the fields entirely\n</code></pre> <p>Affected Endpoints: - <code>POST /v1/auth/academy/student</code> - cohort, plans arrays - <code>POST /v1/admissions/cohort/{cohort_id}/user</code> - cohort array - <code>POST /v1/payments/academy/plan/serviceitem</code> - service_item array - And potentially others...</p> <p>Why This Happens: CSV exports or spreadsheet tools often convert empty cells to <code>null</code>, which then gets included in API requests. Always clean your data before sending!</p>"},{"location":"LLM-DOCS/ADD_STUDENT/#before-bulk-import","title":"Before Bulk Import","text":"<ol> <li> <p>Validate your data structure: <pre><code>// \u2705 CORRECT - Arrays with valid IDs or empty arrays\n[\n  {\"email\": \"user1@example.com\", \"first_name\": \"John\", \"cohort\": [123], \"plans\": [5]},\n  {\"email\": \"user2@example.com\", \"first_name\": \"Jane\", \"cohort\": [], \"plans\": []},\n  {\"email\": \"user3@example.com\", \"first_name\": \"Bob\", \"cohort\": [123, 456]}\n  // Note: omitting cohort/plans is also fine\n]\n\n// \u274c WRONG - Never use null values\n[\n  {\"email\": \"user1@example.com\", \"cohort\": [null]},     // Don't use null\n  {\"email\": \"user2@example.com\", \"cohort\": null},       // Don't use null\n  {\"email\": \"user3@example.com\", \"plans\": [null]},      // Don't use null\n  {\"email\": \"user4@example.com\", \"plans\": null}         // Don't use null\n]\n</code></pre></p> </li> <li> <p>Check for existing users using the search endpoint to avoid duplicates</p> </li> <li> <p>Verify cohort IDs are valid and accessible to your academy</p> </li> <li> <p>Verify plan IDs if using the <code>plans</code> field:</p> </li> <li>Use <code>GET /v1/payments/academy/plan?cohort={cohort_id}</code> to list available plans</li> <li>Ensure plans are compatible with the cohorts you're assigning</li> <li> <p>Remember: plans can only be used for new users (invitations)</p> </li> <li> <p>Test with a small batch (2-3 students) before running large imports</p> </li> </ol>"},{"location":"LLM-DOCS/ADD_STUDENT/#field-requirements","title":"Field Requirements","text":"Field Required? Type Notes <code>email</code> \u2705 Yes String Will be lowercased automatically <code>first_name</code> \u2705 Yes String Required for new students <code>last_name</code> \u2705 Yes String Required for new students <code>phone</code> \u26a0\ufe0f Optional String Defaults to <code>\"\"</code> if not provided <code>invite</code> \u26a0\ufe0f Optional Boolean Default is <code>false</code>, set to <code>true</code> to send emails <code>cohort</code> \u26a0\ufe0f Optional Array[Int] Array of cohort IDs, use <code>[]</code> for none <code>plans</code> \u26a0\ufe0f Optional Array[Int] Only for new users, ignored for existing <code>address</code> \u26a0\ufe0f Optional String Student address"},{"location":"LLM-DOCS/ADD_STUDENT/#common-scenarios","title":"Common Scenarios","text":"<p>Scenario 1: Import students without cohorts <pre><code>{\n  \"email\": \"student@example.com\",\n  \"first_name\": \"John\",\n  \"last_name\": \"Doe\",\n  \"phone\": \"1234567890\",\n  \"invite\": true\n}\n// Note: No cohort field, or use \"cohort\": []\n</code></pre></p> <p>Scenario 2: Import students to multiple cohorts <pre><code>{\n  \"email\": \"student@example.com\",\n  \"first_name\": \"John\",\n  \"last_name\": \"Doe\",\n  \"cohort\": [1429, 1430, 1431],\n  \"invite\": true\n}\n</code></pre></p> <p>Scenario 3: Import students with plans (SaaS/Subscriptions) <pre><code>// Single student with multiple plans\n{\n  \"email\": \"student@example.com\",\n  \"first_name\": \"John\",\n  \"last_name\": \"Doe\",\n  \"cohort\": [1429],\n  \"plans\": [5, 12],  // Multiple plans can be assigned\n  \"invite\": true\n}\n\n// Bulk import with mixed plan assignments\n[\n  {\n    \"email\": \"premium@example.com\",\n    \"first_name\": \"John\",\n    \"last_name\": \"Doe\",\n    \"cohort\": [1429],\n    \"plans\": [12],  // Premium plan\n    \"invite\": true\n  },\n  {\n    \"email\": \"basic@example.com\",\n    \"first_name\": \"Jane\",\n    \"last_name\": \"Smith\",\n    \"cohort\": [1429],\n    \"plans\": [5],  // Basic plan\n    \"invite\": true\n  },\n  {\n    \"email\": \"free@example.com\",\n    \"first_name\": \"Bob\",\n    \"last_name\": \"Johnson\",\n    \"cohort\": [1429],\n    \"plans\": [],  // No plans (free access or manual enrollment)\n    \"invite\": true\n  }\n]\n</code></pre></p> <p>Important Notes: - Plans are processed when the invitation is accepted - A free $0 bag/invoice is created automatically - The subscription is built via the <code>build_plan_financing</code> background task - Student gets capabilities based on their assigned plan(s) - You can assign multiple plans to a single student</p>"},{"location":"LLM-DOCS/ADD_STUDENT/#error-reference","title":"Error Reference","text":"Error Meaning Solution <code>Invalid data. Expected a dictionary, but got list.</code> Endpoint not detecting array Update API/contact support <code>already-exists-with-this-email</code> ProfileAcademy exists with email Use different email or update existing <code>already-exists</code> User already member of academy User is already a student, update instead <code>already-invited</code> Duplicate invitation User already has pending invitation for this cohort <code>Cohort not found</code> Invalid cohort ID in array Verify cohort exists and academy has access <code>Plan not found</code> Invalid plan ID in array Verify plan ID exists using plan list endpoint <code>role-not-found</code> Role 'student' doesn't exist Run academy setup/migrations <code>cannot-add-plans-to-existing-user</code> Plans provided for existing user Remove <code>plans</code> field - existing users must enroll via payment system <code>no-email-or-id</code> Missing required identifier Provide valid email address <code>user-not-found</code> User doesn't exist and invite=false Set <code>invite: true</code> or provide existing user ID <code>Academy not found</code> Invalid academy_id in header Verify Academy header value matches your academy"},{"location":"LLM-DOCS/ADD_STUDENT/#performance-considerations","title":"Performance Considerations","text":"<ul> <li>Batch Size: Recommended batch size is 100-200 students per request</li> <li>Large Imports: For 1000+ students, split into multiple batches</li> <li>Rate Limiting: Wait 1-2 seconds between batch requests</li> <li>Timeout: Very large batches may timeout; reduce size if this occurs</li> </ul>"},{"location":"LLM-DOCS/AUTHENTICATION/","title":"Authentication API - Complete Guide","text":"<p>This document provides a comprehensive guide for frontend applications to implement authentication flows with the BreatheCode API.</p>"},{"location":"LLM-DOCS/AUTHENTICATION/#table-of-contents","title":"Table of Contents","text":"<ol> <li>Overview</li> <li>Authentication Methods</li> <li>Token Management</li> <li>Authentication Flows</li> <li>OAuth Integration</li> <li>Security Best Practices</li> <li>Error Handling</li> </ol>"},{"location":"LLM-DOCS/AUTHENTICATION/#overview","title":"Overview","text":"<p>BreatheCode API supports multiple authentication methods:</p> <ul> <li>Email/Password Login - Traditional username/password authentication</li> <li>OAuth2.0 - GitHub, Google, Facebook, Slack integration</li> <li>Token-based Authentication - Using JWT-like tokens with expiration</li> <li>Invite-based Signup - User invitation and registration flow</li> <li>Password Reset - Secure password recovery</li> </ul> <p>All authenticated requests require a token in the <code>Authorization</code> header:</p> <pre><code>Authorization: Token {your-token-here}\n</code></pre>"},{"location":"LLM-DOCS/AUTHENTICATION/#base-url","title":"Base URL","text":"<pre><code>Production: https://breathecode.herokuapp.com\nDevelopment: http://localhost:8000\n</code></pre>"},{"location":"LLM-DOCS/AUTHENTICATION/#authentication-methods","title":"Authentication Methods","text":""},{"location":"LLM-DOCS/AUTHENTICATION/#1-token-types","title":"1. Token Types","text":"<p>BreatheCode uses different token types for different purposes:</p> Token Type Purpose Lifetime Use Case <code>login</code> Standard authentication Configurable (default: 30 days) Regular user sessions <code>temporal</code> Temporary access Short-lived (hours) One-time operations <code>permanent</code> Long-term access No expiration Service accounts, integrations"},{"location":"LLM-DOCS/AUTHENTICATION/#token-management","title":"Token Management","text":""},{"location":"LLM-DOCS/AUTHENTICATION/#get-token-information","title":"Get Token Information","text":"<p>Endpoint: <code>GET /v1/auth/token/{token}</code></p> <p>Purpose: Validate and get information about a token.</p> <p>Parameters: - <code>token</code> - The token string to validate</p> <p>Response: <pre><code>{\n  \"key\": \"abc123...\",\n  \"token_type\": \"login\",\n  \"expires_at\": \"2024-12-31T23:59:59Z\",\n  \"user\": {\n    \"id\": 123,\n    \"email\": \"user@example.com\",\n    \"first_name\": \"John\",\n    \"last_name\": \"Doe\"\n  }\n}\n</code></pre></p>"},{"location":"LLM-DOCS/AUTHENTICATION/#create-temporal-token","title":"Create Temporal Token","text":"<p>Endpoint: <code>POST /v1/auth/token/me</code></p> <p>Purpose: Generate a temporary token from an existing valid token.</p> <p>Headers: <pre><code>Authorization: Token {your-login-token}\n</code></pre></p> <p>Request Body: <pre><code>{\n  \"token_type\": \"temporal\"\n}\n</code></pre></p> <p>Response: <pre><code>{\n  \"token\": \"temp_abc123...\",\n  \"expires_at\": \"2024-02-20T18:00:00Z\"\n}\n</code></pre></p> <p>Use Cases: - One-time password reset links - Temporary access for external services - Time-limited operations</p>"},{"location":"LLM-DOCS/AUTHENTICATION/#authentication-flows","title":"Authentication Flows","text":""},{"location":"LLM-DOCS/AUTHENTICATION/#flow-1-emailpassword-login-api","title":"Flow 1: Email/Password Login (API)","text":""},{"location":"LLM-DOCS/AUTHENTICATION/#step-1-login","title":"Step 1: Login","text":"<p>Endpoint: <code>POST /v1/auth/login/</code></p> <p>Purpose: Authenticate user with email and password programmatically.</p> <p>Headers: <pre><code>Content-Type: application/json\n</code></pre></p> <p>Request Body: <pre><code>{\n  \"email\": \"user@example.com\",\n  \"password\": \"securePassword123\"\n}\n</code></pre></p> <p>Success Response (200 OK): <pre><code>{\n  \"token\": \"9944b09199c62bcf9418ad846dd0e4bbdfc6ee4b\",\n  \"user_id\": 123,\n  \"email\": \"user@example.com\",\n  \"expires_at\": \"2024-03-20T10:30:00Z\"\n}\n</code></pre></p> <p>Error Responses:</p> <p>403 Forbidden - Invalid Credentials: <pre><code>{\n  \"detail\": \"Unable to log in with provided credentials.\",\n  \"status_code\": 403\n}\n</code></pre></p> <p>403 Forbidden - Email Not Validated: <pre><code>{\n  \"detail\": \"You need to validate your email first\",\n  \"slug\": \"email-not-validated\",\n  \"status_code\": 403,\n  \"data\": [\n    {\n      \"id\": 456,\n      \"email\": \"user@example.com\",\n      \"status\": \"ACCEPTED\",\n      \"is_email_validated\": false,\n      \"token\": \"invite_token_abc123\"\n    }\n  ]\n}\n</code></pre></p>"},{"location":"LLM-DOCS/AUTHENTICATION/#step-2-store-token","title":"Step 2: Store Token","text":"<p>Store the token securely in your frontend:</p> <pre><code>// React example\nlocalStorage.setItem('authToken', response.token);\nlocalStorage.setItem('userId', response.user_id);\nlocalStorage.setItem('tokenExpiry', response.expires_at);\n\n// Or use secure cookie\ndocument.cookie = `authToken=${response.token}; secure; httpOnly; sameSite=strict`;\n</code></pre>"},{"location":"LLM-DOCS/AUTHENTICATION/#step-3-use-token-in-requests","title":"Step 3: Use Token in Requests","text":"<p>Include token in all authenticated requests:</p> <pre><code>// JavaScript/Fetch example\nfetch('https://breathecode.herokuapp.com/v1/auth/user/me', {\n  headers: {\n    'Authorization': `Token ${authToken}`,\n    'Content-Type': 'application/json'\n  }\n})\n.then(response =&gt; response.json())\n.then(data =&gt; console.log(data));\n</code></pre> <pre><code># Python example\nimport requests\n\nheaders = {\n    'Authorization': f'Token {auth_token}',\n    'Content-Type': 'application/json'\n}\n\nresponse = requests.get(\n    'https://breathecode.herokuapp.com/v1/auth/user/me',\n    headers=headers\n)\n</code></pre>"},{"location":"LLM-DOCS/AUTHENTICATION/#step-4-get-user-information","title":"Step 4: Get User Information","text":"<p>Endpoint: <code>GET /v1/auth/user/me</code></p> <p>Headers: <pre><code>Authorization: Token {your-token}\n</code></pre></p> <p>Response: <pre><code>{\n  \"id\": 123,\n  \"email\": \"user@example.com\",\n  \"first_name\": \"John\",\n  \"last_name\": \"Doe\",\n  \"github\": {\n    \"username\": \"johndoe\",\n    \"avatar_url\": \"https://avatars.githubusercontent.com/u/123?v=4\"\n  },\n  \"profile\": {\n    \"avatar_url\": \"https://example.com/avatar.jpg\",\n    \"bio\": \"Full-stack developer\",\n    \"phone\": \"+1234567890\"\n  }\n}\n</code></pre></p>"},{"location":"LLM-DOCS/AUTHENTICATION/#flow-1b-html-login-form-with-redirect","title":"Flow 1B: HTML Login Form with Redirect","text":"<p>For applications that need to redirect users to a login page and receive the token back via URL parameter, use the HTML login form endpoint.</p> <p>Endpoint: <code>GET /v1/auth/view/login</code></p> <p>Purpose: Display an HTML login form that redirects back to your application with an authentication token after successful login.</p> <p>Query Parameters: - <code>url</code> (required) - The callback URL to redirect to after successful authentication. Can be:   - Plain URL: <code>https://yourapp.com/callback</code>   - Base64 encoded URL: The endpoint will automatically detect and decode base64-encoded URLs</p> <p>Example Usage:</p> <pre><code>https://breathecode.herokuapp.com/v1/auth/view/login?url=https://yourapp.com/auth/callback\n</code></pre> <p>User Flow: 1. User is redirected to the login form 2. User enters email and password 3. After successful authentication, user is redirected to your callback URL with token appended</p> <p>Redirect After Success: <pre><code>https://yourapp.com/auth/callback?token=9944b09199c62bcf9418ad846dd0e4bbdfc6ee4b&amp;attempt=1\n</code></pre></p> <p>Query Parameters in Redirect: - <code>token</code> - The authentication token (same format as API login response) - <code>attempt</code> - Always set to <code>1</code>, indicates login attempt</p> <p>Frontend Implementation:</p> <pre><code>// Redirect user to login form\nconst redirectToLogin = () =&gt; {\n  const callbackUrl = `${window.location.origin}/auth/callback`;\n  // URL can be plain or base64 encoded\n  const loginUrl = `https://breathecode.herokuapp.com/v1/auth/view/login?url=${encodeURIComponent(callbackUrl)}`;\n\n  window.location.href = loginUrl;\n};\n\n// Handle callback in your app\n// Route: /auth/callback\nconst handleAuthCallback = () =&gt; {\n  const urlParams = new URLSearchParams(window.location.search);\n  const token = urlParams.get('token');\n  const attempt = urlParams.get('attempt');\n\n  if (token) {\n    // Store token\n    localStorage.setItem('authToken', token);\n\n    // Validate token and get user info\n    fetch('https://breathecode.herokuapp.com/v1/auth/user/me', {\n      headers: {\n        'Authorization': `Token ${token}`\n      }\n    })\n    .then(response =&gt; response.json())\n    .then(user =&gt; {\n      localStorage.setItem('userId', user.id);\n      // Redirect to dashboard\n      window.location.href = '/dashboard';\n    })\n    .catch(error =&gt; {\n      console.error('Token validation failed:', error);\n      // Redirect back to login\n      window.location.href = '/login?error=invalid_token';\n    });\n  } else {\n    // No token received, login failed\n    window.location.href = '/login?error=authentication_failed';\n  }\n};\n</code></pre> <p>Complete React Example:</p> <pre><code>import { useEffect } from 'react';\nimport { useNavigate, useSearchParams } from 'react-router-dom';\n\nconst AuthCallback = () =&gt; {\n  const navigate = useNavigate();\n  const [searchParams] = useSearchParams();\n\n  useEffect(() =&gt; {\n    const token = searchParams.get('token');\n\n    if (!token) {\n      navigate('/login?error=no_token');\n      return;\n    }\n\n    // Validate and store token\n    fetch('https://breathecode.herokuapp.com/v1/auth/user/me', {\n      headers: {\n        'Authorization': `Token ${token}`\n      }\n    })\n      .then(async (response) =&gt; {\n        if (!response.ok) throw new Error('Invalid token');\n\n        const user = await response.json();\n\n        // Store authentication data\n        localStorage.setItem('authToken', token);\n        localStorage.setItem('userId', user.id);\n\n        // Redirect to dashboard\n        navigate('/dashboard');\n      })\n      .catch((error) =&gt; {\n        console.error('Authentication error:', error);\n        navigate('/login?error=invalid_token');\n      });\n  }, [searchParams, navigate]);\n\n  return (\n    &lt;div&gt;\n      &lt;h2&gt;Authenticating...&lt;/h2&gt;\n      &lt;p&gt;Please wait while we log you in.&lt;/p&gt;\n    &lt;/div&gt;\n  );\n};\n\nexport default AuthCallback;\n</code></pre> <p>Error Handling:</p> <p>If login fails, the user is shown an error message on the login form page. Common errors include: - Invalid credentials - Email not validated - Missing email or password</p> <p>After a failed login attempt, the user remains on the login form to retry.</p> <p>Use Cases: - Third-party applications that need BreatheCode authentication - Mobile apps using webviews for authentication - Applications that cannot implement the API login endpoint - Legacy systems requiring URL-based token delivery</p> <p>Security Notes: - Always use HTTPS for the callback URL in production - Validate the token immediately after receiving it - Store tokens securely (use httpOnly cookies when possible) - The token is visible in the URL, so ensure the callback page clears it from history</p>"},{"location":"LLM-DOCS/AUTHENTICATION/#flow-2-user-signup-via-invite","title":"Flow 2: User Signup via Invite","text":"<p>The invite flow is the primary way users join BreatheCode. Users receive an invitation email and complete their registration.</p>"},{"location":"LLM-DOCS/AUTHENTICATION/#step-1-user-receives-invite","title":"Step 1: User Receives Invite","text":"<p>Invitation is sent by academy staff with a unique token. The email contains a link like:</p> <pre><code>https://your-app.com/register?token=invite_abc123xyz\n</code></pre>"},{"location":"LLM-DOCS/AUTHENTICATION/#step-2-validate-invite-token","title":"Step 2: Validate Invite Token","text":"<p>Endpoint: <code>GET /v1/auth/token/{invite_token}</code></p> <p>Purpose: Verify the invite token is valid.</p> <p>Response: <pre><code>{\n  \"key\": \"invite_abc123xyz\",\n  \"token_type\": \"temporal\",\n  \"expires_at\": \"2024-12-31T23:59:59Z\",\n  \"user\": {\n    \"id\": 456,\n    \"email\": \"newuser@example.com\",\n    \"first_name\": \"Jane\",\n    \"last_name\": \"Smith\"\n  }\n}\n</code></pre></p>"},{"location":"LLM-DOCS/AUTHENTICATION/#step-3-accept-invite-set-password","title":"Step 3: Accept Invite &amp; Set Password","text":"<p>Endpoint: <code>PUT /v1/auth/user/me/invite/{new_status}</code></p> <p>Purpose: Accept invite and set password.</p> <p>Parameters: - <code>new_status</code> - Should be <code>accepted</code></p> <p>Query Parameters: - <code>token={invite_token}</code> - The invitation token</p> <p>Request Body: <pre><code>{\n  \"first_name\": \"Jane\",\n  \"last_name\": \"Smith\",\n  \"password\": \"securePassword123\",\n  \"repeat_password\": \"securePassword123\"\n}\n</code></pre></p> <p>Success Response (200 OK): <pre><code>{\n  \"id\": 456,\n  \"email\": \"newuser@example.com\",\n  \"first_name\": \"Jane\",\n  \"last_name\": \"Smith\",\n  \"token\": \"9944b09199c62bcf9418ad846dd0e4bbdfc6ee4b\"\n}\n</code></pre></p>"},{"location":"LLM-DOCS/AUTHENTICATION/#step-4-login-automatically","title":"Step 4: Login Automatically","text":"<p>After accepting invite, the response includes a login token. Store it and redirect to dashboard:</p> <pre><code>// React example\nconst handleAcceptInvite = async (inviteToken, formData) =&gt; {\n  const response = await fetch(\n    `https://breathecode.herokuapp.com/v1/auth/user/me/invite/accepted?token=${inviteToken}`,\n    {\n      method: 'PUT',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        first_name: formData.firstName,\n        last_name: formData.lastName,\n        password: formData.password,\n        repeat_password: formData.confirmPassword\n      })\n    }\n  );\n\n  if (response.ok) {\n    const data = await response.json();\n    // Store token\n    localStorage.setItem('authToken', data.token);\n    localStorage.setItem('userId', data.id);\n    // Redirect to dashboard\n    window.location.href = '/dashboard';\n  }\n};\n</code></pre>"},{"location":"LLM-DOCS/AUTHENTICATION/#flow-3-password-reset","title":"Flow 3: Password Reset","text":""},{"location":"LLM-DOCS/AUTHENTICATION/#step-1-request-password-reset","title":"Step 1: Request Password Reset","text":"<p>Endpoint: <code>POST /v1/auth/password/reset</code></p> <p>Purpose: Request a password reset link.</p> <p>Request Body: <pre><code>{\n  \"email\": \"user@example.com\"\n}\n</code></pre></p> <p>Success Response (200 OK): <pre><code>{\n  \"details\": \"If that email exists, you will receive a password reset link\"\n}\n</code></pre></p> <p>Note: Always returns success even if email doesn't exist (security measure to prevent email enumeration).</p>"},{"location":"LLM-DOCS/AUTHENTICATION/#step-2-user-receives-email","title":"Step 2: User Receives Email","text":"<p>User receives an email with a password reset link:</p> <pre><code>https://your-app.com/password/reset?token=reset_abc123xyz\n</code></pre>"},{"location":"LLM-DOCS/AUTHENTICATION/#step-3-validate-reset-token","title":"Step 3: Validate Reset Token","text":"<p>Endpoint: <code>GET /v1/auth/token/{reset_token}</code></p> <p>Purpose: Verify reset token is valid.</p> <pre><code>const validateResetToken = async (token) =&gt; {\n  const response = await fetch(\n    `https://breathecode.herokuapp.com/v1/auth/token/${token}`\n  );\n\n  if (response.ok) {\n    const data = await response.json();\n    return data; // Token is valid\n  } else {\n    throw new Error('Invalid or expired token');\n  }\n};\n</code></pre>"},{"location":"LLM-DOCS/AUTHENTICATION/#step-4-set-new-password","title":"Step 4: Set New Password","text":"<p>Endpoint: <code>POST /v1/auth/password/{token}</code></p> <p>Purpose: Set new password using reset token.</p> <p>Request Body: <pre><code>{\n  \"password\": \"newSecurePassword123\",\n  \"repeat_password\": \"newSecurePassword123\"\n}\n</code></pre></p> <p>Success Response (200 OK): <pre><code>{\n  \"details\": \"Password updated successfully\"\n}\n</code></pre></p>"},{"location":"LLM-DOCS/AUTHENTICATION/#step-5-redirect-to-login","title":"Step 5: Redirect to Login","text":"<p>After successful password reset, redirect user to login page:</p> <pre><code>const handlePasswordReset = async (token, formData) =&gt; {\n  const response = await fetch(\n    `https://breathecode.herokuapp.com/v1/auth/password/${token}`,\n    {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        password: formData.password,\n        repeat_password: formData.confirmPassword\n      })\n    }\n  );\n\n  if (response.ok) {\n    // Redirect to login\n    window.location.href = '/login?reset=success';\n  }\n};\n</code></pre>"},{"location":"LLM-DOCS/AUTHENTICATION/#flow-4-logout","title":"Flow 4: Logout","text":"<p>Endpoint: <code>POST /v1/auth/logout/</code></p> <p>Purpose: Invalidate current token.</p> <p>Headers: <pre><code>Authorization: Token {your-token}\n</code></pre></p> <p>Success Response (200 OK): <pre><code>{\n  \"details\": \"Successfully logged out\"\n}\n</code></pre></p> <p>Frontend Implementation: <pre><code>const handleLogout = async () =&gt; {\n  const token = localStorage.getItem('authToken');\n\n  await fetch('https://breathecode.herokuapp.com/v1/auth/logout/', {\n    method: 'POST',\n    headers: {\n      'Authorization': `Token ${token}`\n    }\n  });\n\n  // Clear local storage\n  localStorage.removeItem('authToken');\n  localStorage.removeItem('userId');\n  localStorage.removeItem('tokenExpiry');\n\n  // Redirect to login\n  window.location.href = '/login';\n};\n</code></pre></p>"},{"location":"LLM-DOCS/AUTHENTICATION/#oauth-integration","title":"OAuth Integration","text":""},{"location":"LLM-DOCS/AUTHENTICATION/#flow-5-github-oauth","title":"Flow 5: GitHub OAuth","text":"<p>BreatheCode supports GitHub OAuth for seamless authentication.</p>"},{"location":"LLM-DOCS/AUTHENTICATION/#step-1-initiate-github-oauth","title":"Step 1: Initiate GitHub OAuth","text":"<p>Endpoint: <code>GET /v1/auth/github/</code></p> <p>Purpose: Redirect user to GitHub authorization page.</p> <p>Query Parameters: - <code>url</code> - Base64 encoded callback URL (where to redirect after auth) - <code>scope</code> - Optional, default: <code>user:email</code></p> <p>Example: <pre><code>const initiateGitHubLogin = () =&gt; {\n  const callbackUrl = 'https://your-app.com/auth/callback';\n  const encodedUrl = btoa(callbackUrl);\n\n  window.location.href = `https://breathecode.herokuapp.com/v1/auth/github/?url=${encodedUrl}`;\n};\n</code></pre></p>"},{"location":"LLM-DOCS/AUTHENTICATION/#step-2-github-callback","title":"Step 2: GitHub Callback","text":"<p>After user authorizes on GitHub, they're redirected to:</p> <pre><code>GET /v1/auth/github/callback?code={github_code}&amp;url={your_callback_url}\n</code></pre> <p>BreatheCode processes the GitHub code and redirects to your app with token:</p> <pre><code>https://your-app.com/auth/callback?token={breathecode_token}\n</code></pre>"},{"location":"LLM-DOCS/AUTHENTICATION/#step-3-extract-token","title":"Step 3: Extract Token","text":"<pre><code>// React example\nuseEffect(() =&gt; {\n  const urlParams = new URLSearchParams(window.location.search);\n  const token = urlParams.get('token');\n\n  if (token) {\n    // Validate and store token\n    validateToken(token).then(data =&gt; {\n      localStorage.setItem('authToken', token);\n      localStorage.setItem('userId', data.user.id);\n      window.location.href = '/dashboard';\n    });\n  }\n}, []);\n</code></pre>"},{"location":"LLM-DOCS/AUTHENTICATION/#complete-github-flow-example","title":"Complete GitHub Flow Example","text":"<pre><code>// GitHub OAuth Flow\nclass GitHubAuth {\n  static async login() {\n    const callbackUrl = window.location.origin + '/auth/callback';\n    const encodedUrl = btoa(callbackUrl);\n    window.location.href = `https://breathecode.herokuapp.com/v1/auth/github/?url=${encodedUrl}`;\n  }\n\n  static async handleCallback() {\n    const urlParams = new URLSearchParams(window.location.search);\n    const token = urlParams.get('token');\n    const error = urlParams.get('error');\n\n    if (error) {\n      console.error('GitHub auth error:', error);\n      return { success: false, error };\n    }\n\n    if (token) {\n      // Validate token\n      const response = await fetch(\n        `https://breathecode.herokuapp.com/v1/auth/token/${token}`\n      );\n\n      if (response.ok) {\n        const data = await response.json();\n        localStorage.setItem('authToken', token);\n        localStorage.setItem('userId', data.user.id);\n        return { success: true, user: data.user };\n      }\n    }\n\n    return { success: false, error: 'No token received' };\n  }\n}\n</code></pre>"},{"location":"LLM-DOCS/AUTHENTICATION/#flow-6-google-oauth","title":"Flow 6: Google OAuth","text":"<p>Similar to GitHub, but uses Google OAuth 2.0.</p>"},{"location":"LLM-DOCS/AUTHENTICATION/#step-1-initiate-google-oauth","title":"Step 1: Initiate Google OAuth","text":"<p>Endpoint: <code>GET /v1/auth/google</code></p> <p>Query Parameters: - <code>url</code> - Base64 encoded callback URL</p> <p>Example: <pre><code>const initiateGoogleLogin = () =&gt; {\n  const callbackUrl = 'https://your-app.com/auth/google/callback';\n  const encodedUrl = btoa(callbackUrl);\n\n  window.location.href = `https://breathecode.herokuapp.com/v1/auth/google?url=${encodedUrl}`;\n};\n</code></pre></p>"},{"location":"LLM-DOCS/AUTHENTICATION/#step-2-google-callback","title":"Step 2: Google Callback","text":"<p>Endpoint: <code>GET /v1/auth/google/callback</code></p> <p>Works the same as GitHub callback - redirects to your URL with token parameter.</p>"},{"location":"LLM-DOCS/AUTHENTICATION/#flow-7-slack-oauth","title":"Flow 7: Slack OAuth","text":""},{"location":"LLM-DOCS/AUTHENTICATION/#initiate-slack-oauth","title":"Initiate Slack OAuth","text":"<p>Endpoint: <code>GET /v1/auth/slack/</code></p> <p>Query Parameters: - <code>url</code> - Callback URL - <code>user</code> - Optional, user token for linking accounts</p> <p>Callback: <code>GET /v1/auth/slack/callback</code></p>"},{"location":"LLM-DOCS/AUTHENTICATION/#flow-8-facebook-oauth","title":"Flow 8: Facebook OAuth","text":""},{"location":"LLM-DOCS/AUTHENTICATION/#initiate-facebook-oauth","title":"Initiate Facebook OAuth","text":"<p>Endpoint: <code>GET /v1/auth/facebook/</code></p> <p>Query Parameters: - <code>url</code> - Callback URL</p> <p>Callback: <code>GET /v1/auth/facebook/callback</code></p>"},{"location":"LLM-DOCS/AUTHENTICATION/#security-best-practices","title":"Security Best Practices","text":""},{"location":"LLM-DOCS/AUTHENTICATION/#1-token-storage","title":"1. Token Storage","text":"<p>Best Practices:</p> <pre><code>// \u2705 Good: Store in httpOnly cookie (most secure)\n// Set on server-side\nresponse.cookie('authToken', token, {\n  httpOnly: true,\n  secure: true,\n  sameSite: 'strict',\n  maxAge: 30 * 24 * 60 * 60 * 1000 // 30 days\n});\n\n// \u26a0\ufe0f Acceptable: Store in localStorage (convenient but less secure)\nlocalStorage.setItem('authToken', token);\n\n// \u274c Bad: Store in regular cookie (vulnerable to XSS)\ndocument.cookie = `authToken=${token}`;\n</code></pre>"},{"location":"LLM-DOCS/AUTHENTICATION/#2-token-validation","title":"2. Token Validation","text":"<p>Always validate token before using:</p> <pre><code>const isTokenValid = async (token) =&gt; {\n  try {\n    const response = await fetch(\n      `https://breathecode.herokuapp.com/v1/auth/token/${token}`\n    );\n\n    if (response.ok) {\n      const data = await response.json();\n      // Check expiration\n      const expiresAt = new Date(data.expires_at);\n      return expiresAt &gt; new Date();\n    }\n    return false;\n  } catch (error) {\n    return false;\n  }\n};\n</code></pre>"},{"location":"LLM-DOCS/AUTHENTICATION/#3-token-expiration-handling","title":"3. Token Expiration Handling","text":"<p>Implement automatic token refresh or re-login:</p> <pre><code>const makeAuthenticatedRequest = async (url, options = {}) =&gt; {\n  const token = localStorage.getItem('authToken');\n  const expiry = localStorage.getItem('tokenExpiry');\n\n  // Check if token is expired\n  if (new Date(expiry) &lt;= new Date()) {\n    // Token expired, redirect to login\n    window.location.href = '/login?expired=true';\n    return;\n  }\n\n  const response = await fetch(url, {\n    ...options,\n    headers: {\n      ...options.headers,\n      'Authorization': `Token ${token}`\n    }\n  });\n\n  if (response.status === 401) {\n    // Token invalid, redirect to login\n    localStorage.removeItem('authToken');\n    window.location.href = '/login';\n    return;\n  }\n\n  return response;\n};\n</code></pre>"},{"location":"LLM-DOCS/AUTHENTICATION/#4-secure-password-requirements","title":"4. Secure Password Requirements","text":"<p>Enforce strong passwords on frontend:</p> <pre><code>const validatePassword = (password) =&gt; {\n  const requirements = {\n    minLength: password.length &gt;= 8,\n    hasUpperCase: /[A-Z]/.test(password),\n    hasLowerCase: /[a-z]/.test(password),\n    hasNumber: /\\d/.test(password),\n    hasSpecialChar: /[!@#$%^&amp;*(),.?\":{}|&lt;&gt;]/.test(password)\n  };\n\n  return {\n    isValid: Object.values(requirements).every(req =&gt; req),\n    requirements\n  };\n};\n</code></pre>"},{"location":"LLM-DOCS/AUTHENTICATION/#5-https-only","title":"5. HTTPS Only","text":"<p>Always use HTTPS in production:</p> <pre><code>// Enforce HTTPS\nif (location.protocol !== 'https:' &amp;&amp; process.env.NODE_ENV === 'production') {\n  location.replace(`https:${location.href.substring(location.protocol.length)}`);\n}\n</code></pre>"},{"location":"LLM-DOCS/AUTHENTICATION/#6-csrf-protection","title":"6. CSRF Protection","text":"<p>For academy-scoped endpoints, include academy header:</p> <pre><code>const makeAcademyRequest = async (url, academyId, options = {}) =&gt; {\n  const token = localStorage.getItem('authToken');\n\n  return fetch(url, {\n    ...options,\n    headers: {\n      ...options.headers,\n      'Authorization': `Token ${token}`,\n      'Academy': academyId\n    }\n  });\n};\n</code></pre>"},{"location":"LLM-DOCS/AUTHENTICATION/#error-handling","title":"Error Handling","text":""},{"location":"LLM-DOCS/AUTHENTICATION/#common-error-codes","title":"Common Error Codes","text":"Status Code Error Description Action 400 Bad Request Invalid request format Check request payload 401 Unauthorized Missing or invalid token Redirect to login 403 Forbidden Valid token but no permission Show access denied message 404 Not Found Resource doesn't exist Check URL/endpoint 429 Too Many Requests Rate limit exceeded Implement backoff retry 500 Server Error Internal server error Show error message, retry"},{"location":"LLM-DOCS/AUTHENTICATION/#error-response-format","title":"Error Response Format","text":"<pre><code>{\n  \"detail\": \"Error message\",\n  \"slug\": \"error-identifier\",\n  \"status_code\": 403,\n  \"data\": {} // Optional additional data\n}\n</code></pre>"},{"location":"LLM-DOCS/AUTHENTICATION/#comprehensive-error-handler","title":"Comprehensive Error Handler","text":"<pre><code>class AuthError extends Error {\n  constructor(message, code, slug, data) {\n    super(message);\n    this.code = code;\n    this.slug = slug;\n    this.data = data;\n  }\n}\n\nconst handleAuthError = async (response) =&gt; {\n  const data = await response.json().catch(() =&gt; ({}));\n\n  switch (response.status) {\n    case 400:\n      throw new AuthError(\n        data.detail || 'Invalid request',\n        400,\n        data.slug\n      );\n\n    case 401:\n      // Unauthorized - token invalid or expired\n      localStorage.removeItem('authToken');\n      window.location.href = '/login?expired=true';\n      throw new AuthError('Session expired', 401, 'token-expired');\n\n    case 403:\n      if (data.slug === 'email-not-validated') {\n        // Special case: email not validated\n        return {\n          needsEmailValidation: true,\n          invites: data.data\n        };\n      }\n      throw new AuthError(\n        data.detail || 'Access forbidden',\n        403,\n        data.slug\n      );\n\n    case 429:\n      throw new AuthError(\n        'Too many requests. Please try again later.',\n        429,\n        'rate-limit'\n      );\n\n    case 500:\n      throw new AuthError(\n        'Server error. Please try again.',\n        500,\n        'server-error'\n      );\n\n    default:\n      throw new AuthError(\n        data.detail || 'Unknown error',\n        response.status,\n        data.slug\n      );\n  }\n};\n\n// Usage\ntry {\n  const response = await fetch('/v1/auth/login/', {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify({ email, password })\n  });\n\n  if (!response.ok) {\n    await handleAuthError(response);\n  }\n\n  const data = await response.json();\n  // Success handling\n} catch (error) {\n  if (error instanceof AuthError) {\n    // Handle specific auth errors\n    console.error(`Auth error [${error.slug}]:`, error.message);\n  }\n}\n</code></pre>"},{"location":"LLM-DOCS/AUTHENTICATION/#complete-frontend-implementation-examples","title":"Complete Frontend Implementation Examples","text":""},{"location":"LLM-DOCS/AUTHENTICATION/#react-authentication-context","title":"React Authentication Context","text":"<pre><code>import React, { createContext, useContext, useState, useEffect } from 'react';\n\nconst AuthContext = createContext(null);\n\nexport const AuthProvider = ({ children }) =&gt; {\n  const [user, setUser] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [token, setToken] = useState(localStorage.getItem('authToken'));\n\n  useEffect(() =&gt; {\n    if (token) {\n      validateAndLoadUser(token);\n    } else {\n      setLoading(false);\n    }\n  }, [token]);\n\n  const validateAndLoadUser = async (authToken) =&gt; {\n    try {\n      const response = await fetch(\n        'https://breathecode.herokuapp.com/v1/auth/user/me',\n        {\n          headers: {\n            'Authorization': `Token ${authToken}`\n          }\n        }\n      );\n\n      if (response.ok) {\n        const userData = await response.json();\n        setUser(userData);\n      } else {\n        // Invalid token\n        localStorage.removeItem('authToken');\n        setToken(null);\n      }\n    } catch (error) {\n      console.error('Error validating token:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const login = async (email, password) =&gt; {\n    const response = await fetch(\n      'https://breathecode.herokuapp.com/v1/auth/login/',\n      {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({ email, password })\n      }\n    );\n\n    if (!response.ok) {\n      const error = await response.json();\n      throw new Error(error.detail || 'Login failed');\n    }\n\n    const data = await response.json();\n    localStorage.setItem('authToken', data.token);\n    localStorage.setItem('tokenExpiry', data.expires_at);\n    setToken(data.token);\n\n    return data;\n  };\n\n  const logout = async () =&gt; {\n    if (token) {\n      await fetch('https://breathecode.herokuapp.com/v1/auth/logout/', {\n        method: 'POST',\n        headers: {\n          'Authorization': `Token ${token}`\n        }\n      });\n    }\n\n    localStorage.removeItem('authToken');\n    localStorage.removeItem('tokenExpiry');\n    setToken(null);\n    setUser(null);\n  };\n\n  const acceptInvite = async (inviteToken, formData) =&gt; {\n    const response = await fetch(\n      `https://breathecode.herokuapp.com/v1/auth/user/me/invite/accepted?token=${inviteToken}`,\n      {\n        method: 'PUT',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(formData)\n      }\n    );\n\n    if (!response.ok) {\n      const error = await response.json();\n      throw new Error(error.detail || 'Invite acceptance failed');\n    }\n\n    const data = await response.json();\n    localStorage.setItem('authToken', data.token);\n    setToken(data.token);\n\n    return data;\n  };\n\n  const requestPasswordReset = async (email) =&gt; {\n    const response = await fetch(\n      'https://breathecode.herokuapp.com/v1/auth/password/reset',\n      {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({ email })\n      }\n    );\n\n    return response.ok;\n  };\n\n  const resetPassword = async (token, password, repeatPassword) =&gt; {\n    const response = await fetch(\n      `https://breathecode.herokuapp.com/v1/auth/password/${token}`,\n      {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          password,\n          repeat_password: repeatPassword\n        })\n      }\n    );\n\n    if (!response.ok) {\n      const error = await response.json();\n      throw new Error(error.detail || 'Password reset failed');\n    }\n\n    return true;\n  };\n\n  const value = {\n    user,\n    token,\n    loading,\n    login,\n    logout,\n    acceptInvite,\n    requestPasswordReset,\n    resetPassword\n  };\n\n  return &lt;AuthContext.Provider value={value}&gt;{children}&lt;/AuthContext.Provider&gt;;\n};\n\nexport const useAuth = () =&gt; {\n  const context = useContext(AuthContext);\n  if (!context) {\n    throw new Error('useAuth must be used within AuthProvider');\n  }\n  return context;\n};\n</code></pre>"},{"location":"LLM-DOCS/AUTHENTICATION/#protected-route-component","title":"Protected Route Component","text":"<pre><code>import { Navigate, useLocation } from 'react-router-dom';\nimport { useAuth } from './AuthContext';\n\nexport const ProtectedRoute = ({ children }) =&gt; {\n  const { user, loading } = useAuth();\n  const location = useLocation();\n\n  if (loading) {\n    return &lt;div&gt;Loading...&lt;/div&gt;;\n  }\n\n  if (!user) {\n    // Redirect to login, but save the location they were trying to access\n    return &lt;Navigate to=\"/login\" state={{ from: location }} replace /&gt;;\n  }\n\n  return children;\n};\n</code></pre>"},{"location":"LLM-DOCS/AUTHENTICATION/#api-reference-summary","title":"API Reference Summary","text":""},{"location":"LLM-DOCS/AUTHENTICATION/#authentication-endpoints","title":"Authentication Endpoints","text":"Endpoint Method Purpose Auth Required <code>/v1/auth/login/</code> POST Login with email/password (API) No <code>/v1/auth/view/login</code> GET HTML login form with redirect No <code>/v1/auth/logout/</code> POST Logout and invalidate token Yes <code>/v1/auth/user/me</code> GET Get current user info Yes <code>/v1/auth/user/me</code> PUT Update user info Yes <code>/v1/auth/token/{token}</code> GET Get token information No <code>/v1/auth/token/me</code> POST Create temporal token Yes <code>/v1/auth/password/reset</code> POST Request password reset No <code>/v1/auth/password/{token}</code> POST Set new password No <code>/v1/auth/user/me/invite/accepted</code> PUT Accept invite &amp; register No <code>/v1/auth/github/</code> GET Initiate GitHub OAuth No <code>/v1/auth/github/callback</code> GET GitHub OAuth callback No <code>/v1/auth/google</code> GET Initiate Google OAuth No <code>/v1/auth/google/callback</code> GET Google OAuth callback No <code>/v1/auth/slack/</code> GET Initiate Slack OAuth No <code>/v1/auth/slack/callback</code> GET Slack OAuth callback No <code>/v1/auth/facebook/</code> GET Initiate Facebook OAuth No <code>/v1/auth/facebook/callback</code> GET Facebook OAuth callback No"},{"location":"LLM-DOCS/AUTHENTICATION/#testing-authentication-flows","title":"Testing Authentication Flows","text":""},{"location":"LLM-DOCS/AUTHENTICATION/#manual-testing-checklist","title":"Manual Testing Checklist","text":"<ul> <li>[ ] Login with valid credentials</li> <li>[ ] Login with invalid credentials</li> <li>[ ] Login with unvalidated email</li> <li>[ ] Logout</li> <li>[ ] Access protected endpoint with valid token</li> <li>[ ] Access protected endpoint with expired token</li> <li>[ ] Access protected endpoint with invalid token</li> <li>[ ] Request password reset</li> <li>[ ] Complete password reset flow</li> <li>[ ] Accept invite with valid token</li> <li>[ ] Accept invite with expired token</li> <li>[ ] GitHub OAuth flow</li> <li>[ ] Google OAuth flow</li> <li>[ ] Token expiration handling</li> <li>[ ] Multiple concurrent sessions</li> </ul>"},{"location":"LLM-DOCS/AUTHENTICATION/#related-documentation","title":"Related Documentation","text":"<ul> <li>BC_AUTH_FIRST_PARTY_APPS.md - First-party app authentication</li> <li>BC_STAFF_INVITES.md - Staff invitation system</li> <li>STUDENT_REPORT.md - Student data and permissions</li> </ul>"},{"location":"LLM-DOCS/AUTHENTICATION/#support","title":"Support","text":"<p>For questions or issues with authentication: - Check token expiration and format - Verify HTTPS is used in production - Review error messages and status codes - Contact development team for API issues</p> <p>Last Updated: October 2024</p>"},{"location":"LLM-DOCS/BC_AUTH_FIRST_PARTY_APPS/","title":"BreatheCode Authentication for First-Party 4Geeks Apps","text":""},{"location":"LLM-DOCS/BC_AUTH_FIRST_PARTY_APPS/#overview","title":"Overview","text":"<p>This guide explains authentication for applications owned and operated by 4Geeks. First-party apps have direct access to BreatheCode's authentication APIs without complex OAuth app registration.</p>"},{"location":"LLM-DOCS/BC_AUTH_FIRST_PARTY_APPS/#authentication-methods","title":"Authentication Methods","text":""},{"location":"LLM-DOCS/BC_AUTH_FIRST_PARTY_APPS/#1-email-password-login","title":"1. Email &amp; Password Login","text":"<p>Endpoint: <pre><code>POST /v1/auth/login/\n</code></pre></p> <p>Request: <pre><code>{\n  \"email\": \"user@example.com\",\n  \"password\": \"userpassword\"\n}\n</code></pre></p> <p>Response (200 OK): <pre><code>{\n  \"token\": \"9944b09199c62bcf9418ad846dd0e4bbdfc6ee4b\",\n  \"user_id\": 123,\n  \"email\": \"user@example.com\",\n  \"expires_at\": null\n}\n</code></pre></p> <p>Error (401 Unauthorized): <pre><code>{\n  \"detail\": \"Unable to log in with provided credentials.\",\n  \"status_code\": 401\n}\n</code></pre></p>"},{"location":"LLM-DOCS/BC_AUTH_FIRST_PARTY_APPS/#2-github-single-sign-on-sso","title":"2. GitHub Single Sign-On (SSO)","text":"<p>Endpoint: <pre><code>GET /v1/auth/github?url=&lt;base64-encoded-callback-url&gt;\n</code></pre></p> <p>Parameters: - <code>url</code> (required): Base64-encoded URL where user will be redirected after auth - <code>scope</code> (optional): GitHub scopes (default: <code>user:email</code>)</p> <p>Example: <pre><code># Your callback URL: https://your-app.com/auth/callback\n# Base64 encode it: aHR0cHM6Ly95b3VyLWFwcC5jb20vYXV0aC9jYWxsYmFjaw==\n\nGET /v1/auth/github?url=aHR0cHM6Ly95b3VyLWFwcC5jb20vYXV0aC9jYWxsYmFjaw==\n</code></pre></p> <p>After Authentication:</p> <p>User is redirected to your callback URL with the token: <pre><code>https://your-app.com/auth/callback?token=9944b09199c62bcf9418ad846dd0e4bbdfc6ee4b\n</code></pre></p>"},{"location":"LLM-DOCS/BC_AUTH_FIRST_PARTY_APPS/#3-google-single-sign-on-sso","title":"3. Google Single Sign-On (SSO)","text":"<p>Endpoint: <pre><code>GET /v1/auth/google?url=&lt;base64-encoded-callback-url&gt;\n</code></pre></p> <p>Parameters: - <code>url</code> (required): Base64-encoded callback URL</p> <p>After Authentication:</p> <p>User is redirected to your callback with token: <pre><code>https://your-app.com/auth/callback?token=9944b09199c62bcf9418ad846dd0e4bbdfc6ee4b\n</code></pre></p>"},{"location":"LLM-DOCS/BC_AUTH_FIRST_PARTY_APPS/#making-authenticated-api-requests","title":"Making Authenticated API Requests","text":""},{"location":"LLM-DOCS/BC_AUTH_FIRST_PARTY_APPS/#standard-authentication-header","title":"Standard Authentication Header","text":"<p>All authenticated API requests use the token in the <code>Authorization</code> header:</p> <pre><code>curl -H \"Authorization: Token 9944b09199c62bcf9418ad846dd0e4bbdfc6ee4b\" \\\n  https://api.breatheco.de/v1/auth/user/me\n</code></pre> <p>Header Format: <pre><code>Authorization: Token &lt;user-token&gt;\n</code></pre></p> <p>Note: Use <code>Token</code> (not <code>Bearer</code>)</p>"},{"location":"LLM-DOCS/BC_AUTH_FIRST_PARTY_APPS/#academy-header-required-for-academy-endpoints","title":"Academy Header (Required for Academy Endpoints)","text":"<p>Endpoints with <code>/academy/</code> in the path require an additional Academy header:</p> <pre><code>curl -H \"Authorization: Token &lt;token&gt;\" \\\n     -H \"Academy: &lt;academy-id-or-slug&gt;\" \\\n     https://api.breatheco.de/v1/auth/academy/settings\n</code></pre> <p>Examples of Academy-Scoped Endpoints: - <code>/v1/auth/academy/settings</code> - Requires <code>Academy</code> header - <code>/v1/auth/academy/member</code> - Requires <code>Academy</code> header - <code>/v1/auth/academy/token/</code> - Requires <code>Academy</code> header - <code>/v1/admissions/academy/cohort</code> - Requires <code>Academy</code> header - <code>/v1/admissions/academy/student</code> - Requires <code>Academy</code> header</p> <p>Academy Header Format: <pre><code>Academy: 1\n</code></pre> or <pre><code>Academy: downtown-miami\n</code></pre></p> <p>Complete Request Example: <pre><code>curl -X GET https://api.breatheco.de/v1/auth/academy/member \\\n  -H \"Authorization: Token 9944b09199c62bcf9418ad846dd0e4bbdfc6ee4b\" \\\n  -H \"Academy: downtown-miami\"\n</code></pre></p> <p>Error Without Academy Header (400 Bad Request): <pre><code>{\n  \"detail\": \"Missing academy_id parameter expected for the endpoint url or 'Academy' property expected in the request header\",\n  \"status_code\": 400\n}\n</code></pre></p>"},{"location":"LLM-DOCS/BC_AUTH_FIRST_PARTY_APPS/#key-endpoints","title":"Key Endpoints","text":""},{"location":"LLM-DOCS/BC_AUTH_FIRST_PARTY_APPS/#authentication","title":"Authentication","text":"Endpoint Method Headers Required Description <code>/v1/auth/login/</code> POST None Email/password login <code>/v1/auth/github</code> GET None GitHub SSO redirect <code>/v1/auth/google</code> GET None Google SSO redirect <code>/v1/auth/logout/</code> POST Token Logout and invalidate token <code>/v1/auth/token/&lt;token&gt;</code> GET None Verify token validity"},{"location":"LLM-DOCS/BC_AUTH_FIRST_PARTY_APPS/#user-data","title":"User Data","text":"Endpoint Method Headers Required Description <code>/v1/auth/user/me</code> GET Token Get current user with roles &amp; permissions <code>/v1/auth/profile/me</code> GET Token Get user profile <code>/v1/auth/profile/me</code> PUT Token Update user profile"},{"location":"LLM-DOCS/BC_AUTH_FIRST_PARTY_APPS/#academy-scoped-require-academy-header","title":"Academy-Scoped (Require Academy Header)","text":"Endpoint Method Headers Required Description <code>/v1/auth/academy/settings</code> GET Token + Academy Get academy auth settings <code>/v1/auth/academy/member</code> GET Token + Academy List academy members <code>/v1/auth/academy/member/&lt;id&gt;</code> GET Token + Academy Get specific member <code>/v1/admissions/academy/cohort</code> GET Token + Academy Get academy cohorts <code>/v1/admissions/academy/student</code> GET Token + Academy Get academy students"},{"location":"LLM-DOCS/BC_AUTH_FIRST_PARTY_APPS/#public-endpoints-no-auth","title":"Public Endpoints (No Auth)","text":"Endpoint Method Auth Required Description <code>/v1/admissions/catalog/countries</code> GET \u274c List countries <code>/v1/admissions/catalog/cities</code> GET \u274c List cities (filter: <code>?country=us</code>) <code>/v1/admissions/catalog/timezones</code> GET \u274c List timezones <code>/v1/admissions/academy</code> GET \u274c List all academies"},{"location":"LLM-DOCS/BC_AUTH_FIRST_PARTY_APPS/#response-structures","title":"Response Structures","text":""},{"location":"LLM-DOCS/BC_AUTH_FIRST_PARTY_APPS/#user-object-from-v1authuserme","title":"User Object (from <code>/v1/auth/user/me</code>)","text":"<p>Request: <pre><code>GET /v1/auth/user/me\nAuthorization: Token 9944b09199c62bcf9418ad846dd0e4bbdfc6ee4b\n</code></pre></p> <p>Response (200 OK): <pre><code>{\n  \"id\": 123,\n  \"email\": \"aalejo@gmail.com\",\n  \"username\": \"aalejo@gmail.com\",\n  \"first_name\": \"Alejandro\",\n  \"last_name\": \"Sanchez\",\n  \"date_joined\": \"2022-10-12T20:42:55.827Z\",\n\n  \"github\": {\n    \"avatar_url\": \"https://avatars.githubusercontent.com/u/123456\",\n    \"name\": \"Alejandro Sanchez\",\n    \"username\": \"aalejosan\"\n  },\n\n  \"profile\": {\n    \"avatar_url\": \"https://avatars.githubusercontent.com/u/123456\"\n  },\n\n  \"roles\": [\n    {\n      \"id\": 1,\n      \"academy\": {\n        \"id\": 1,\n        \"slug\": \"downtown-miami\",\n        \"name\": \"4Geeks Academy Miami\"\n      },\n      \"cohort\": {\n        \"id\": 5,\n        \"slug\": \"web-dev-2024\",\n        \"name\": \"Web Development 2024\"\n      },\n      \"role\": {\n        \"slug\": \"student\",\n        \"name\": \"Student\"\n      },\n      \"created_at\": \"2022-10-12T21:59:33.999Z\"\n    }\n  ],\n\n  \"permissions\": [\n    {\n      \"codename\": \"get_my_profile\",\n      \"name\": \"Get my profile\"\n    },\n    {\n      \"codename\": \"get_my_certificate\",\n      \"name\": \"Get my certificate\"\n    }\n  ],\n\n  \"settings\": {\n    \"lang\": \"en\",\n    \"main_currency\": \"usd\"\n  }\n}\n</code></pre></p> <p>Field Notes: - <code>github</code>: GitHub account info (null if not connected) - <code>profile</code>: User profile (null if not created) - <code>roles</code>: ProfileAcademy relationships (academies user belongs to) - <code>permissions</code>: Permissions from Django groups - <code>settings</code>: User preferences</p>"},{"location":"LLM-DOCS/BC_AUTH_FIRST_PARTY_APPS/#profile-object-from-v1authprofileme","title":"Profile Object (from <code>/v1/auth/profile/me</code>)","text":"<p>Request: <pre><code>GET /v1/auth/profile/me\nAuthorization: Token &lt;token&gt;\n</code></pre></p> <p>Response (200 OK): <pre><code>{\n  \"user\": {\n    \"id\": 123,\n    \"email\": \"user@example.com\",\n    \"first_name\": \"John\",\n    \"last_name\": \"Doe\"\n  },\n  \"avatar_url\": \"https://avatars.githubusercontent.com/u/123456\",\n  \"bio\": \"Full-stack developer passionate about education\",\n  \"phone\": \"+1234567890\",\n  \"show_tutorial\": false,\n  \"twitter_username\": \"johndoe\",\n  \"github_username\": \"johndoe\",\n  \"portfolio_url\": \"https://johndoe.dev\",\n  \"linkedin_url\": \"https://linkedin.com/in/johndoe\",\n  \"blog\": \"https://blog.johndoe.com\"\n}\n</code></pre></p>"},{"location":"LLM-DOCS/BC_AUTH_FIRST_PARTY_APPS/#token-verification-from-v1authtokentoken","title":"Token Verification (from <code>/v1/auth/token/&lt;token&gt;</code>)","text":"<p>Request: <pre><code>GET /v1/auth/token/9944b09199c62bcf9418ad846dd0e4bbdfc6ee4b\n</code></pre></p> <p>Response (200 OK): <pre><code>{\n  \"token\": \"9944b09199c62bcf9418ad846dd0e4bbdfc6ee4b\",\n  \"token_type\": \"login\",\n  \"expires_at\": null,\n  \"user\": {\n    \"id\": 123,\n    \"email\": \"user@example.com\",\n    \"first_name\": \"John\",\n    \"last_name\": \"Doe\"\n  }\n}\n</code></pre></p>"},{"location":"LLM-DOCS/BC_AUTH_FIRST_PARTY_APPS/#request-examples","title":"Request Examples","text":""},{"location":"LLM-DOCS/BC_AUTH_FIRST_PARTY_APPS/#basic-authentication-request","title":"Basic Authentication Request","text":"<pre><code>curl -X GET https://api.breatheco.de/v1/auth/user/me \\\n  -H \"Authorization: Token 9944b09199c62bcf9418ad846dd0e4bbdfc6ee4b\"\n</code></pre>"},{"location":"LLM-DOCS/BC_AUTH_FIRST_PARTY_APPS/#academy-scoped-request","title":"Academy-Scoped Request","text":"<pre><code>curl -X GET https://api.breatheco.de/v1/auth/academy/member \\\n  -H \"Authorization: Token 9944b09199c62bcf9418ad846dd0e4bbdfc6ee4b\" \\\n  -H \"Academy: downtown-miami\"\n</code></pre>"},{"location":"LLM-DOCS/BC_AUTH_FIRST_PARTY_APPS/#creating-a-resource","title":"Creating a Resource","text":"<pre><code>curl -X POST https://api.breatheco.de/v1/admissions/academy/cohort \\\n  -H \"Authorization: Token 9944b09199c62bcf9418ad846dd0e4bbdfc6ee4b\" \\\n  -H \"Academy: 1\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"name\": \"New Cohort\",\n    \"slug\": \"new-cohort-2024\",\n    \"kickoff_date\": \"2024-01-15T09:00:00Z\"\n  }'\n</code></pre>"},{"location":"LLM-DOCS/BC_AUTH_FIRST_PARTY_APPS/#public-request-no-auth","title":"Public Request (No Auth)","text":"<pre><code>curl -X GET https://api.breatheco.de/v1/admissions/catalog/countries\n</code></pre>"},{"location":"LLM-DOCS/BC_AUTH_FIRST_PARTY_APPS/#token-types","title":"Token Types","text":"Type Lifetime Use Case <code>login</code> Permanent Standard user login <code>temporal</code> 1 hour Password reset, temporary access <code>one_time</code> Single use Email verification, one-time operations <code>permanent</code> Never expires Service accounts, integrations"},{"location":"LLM-DOCS/BC_AUTH_FIRST_PARTY_APPS/#error-handling","title":"Error Handling","text":""},{"location":"LLM-DOCS/BC_AUTH_FIRST_PARTY_APPS/#common-http-status-codes","title":"Common HTTP Status Codes","text":"Code Meaning Action 200 OK Request successful 201 Created Resource created 400 Bad Request Check request data or missing Academy header 401 Unauthorized Token missing or invalid - user needs to login 403 Forbidden User lacks permission for this operation 404 Not Found Resource doesn't exist 500 Server Error Try again later or contact support"},{"location":"LLM-DOCS/BC_AUTH_FIRST_PARTY_APPS/#error-response-formats","title":"Error Response Formats","text":"<p>Simple Error: <pre><code>{\n  \"detail\": \"Error message\",\n  \"status_code\": 401\n}\n</code></pre></p> <p>Validation Error: <pre><code>{\n  \"detail\": \"Cannot remove user because they are whitelisted\",\n  \"status_code\": 400,\n  \"slug\": \"user-whitelisted\"\n}\n</code></pre></p> <p>With Translation Support: <pre><code>{\n  \"detail\": \"Missing academy_id parameter expected for the endpoint url or 'Academy' property expected in the request header\",\n  \"status_code\": 400,\n  \"slug\": \"missing-academy-header\"\n}\n</code></pre></p>"},{"location":"LLM-DOCS/BC_AUTH_FIRST_PARTY_APPS/#security-best-practices","title":"Security Best Practices","text":""},{"location":"LLM-DOCS/BC_AUTH_FIRST_PARTY_APPS/#1-always-use-https","title":"1. Always Use HTTPS","text":"<pre><code># \u2705 Correct\nhttps://api.breatheco.de\n\n# \u274c Never in production\nhttp://api.breatheco.de\n</code></pre>"},{"location":"LLM-DOCS/BC_AUTH_FIRST_PARTY_APPS/#2-secure-token-storage","title":"2. Secure Token Storage","text":"<ul> <li>Use HttpOnly cookies for web apps (prevents XSS)</li> <li>Encrypt tokens in mobile app storage</li> <li>Never log tokens in console/files</li> <li>Never commit tokens to version control</li> </ul>"},{"location":"LLM-DOCS/BC_AUTH_FIRST_PARTY_APPS/#3-token-transmission","title":"3. Token Transmission","text":"<pre><code># \u2705 Correct - In header\nAuthorization: Token abc123...\n\n# \u274c Never in URL\nhttps://api.breatheco.de/endpoint?token=abc123\n</code></pre>"},{"location":"LLM-DOCS/BC_AUTH_FIRST_PARTY_APPS/#4-handle-expiration","title":"4. Handle Expiration","text":"<p>When you receive a 401 response: 1. Clear stored token 2. Redirect user to login 3. Don't retry with same token</p>"},{"location":"LLM-DOCS/BC_AUTH_FIRST_PARTY_APPS/#5-validate-on-every-request","title":"5. Validate on Every Request","text":"<p>Don't assume a token is valid - handle 401 responses gracefully.</p>"},{"location":"LLM-DOCS/BC_AUTH_FIRST_PARTY_APPS/#complete-authentication-flow","title":"Complete Authentication Flow","text":""},{"location":"LLM-DOCS/BC_AUTH_FIRST_PARTY_APPS/#step-1-user-initiates-login","title":"Step 1: User Initiates Login","text":"<p>Redirect to authentication endpoint: - GitHub: <code>/v1/auth/github?url=&lt;callback&gt;</code> - Google: <code>/v1/auth/google?url=&lt;callback&gt;</code> - Email/Password: <code>POST /v1/auth/login/</code></p>"},{"location":"LLM-DOCS/BC_AUTH_FIRST_PARTY_APPS/#step-2-receive-token","title":"Step 2: Receive Token","text":"<ul> <li>OAuth (GitHub/Google): Extract from callback URL query parameter</li> <li>Email/Password: Extract from response JSON</li> </ul>"},{"location":"LLM-DOCS/BC_AUTH_FIRST_PARTY_APPS/#step-3-store-token-securely","title":"Step 3: Store Token Securely","text":"<p>Store in your application's secure storage.</p>"},{"location":"LLM-DOCS/BC_AUTH_FIRST_PARTY_APPS/#step-4-make-api-requests","title":"Step 4: Make API Requests","text":"<p>Include token in Authorization header: <pre><code>Authorization: Token &lt;token&gt;\n</code></pre></p> <p>For academy-scoped endpoints, also include: <pre><code>Academy: &lt;academy-id-or-slug&gt;\n</code></pre></p>"},{"location":"LLM-DOCS/BC_AUTH_FIRST_PARTY_APPS/#step-5-fetch-user-data","title":"Step 5: Fetch User Data","text":"<pre><code>GET /v1/auth/user/me\nAuthorization: Token &lt;token&gt;\n</code></pre> <p>Use the response to: - Display user information - Check user roles and permissions - Determine which academies they belong to</p>"},{"location":"LLM-DOCS/BC_AUTH_FIRST_PARTY_APPS/#step-6-handle-logout","title":"Step 6: Handle Logout","text":"<pre><code>POST /v1/auth/logout/\nAuthorization: Token &lt;token&gt;\n</code></pre> <p>Clear stored token from your application.</p>"},{"location":"LLM-DOCS/BC_AUTH_FIRST_PARTY_APPS/#common-integration-patterns","title":"Common Integration Patterns","text":""},{"location":"LLM-DOCS/BC_AUTH_FIRST_PARTY_APPS/#pattern-1-check-user-permissions","title":"Pattern 1: Check User Permissions","text":"<pre><code># Get user with permissions\nGET /v1/auth/user/me\nAuthorization: Token &lt;token&gt;\n\n# Check if user has specific permission\n# In response, look for permission in permissions array:\n{\n  \"permissions\": [\n    {\"codename\": \"crud_cohort\", \"name\": \"Create, update or delete cohort info\"}\n  ]\n}\n</code></pre>"},{"location":"LLM-DOCS/BC_AUTH_FIRST_PARTY_APPS/#pattern-2-find-users-academies","title":"Pattern 2: Find User's Academies","text":"<pre><code># Get user data\nGET /v1/auth/user/me\nAuthorization: Token &lt;token&gt;\n\n# User's academies are in the roles array:\n{\n  \"roles\": [\n    {\n      \"academy\": {\n        \"id\": 1,\n        \"slug\": \"downtown-miami\",\n        \"name\": \"4Geeks Academy Miami\"\n      },\n      \"role\": {\"slug\": \"admin\"}\n    }\n  ]\n}\n</code></pre>"},{"location":"LLM-DOCS/BC_AUTH_FIRST_PARTY_APPS/#pattern-3-academy-scoped-operations","title":"Pattern 3: Academy-Scoped Operations","text":"<pre><code># Step 1: Get user's academies from /v1/auth/user/me\n# Step 2: Choose an academy\n# Step 3: Make academy-scoped request\n\nGET /v1/admissions/academy/cohort\nAuthorization: Token &lt;token&gt;\nAcademy: downtown-miami\n</code></pre>"},{"location":"LLM-DOCS/BC_AUTH_FIRST_PARTY_APPS/#token-types-explained","title":"Token Types Explained","text":""},{"location":"LLM-DOCS/BC_AUTH_FIRST_PARTY_APPS/#login-token-default","title":"<code>login</code> Token (Default)","text":"<ul> <li>Created during email/password or OAuth login</li> <li>Permanent (doesn't expire)</li> <li>Used for normal user sessions</li> <li>Can be invalidated via logout</li> </ul>"},{"location":"LLM-DOCS/BC_AUTH_FIRST_PARTY_APPS/#temporal-token","title":"<code>temporal</code> Token","text":"<ul> <li>Short-lived (1 hour)</li> <li>Used for password reset links</li> <li>Automatically expires</li> <li>Can't be used for general API access</li> </ul>"},{"location":"LLM-DOCS/BC_AUTH_FIRST_PARTY_APPS/#one_time-token","title":"<code>one_time</code> Token","text":"<ul> <li>Single use only</li> <li>Deleted after first use</li> <li>Used for email verification, secure operations</li> <li>Can't be reused</li> </ul>"},{"location":"LLM-DOCS/BC_AUTH_FIRST_PARTY_APPS/#permanent-token","title":"<code>permanent</code> Token","text":"<ul> <li>Never expires</li> <li>Used for service accounts, academy tokens</li> <li>Requires special permission to create</li> <li>Should be carefully managed</li> </ul>"},{"location":"LLM-DOCS/BC_AUTH_FIRST_PARTY_APPS/#troubleshooting","title":"Troubleshooting","text":""},{"location":"LLM-DOCS/BC_AUTH_FIRST_PARTY_APPS/#issue-401-unauthorized","title":"Issue: 401 Unauthorized","text":"<p>Possible Causes: - Token not provided in header - Token expired or invalid - Token format incorrect (should be <code>Token abc...</code> not <code>Bearer abc...</code>)</p> <p>Solution: <pre><code># Check token format\nAuthorization: Token 9944b09199c62bcf9418ad846dd0e4bbdfc6ee4b\n\n# Verify token is valid\nGET /v1/auth/token/&lt;your-token&gt;\n</code></pre></p>"},{"location":"LLM-DOCS/BC_AUTH_FIRST_PARTY_APPS/#issue-400-bad-request-on-academy-endpoints","title":"Issue: 400 Bad Request on Academy Endpoints","text":"<p>Cause: Missing Academy header on endpoint that requires it.</p> <p>Solution: <pre><code># Add Academy header\n-H \"Academy: &lt;academy-id-or-slug&gt;\"\n</code></pre></p> <p>How to know if endpoint needs Academy header: - URL contains <code>/academy/</code> \u2192 Requires Academy header - Error message mentions \"Missing academy_id\" \u2192 Requires Academy header</p>"},{"location":"LLM-DOCS/BC_AUTH_FIRST_PARTY_APPS/#issue-403-forbidden","title":"Issue: 403 Forbidden","text":"<p>Cause: User lacks the required permission for this operation.</p> <p>Solution: 1. Check user's permissions: <code>GET /v1/auth/user/me</code> 2. Verify user has correct role in the academy 3. Contact academy admin to grant permission</p>"},{"location":"LLM-DOCS/BC_AUTH_FIRST_PARTY_APPS/#issue-cors-errors","title":"Issue: CORS Errors","text":"<p>Cause: Your domain not whitelisted in BreatheCode CORS settings.</p> <p>Solution: Contact platform team to add your domain to CORS whitelist.</p>"},{"location":"LLM-DOCS/BC_AUTH_FIRST_PARTY_APPS/#testing","title":"Testing","text":""},{"location":"LLM-DOCS/BC_AUTH_FIRST_PARTY_APPS/#manual-api-testing","title":"Manual API Testing","text":"<pre><code># 1. Login\ncurl -X POST https://api.breatheco.de/v1/auth/login/ \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"email\":\"test@example.com\",\"password\":\"test123\"}'\n\n# Response: {\"token\":\"abc123...\",\"user_id\":1,\"email\":\"test@example.com\"}\n\n# 2. Get user info\ncurl https://api.breatheco.de/v1/auth/user/me \\\n  -H \"Authorization: Token abc123...\"\n\n# 3. Academy-scoped request\ncurl https://api.breatheco.de/v1/auth/academy/member \\\n  -H \"Authorization: Token abc123...\" \\\n  -H \"Academy: 1\"\n\n# 4. Logout\ncurl -X POST https://api.breatheco.de/v1/auth/logout/ \\\n  -H \"Authorization: Token abc123...\"\n</code></pre>"},{"location":"LLM-DOCS/BC_AUTH_FIRST_PARTY_APPS/#verify-token-is-working","title":"Verify Token is Working","text":"<pre><code># Method 1: Get user info\ncurl https://api.breatheco.de/v1/auth/user/me \\\n  -H \"Authorization: Token &lt;your-token&gt;\"\n# Should return user object\n\n# Method 2: Verify token directly\ncurl https://api.breatheco.de/v1/auth/token/&lt;your-token&gt;\n# Should return token info\n</code></pre>"},{"location":"LLM-DOCS/BC_AUTH_FIRST_PARTY_APPS/#quick-start-checklist","title":"Quick Start Checklist","text":"<p>For a new first-party 4Geeks app:</p> <ul> <li>[ ] Choose authentication method (GitHub/Google SSO recommended)</li> <li>[ ] Implement login redirect with base64-encoded callback</li> <li>[ ] Handle OAuth callback to extract token</li> <li>[ ] Store token securely</li> <li>[ ] Add <code>Authorization: Token &lt;token&gt;</code> header to all API requests</li> <li>[ ] Add <code>Academy: &lt;id-or-slug&gt;</code> header for academy-scoped endpoints</li> <li>[ ] Fetch user data from <code>/v1/auth/user/me</code></li> <li>[ ] Handle 401 errors (redirect to login)</li> <li>[ ] Handle 400 errors on academy endpoints (add Academy header)</li> <li>[ ] Implement logout</li> <li>[ ] Test with real user accounts</li> </ul>"},{"location":"LLM-DOCS/BC_AUTH_FIRST_PARTY_APPS/#environment-configuration","title":"Environment Configuration","text":"<pre><code># Production\nBREATHECODE_API_URL=https://api.breatheco.de\n\n# Staging\nBREATHECODE_API_URL=https://api-staging.breatheco.de\n\n# Local Development\nBREATHECODE_API_URL=http://localhost:8000\n</code></pre>"},{"location":"LLM-DOCS/BC_AUTH_FIRST_PARTY_APPS/#additional-resources","title":"Additional Resources","text":"<ul> <li>API Documentation: https://api.breatheco.de/swagger/</li> <li>GraphQL Playground: https://api.breatheco.de/graphql</li> <li>OpenAPI Spec: https://api.breatheco.de/openapi.json</li> <li>Linked Services (for third-party apps): https://breatheco-de.github.io/linked-services-django-plugin/</li> </ul> <p>Summary: First-party 4Geeks apps use simple token-based authentication. Get a token via email/password or OAuth (GitHub/Google), include it in the <code>Authorization</code> header, and add the <code>Academy</code> header for academy-scoped endpoints. No app registration needed!</p>"},{"location":"LLM-DOCS/BC_CHECKOUT/","title":"BC CHECKOUT","text":"<p>This si how the payment goes</p>"},{"location":"LLM-DOCS/BC_CHECKOUT/#1-first-we-create-a-bag-by-calling-checking","title":"1) First we create a bag by calling checking:","text":"<p>PUT /v2/payments/checking</p> <p><pre><code>{\"type\":\"PREVIEW\",\"plans\":[\"4geeks-plus-subscription\"],\"country_code\":\"US\",\"service_items\":[]}\n</code></pre> Successfull response payload:</p> <pre><code>{\n    \"id\": 2414288,\n    \"service_items\": [],\n    \"plans\": [\n        {\n            \"title\": null,\n            \"slug\": \"4geeks-plus-subscription\",\n            \"status\": \"ACTIVE\",\n            \"time_of_life\": 0,\n            \"time_of_life_unit\": null,\n            \"trial_duration\": 0,\n            \"trial_duration_unit\": \"MONTH\",\n            \"service_items\": [\n                {\n                    \"unit_type\": \"UNIT\",\n                    \"how_many\": -1,\n                    \"sort_priority\": 6,\n                    \"service\": {\n                        \"id\": 45,\n                        \"title\": \"Earn course certificates\",\n                        \"slug\": \"course-certificates\",\n                        \"icon_url\": null,\n                        \"private\": true,\n                        \"groups\": [],\n                        \"type\": \"COHORT_SET\",\n                        \"consumer\": \"NO_SET\",\n                        \"session_duration\": null\n                    },\n                    \"is_team_allowed\": false\n                },\n                {\n                    \"unit_type\": \"UNIT\",\n                    \"how_many\": -1,\n                    \"sort_priority\": 1,\n                    \"service\": {\n                        \"id\": 106,\n                        \"title\": \"Generate Content with AI\",\n                        \"slug\": \"ai-generation\",\n                        \"icon_url\": null,\n                        \"private\": true,\n                        \"groups\": [\n                            {\n                                \"name\": \"Creator\",\n                                \"permissions\": [\n                                    {\n                                        \"name\": \"Create packages in learnpack\",\n                                        \"codename\": \"learnpack_create_package\"\n                                    }\n                                ]\n                            }\n                        ],\n                        \"type\": \"VOID\",\n                        \"consumer\": \"AI_INTERACTION\",\n                        \"session_duration\": null\n                    },\n                    \"is_team_allowed\": false\n                },\n                {\n                    \"unit_type\": \"UNIT\",\n                    \"how_many\": 5000,\n                    \"sort_priority\": 2,\n                    \"service\": {\n                        \"id\": 93,\n                        \"title\": \"AI Chat\",\n                        \"slug\": \"ai-conversation-message\",\n                        \"icon_url\": null,\n                        \"private\": true,\n                        \"groups\": [],\n                        \"type\": \"VOID\",\n                        \"consumer\": \"AI_INTERACTION\",\n                        \"session_duration\": null\n                    },\n                    \"is_team_allowed\": false\n                },\n                {\n                    \"unit_type\": \"UNIT\",\n                    \"how_many\": 2,\n                    \"sort_priority\": 3,\n                    \"service\": {\n                        \"id\": 52,\n                        \"title\": \"Mentorships from experts\",\n                        \"slug\": \"mentorships-from-experts\",\n                        \"icon_url\": null,\n                        \"private\": true,\n                        \"groups\": [\n                            {\n                                \"name\": \"Mentorships\",\n                                \"permissions\": [\n                                    {\n                                        \"name\": \"Get my mentoring sessions\",\n                                        \"codename\": \"get_my_mentoring_sessions\"\n                                    },\n                                    {\n                                        \"name\": \"Join mentorship\",\n                                        \"codename\": \"join_mentorship\"\n                                    }\n                                ]\n                            }\n                        ],\n                        \"type\": \"MENTORSHIP_SERVICE_SET\",\n                        \"consumer\": \"JOIN_MENTORSHIP\",\n                        \"session_duration\": null\n                    },\n                    \"is_team_allowed\": true\n                },\n                {\n                    \"unit_type\": \"UNIT\",\n                    \"how_many\": 3,\n                    \"sort_priority\": 1,\n                    \"service\": {\n                        \"id\": 109,\n                        \"title\": \"Publish a LearnPack tutorial\",\n                        \"slug\": \"learnpack-publish\",\n                        \"icon_url\": null,\n                        \"private\": false,\n                        \"groups\": [\n                            {\n                                \"name\": \"Creator\",\n                                \"permissions\": [\n                                    {\n                                        \"name\": \"Create packages in learnpack\",\n                                        \"codename\": \"learnpack_create_package\"\n                                    }\n                                ]\n                            }\n                        ],\n                        \"type\": \"VOID\",\n                        \"consumer\": \"NO_SET\",\n                        \"session_duration\": null\n                    },\n                    \"is_team_allowed\": true\n                },\n                {\n                    \"unit_type\": \"UNIT\",\n                    \"how_many\": 5000,\n                    \"sort_priority\": 1,\n                    \"service\": {\n                        \"id\": 48,\n                        \"title\": \"AI compilation\",\n                        \"slug\": \"ai-compilation\",\n                        \"icon_url\": null,\n                        \"private\": true,\n                        \"groups\": [],\n                        \"type\": \"VOID\",\n                        \"consumer\": \"AI_INTERACTION\",\n                        \"session_duration\": null\n                    },\n                    \"is_team_allowed\": true\n                },\n                {\n                    \"unit_type\": \"UNIT\",\n                    \"how_many\": -1,\n                    \"sort_priority\": 1,\n                    \"service\": {\n                        \"id\": 111,\n                        \"title\": \"Access to all of our Courses\",\n                        \"slug\": \"access-to-all-courses\",\n                        \"icon_url\": null,\n                        \"private\": true,\n                        \"groups\": [\n                            {\n                                \"name\": \"Student\",\n                                \"permissions\": [\n                                    {\n                                        \"name\": \"Get my containers\",\n                                        \"codename\": \"get_containers\"\n                                    },\n                                    {\n                                        \"name\": \"Get my certificate\",\n                                        \"codename\": \"get_my_certificate\"\n                                    },\n                                    {\n                                        \"name\": \"Get my mentoring sessions\",\n                                        \"codename\": \"get_my_mentoring_sessions\"\n                                    },\n                                    {\n                                        \"name\": \"Upload assignment telemetry\",\n                                        \"codename\": \"upload_assignment_telemetry\"\n                                    }\n                                ]\n                            }\n                        ],\n                        \"type\": \"COHORT_SET\",\n                        \"consumer\": \"READ_LESSON\",\n                        \"session_duration\": null\n                    },\n                    \"is_team_allowed\": true\n                }\n            ],\n            \"financing_options\": [],\n            \"has_available_cohorts\": true\n        }\n    ],\n    \"coupons\": [\n        {\n            \"slug\": \"new-year-50\",\n            \"discount_type\": \"PERCENT_OFF\",\n            \"discount_value\": 0.5,\n            \"referral_type\": \"NO_REFERRAL\",\n            \"referral_value\": 0.0,\n            \"auto\": true,\n            \"offered_at\": \"2025-02-04T22:04:29Z\",\n            \"expires_at\": \"2026-10-06T17:52:36Z\"\n        }\n    ],\n    \"status\": \"CHECKING\",\n    \"type\": \"PREVIEW\",\n    \"is_recurrent\": true,\n    \"was_delivered\": false,\n    \"amount_per_month\": 59.99,\n    \"amount_per_quarter\": 0.0,\n    \"amount_per_half\": 0.0,\n    \"amount_per_year\": 479.99,\n    \"token\": \"409a031c3ff6e2f55394722d4c05db63bd336df4\",\n    \"seat_service_item\": null,\n    \"expires_at\": \"2025-10-11T17:42:38.186215Z\"\n}\n</code></pre> <p>You will get all the service items that are included in the plan, this services are ideal to explain to the user which features are included in he plan. If the \"coupons\" key on the response payload has a none-empty array, it meanse this plan has coupons that need to be \"auto aplied\" If the coupon is applied, we need to show the real price crossed over and the new price with the discount applied.</p>"},{"location":"LLM-DOCS/BC_CHECKOUT/#2-then-the-user-needs-to-fill-the-card-and-press-the-button-to-pay","title":"2) Then the user needs to fill the card and press the button to pay:","text":"<p>We call the first endpoint first to save the card on the payment platform (stripe)</p> <p>POST /v2/payments/card Request Payload:  <pre><code>{\"card_number\":\"4242424242424242\",\"exp_month\":\"10\",\"exp_year\":\"26\",\"cvc\":\"435\",\"academy\":47}\n</code></pre></p> <p>Response payload like this: Status: 200 <pre><code>{\n    \"status\": \"ok\",\n    \"details\": {\n        \"4Geeks.com\": {\n            \"card_last4\": \"4242\",\n            \"card_brand\": \"Visa\",\n            \"card_exp_month\": 10,\n            \"card_exp_year\": 2026\n        }\n    }\n}\n</code></pre></p>"},{"location":"LLM-DOCS/BC_CHECKOUT/#3-after-the-card-was-saved-we-call-the-pay-endpoint-to-charge-the-user","title":"3) After the card was saved, we call the \"pay\" endpoint to charge the user:","text":"<p>Then you call the pay method like this:  POST /v2/payments/pay <pre><code>{\"country_code\":\"US\",\"type\":\"PREVIEW\",\"token\":\"cc70fb0c3bff8f0967205b0b46acc8610a74a3c7\",\"chosen_period\":\"YEAR\",\"coupons\":[{\"slug\":\"new-year-50\",\"discount_type\":\"PERCENT_OFF\",\"discount_value\":0.5,\"referral_type\":\"NO_REFERRAL\",\"referral_value\":0,\"auto\":true,\"offered_at\":\"2025-02-04T22:04:29Z\",\"expires_at\":\"2026-10-06T17:52:36Z\"}],\"add_ons\":[],\"conversion_info\":{\"user_agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36\",\"landing_url\":\"/\",\"conversion_url\":\"/\",\"internal_cta_placement\":\"navbar-get-started\"}}\n</code></pre></p> <p>Successfull Response payload: Status: 200 <pre><code>{\n    \"amount\": 239.995,\n    \"currency\": {\n        \"code\": \"USD\",\n        \"name\": \"US Dollar\"\n    },\n    \"paid_at\": \"2025-10-11T16:35:12.904426Z\",\n    \"status\": \"FULFILLED\",\n    \"user\": {\n        \"first_name\": \"Ramon\",\n        \"last_name\": \"Peralta\",\n        \"email\": \"aalejo+ramon@gmail.com\"\n    },\n    \"id\": 7018,\n    \"coupons\": [\n        {\n            \"slug\": \"new-year-50\",\n            \"discount_type\": \"PERCENT_OFF\",\n            \"discount_value\": 0.5,\n            \"referral_type\": \"NO_REFERRAL\",\n            \"referral_value\": 0.0,\n            \"auto\": true,\n            \"offered_at\": \"2025-02-04T22:04:29Z\",\n            \"expires_at\": \"2026-10-06T17:52:36Z\"\n        }\n    ]\n}\n</code></pre></p> <p>If the payment failed we get the following payload: status: 4xx Failed Response payload: <pre><code>{\n    \"detail\": \"Card declined\",\n    \"status_code\": 402,\n    \"silent\": true,\n    \"silent_code\": \"card-error\"\n}\n</code></pre></p>"},{"location":"LLM-DOCS/BC_CHECKOUT_CONSUMABLE/","title":"BC CHECKOUT CONSUMABLE","text":""},{"location":"LLM-DOCS/BC_CHECKOUT_CONSUMABLE/#complete-flow-to-buy-more-consumables","title":"Complete Flow to Buy More Consumables","text":""},{"location":"LLM-DOCS/BC_CHECKOUT_CONSUMABLE/#1-check-available-services-optional-but-recommended","title":"1\ufe0f\u20e3 Check Available Services (Optional but recommended)","text":"<p>Get list of available services you can purchase:</p> <pre><code>GET /v1/payments/service?academy={academy_id}\n</code></pre> <p>Response: <pre><code>[\n  {\n    \"slug\": \"mentorship-service\",\n    \"title\": \"Mentorship Service\",\n    \"description\": \"1-on-1 mentoring sessions\",\n    \"type\": \"MENTORSHIP_SERVICE\",\n    ...\n  },\n  {\n    \"slug\": \"event-service\",\n    \"title\": \"Event Service\", \n    \"description\": \"Access to workshops and events\",\n    \"type\": \"EVENT_TYPE_SET\",\n    ...\n  }\n]\n</code></pre></p>"},{"location":"LLM-DOCS/BC_CHECKOUT_CONSUMABLE/#2-get-service-pricing-optional","title":"2\ufe0f\u20e3 Get Service Pricing (Optional)","text":"<p>Check pricing for a specific academy and service:</p> <pre><code>GET /v1/payments/academy/academyservice/{service_slug}?country_code=US\n</code></pre> <p>Headers: - <code>Academy: {academy_id}</code></p> <p>This returns the pricing information for that service at that academy.</p>"},{"location":"LLM-DOCS/BC_CHECKOUT_CONSUMABLE/#3-check-current-balance-optional","title":"3\ufe0f\u20e3 Check Current Balance (Optional)","text":"<p>See your current consumable balance:</p> <pre><code>GET /v1/payments/me/service/consumable\n</code></pre> <p>Response: <pre><code>{\n  \"mentorship_service_sets\": [...],\n  \"event_type_sets\": [...],\n  \"cohort_sets\": [...],\n  \"voids\": [...]\n}\n</code></pre></p>"},{"location":"LLM-DOCS/BC_CHECKOUT_CONSUMABLE/#4-verify-payment-method-exists","title":"4\ufe0f\u20e3 Verify Payment Method Exists","text":"<p>Check if you have a card on file:</p> <pre><code>GET /v2/payments/card?academy_id={academy_id}\n</code></pre> <p>Response if card exists: <pre><code>{\n  \"has_payment_method\": true,\n  \"card_last4\": \"4242\",\n  \"card_brand\": \"Visa\",\n  \"card_exp_month\": 12,\n  \"card_exp_year\": 2025\n}\n</code></pre></p> <p>If no card exists, add one first: <pre><code>POST /v2/payments/card?academy_id={academy_id}\n{\n  \"card_number\": \"4242424242424242\",\n  \"exp_month\": 12,\n  \"exp_year\": 2025,\n  \"cvc\": \"123\"\n}\n</code></pre></p>"},{"location":"LLM-DOCS/BC_CHECKOUT_CONSUMABLE/#5-purchase-consumables-main-endpoint","title":"5\ufe0f\u20e3 Purchase Consumables \u2b50 Main Endpoint","text":"<pre><code>POST /v1/payments/consumable/checkout\n</code></pre> <p>Request Body: <pre><code>{\n  \"service\": \"mentorship-service\",  // or service ID as integer\n  \"how_many\": 10,                   // number of units to purchase\n  \"academy\": 1,                      // academy ID\n  \"country_code\": \"US\",             // optional, for pricing\n  \"is_team_allowed\": false           \n}\n</code></pre></p> <p>Parameters: - <code>service</code> (required): Service slug (string) or ID (integer) - <code>how_many</code> (required): Number of consumable units to buy (positive number) - <code>academy</code> (required): Academy ID - <code>country_code</code> (optional): For country-specific pricing - <code>is_team_allowed</code> (optional): Whether team consumption is allowed, this is used for buying saas seats</p> <p>Response (201 Created): <pre><code>{\n  \"id\": 123,\n  \"amount\": 99.99,\n  \"currency\": {\n    \"code\": \"USD\",\n    \"name\": \"US Dollar\"\n  },\n  \"paid_at\": \"2025-10-11T12:34:56Z\",\n  \"status\": \"FULFILLED\",\n  \"stripe_id\": \"ch_xxxxx\",\n  \"user\": {...},\n  \"bag\": {...}\n}\n</code></pre></p>"},{"location":"LLM-DOCS/BC_CHECKOUT_CONSUMABLE/#6-verify-purchase-optional","title":"6\ufe0f\u20e3 Verify Purchase (Optional)","text":"<p>Check your updated balance:</p> <pre><code>GET /v1/payments/me/service/consumable\n</code></pre> <p>You should see the newly purchased consumables in your balance.</p>"},{"location":"LLM-DOCS/BC_CHECKOUT_CONSUMABLE/#complete-example-flow","title":"Complete Example Flow","text":"<pre><code>// Step 1: Check if payment method exists\nconst checkCard = await fetch('/v2/payments/card?academy_id=1');\nconst cardData = await checkCard.json();\n\nif (!cardData.has_payment_method) {\n  // User needs to add card first\n  alert('Please add a payment method first');\n  return;\n}\n\n// Step 2: Purchase 10 mentorship sessions\nconst purchase = await fetch('/v1/payments/consumable/checkout', {\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json',\n    'Authorization': 'Token your-auth-token'\n  },\n  body: JSON.stringify({\n    service: 'mentorship-service',  // or use service ID\n    how_many: 10,\n    academy: 1,\n    country_code: 'US',\n    mentorship_service_set: 1  // optional\n  })\n});\n\nif (purchase.ok) {\n  const invoice = await purchase.json();\n  console.log('Purchase successful!', invoice);\n  console.log(`Charged: ${invoice.amount} ${invoice.currency.code}`);\n} else {\n  const error = await purchase.json();\n  console.error('Purchase failed:', error);\n}\n\n// Step 3: Check new balance\nconst balance = await fetch('/v1/payments/me/service/consumable');\nconst balanceData = await balance.json();\nconsole.log('New balance:', balanceData);\n</code></pre>"},{"location":"LLM-DOCS/BC_CHECKOUT_CONSUMABLE/#academy-staff-grant-consumables-to-a-user","title":"Academy staff: grant consumables to a user","text":"<p>Staff can grant consumables (e.g. mentorship or event access) to a user without the user paying by card. This uses the same proof-of-payment and externally-managed invoice pattern as staff-assigned plan financing.</p> <p>Endpoint: <code>POST /v1/payments/academy/user/consumable</code> Capability: <code>crud_consumable</code> Headers: <code>Academy: {academy_id}</code>, plus auth.</p> <p>Restriction: The payment method must not be a credit card or crypto. Use a method such as bank transfer or manual; proof of payment (file or reference) is required.</p> <p>Request body:</p> Field Required Description <code>user</code> Yes User id or email <code>service</code> Yes Service id or slug (<code>MENTORSHIP_SERVICE_SET</code>, <code>EVENT_TYPE_SET</code>, or <code>VOID</code>) <code>how_many</code> Yes Positive integer <code>payment_method</code> Yes PaymentMethod id (must have <code>is_credit_card=False</code>, <code>is_crypto=False</code>) <code>mentorship_service_set</code> If service is MENTORSHIP_SERVICE_SET Set id for this academy <code>event_type_set</code> If service is EVENT_TYPE_SET Set id for this academy (for VOID, omit both set fields) <code>amount</code> No Amount for the invoice (default 0) <code>reference</code> One of file/reference Proof of payment reference <code>file</code> One of file/reference Proof of payment file (upload id) <code>provided_payment_details</code> No Optional payment details text <p>Response: <code>201 Created</code> with the created invoice (serialized). The created consumable is linked to this invoice via <code>standalone_invoice</code>.</p>"},{"location":"LLM-DOCS/BC_CHECKOUT_CONSUMABLE/#key-points","title":"Key Points","text":"<p>\u2705 Single endpoint: <code>/v1/payments/consumable/checkout</code> handles the entire purchase \u2705 Uses saved card: Automatically charges the card you have on file \u2705 Instant delivery: Consumables are immediately added to your account \u2705 Flexible pricing: Supports country-specific pricing ratios \u2705 Multiple service types: Works for mentorships, events, and other services  </p> <p>The system automatically: - Creates a Bag with the purchase details - Charges your saved payment method via Stripe - Creates an Invoice record - Creates a Consumable with the purchased units - Logs the activity</p> <p>No bag/checking flow needed - this is a direct purchase endpoint! \ud83d\ude80</p>"},{"location":"LLM-DOCS/BC_INVOICE/","title":"BC INVOICE","text":""},{"location":"LLM-DOCS/BC_INVOICE/#user-invoice-history-endpoint","title":"\ud83d\udccb User Invoice History Endpoint","text":""},{"location":"LLM-DOCS/BC_INVOICE/#get-all-invoices-history","title":"Get All Invoices (History)","text":"<pre><code>GET /v1/payments/me/invoice\n</code></pre> <p>Query Parameters (all optional): - <code>status</code> - Filter by status (comma-separated): <code>FULFILLED</code>, <code>REJECTED</code>, <code>PENDING</code>, <code>REFUNDED</code>, <code>DISPUTED_AS_FRAUD</code> - <code>limit</code> - Number of results per page - <code>offset</code> - Pagination offset - <code>sort</code> - Sort field (default: <code>-id</code> - newest first)</p> <p>Example Requests:</p> <pre><code># Get all invoices (paginated, newest first)\nGET /v1/payments/me/invoice\n\n# Get only fulfilled (paid) invoices\nGET /v1/payments/me/invoice?status=FULFILLED\n\n# Get fulfilled and refunded invoices\nGET /v1/payments/me/invoice?status=FULFILLED,REFUNDED\n\n# Get first 10 invoices\nGET /v1/payments/me/invoice?limit=10&amp;offset=0\n\n# Sort by oldest first\nGET /v1/payments/me/invoice?sort=id\n</code></pre> <p>Response Structure: <pre><code>{\n  \"count\": 25,\n  \"first\": null,\n  \"last\": null,\n  \"next\": \"http://api.example.com/v1/payments/me/invoice?limit=20&amp;offset=20\",\n  \"previous\": null,\n  \"results\": [\n    {\n      \"id\": 123,\n      \"amount\": 99.99,\n      \"currency\": {\n        \"code\": \"USD\",\n        \"name\": \"US Dollar\"\n      },\n      \"paid_at\": \"2025-10-11T12:34:56Z\",\n      \"refunded_at\": null,\n      \"status\": \"FULFILLED\",\n      \"stripe_id\": \"ch_xxxxxxxxxxxxx\",\n      \"refund_stripe_id\": null,\n      \"amount_refunded\": 0.0,\n      \"externally_managed\": false,\n      \"created_at\": \"2025-10-11T12:34:56Z\",\n      \"updated_at\": \"2025-10-11T12:34:56Z\"\n    },\n    {\n      \"id\": 122,\n      \"amount\": 49.99,\n      \"currency\": {\n        \"code\": \"USD\",\n        \"name\": \"US Dollar\"\n      },\n      \"paid_at\": \"2025-09-11T10:20:30Z\",\n      \"refunded_at\": null,\n      \"status\": \"FULFILLED\",\n      \"stripe_id\": \"ch_yyyyyyyyyyyyy\",\n      \"refund_stripe_id\": null,\n      \"amount_refunded\": 0.0,\n      \"externally_managed\": false,\n      \"created_at\": \"2025-09-11T10:20:30Z\",\n      \"updated_at\": \"2025-09-11T10:20:30Z\"\n    }\n  ]\n}\n</code></pre></p>"},{"location":"LLM-DOCS/BC_INVOICE/#get-single-invoice-details","title":"Get Single Invoice Details","text":"<pre><code>GET /v1/payments/me/invoice/{invoice_id}\n</code></pre> <p>Example: <pre><code>GET /v1/payments/me/invoice/123\n</code></pre></p> <p>Response (more detailed): <pre><code>{\n  \"id\": 123,\n  \"amount\": 99.99,\n  \"currency\": {\n    \"code\": \"USD\",\n    \"name\": \"US Dollar\",\n    \"decimals\": 2\n  },\n  \"paid_at\": \"2025-10-11T12:34:56Z\",\n  \"refunded_at\": null,\n  \"status\": \"FULFILLED\",\n  \"stripe_id\": \"ch_xxxxxxxxxxxxx\",\n  \"refund_stripe_id\": null,\n  \"amount_refunded\": 0.0,\n  \"externally_managed\": false,\n  \"user\": {\n    \"id\": 1,\n    \"email\": \"user@example.com\",\n    \"first_name\": \"John\",\n    \"last_name\": \"Doe\"\n  },\n  \"academy\": {\n    \"id\": 1,\n    \"name\": \"4Geeks Academy\"\n  },\n  \"bag\": {\n    \"id\": 456,\n    \"type\": \"BAG\",\n    \"status\": \"PAID\",\n    \"was_delivered\": true,\n    \"chosen_period\": \"MONTH\",\n    \"is_recurrent\": true\n  },\n  \"created_at\": \"2025-10-11T12:34:56Z\",\n  \"updated_at\": \"2025-10-11T12:34:56Z\"\n}\n</code></pre></p>"},{"location":"LLM-DOCS/BC_INVOICE/#invoice-statuses","title":"Invoice Statuses","text":"Status Description <code>FULFILLED</code> Payment completed successfully \u2705 <code>PENDING</code> Payment processing or awaiting confirmation \u23f3 <code>REJECTED</code> Payment was rejected \u274c <code>REFUNDED</code> Payment was refunded \ud83d\udcb0 <code>DISPUTED_AS_FRAUD</code> Payment disputed as fraudulent \u26a0\ufe0f"},{"location":"LLM-DOCS/BC_INVOICE/#complete-example-usage","title":"Complete Example Usage","text":"<pre><code>// Get invoice history\nasync function getInvoiceHistory() {\n  const response = await fetch('/v1/payments/me/invoice?limit=20', {\n    headers: {\n      'Authorization': 'Token your-auth-token'\n    }\n  });\n\n  const data = await response.json();\n\n  console.log(`Total invoices: ${data.count}`);\n  console.log('Recent invoices:', data.results);\n\n  // Show invoice details\n  data.results.forEach(invoice =&gt; {\n    console.log(`\n      Invoice #${invoice.id}\n      Amount: ${invoice.currency.code} ${invoice.amount}\n      Date: ${invoice.paid_at}\n      Status: ${invoice.status}\n      ${invoice.stripe_id ? `Stripe: ${invoice.stripe_id}` : ''}\n    `);\n  });\n\n  return data;\n}\n\n// Get specific invoice\nasync function getInvoiceDetails(invoiceId) {\n  const response = await fetch(`/v1/payments/me/invoice/${invoiceId}`, {\n    headers: {\n      'Authorization': 'Token your-auth-token'\n    }\n  });\n\n  const invoice = await response.json();\n  console.log('Invoice details:', invoice);\n  return invoice;\n}\n\n// Get only paid invoices\nasync function getPaidInvoices() {\n  const response = await fetch('/v1/payments/me/invoice?status=FULFILLED', {\n    headers: {\n      'Authorization': 'Token your-auth-token'\n    }\n  });\n\n  return await response.json();\n}\n</code></pre>"},{"location":"LLM-DOCS/BC_INVOICE/#bonus-academy-staff-view","title":"Bonus: Academy Staff View","text":"<p>If you have academy staff permissions, you can view invoices for your academy:</p> <pre><code>GET /v1/payments/academy/invoice\nHeaders: Academy: {academy_id}\n</code></pre> <p>Query parameters (all optional): - <code>user</code> \u2013 User ID or email. When provided, returns only invoices for that user (all billing for a single user). - <code>status</code> \u2013 Filter by status (comma-separated). - <code>date_start</code> / <code>date_end</code> \u2013 Filter by paid date range.</p> <p>Requires <code>read_invoice</code> capability.</p>"},{"location":"LLM-DOCS/BC_INVOICE/#summary","title":"Summary","text":"<p>\u2705 Yes, there's a full invoice history endpoint: <code>/v1/payments/me/invoice</code> \u2705 Supports filtering by status \u2705 Supports pagination for large histories \u2705 Shows all payment details including amounts, dates, Stripe IDs \u2705 Can get individual invoice details with <code>/v1/payments/me/invoice/{invoice_id}</code></p> <p>Perfect for building a \"Payment History\" or \"My Invoices\" page in your frontend! \ud83d\udcb3\ud83d\udcca</p>"},{"location":"LLM-DOCS/BC_REFUNDS/","title":"\ud83d\udcb0 Refunds System","text":""},{"location":"LLM-DOCS/BC_REFUNDS/#overview","title":"\ud83d\udccb Overview","text":"<p>The refunds system allows processing full or partial refunds of invoices. When a refund is processed, a CreditNote (credit note) is created to document the refund and the invoice status is updated. The system also handles integration with Stripe to process refunds for credit card payments.</p>"},{"location":"LLM-DOCS/BC_REFUNDS/#system-architecture","title":"\ud83c\udfd7\ufe0f System Architecture","text":""},{"location":"LLM-DOCS/BC_REFUNDS/#main-models","title":"Main Models","text":""},{"location":"LLM-DOCS/BC_REFUNDS/#1-invoice","title":"1. Invoice","text":"<p>The invoice represents a payment made by a user. Fields relevant for refunds:</p> <ul> <li><code>amount</code>: Total invoice amount</li> <li><code>amount_refunded</code>: Total amount already refunded</li> <li><code>status</code>: Invoice status (can be <code>FULFILLED</code>, <code>PARTIALLY_REFUNDED</code>, <code>REFUNDED</code>)</li> <li><code>refunded_at</code>: Date when the invoice was fully refunded</li> <li><code>refund_stripe_id</code>: Stripe refund ID (if applicable)</li> <li><code>stripe_id</code>: Stripe charge ID</li> <li><code>amount_breakdown</code>: Breakdown of how the amount is divided between plans and services</li> </ul> <p>Invoice statuses related to refunds: - <code>FULFILLED</code>: Invoice fully paid - <code>PARTIALLY_REFUNDED</code>: Invoice partially refunded - <code>REFUNDED</code>: Invoice fully refunded</p>"},{"location":"LLM-DOCS/BC_REFUNDS/#2-creditnote","title":"2. CreditNote","text":"<p>Represents a processed refund. Each refund creates a CreditNote.</p> <p>Main fields: - <code>invoice</code>: Associated invoice (ForeignKey) - <code>amount</code>: Refund amount - <code>currency</code>: Refund currency - <code>reason</code>: Refund reason - <code>status</code>: Credit note status (<code>DRAFT</code>, <code>ISSUED</code>, <code>CANCELLED</code>) - <code>issued_at</code>: Issue date - <code>legal_text</code>: Country-specific legal text - <code>country_code</code>: Country code for legal compliance - <code>breakdown</code>: Breakdown of what is being refunded (plans, service-items) - <code>refund_stripe_id</code>: Stripe refund ID (if applicable)</p> <p>Relationship: - An Invoice can have multiple CreditNotes (for partial refunds) - Each CreditNote is linked to an Invoice</p>"},{"location":"LLM-DOCS/BC_REFUNDS/#refund-processing-flow","title":"\ud83d\udd04 Refund Processing Flow","text":""},{"location":"LLM-DOCS/BC_REFUNDS/#1-api-endpoint","title":"1. API Endpoint","text":"<pre><code>POST /v1/payments/academy/invoice/{invoice_id}/refund\nHeaders: Academy: {academy_id}\n</code></pre> <p>Permission requirements: <code>crud_invoice</code></p>"},{"location":"LLM-DOCS/BC_REFUNDS/#2-request-parameters","title":"2. Request Parameters","text":"<pre><code>{\n  \"refund_amount\": 100.00,\n  \"items_to_refund\": {\n    \"plan-slug-1\": 60.00,\n    \"service-slug-1\": 40.00\n  },\n  \"reason\": \"Customer requested refund\"\n}\n</code></pre> <p>Required fields: - <code>refund_amount</code> (float): Total amount to refund (must match the sum of <code>items_to_refund</code>) - <code>items_to_refund</code> (dict): Dictionary mapping slugs to refund amounts   - Keys are plan or service slugs   - Values are the amounts to refund for each item - <code>reason</code> (string, optional): Refund reason</p>"},{"location":"LLM-DOCS/BC_REFUNDS/#3-validations","title":"3. Validations","text":"<p>The system performs the following validations:</p> <ol> <li>Invoice exists and belongs to the academy</li> <li>Invoice is not fully refunded</li> <li>Valid refund amount:</li> <li>Must be greater than 0</li> <li>Cannot exceed available amount (<code>invoice.amount - invoice.amount_refunded</code>)</li> <li>Valid items_to_refund:</li> <li>Must be a non-empty dictionary</li> <li>All slugs must exist in <code>invoice.amount_breakdown</code></li> <li>All amounts must be positive numbers</li> <li>Amounts cannot exceed original amounts for each item</li> <li>Amount matching:</li> <li><code>refund_amount</code> must match the sum of all values in <code>items_to_refund</code> (with 0.01 tolerance for floating point differences)</li> <li>Invoice status:</li> <li>Only invoices with status <code>FULFILLED</code>, <code>PARTIALLY_REFUNDED</code>, or <code>REFUNDED</code> can be refunded</li> </ol>"},{"location":"LLM-DOCS/BC_REFUNDS/#4-processing","title":"4. Processing","text":"<p>The refund process follows these steps:</p>"},{"location":"LLM-DOCS/BC_REFUNDS/#step-1-calculate-refund-breakdown","title":"Step 1: Calculate Refund Breakdown","text":"<pre><code>calculate_refund_breakdown(invoice, refund_amount, items_to_refund, lang)\n</code></pre> <p>This function: - Validates that all slugs exist in <code>invoice.amount_breakdown</code> - Validates that amounts don't exceed originals - Generates a breakdown with the structure: <pre><code>{\n  \"plans\": {\n    \"plan-slug-1\": {\n      \"amount\": 60.00,\n      \"currency\": \"USD\",\n      ...\n    }\n  },\n  \"service-items\": {\n    \"service-slug-1\": {\n      \"amount\": 40.00,\n      \"currency\": \"USD\",\n      \"how-many\": 1,\n      \"unit-type\": \"UNIT\",\n      ...\n    }\n  }\n}\n</code></pre></p>"},{"location":"LLM-DOCS/BC_REFUNDS/#step-2-process-refund-in-stripe-if-applicable","title":"Step 2: Process Refund in Stripe (if applicable)","text":"<p>If the invoice has <code>stripe_id</code>: - Calls <code>stripe_service.refund_payment(invoice, amount=amount)</code> - Gets the <code>refund_stripe_id</code> from Stripe - Automatically updates <code>invoice.amount_refunded</code> and <code>invoice.status</code></p> <p>If the invoice does NOT have <code>stripe_id</code>: - Manually updates <code>invoice.amount_refunded</code> - Updates <code>invoice.status</code> to <code>PARTIALLY_REFUNDED</code> or <code>REFUNDED</code> as appropriate</p>"},{"location":"LLM-DOCS/BC_REFUNDS/#step-3-create-creditnote","title":"Step 3: Create CreditNote","text":"<p>A <code>CreditNote</code> record is created with: - Reference to the invoice - Amount, currency, reason - Refund breakdown - <code>refund_stripe_id</code> (if applicable) - Status <code>ISSUED</code></p>"},{"location":"LLM-DOCS/BC_REFUNDS/#step-4-deprecate-plans-and-remove-services","title":"Step 4: Deprecate Plans and Remove Services","text":"<p>If plans are being refunded: - Finds all active <code>Subscription</code> for the user with those plans - Changes them to <code>EXPIRED</code> status with explanatory message - Finds all active <code>PlanFinancing</code> for the user with those plans - Changes them to <code>EXPIRED</code> status with explanatory message</p> <p>If service-items are being refunded: - Deletes associated <code>SubscriptionServiceItem</code> - Deletes associated <code>PlanServiceItemHandler</code></p>"},{"location":"LLM-DOCS/BC_REFUNDS/#main-functions","title":"\ud83d\udcdd Main Functions","text":""},{"location":"LLM-DOCS/BC_REFUNDS/#calculate_refund_breakdown","title":"<code>calculate_refund_breakdown()</code>","text":"<p>Location: <code>breathecode/payments/actions.py</code></p> <p>Purpose: Calculates which invoice components should be refunded based on the amount and specified items.</p> <p>Parameters: - <code>invoice</code> (Invoice): The invoice to refund - <code>refund_amount</code> (float): Total amount to refund - <code>items_to_refund</code> (dict[str, float]): Dictionary mapping slugs to amounts - <code>lang</code> (str): Language code for error messages</p> <p>Returns: - <code>dict[str, Any]</code>: Refund breakdown with plans and service-items structure</p> <p>Validations: - Invoice must have <code>amount_breakdown</code> - Amount must be greater than 0 - Amount cannot exceed available - All slugs must exist in breakdown - Amounts per item cannot exceed originals - Total amount must match sum of items</p>"},{"location":"LLM-DOCS/BC_REFUNDS/#process_refund","title":"<code>process_refund()</code>","text":"<p>Location: <code>breathecode/payments/actions.py</code></p> <p>Purpose: Processes a complete refund: creates the CreditNote, processes payment in Stripe (if applicable), and deprecates plans/removes services.</p> <p>Parameters: - <code>invoice</code> (Invoice): The invoice to refund - <code>amount</code> (float): Total amount to refund (required) - <code>items_to_refund</code> (dict[str, float]): Dictionary mapping slugs to amounts (required) - <code>breakdown</code> (dict, optional): Refund breakdown (calculated if not provided) - <code>reason</code> (str): Refund reason - <code>country_code</code> (str, optional): Country code - <code>legal_text</code> (str, optional): Country-specific legal text - <code>lang</code> (str): Language code</p> <p>Returns: - <code>CreditNote</code>: The created CreditNote object</p> <p>Side effects: - Creates a refund in Stripe (if applicable) - Updates <code>invoice.amount_refunded</code> and <code>invoice.status</code> - Creates a <code>CreditNote</code> record - Expires associated subscriptions and plan financings - Deletes associated service items</p>"},{"location":"LLM-DOCS/BC_REFUNDS/#refund_payment-stripe-service","title":"<code>refund_payment()</code> (Stripe Service)","text":"<p>Location: <code>breathecode/payments/services/stripe.py</code></p> <p>Purpose: Processes a refund through the Stripe API.</p> <p>Parameters: - <code>invoice</code> (Invoice): The invoice to refund - <code>amount</code> (float, optional): Amount to refund (if None, refunds full available amount)</p> <p>Returns: - <code>dict</code>: Contains <code>refund</code>, <code>refunded_amount</code>, and <code>invoice</code></p> <p>Validations: - Amount cannot exceed available - Amount must be greater than 0 - Invoice must have <code>stripe_id</code></p>"},{"location":"LLM-DOCS/BC_REFUNDS/#stripe-integration","title":"\ud83d\udd0c Stripe Integration","text":""},{"location":"LLM-DOCS/BC_REFUNDS/#stripe-refund-flow","title":"Stripe Refund Flow","text":"<ol> <li>Validation: Verifies that the invoice has <code>stripe_id</code></li> <li>Refund Creation: Calls <code>stripe.Refund.create()</code> with:</li> <li><code>charge</code>: The invoice's <code>stripe_id</code></li> <li><code>amount</code>: The amount in cents (if partial refund)</li> <li>Invoice Update: Stripe automatically updates:</li> <li><code>invoice.amount_refunded</code></li> <li><code>invoice.refund_stripe_id</code> (or accumulates if already exists)</li> <li><code>invoice.status</code> (to <code>PARTIALLY_REFUNDED</code> or <code>REFUNDED</code>)</li> <li>CreditNote Creation: Only after successful Stripe refund</li> </ol>"},{"location":"LLM-DOCS/BC_REFUNDS/#multiple-refunds","title":"Multiple Refunds","text":"<p>The system supports multiple partial refunds: - Each refund creates a new <code>CreditNote</code> - <code>invoice.amount_refunded</code> accumulates - <code>invoice.refund_stripe_id</code> may contain the last refund ID (Stripe handles multiple refunds internally) - Status changes to <code>REFUNDED</code> when <code>amount_refunded &gt;= amount</code></p>"},{"location":"LLM-DOCS/BC_REFUNDS/#serializers","title":"\ud83d\udcca Serializers","text":""},{"location":"LLM-DOCS/BC_REFUNDS/#creditnoteserializer","title":"CreditNoteSerializer","text":"<p>Location: <code>breathecode/payments/serializers.py</code></p> <p>Serialized fields: - <code>id</code>: Credit note ID - <code>amount</code>: Refund amount - <code>currency</code>: Currency (serialized with <code>GetCurrencySmallSerializer</code>) - <code>reason</code>: Refund reason - <code>issued_at</code>: Issue date - <code>status</code>: Status (<code>DRAFT</code>, <code>ISSUED</code>, <code>CANCELLED</code>) - <code>legal_text</code>: Legal text - <code>country_code</code>: Country code - <code>breakdown</code>: Refund breakdown - <code>refund_stripe_id</code>: Stripe ID - <code>created_at</code>, <code>updated_at</code>: Timestamps - <code>invoice</code>: Associated invoice (serialized with <code>GetInvoiceSmallSerializer</code>) - <code>invoice_credit_notes</code>: All credit notes for the invoice (method field)</p>"},{"location":"LLM-DOCS/BC_REFUNDS/#getinvoiceserializer","title":"GetInvoiceSerializer","text":"<p>Includes refund-related fields: - <code>amount_refunded</code>: Total refunded amount - <code>refund_stripe_id</code>: Stripe refund ID - <code>refunded_at</code>: Full refund date - <code>credit_notes</code>: List of all associated credit notes</p>"},{"location":"LLM-DOCS/BC_REFUNDS/#use-cases","title":"\ud83c\udfaf Use Cases","text":""},{"location":"LLM-DOCS/BC_REFUNDS/#case-1-full-invoice-refund","title":"Case 1: Full Invoice Refund","text":"<pre><code>POST /v1/payments/academy/invoice/123/refund\n{\n  \"refund_amount\": 99.99,\n  \"items_to_refund\": {\n    \"monthly-plan\": 99.99\n  },\n  \"reason\": \"Customer cancellation\"\n}\n</code></pre> <p>Result: - A CreditNote is created for $99.99 - Invoice status changes to <code>REFUNDED</code> - If there's an active Subscription with that plan, it expires - Refund is processed in Stripe (if applicable)</p>"},{"location":"LLM-DOCS/BC_REFUNDS/#case-2-partial-refund-of-multiple-items","title":"Case 2: Partial Refund of Multiple Items","text":"<pre><code>POST /v1/payments/academy/invoice/123/refund\n{\n  \"refund_amount\": 50.00,\n  \"items_to_refund\": {\n    \"monthly-plan\": 30.00,\n    \"mentoring-service\": 20.00\n  },\n  \"reason\": \"Partial refund for service issues\"\n}\n</code></pre> <p>Result: - A CreditNote is created for $50.00 - Invoice status changes to <code>PARTIALLY_REFUNDED</code> - $30 is refunded from the plan and $20 from the service - Plan subscription expires - Mentoring service items are deleted</p>"},{"location":"LLM-DOCS/BC_REFUNDS/#case-3-multiple-partial-refunds","title":"Case 3: Multiple Partial Refunds","text":"<p>First refund: <pre><code>POST /v1/payments/academy/invoice/123/refund\n{\n  \"refund_amount\": 30.00,\n  \"items_to_refund\": {\"plan-slug\": 30.00}\n}\n</code></pre></p> <p>Second refund (later): <pre><code>POST /v1/payments/academy/invoice/123/refund\n{\n  \"refund_amount\": 20.00,\n  \"items_to_refund\": {\"service-slug\": 20.00}\n}\n</code></pre></p> <p>Result: - 2 separate CreditNotes are created - <code>invoice.amount_refunded</code> = 50.00 - If invoice total is $100, it remains in <code>PARTIALLY_REFUNDED</code> status - If total is $50, it changes to <code>REFUNDED</code> after the second refund</p>"},{"location":"LLM-DOCS/BC_REFUNDS/#validations-and-common-errors","title":"\u26a0\ufe0f Validations and Common Errors","text":""},{"location":"LLM-DOCS/BC_REFUNDS/#validation-errors","title":"Validation Errors","text":"<ol> <li>\"Invoice has already been fully refunded\"</li> <li>Occurs when <code>invoice.amount_refunded &gt;= invoice.amount</code></li> <li> <p>Solution: Check invoice status before attempting to refund</p> </li> <li> <p>\"Refund amount exceeds available amount to refund\"</p> </li> <li>Requested amount exceeds <code>invoice.amount - invoice.amount_refunded</code></li> <li> <p>Solution: Correctly calculate available amount</p> </li> <li> <p>\"Invalid slugs provided\"</p> </li> <li>Slugs in <code>items_to_refund</code> don't exist in <code>invoice.amount_breakdown</code></li> <li> <p>Solution: Verify available slugs in the invoice</p> </li> <li> <p>\"Refund amount does not match the sum of items_to_refund amounts\"</p> </li> <li><code>refund_amount</code> doesn't match the sum of values in <code>items_to_refund</code></li> <li> <p>Solution: Ensure amounts sum exactly to <code>refund_amount</code></p> </li> <li> <p>\"Refund amount for '{slug}' exceeds its original amount\"</p> </li> <li>Attempting to refund more than an item originally cost</li> <li> <p>Solution: Verify original amounts in <code>invoice.amount_breakdown</code></p> </li> <li> <p>\"Only fulfilled or partially refunded invoices can be refunded\"</p> </li> <li>Invoice is not in a valid state for refunding</li> <li>Solution: Only invoices with status <code>FULFILLED</code>, <code>PARTIALLY_REFUNDED</code>, or <code>REFUNDED</code> can be refunded</li> </ol>"},{"location":"LLM-DOCS/BC_REFUNDS/#stripe-errors","title":"Stripe Errors","text":"<p>If there's an error processing the refund in Stripe: - Error is logged - An exception is raised that stops the process - CreditNote is NOT created - Invoice is NOT updated</p>"},{"location":"LLM-DOCS/BC_REFUNDS/#related-queries-and-endpoints","title":"\ud83d\udd0d Related Queries and Endpoints","text":""},{"location":"LLM-DOCS/BC_REFUNDS/#view-credit-notes-for-an-invoice","title":"View Credit Notes for an Invoice","text":"<p>Credit notes are included in the Invoice serializer: <pre><code>GET /v1/payments/academy/invoice/{invoice_id}\n</code></pre></p> <p>Response includes: <pre><code>{\n  \"credit_notes\": [\n    {\n      \"id\": 1,\n      \"amount\": 50.00,\n      \"reason\": \"Partial refund\",\n      \"status\": \"ISSUED\",\n      ...\n    }\n  ]\n}\n</code></pre></p>"},{"location":"LLM-DOCS/BC_REFUNDS/#view-all-credit-notes","title":"View All Credit Notes","text":"<p>Each CreditNote includes all credit notes for its invoice in <code>invoice_credit_notes</code>: <pre><code>{\n  \"invoice_credit_notes\": [\n    {\n      \"id\": 1,\n      \"amount\": 30.00,\n      ...\n    },\n    {\n      \"id\": 2,\n      \"amount\": 20.00,\n      ...\n    }\n  ]\n}\n</code></pre></p>"},{"location":"LLM-DOCS/BC_REFUNDS/#testing","title":"\ud83e\uddea Testing","text":""},{"location":"LLM-DOCS/BC_REFUNDS/#recommended-tests","title":"Recommended Tests","text":"<ol> <li>Full refund test:</li> <li>Create invoice with plan</li> <li>Process full refund</li> <li>Verify CreditNote created</li> <li>Verify invoice.status = REFUNDED</li> <li> <p>Verify subscription expired</p> </li> <li> <p>Partial refund test:</p> </li> <li>Create invoice with multiple items</li> <li>Process partial refund</li> <li>Verify CreditNote with correct amount</li> <li>Verify invoice.status = PARTIALLY_REFUNDED</li> <li> <p>Verify only specified items were affected</p> </li> <li> <p>Validation tests:</p> </li> <li>Attempt to refund more than available</li> <li>Attempt to refund with invalid slugs</li> <li>Attempt to refund already fully refunded invoice</li> <li> <p>Attempt to refund with non-matching amounts</p> </li> <li> <p>Stripe integration test:</p> </li> <li>Mock Stripe refund</li> <li>Verify refund_stripe_id saved</li> <li>Verify invoice update</li> </ol>"},{"location":"LLM-DOCS/BC_REFUNDS/#code-references","title":"\ud83d\udcda Code References","text":""},{"location":"LLM-DOCS/BC_REFUNDS/#main-files","title":"Main Files","text":"<ul> <li>Models: <code>breathecode/payments/models.py</code></li> <li><code>Invoice</code> (lines 1750-1876)</li> <li> <p><code>CreditNote</code> (lines 1878-1930)</p> </li> <li> <p>Actions: <code>breathecode/payments/actions.py</code></p> </li> <li><code>calculate_refund_breakdown()</code> (lines 2462-2626)</li> <li> <p><code>process_refund()</code> (lines 2629-2828)</p> </li> <li> <p>Views: <code>breathecode/payments/views.py</code></p> </li> <li> <p><code>AcademyInvoiceRefundView</code> (lines 2102-2273)</p> </li> <li> <p>Services: <code>breathecode/payments/services/stripe.py</code></p> </li> <li> <p><code>refund_payment()</code> (lines 440-524)</p> </li> <li> <p>Serializers: <code>breathecode/payments/serializers.py</code></p> </li> <li><code>CreditNoteSerializer</code> (lines 923-949)</li> <li> <p><code>GetInvoiceSerializer</code> (lines 951-980)</p> </li> <li> <p>URLs: <code>breathecode/payments/urls/v1.py</code></p> </li> <li>Endpoint: line 138</li> </ul>"},{"location":"LLM-DOCS/BC_REFUNDS/#best-practices","title":"\ud83c\udf93 Best Practices","text":"<ol> <li>Always validate before processing:</li> <li>Verify invoice exists and is in valid state</li> <li>Calculate available amount before requesting refund</li> <li> <p>Verify slugs exist in breakdown</p> </li> <li> <p>Error handling:</p> </li> <li>Catch Stripe exceptions</li> <li>Log errors for debugging</li> <li> <p>Provide clear error messages to user</p> </li> <li> <p>Transactions:</p> </li> <li>Refund process should be atomic</li> <li>If Stripe refund fails, don't create CreditNote</li> <li> <p>If CreditNote creation fails, revert invoice changes</p> </li> <li> <p>Documentation:</p> </li> <li>Always include a clear reason for the refund</li> <li>Maintain logs of all processed refunds</li> <li> <p>Record who processed the refund (user/admin)</p> </li> <li> <p>Testing:</p> </li> <li>Test full and partial refunds</li> <li>Test multiple partial refunds</li> <li>Test amount and slug validations</li> <li>Test Stripe integration (mocks)</li> </ol>"},{"location":"LLM-DOCS/BC_REFUNDS/#security","title":"\ud83d\udd10 Security","text":"<ul> <li>Only users with <code>crud_invoice</code> permission can process refunds</li> <li>Validations prevent duplicate or excessive refunds</li> <li>Stripe refunds require API key authentication</li> <li>All errors are translated using Capy Core's i18n system</li> </ul>"},{"location":"LLM-DOCS/BC_REFUNDS/#additional-notes","title":"\ud83d\udcdd Additional Notes","text":"<ul> <li>The system supports refunds for both Stripe payments and external payments</li> <li>Partial refunds allow flexibility in cases of disputes or issues with specific services</li> <li>Refund breakdown is stored in CreditNote for audit purposes</li> <li>Subscriptions and plan financings are automatically expired when their plans are refunded</li> <li>Service items are deleted when refunded</li> </ul>"},{"location":"LLM-DOCS/BC_SERVICE_STOCK_STATUS/","title":"Service Stock Status \u2013 Debug User Consumable Issues","text":"<p>This document explains how to use the Service Stock Status endpoint to debug why a student does not have the consumables they should have (e.g. mentorship sessions, event access, cohort access). The endpoint returns all service stock schedulers that should issue consumables for that user in the academy, plus diagnosis messages and optional balance.</p>"},{"location":"LLM-DOCS/BC_SERVICE_STOCK_STATUS/#endpoint","title":"Endpoint","text":"<pre><code>GET /v1/payments/academy/service/stock_status/&lt;user_id&gt;\n</code></pre> <ul> <li><code>user_id</code> (path, required): The student\u2019s user ID.</li> <li>Academy (header, required): Academy ID (e.g. <code>Academy: 1</code>).</li> <li>Permission: Requires <code>read_service_stock_status</code> (sysadmin only; not granted to academy staff roles).</li> </ul>"},{"location":"LLM-DOCS/BC_SERVICE_STOCK_STATUS/#optional-query-parameter","title":"Optional query parameter","text":"Parameter Values Description <code>include_balance</code> <code>true</code>, <code>1</code>, <code>y</code> If set, adds <code>consumables_balance</code> to the response (same shape as <code>GET /v1/payments/me/service/consumable</code>). Use it to compare \u201cexpected\u201d vs \u201cactual\u201d balance. <p>Example:</p> <pre><code># Basic call \u2013 schedulers and issues only\nGET /v1/payments/academy/service/stock_status/12345\nHeaders: Academy: 1, Authorization: Bearer &lt;token&gt;\n\n# With current consumable balance (to compare with what schedulers should grant)\nGET /v1/payments/academy/service/stock_status/12345?include_balance=true\nHeaders: Academy: 1, Authorization: Bearer &lt;token&gt;\n</code></pre>"},{"location":"LLM-DOCS/BC_SERVICE_STOCK_STATUS/#when-to-use-it","title":"When to use it","text":"<ul> <li>A student says they should have consumables (e.g. mentorship sessions) but don\u2019t see them.</li> <li>You want to see why a given scheduler is not creating or renewing consumables (payment due, expired subscription, missing resource, etc.).</li> <li>You need the scheduler id to run the CLI diagnostic or force renewal (see below).</li> </ul>"},{"location":"LLM-DOCS/BC_SERVICE_STOCK_STATUS/#response-shape","title":"Response shape","text":""},{"location":"LLM-DOCS/BC_SERVICE_STOCK_STATUS/#top-level","title":"Top level","text":"Field Type Description <code>user</code> object <code>{ \"id\", \"email\" }</code> \u2013 the user you queried. <code>academy_id</code> int Academy from the header. <code>schedulers</code> array One object per service stock scheduler that can issue consumables for this user in this academy. <code>consumables_balance</code> object Present only if <code>include_balance=true</code>. Same structure as <code>GET /v1/payments/me/service/consumable</code> (mentorship_service_sets, cohort_sets, event_type_sets, voids)."},{"location":"LLM-DOCS/BC_SERVICE_STOCK_STATUS/#each-item-in-schedulers","title":"Each item in <code>schedulers</code>","text":"Field Type Description <code>id</code> int Scheduler id. Use this with the CLI: <code>python manage.py diagnose_scheduler --scheduler-id &lt;id&gt;</code> (and optionally <code>--force-renew</code>, <code>--fix-resource</code>). <code>source_type</code> string <code>\"subscription\"</code> or <code>\"plan_financing\"</code> \u2013 where this scheduler gets its plan/service from. <code>source_id</code> int Subscription or PlanFinancing id. <code>seat_id</code> int | null If the consumables are for a seat (not the subscription/plan owner), this is the subscription_seat or plan_financing_seat id. <code>service</code> string Service slug (e.g. <code>mentorship-service</code>, <code>event-service</code>). <code>service_item_id</code> int Service item id. <code>renew_at</code> number Renewal interval (e.g. 1). <code>renew_at_unit</code> string Unit (e.g. <code>MONTH</code>, <code>WEEK</code>). <code>is_renewable</code> bool Whether the service item is set to auto-renew. <code>scheduler_valid_until</code> string (ISO) | null When the next refill is due. After this time, the renewal job should create a new consumable. <code>resource_linked</code> bool Important for debugging. <code>true</code> if the subscription/plan financing has the required resource (e.g. <code>selected_mentorship_service_set</code>, <code>selected_cohort_set</code>, <code>selected_event_type_set</code>) for this service. If <code>false</code>, consumables often cannot be created until the resource is set or copied (e.g. with <code>--fix-resource</code>). <code>consumables_count</code> int How many consumables this scheduler has already created. <code>consumables_sample</code> array Last few consumables (id, how_many, valid_until, user_id). <code>issues</code> array of strings Diagnosis: reasons why renewal might be blocked (see below)."},{"location":"LLM-DOCS/BC_SERVICE_STOCK_STATUS/#understanding-issues","title":"Understanding <code>issues</code>","text":"<p>Each scheduler\u2019s <code>issues</code> array lists possible blockers. Use them to decide the next step.</p>"},{"location":"LLM-DOCS/BC_SERVICE_STOCK_STATUS/#subscription-plan-financing-status","title":"Subscription / plan financing status","text":"<ul> <li>\"Subscription X is expired (valid_until: ...)\" \u2013 Subscription has ended. No consumables will be issued until the subscription is renewed or replaced.</li> <li>\"Subscription X needs to be paid (next_payment_at: ...)\" \u2013 Payment is overdue. Process payment for that subscription.</li> <li>\"Subscription X has invalid status: DEPRECATED | EXPIRED | PAYMENT_ISSUE\" \u2013 Subscription is in a bad state; fix or replace it.</li> <li>\"Plan financing X is expired (plan_expires_at: ...)\" \u2013 Same idea for plan financing.</li> <li>\"Plan financing X needs to be paid (next_payment_at: ...)\" \u2013 Payment due for plan financing.</li> <li>\"Plan financing X has invalid status: ...\" \u2013 Plan financing is CANCELLED, DEPRECATED, or EXPIRED.</li> </ul>"},{"location":"LLM-DOCS/BC_SERVICE_STOCK_STATUS/#resource-cohort-event-type-mentorship-set","title":"Resource (cohort / event type / mentorship set)","text":"<ul> <li>\"Subscription has no linked resource for service X (type: ...)\" \u2013 The subscription does not have the required <code>selected_*</code> (e.g. cohort set, event type set, mentorship service set). Consumables for that service type need that resource.</li> <li>\"Plan financing X has no linked resource for service Y ...\" \u2013 Same for plan financing. If the message says \"but plans Z do\", you can often fix it with:   <pre><code>python manage.py diagnose_scheduler --scheduler-id &lt;scheduler_id&gt; --fix-resource\n</code></pre></li> </ul>"},{"location":"LLM-DOCS/BC_SERVICE_STOCK_STATUS/#scheduler-timing","title":"Scheduler timing","text":"<ul> <li>\"Scheduler does not need renewal yet (valid_until=... &gt; now)\" \u2013 The next refill is in the future. No action unless you need to force an early refill (see below).</li> <li>\"Service item X is not renewable (is_renewable=False)\" \u2013 Auto-renewal is off; the first consumable may still exist, but no new ones will be created automatically.</li> </ul>"},{"location":"LLM-DOCS/BC_SERVICE_STOCK_STATUS/#other","title":"Other","text":"<ul> <li>\"Scheduler has no plan_handler or subscription_handler\" \u2013 Scheduler is misconfigured; needs backend/data fix.</li> </ul>"},{"location":"LLM-DOCS/BC_SERVICE_STOCK_STATUS/#debugging-workflow","title":"Debugging workflow","text":"<ol> <li> <p>Call the endpoint <code>GET /v1/payments/academy/service/stock_status/&lt;user_id&gt;</code> (optionally with <code>?include_balance=true</code>).</p> </li> <li> <p>Confirm user and academy    Check <code>user</code> and <code>academy_id</code> in the response.</p> </li> <li> <p>If <code>schedulers</code> is empty </p> </li> <li>User has no subscription/plan/seat in this academy that grants consumables, or  </li> <li> <p>Schedulers were never created (e.g. after adding a seat, the <code>build_service_stock_scheduler_*</code> task may not have run).    Check subscriptions/plan financings and seats for this user in this academy.</p> </li> <li> <p>For each scheduler that should grant the missing consumable </p> </li> <li>Read <code>issues</code>: fix expired/overdue/invalid subscription or plan financing, or missing resource.  </li> <li>Check <code>resource_linked</code>: if <code>false</code>, consumables for that service often won\u2019t be created until you set or copy the resource (e.g. <code>diagnose_scheduler --scheduler-id &lt;id&gt; --fix-resource</code>).  </li> <li> <p>Use <code>id</code> with the CLI for deeper checks or to force actions.</p> </li> <li> <p>Optional: run the CLI diagnostic <pre><code>python manage.py diagnose_scheduler --scheduler-id &lt;scheduler_id&gt;\n</code></pre>    This prints the same kind of checks in more detail. Add <code>--fix-resource</code> to copy the resource from the plan to the plan financing when applicable, or <code>--force-renew</code> to trigger a renewal (only if issues are resolved or acceptable).</p> </li> <li> <p>Compare with actual balance    If you used <code>include_balance=true</code>, compare <code>consumables_balance</code> with what you expect from the schedulers (e.g. service slug, amounts). That shows whether the problem is \u201cno consumables at all\u201d vs \u201cwrong service/resource/amount\u201d.</p> </li> </ol>"},{"location":"LLM-DOCS/BC_SERVICE_STOCK_STATUS/#example-response-minimal","title":"Example response (minimal)","text":"<pre><code>{\n  \"user\": { \"id\": 12345, \"email\": \"student@example.com\" },\n  \"academy_id\": 1,\n  \"schedulers\": [\n    {\n      \"id\": 100,\n      \"source_type\": \"plan_financing\",\n      \"source_id\": 50,\n      \"seat_id\": null,\n      \"service\": \"mentorship-service\",\n      \"service_item_id\": 3,\n      \"renew_at\": 1,\n      \"renew_at_unit\": \"MONTH\",\n      \"is_renewable\": true,\n      \"scheduler_valid_until\": \"2025-03-15T00:00:00Z\",\n      \"resource_linked\": false,\n      \"consumables_count\": 0,\n      \"consumables_sample\": [],\n      \"issues\": [\n        \"Plan financing 50 has no linked resource for mentorship-service (type: MENTORSHIP_SERVICE_SET), but plans [7] do; resource should be copied to plan financing.\"\n      ]\n    }\n  ]\n}\n</code></pre> <p>Here, the student has no consumables because <code>resource_linked</code> is <code>false</code>: the plan financing is missing the mentorship service set. The message says the plan has it; you can run:</p> <pre><code>python manage.py diagnose_scheduler --scheduler-id 100 --fix-resource\n</code></pre> <p>to copy the resource and then (if the scheduler is due) renewal can create the consumable.</p>"},{"location":"LLM-DOCS/BC_SERVICE_STOCK_STATUS/#related","title":"Related","text":"<ul> <li>Consumable balance (student view): <code>GET /v1/payments/me/service/consumable</code> </li> <li>Academy consumables (staff): <code>GET /v1/payments/academy/service/consumable?users=&lt;user_id&gt;</code> (includes staff-granted and subscription/plan consumables for that academy).  </li> <li>CLI: <code>python manage.py diagnose_scheduler --scheduler-id &lt;id&gt;</code> with optional <code>--fix-resource</code> and <code>--force-renew</code>.</li> </ul>"},{"location":"LLM-DOCS/BC_STAFF_INVITES/","title":"Staff Member Invitations","text":"<p>This document covers how to invite staff members to an academy, including how to fetch available roles and manage invitations.</p>"},{"location":"LLM-DOCS/BC_STAFF_INVITES/#overview","title":"Overview","text":"<p>Staff members are non-student members of an academy who have administrative, teaching, or support roles. Unlike students, staff members are assigned specific roles that grant them capabilities to perform various actions within the academy.</p>"},{"location":"LLM-DOCS/BC_STAFF_INVITES/#table-of-contents","title":"Table of Contents","text":"<ol> <li>Fetch Available Roles</li> <li>Invite Staff Member</li> <li>Add Existing User as Staff</li> <li>List Staff Members</li> <li>Resend Staff Invitation</li> <li>Accept Staff Invitation</li> <li>Common Use Cases</li> </ol>"},{"location":"LLM-DOCS/BC_STAFF_INVITES/#fetch-available-roles","title":"Fetch Available Roles","text":"<p>Before inviting a staff member, you need to know which roles are available.</p>"},{"location":"LLM-DOCS/BC_STAFF_INVITES/#get-all-roles","title":"Get All Roles","text":"<p>Endpoint: <code>GET /v1/auth/role</code></p> <p>Authentication: Not required (public endpoint)</p> <p>Response: <pre><code>[\n  {\n    \"id\": 1,\n    \"slug\": \"admin\",\n    \"name\": \"Admin\"\n  },\n  {\n    \"id\": 2,\n    \"slug\": \"teacher\",\n    \"name\": \"Teacher\"\n  },\n  {\n    \"id\": 3,\n    \"slug\": \"academy_coordinator\",\n    \"name\": \"Mentor in residence\"\n  }\n]\n</code></pre></p>"},{"location":"LLM-DOCS/BC_STAFF_INVITES/#get-specific-role-details","title":"Get Specific Role Details","text":"<p>Endpoint: <code>GET /v1/auth/role/{role_slug}</code></p> <p>Authentication: Not required (public endpoint)</p> <p>Response: <pre><code>{\n  \"id\": 2,\n  \"slug\": \"teacher\",\n  \"name\": \"Teacher\",\n  \"capabilities\": [\n    {\n      \"slug\": \"read_assignment\",\n      \"description\": \"Read assignment information\"\n    },\n    {\n      \"slug\": \"crud_assignment\",\n      \"description\": \"Create, update or delete assignments\"\n    }\n  ]\n}\n</code></pre></p>"},{"location":"LLM-DOCS/BC_STAFF_INVITES/#available-staff-roles","title":"Available Staff Roles","text":"<p>Here are the main roles available for staff members:</p> Role Slug Role Name Description <code>admin</code> Admin Full access to all academy features <code>staff</code> Staff (Base) Base staff role with read access to most features <code>read_only</code> Read Only (Base) Read-only access to academy resources <code>basic</code> Basic (Base) Minimal staff access <code>academy_token</code> Academy Token Token-based access for integrations <code>teacher</code> Teacher Can manage cohorts, students, and assignments <code>assistant</code> Teacher Assistant Can assist with cohorts and assignments <code>academy_coordinator</code> Mentor in residence Advanced teaching role with additional permissions <code>career_support</code> Career Support Career services and job placement support <code>admissions_developer</code> Admissions Developer Manage admissions and student lifecycle <code>country_manager</code> Country Manager Manage academy operations at country level <code>syllabus_coordinator</code> Syllabus Coordinator Manage curriculum and content <code>community_manager</code> Community Manager Manage events, content, and community <code>growth_manager</code> Growth Manager Marketing and growth operations <code>culture_and_recruitment</code> Culture and Recruitment HR and recruitment <code>homework_reviewer</code> Homework Reviewer Review student assignments"},{"location":"LLM-DOCS/BC_STAFF_INVITES/#invite-staff-member","title":"Invite Staff Member","text":"<p>Invite a new user to join your academy as a staff member.</p>"},{"location":"LLM-DOCS/BC_STAFF_INVITES/#endpoint","title":"Endpoint","text":"<p>POST <code>/v1/auth/academy/member</code></p> <p>Headers: <pre><code>Authorization: Token &lt;your_token&gt;\nAcademy: &lt;academy_id&gt;\n</code></pre></p> <p>Required Capability: <code>crud_member</code></p>"},{"location":"LLM-DOCS/BC_STAFF_INVITES/#request-body","title":"Request Body","text":"<pre><code>{\n  \"first_name\": \"John\",\n  \"last_name\": \"Doe\",\n  \"email\": \"john.doe@example.com\",\n  \"role\": \"teacher\",\n  \"invite\": true\n}\n</code></pre>"},{"location":"LLM-DOCS/BC_STAFF_INVITES/#request-fields","title":"Request Fields","text":"Field Type Required Description <code>first_name</code> string Yes Staff member's first name <code>last_name</code> string Yes Staff member's last name <code>email</code> string Yes Staff member's email address (must be unique) <code>role</code> string Yes Role slug (e.g., \"teacher\", \"admin\", \"staff\") <code>invite</code> boolean No If true, sends invitation email (default: true) <code>phone</code> string No Staff member's phone number <code>address</code> string No Staff member's address"},{"location":"LLM-DOCS/BC_STAFF_INVITES/#response","title":"Response","text":"<p>Status Code: <code>201 Created</code></p> <pre><code>{\n  \"id\": 123,\n  \"user\": null,\n  \"email\": \"john.doe@example.com\",\n  \"first_name\": \"John\",\n  \"last_name\": \"Doe\",\n  \"role\": {\n    \"id\": 2,\n    \"slug\": \"teacher\",\n    \"name\": \"Teacher\"\n  },\n  \"academy\": {\n    \"id\": 4,\n    \"slug\": \"downtown-miami\",\n    \"name\": \"Downtown Miami\"\n  },\n  \"status\": \"INVITED\",\n  \"phone\": null,\n  \"address\": null,\n  \"created_at\": \"2024-01-15T10:30:00Z\"\n}\n</code></pre>"},{"location":"LLM-DOCS/BC_STAFF_INVITES/#example-request","title":"Example Request","text":"<pre><code>curl -X POST \"https://breathecode.herokuapp.com/v1/auth/academy/member\" \\\n  -H \"Authorization: Token YOUR_TOKEN\" \\\n  -H \"Academy: 4\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"first_name\": \"Sarah\",\n    \"last_name\": \"Johnson\",\n    \"email\": \"sarah.johnson@example.com\",\n    \"role\": \"academy_coordinator\",\n    \"invite\": true\n  }'\n</code></pre>"},{"location":"LLM-DOCS/BC_STAFF_INVITES/#add-existing-user-as-staff","title":"Add Existing User as Staff","text":"<p>If the user already exists in the system, they will be immediately added to the academy without sending an invitation email.</p>"},{"location":"LLM-DOCS/BC_STAFF_INVITES/#endpoint_1","title":"Endpoint","text":"<p>POST <code>/v1/auth/academy/member</code></p> <p>Request Body:</p> <pre><code>{\n  \"user\": 456,\n  \"role\": \"teacher\",\n  \"invite\": false\n}\n</code></pre>"},{"location":"LLM-DOCS/BC_STAFF_INVITES/#request-fields_1","title":"Request Fields","text":"Field Type Required Description <code>user</code> integer Yes Existing user's ID <code>role</code> string Yes Role slug to assign <code>invite</code> boolean No Set to false to skip invitation email"},{"location":"LLM-DOCS/BC_STAFF_INVITES/#response_1","title":"Response","text":"<p>Status Code: <code>201 Created</code></p> <pre><code>{\n  \"id\": 124,\n  \"user\": {\n    \"id\": 456,\n    \"email\": \"existing.user@example.com\",\n    \"first_name\": \"Mike\",\n    \"last_name\": \"Smith\"\n  },\n  \"email\": \"existing.user@example.com\",\n  \"first_name\": \"Mike\",\n  \"last_name\": \"Smith\",\n  \"role\": {\n    \"id\": 2,\n    \"slug\": \"teacher\",\n    \"name\": \"Teacher\"\n  },\n  \"academy\": {\n    \"id\": 4,\n    \"slug\": \"downtown-miami\",\n    \"name\": \"Downtown Miami\"\n  },\n  \"status\": \"ACTIVE\",\n  \"created_at\": \"2024-01-15T10:35:00Z\"\n}\n</code></pre>"},{"location":"LLM-DOCS/BC_STAFF_INVITES/#list-staff-members","title":"List Staff Members","text":"<p>Retrieve a list of all staff members in your academy.</p>"},{"location":"LLM-DOCS/BC_STAFF_INVITES/#endpoint_2","title":"Endpoint","text":"<p>GET <code>/v1/auth/academy/member</code></p> <p>Headers: <pre><code>Authorization: Token &lt;your_token&gt;\nAcademy: &lt;academy_id&gt;\n</code></pre></p> <p>Required Capability: <code>read_member</code></p>"},{"location":"LLM-DOCS/BC_STAFF_INVITES/#query-parameters","title":"Query Parameters","text":"Parameter Type Description <code>roles</code> string Filter by role slugs (comma-separated), e.g., <code>roles=teacher,admin</code> <code>status</code> string Filter by status: <code>INVITED</code>, <code>ACTIVE</code> <code>like</code> string Search by name or email <code>limit</code> integer Number of results per page (default: 10) <code>offset</code> integer Pagination offset"},{"location":"LLM-DOCS/BC_STAFF_INVITES/#response_2","title":"Response","text":"<p>Status Code: <code>200 OK</code></p> <pre><code>{\n  \"count\": 25,\n  \"first\": null,\n  \"next\": \"https://breathecode.herokuapp.com/v1/auth/academy/member?limit=10&amp;offset=10\",\n  \"previous\": null,\n  \"last\": null,\n  \"results\": [\n    {\n      \"id\": 123,\n      \"user\": {\n        \"id\": 456,\n        \"email\": \"john.doe@example.com\",\n        \"first_name\": \"John\",\n        \"last_name\": \"Doe\"\n      },\n      \"email\": \"john.doe@example.com\",\n      \"first_name\": \"John\",\n      \"last_name\": \"Doe\",\n      \"role\": {\n        \"id\": 2,\n        \"slug\": \"teacher\",\n        \"name\": \"Teacher\"\n      },\n      \"status\": \"ACTIVE\",\n      \"created_at\": \"2024-01-15T10:30:00Z\"\n    }\n  ]\n}\n</code></pre>"},{"location":"LLM-DOCS/BC_STAFF_INVITES/#example-requests","title":"Example Requests","text":"<pre><code># Get all staff members (excluding students)\ncurl \"https://breathecode.herokuapp.com/v1/auth/academy/member\" \\\n  -H \"Authorization: Token YOUR_TOKEN\" \\\n  -H \"Academy: 4\"\n\n# Get only teachers\ncurl \"https://breathecode.herokuapp.com/v1/auth/academy/member?roles=teacher\" \\\n  -H \"Authorization: Token YOUR_TOKEN\" \\\n  -H \"Academy: 4\"\n\n# Get invited but not yet active staff\ncurl \"https://breathecode.herokuapp.com/v1/auth/academy/member?status=INVITED\" \\\n  -H \"Authorization: Token YOUR_TOKEN\" \\\n  -H \"Academy: 4\"\n\n# Search for staff by name\ncurl \"https://breathecode.herokuapp.com/v1/auth/academy/member?like=john\" \\\n  -H \"Authorization: Token YOUR_TOKEN\" \\\n  -H \"Academy: 4\"\n</code></pre>"},{"location":"LLM-DOCS/BC_STAFF_INVITES/#resend-staff-invitation","title":"Resend Staff Invitation","text":"<p>Resend an invitation email to a staff member who hasn't accepted yet.</p>"},{"location":"LLM-DOCS/BC_STAFF_INVITES/#endpoint_3","title":"Endpoint","text":"<p>PUT <code>/v1/auth/academy/member/{profileacademy_id}/invite</code></p> <p>Headers: <pre><code>Authorization: Token &lt;your_token&gt;\nAcademy: &lt;academy_id&gt;\n</code></pre></p> <p>Required Capability: <code>invite_resend</code></p>"},{"location":"LLM-DOCS/BC_STAFF_INVITES/#response_3","title":"Response","text":"<p>Status Code: <code>200 OK</code></p> <pre><code>{\n  \"id\": 789,\n  \"email\": \"john.doe@example.com\",\n  \"first_name\": \"John\",\n  \"last_name\": \"Doe\",\n  \"role\": {\n    \"slug\": \"teacher\",\n    \"name\": \"Teacher\"\n  },\n  \"academy\": {\n    \"id\": 4,\n    \"slug\": \"downtown-miami\",\n    \"name\": \"Downtown Miami\"\n  },\n  \"status\": \"PENDING\",\n  \"sent_at\": \"2024-01-15T10:45:00Z\",\n  \"created_at\": \"2024-01-15T10:30:00Z\"\n}\n</code></pre>"},{"location":"LLM-DOCS/BC_STAFF_INVITES/#rate-limiting","title":"Rate Limiting","text":"<p>Invitations can only be resent after 2 minutes from the last send. If you try to resend before this time, you'll receive an error:</p> <pre><code>{\n  \"detail\": \"Impossible to resend invitation\",\n  \"status_code\": 400,\n  \"slug\": \"sent-at-diff-less-two-minutes\"\n}\n</code></pre>"},{"location":"LLM-DOCS/BC_STAFF_INVITES/#example-request_1","title":"Example Request","text":"<pre><code>curl -X PUT \"https://breathecode.herokuapp.com/v1/auth/academy/member/123/invite\" \\\n  -H \"Authorization: Token YOUR_TOKEN\" \\\n  -H \"Academy: 4\"\n</code></pre>"},{"location":"LLM-DOCS/BC_STAFF_INVITES/#accept-staff-invitation","title":"Accept Staff Invitation","text":"<p>When a staff member receives an invitation email, they need to accept it to join the academy.</p>"},{"location":"LLM-DOCS/BC_STAFF_INVITES/#accept-invitation-flow","title":"Accept Invitation Flow","text":"<ol> <li>User clicks invitation link in email</li> <li>User is redirected to: <code>/v1/auth/member/invite/{token}</code></li> <li>User provides information (if new user):</li> <li>Password</li> <li>Confirms email</li> <li>System creates/updates user account and profile</li> </ol>"},{"location":"LLM-DOCS/BC_STAFF_INVITES/#invitation-token-endpoint","title":"Invitation Token Endpoint","text":"<p>GET <code>/v1/auth/member/invite/{token}</code></p> <p>This endpoint displays a form for the user to accept the invitation.</p>"},{"location":"LLM-DOCS/BC_STAFF_INVITES/#accept-invitation-api","title":"Accept Invitation API","text":"<p>POST <code>/v1/auth/member/invite/{token}</code></p> <p>Request Body (for new users):</p> <pre><code>{\n  \"first_name\": \"John\",\n  \"last_name\": \"Doe\",\n  \"password\": \"securePassword123!\",\n  \"repeat_password\": \"securePassword123!\"\n}\n</code></pre>"},{"location":"LLM-DOCS/BC_STAFF_INVITES/#response_4","title":"Response","text":"<p>Status Code: <code>200 OK</code></p> <pre><code>{\n  \"token\": \"new_authentication_token_here\",\n  \"user\": {\n    \"id\": 456,\n    \"email\": \"john.doe@example.com\",\n    \"first_name\": \"John\",\n    \"last_name\": \"Doe\"\n  },\n  \"profile\": {\n    \"id\": 123,\n    \"role\": {\n      \"slug\": \"teacher\",\n      \"name\": \"Teacher\"\n    },\n    \"academy\": {\n      \"id\": 4,\n      \"slug\": \"downtown-miami\",\n      \"name\": \"Downtown Miami\"\n    },\n    \"status\": \"ACTIVE\"\n  }\n}\n</code></pre>"},{"location":"LLM-DOCS/BC_STAFF_INVITES/#common-use-cases","title":"Common Use Cases","text":""},{"location":"LLM-DOCS/BC_STAFF_INVITES/#1-invite-a-new-teacher","title":"1. Invite a New Teacher","text":"<pre><code>curl -X POST \"https://breathecode.herokuapp.com/v1/auth/academy/member\" \\\n  -H \"Authorization: Token YOUR_TOKEN\" \\\n  -H \"Academy: 4\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"first_name\": \"Maria\",\n    \"last_name\": \"Garcia\",\n    \"email\": \"maria.garcia@example.com\",\n    \"role\": \"teacher\",\n    \"invite\": true\n  }'\n</code></pre>"},{"location":"LLM-DOCS/BC_STAFF_INVITES/#2-promote-existing-user-to-admin","title":"2. Promote Existing User to Admin","text":"<pre><code>curl -X POST \"https://breathecode.herokuapp.com/v1/auth/academy/member\" \\\n  -H \"Authorization: Token YOUR_TOKEN\" \\\n  -H \"Academy: 4\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"user\": 789,\n    \"role\": \"admin\",\n    \"invite\": false\n  }'\n</code></pre>"},{"location":"LLM-DOCS/BC_STAFF_INVITES/#3-list-all-teachers-and-coordinators","title":"3. List All Teachers and Coordinators","text":"<pre><code>curl \"https://breathecode.herokuapp.com/v1/auth/academy/member?roles=teacher,academy_coordinator\" \\\n  -H \"Authorization: Token YOUR_TOKEN\" \\\n  -H \"Academy: 4\"\n</code></pre>"},{"location":"LLM-DOCS/BC_STAFF_INVITES/#4-find-pending-staff-invitations","title":"4. Find Pending Staff Invitations","text":"<pre><code>curl \"https://breathecode.herokuapp.com/v1/auth/academy/member?status=INVITED\" \\\n  -H \"Authorization: Token YOUR_TOKEN\" \\\n  -H \"Academy: 4\"\n</code></pre>"},{"location":"LLM-DOCS/BC_STAFF_INVITES/#5-bulk-invite-staff-members","title":"5. Bulk Invite Staff Members","text":"<pre><code># Invite multiple staff members\nfor email in \"teacher1@example.com\" \"teacher2@example.com\" \"admin@example.com\"; do\n  curl -X POST \"https://breathecode.herokuapp.com/v1/auth/academy/member\" \\\n    -H \"Authorization: Token YOUR_TOKEN\" \\\n    -H \"Academy: 4\" \\\n    -H \"Content-Type: application/json\" \\\n    -d \"{\n      \\\"first_name\\\": \\\"Staff\\\",\n      \\\"last_name\\\": \\\"Member\\\",\n      \\\"email\\\": \\\"$email\\\",\n      \\\"role\\\": \\\"teacher\\\",\n      \\\"invite\\\": true\n    }\"\ndone\n</code></pre>"},{"location":"LLM-DOCS/BC_STAFF_INVITES/#error-handling","title":"Error Handling","text":""},{"location":"LLM-DOCS/BC_STAFF_INVITES/#common-errors","title":"Common Errors","text":""},{"location":"LLM-DOCS/BC_STAFF_INVITES/#email-already-exists","title":"Email Already Exists","text":"<pre><code>{\n  \"detail\": \"User with this email already exists in this academy\",\n  \"status_code\": 400,\n  \"slug\": \"user-exists\"\n}\n</code></pre>"},{"location":"LLM-DOCS/BC_STAFF_INVITES/#invalid-role","title":"Invalid Role","text":"<pre><code>{\n  \"detail\": \"Role not found\",\n  \"status_code\": 404,\n  \"slug\": \"role-not-found\"\n}\n</code></pre>"},{"location":"LLM-DOCS/BC_STAFF_INVITES/#missing-permissions","title":"Missing Permissions","text":"<pre><code>{\n  \"detail\": \"You don't have permission to perform this action\",\n  \"status_code\": 403,\n  \"slug\": \"permission-denied\"\n}\n</code></pre>"},{"location":"LLM-DOCS/BC_STAFF_INVITES/#invitation-not-found","title":"Invitation Not Found","text":"<pre><code>{\n  \"detail\": \"No pending invite was found for this user and academy\",\n  \"status_code\": 404,\n  \"slug\": \"user-invite-not-found\"\n}\n</code></pre>"},{"location":"LLM-DOCS/BC_STAFF_INVITES/#best-practices","title":"Best Practices","text":"<ol> <li> <p>Choose the Right Role: Select the role with the minimum permissions needed for the staff member's responsibilities.</p> </li> <li> <p>Verify Email Addresses: Ensure email addresses are correct before sending invitations to avoid bounced emails.</p> </li> <li> <p>Use Descriptive Names: Provide full first and last names for better identification in the system.</p> </li> <li> <p>Check Existing Members: Before inviting, check if the user already exists to avoid duplicate invitations.</p> </li> <li> <p>Monitor Pending Invitations: Regularly check for pending invitations and resend if necessary.</p> </li> <li> <p>Document Permissions: Keep track of which roles have which capabilities for your organization.</p> </li> <li> <p>Onboarding Process: Have a documented onboarding process for new staff members after they accept invitations.</p> </li> </ol>"},{"location":"LLM-DOCS/BC_STAFF_INVITES/#related-endpoints","title":"Related Endpoints","text":"<ul> <li>List Roles: <code>GET /v1/auth/role</code> - Get all available roles</li> <li>Update Member: <code>PUT /v1/auth/academy/member/{id}</code> - Update staff member details</li> <li>Remove Member: <code>DELETE /v1/auth/academy/member/{id}</code> - Remove staff member from academy</li> <li>Get Member: <code>GET /v1/auth/academy/member/{id}</code> - Get specific staff member details</li> </ul>"},{"location":"LLM-DOCS/BC_STAFF_INVITES/#notes","title":"Notes","text":"<ul> <li>Staff members cannot be students at the same academy simultaneously</li> <li>The <code>student</code> role is handled separately through the student enrollment process</li> <li>Invitations expire after a certain period (check your academy settings)</li> <li>Staff members can be assigned to specific cohorts with different roles</li> <li>Email whitelabeling is applied automatically using the academy's branding</li> </ul>"},{"location":"LLM-DOCS/BC_STAFF_INVITES/#support","title":"Support","text":"<p>For additional support or questions about staff invitations, please contact the 4Geeks development team or refer to the main API documentation.</p>"},{"location":"LLM-DOCS/BUILD_SYLLABUS/","title":"Building with Syllabus and Assets","text":"<p>This guide documents the key endpoints for interacting with syllabi and assets in the BreatheCode API.</p>"},{"location":"LLM-DOCS/BUILD_SYLLABUS/#base-url","title":"Base URL","text":"<p>All endpoints are prefixed with <code>/v1/admissions</code> for syllabus operations and <code>/v1/registry</code> for asset operations.</p>"},{"location":"LLM-DOCS/BUILD_SYLLABUS/#syllabus-endpoints","title":"Syllabus Endpoints","text":""},{"location":"LLM-DOCS/BUILD_SYLLABUS/#listget-syllabi","title":"List/Get Syllabi","text":"<p>Endpoint: <code>GET /v1/admissions/syllabus</code></p> <p>Description: List all syllabi accessible to the user (public + owned by academies they have access to)</p> <p>Query Parameters: - <code>like</code>: Filter by name or slug (case-insensitive)</p> <p>Permission Required: <code>read_syllabus</code></p> <p>Response: Array of syllabus objects</p> <p>Endpoint: <code>GET /v1/admissions/syllabus/{syllabus_id}</code></p> <p>Description: Get a specific syllabus by ID</p> <p>Permission Required: <code>read_syllabus</code></p> <p>Response: Single syllabus object</p> <p>Endpoint: <code>GET /v1/admissions/syllabus/{syllabus_slug}</code></p> <p>Description: Get a specific syllabus by slug</p> <p>Permission Required: <code>read_syllabus</code></p> <p>Response: Single syllabus object</p> <p>Endpoint: <code>GET /v1/admissions/academy/{academy_id}/syllabus</code></p> <p>Description: List all syllabi for a specific academy</p> <p>Permission Required: <code>read_syllabus</code></p> <p>Response: Array of syllabus objects</p> <p>Endpoint: <code>GET /v1/admissions/academy/{academy_id}/syllabus/{syllabus_id}</code></p> <p>Description: Get a specific syllabus for an academy by ID</p> <p>Permission Required: <code>read_syllabus</code></p> <p>Response: Single syllabus object</p> <p>Endpoint: <code>GET /v1/admissions/academy/{academy_id}/syllabus/{syllabus_slug}</code></p> <p>Description: Get a specific syllabus for an academy by slug</p> <p>Permission Required: <code>read_syllabus</code></p> <p>Response: Single syllabus object</p> <p>Endpoint: <code>GET /v1/admissions/public/syllabus</code></p> <p>Description: Get public syllabi (no authentication required)</p> <p>Response: Array of public syllabus objects</p>"},{"location":"LLM-DOCS/BUILD_SYLLABUS/#create-syllabus","title":"Create Syllabus","text":"<p>Endpoint: <code>POST /v1/admissions/academy/{academy_id}/syllabus</code></p> <p>Description: Create a new syllabus for an academy</p> <p>Permission Required: <code>crud_syllabus</code></p> <p>Request Body: <pre><code>{\n  \"slug\": \"web-development-fundamentals\",\n  \"name\": \"Web Development Fundamentals\",\n  \"description\": \"Learn the basics of web development\",\n  \"private\": false\n}\n</code></pre></p> <p>Required Fields: - <code>slug</code>: Unique identifier for the syllabus - <code>name</code>: Display name of the syllabus</p> <p>Response: Created syllabus object (HTTP 201)</p>"},{"location":"LLM-DOCS/BUILD_SYLLABUS/#update-syllabus","title":"Update Syllabus","text":"<p>Endpoint: <code>PUT /v1/admissions/academy/{academy_id}/syllabus/{syllabus_id}</code></p> <p>Description: Update an existing syllabus by ID</p> <p>Permission Required: <code>crud_syllabus</code></p> <p>Request Body: <pre><code>{\n  \"name\": \"Updated Syllabus Name\",\n  \"description\": \"Updated description\",\n  \"private\": true\n}\n</code></pre></p> <p>Notes: - Cannot set <code>slug</code> or <code>name</code> to empty strings - Only the academy owner can update the syllabus</p> <p>Response: Updated syllabus object (HTTP 200)</p> <p>Endpoint: <code>PUT /v1/admissions/academy/{academy_id}/syllabus/{syllabus_slug}</code></p> <p>Description: Update an existing syllabus by slug</p> <p>Permission Required: <code>crud_syllabus</code></p> <p>Response: Updated syllabus object (HTTP 200)</p>"},{"location":"LLM-DOCS/BUILD_SYLLABUS/#syllabus-version-endpoints","title":"Syllabus Version Endpoints","text":""},{"location":"LLM-DOCS/BUILD_SYLLABUS/#listget-syllabus-versions","title":"List/Get Syllabus Versions","text":"<p>Endpoint: <code>GET /v1/admissions/syllabus/{syllabus_id}/version</code></p> <p>Description: List all versions of a syllabus</p> <p>Permission Required: <code>read_syllabus</code></p> <p>Query Parameters: - <code>status</code>: Filter by status (comma-separated: <code>PUBLISHED</code>, <code>DRAFT</code>, etc.)</p> <p>Response: Array of syllabus version objects</p> <p>Endpoint: <code>GET /v1/admissions/syllabus/{syllabus_slug}/version</code></p> <p>Description: List all versions of a syllabus by slug</p> <p>Permission Required: <code>read_syllabus</code></p> <p>Response: Array of syllabus version objects</p> <p>Endpoint: <code>GET /v1/admissions/syllabus/{syllabus_id}/version/{version}</code></p> <p>Description: Get a specific version of a syllabus</p> <p>Permission Required: <code>read_syllabus</code></p> <p>Special Values: - <code>version=latest</code>: Gets the latest published version</p> <p>Response: Single syllabus version object</p> <p>Endpoint: <code>GET /v1/admissions/syllabus/{syllabus_slug}/version/{version}</code></p> <p>Description: Get a specific version of a syllabus by slug</p> <p>Permission Required: <code>read_syllabus</code></p> <p>Response: Single syllabus version object</p> <p>Endpoint: <code>GET /v1/admissions/academy/{academy_id}/syllabus/{syllabus_id}/version</code></p> <p>Description: List all versions for an academy's syllabus</p> <p>Permission Required: <code>read_syllabus</code></p> <p>Response: Array of syllabus version objects</p> <p>Endpoint: <code>GET /v1/admissions/academy/{academy_id}/syllabus/{syllabus_id}/version/{version}</code></p> <p>Description: Get a specific version of an academy's syllabus</p> <p>Permission Required: <code>read_syllabus</code></p> <p>Response: Single syllabus version object</p> <p>Endpoint: <code>GET /v1/admissions/syllabus/version</code></p> <p>Description: Get all syllabus versions across all syllabi</p> <p>Permission Required: <code>read_syllabus</code></p> <p>Response: Array of all syllabus version objects</p>"},{"location":"LLM-DOCS/BUILD_SYLLABUS/#create-syllabus-version","title":"Create Syllabus Version","text":"<p>Endpoint: <code>POST /v1/admissions/syllabus/{syllabus_id}/version</code></p> <p>Description: Create a new version of a syllabus</p> <p>Permission Required: <code>crud_syllabus</code></p> <p>Request Body: <pre><code>{\n  \"json\": {\n    \"days\": [],\n    \"weeks\": []\n  },\n  \"status\": \"DRAFT\",\n  \"integrity_check_at\": null,\n  \"integrity_status\": \"PENDING\"\n}\n</code></pre></p> <p>Response: Created syllabus version object (HTTP 201)</p> <p>Endpoint: <code>POST /v1/admissions/syllabus/{syllabus_slug}/version</code></p> <p>Description: Create a new version of a syllabus by slug</p> <p>Permission Required: <code>crud_syllabus</code></p> <p>Response: Created syllabus version object (HTTP 201)</p> <p>Endpoint: <code>POST /v1/admissions/academy/{academy_id}/syllabus/{syllabus_id}/version</code></p> <p>Description: Create a new version for an academy's syllabus</p> <p>Permission Required: <code>crud_syllabus</code></p> <p>Response: Created syllabus version object (HTTP 201)</p>"},{"location":"LLM-DOCS/BUILD_SYLLABUS/#update-syllabus-version","title":"Update Syllabus Version","text":"<p>Endpoint: <code>PUT /v1/admissions/syllabus/{syllabus_id}/version/{version}</code></p> <p>Description: Update a specific version of a syllabus</p> <p>Permission Required: <code>crud_syllabus</code></p> <p>Request Body: <pre><code>{\n  \"json\": {\n    \"days\": [],\n    \"weeks\": []\n  },\n  \"status\": \"PUBLISHED\"\n}\n</code></pre></p> <p>Notes: - Version must be numeric - Only the academy owner can update</p> <p>Response: Updated syllabus version object (HTTP 200)</p> <p>Endpoint: <code>PUT /v1/admissions/syllabus/{syllabus_slug}/version/{version}</code></p> <p>Description: Update a specific version of a syllabus by slug</p> <p>Permission Required: <code>crud_syllabus</code></p> <p>Response: Updated syllabus version object (HTTP 200)</p> <p>Endpoint: <code>PUT /v1/admissions/academy/{academy_id}/syllabus/{syllabus_id}/version/{version}</code></p> <p>Description: Update a specific version for an academy's syllabus</p> <p>Permission Required: <code>crud_syllabus</code></p> <p>Response: Updated syllabus version object (HTTP 200)</p>"},{"location":"LLM-DOCS/BUILD_SYLLABUS/#exportpreview-syllabus-version","title":"Export/Preview Syllabus Version","text":"<p>Endpoint: <code>GET /v1/admissions/syllabus/{syllabus_id}/version/{version}.csv</code></p> <p>Description: Export a syllabus version as CSV</p> <p>Permission Required: <code>read_syllabus</code></p> <p>Response: CSV file download</p> <p>Endpoint: <code>GET /v1/admissions/syllabus/{syllabus_id}/version/{version}/preview</code></p> <p>Description: Preview a syllabus version in HTML format</p> <p>Permission Required: <code>read_syllabus</code></p> <p>Response: HTML preview</p>"},{"location":"LLM-DOCS/BUILD_SYLLABUS/#admin-endpoints","title":"Admin Endpoints","text":"<p>Endpoint: <code>PUT /v1/admissions/admin/syllabus/asset/{asset_slug}</code></p> <p>Description: Replace an asset slug across all syllabus versions</p> <p>Permission Required: Superuser</p> <p>Response: Summary of changes made</p>"},{"location":"LLM-DOCS/BUILD_SYLLABUS/#asset-endpoints","title":"Asset Endpoints","text":""},{"location":"LLM-DOCS/BUILD_SYLLABUS/#listget-public-assets","title":"List/Get Public Assets","text":"<p>Endpoint: <code>GET /v1/registry/asset</code></p> <p>Description: List all public assets</p> <p>Query Parameters: - <code>academy</code>: Filter by academy ID(s) (comma-separated) - <code>asset_type</code>: Filter by asset type (e.g., <code>LESSON</code>, <code>ARTICLE</code>, <code>EXERCISE</code>, <code>PROJECT</code>) - <code>category</code>: Filter by category slug(s) (comma-separated) - <code>exclude_category</code>: Exclude category slug(s) (comma-separated) - <code>technologies</code>: Filter by technology slug(s) (comma-separated) - <code>exclude_technologies</code>: Exclude technology slug(s) (comma-separated) - <code>language</code>: Filter by language code - <code>video</code>: Filter assets with video (<code>true</code>) - <code>external</code>: Filter external assets (<code>true</code>, <code>false</code>, or <code>both</code>) - <code>like</code>: Search by title, slug, or content - <code>status</code>: Filter by status (default shows only <code>PUBLISHED</code>) - <code>visibility</code>: Filter by visibility (default is <code>PUBLIC</code>) - <code>need_translation</code>: Show assets needing translation (<code>true</code>) - <code>authors_username</code>: Filter by author username(s) (comma-separated) - <code>big</code>: Return extended asset information - <code>expand</code>: Expand related objects (e.g., <code>technologies,category</code>)</p> <p>Response: Array of public asset objects</p> <p>Endpoint: <code>GET /v1/registry/asset/{asset_slug}</code></p> <p>Description: Get a specific public asset by slug</p> <p>Response: Single asset object</p>"},{"location":"LLM-DOCS/BUILD_SYLLABUS/#listget-users-assets","title":"List/Get User's Assets","text":"<p>Endpoint: <code>GET /v1/registry/asset/me</code></p> <p>Description: List assets created or owned by the authenticated user</p> <p>Permission Required: <code>learnpack_create_package</code></p> <p>Query Parameters: Same as public asset endpoint</p> <p>Response: Array of user's asset objects</p> <p>Endpoint: <code>GET /v1/registry/asset/me/{asset_slug}</code></p> <p>Description: Get a specific asset owned by the user</p> <p>Permission Required: <code>learnpack_create_package</code></p> <p>Response: Single asset object</p>"},{"location":"LLM-DOCS/BUILD_SYLLABUS/#listget-academy-assets","title":"List/Get Academy Assets","text":"<p>Endpoint: <code>GET /v1/registry/academy/asset</code></p> <p>Description: List all assets for an academy (includes public assets and academy-specific assets)</p> <p>Permission Required: <code>read_asset</code></p> <p>Query Parameters: - All query parameters from public asset endpoint, plus: - <code>author</code>: Filter by author ID - <code>owner</code>: Filter by owner ID - <code>like</code>: Search by slug, title, readme_url, url, or alias slug - <code>asset_type</code>: Filter by asset type - <code>category</code>: Filter by category slug(s) - <code>exclude_category</code>: Exclude category slug(s) - <code>technologies</code>: Filter by technology slug(s) - <code>exclude_technologies</code>: Exclude technology slug(s) - <code>language</code>: Filter by language - <code>status</code>: Filter by status - <code>visibility</code>: Filter by visibility - <code>test_status</code>: Filter by test status - <code>sync_status</code>: Filter by sync status - <code>published</code>: Filter by published status - <code>slug</code>: Filter by exact slug(s) (comma-separated) - <code>interactive</code>: Filter interactive assets</p> <p>Notes: - Content writers can only see assets they authored - Returns assets belonging to the academy or public assets</p> <p>Response: Array of academy asset objects</p> <p>Endpoint (v1): <code>GET /v1/registry/academy/asset/{asset_slug_or_id}</code></p> <p>Description: Get a specific asset for an academy by slug or ID</p> <p>Permission Required: <code>read_asset</code></p> <p>Response: Single academy asset object</p> <p>Endpoint (v2): <code>GET /v2/registry/academy/asset/{asset_slug}</code></p> <p>Description: Get a specific asset for an academy (v2 with consumption tracking)</p> <p>Permission Required: <code>read_asset</code></p> <p>Consumption: <code>read_lesson</code> (tracks asset consumption)</p> <p>Response: Single academy asset object</p>"},{"location":"LLM-DOCS/BUILD_SYLLABUS/#create-asset","title":"Create Asset","text":"<p>Endpoint: <code>POST /v1/registry/asset/me</code></p> <p>Description: Create a new asset for the authenticated user</p> <p>Permission Required: <code>learnpack_create_package</code></p> <p>Request Body: <pre><code>{\n  \"slug\": \"intro-to-python\",\n  \"title\": \"Introduction to Python\",\n  \"asset_type\": \"LESSON\",\n  \"category\": 1,\n  \"lang\": \"en\",\n  \"readme\": \"# Introduction to Python\\n\\nThis is the content...\",\n  \"visibility\": \"PUBLIC\",\n  \"status\": \"DRAFT\",\n  \"technologies\": [1, 2, 3]\n}\n</code></pre></p> <p>Required Fields: - <code>slug</code>: Unique identifier - <code>title</code>: Display title - <code>asset_type</code>: Type of asset - <code>category</code>: Category ID</p> <p>Response: Created asset object (HTTP 201)</p> <p>Endpoint: <code>POST /v1/registry/academy/asset</code></p> <p>Description: Create a new asset for an academy</p> <p>Permission Required: <code>crud_asset</code></p> <p>Request Body: Same as above, asset is automatically assigned to the academy</p> <p>Response: Created asset object (HTTP 201)</p>"},{"location":"LLM-DOCS/BUILD_SYLLABUS/#update-asset","title":"Update Asset","text":"<p>Endpoint: <code>PUT /v1/registry/asset/me/{asset_slug}</code></p> <p>Description: Update an existing asset owned by the user</p> <p>Permission Required: <code>learnpack_create_package</code></p> <p>Request Body: <pre><code>{\n  \"title\": \"Updated Title\",\n  \"readme\": \"# Updated content...\",\n  \"status\": \"PUBLISHED\"\n}\n</code></pre></p> <p>Notes: - Can update single asset or multiple assets (send array) - User must be the author or owner of the asset</p> <p>Response: Updated asset object (HTTP 200)</p> <p>Endpoint: <code>PUT /v1/registry/academy/asset/{asset_slug_or_id}</code></p> <p>Description: Update an existing asset for an academy</p> <p>Permission Required: <code>crud_asset</code></p> <p>Request Body: Same as above</p> <p>Notes: - Asset must belong to the academy or be public (and will be claimed by the academy)</p> <p>Response: Updated asset object (HTTP 200)</p>"},{"location":"LLM-DOCS/BUILD_SYLLABUS/#asset-actions","title":"Asset Actions","text":"<p>Endpoint: <code>POST /v1/registry/academy/asset/action/{action_slug}</code></p> <p>Description: Perform bulk actions on multiple assets</p> <p>Permission Required: <code>crud_asset</code></p> <p>Available Actions: - <code>test</code>: Run automated tests on the assets - <code>pull</code>: Pull latest changes from GitHub - <code>push</code>: Push changes to GitHub (ARTICLE, LESSON, QUIZ only) - <code>analyze_seo</code>: Analyze SEO performance - <code>claim_asset</code>: Claim an unowned asset for the academy - <code>create_repo</code>: Create a GitHub repository for the asset</p> <p>Request Body: <pre><code>{\n  \"assets\": [\"intro-to-python\", \"python-loops\", \"python-functions\"],\n  \"override_meta\": false\n}\n</code></pre></p> <p>Response: Array of successfully processed assets</p> <p>Endpoint: <code>PUT /v1/registry/academy/asset/{asset_slug}/action/{action_slug}</code></p> <p>Description: Perform an action on a single asset</p> <p>Permission Required: <code>crud_asset</code></p> <p>Available Actions: Same as above</p> <p>Request Body: <pre><code>{\n  \"override_meta\": false\n}\n</code></pre></p> <p>Response: Updated asset object (HTTP 200)</p>"},{"location":"LLM-DOCS/BUILD_SYLLABUS/#asset-relations-and-metadata","title":"Asset Relations and Metadata","text":"<p>Endpoint: <code>GET /v1/registry/asset/{asset_id}/context</code></p> <p>Description: Get context information for an asset</p> <p>Response: Context object with related assets and metadata</p> <p>Endpoint: <code>GET /v1/registry/asset/{asset_slug}/supersedes</code></p> <p>Description: Get assets that are superseded by this asset</p> <p>Permission Required: <code>read_asset</code></p> <p>Response: Array of superseded assets</p> <p>Endpoint: <code>GET /v1/registry/asset/{asset_slug}/github/config</code></p> <p>Description: Get GitHub configuration for an asset</p> <p>Response: GitHub config object</p> <p>Endpoint: <code>GET /v1/registry/asset/{asset_slug}.{extension}</code></p> <p>Description: Get asset readme in specific format</p> <p>Extensions: <code>md</code>, <code>json</code>, <code>html</code></p> <p>Response: Rendered content in requested format</p> <p>Endpoint: <code>GET /v1/registry/asset/preview/{asset_slug}</code></p> <p>Description: Preview asset in HTML</p> <p>Response: HTML preview</p> <p>Endpoint: <code>GET /v1/registry/asset/thumbnail/{asset_slug}</code></p> <p>Description: Get or generate asset thumbnail</p> <p>Response: Image URL or generated thumbnail</p> <p>Endpoint: <code>PUT /v1/registry/academy/asset/{asset_slug}/thumbnail</code></p> <p>Description: Update asset thumbnail</p> <p>Permission Required: <code>crud_asset</code></p> <p>Response: Updated thumbnail URL</p>"},{"location":"LLM-DOCS/BUILD_SYLLABUS/#asset-comments","title":"Asset Comments","text":"<p>Endpoint: <code>GET /v1/registry/academy/asset/comment</code></p> <p>Description: List all comments on academy assets</p> <p>Permission Required: <code>read_asset</code></p> <p>Query Parameters: - <code>asset</code>: Filter by asset slug - <code>status</code>: Filter by comment status - <code>author</code>: Filter by author ID</p> <p>Response: Array of comment objects</p> <p>Endpoint: <code>POST /v1/registry/academy/asset/comment</code></p> <p>Description: Create a new comment on an asset</p> <p>Permission Required: <code>crud_asset</code></p> <p>Request Body: <pre><code>{\n  \"asset\": 1,\n  \"text\": \"This needs improvement...\",\n  \"status\": \"PENDING\"\n}\n</code></pre></p> <p>Response: Created comment object (HTTP 201)</p> <p>Endpoint: <code>PUT /v1/registry/academy/asset/comment/{comment_id}</code></p> <p>Description: Update an existing comment</p> <p>Permission Required: <code>crud_asset</code></p> <p>Response: Updated comment object (HTTP 200)</p> <p>Endpoint: <code>DELETE /v1/registry/academy/asset/comment/{comment_id}</code></p> <p>Description: Delete a comment</p> <p>Permission Required: <code>crud_asset</code></p> <p>Response: HTTP 204 (No Content)</p>"},{"location":"LLM-DOCS/BUILD_SYLLABUS/#asset-errors","title":"Asset Errors","text":"<p>Endpoint: <code>GET /v1/registry/academy/asset/error</code></p> <p>Description: List all errors for academy assets</p> <p>Permission Required: <code>read_asset</code></p> <p>Query Parameters: - <code>asset</code>: Filter by asset slug - <code>status</code>: Filter by error status</p> <p>Response: Array of error objects</p> <p>Endpoint: <code>PUT /v1/registry/academy/asset/error</code></p> <p>Description: Update multiple errors (bulk operation)</p> <p>Permission Required: <code>crud_asset_error</code></p> <p>Response: Array of updated error objects</p> <p>Endpoint: <code>DELETE /v1/registry/academy/asset/error/{error_id}</code></p> <p>Description: Delete a specific error</p> <p>Permission Required: <code>crud_asset_error</code></p> <p>Response: HTTP 204 (No Content)</p> <p>Endpoint: <code>DELETE /v1/registry/academy/asset/error</code></p> <p>Description: Delete multiple errors (bulk operation)</p> <p>Permission Required: <code>crud_asset_error</code></p> <p>Query Parameters: Use filter parameters like <code>id=1,2,3</code></p> <p>Response: HTTP 204 (No Content)</p>"},{"location":"LLM-DOCS/BUILD_SYLLABUS/#asset-aliases","title":"Asset Aliases","text":"<p>Endpoint: <code>GET /v1/registry/academy/asset/alias</code></p> <p>Description: List all asset aliases for an academy</p> <p>Permission Required: <code>read_asset</code></p> <p>Response: Array of alias objects</p> <p>Endpoint: <code>GET /v1/registry/academy/asset/alias/{alias_slug}</code></p> <p>Description: Get a specific alias</p> <p>Permission Required: <code>read_asset</code></p> <p>Response: Single alias object</p> <p>Endpoint: <code>DELETE /v1/registry/academy/asset/alias/{alias_slug}</code></p> <p>Description: Delete an asset alias</p> <p>Permission Required: <code>crud_asset</code></p> <p>Notes: - Cannot delete an alias if it's the same as the asset's main slug (must rename asset first)</p> <p>Response: HTTP 204 (No Content)</p>"},{"location":"LLM-DOCS/BUILD_SYLLABUS/#seo-and-quality","title":"SEO and Quality","text":"<p>Endpoint: <code>GET /v1/registry/academy/asset/{asset_slug}/seo_report</code></p> <p>Description: Get SEO analysis report for an asset</p> <p>Permission Required: <code>read_asset</code></p> <p>Response: SEO report object</p> <p>Endpoint: <code>GET /v1/registry/academy/asset/{asset_slug}/originality</code></p> <p>Description: Get originality/plagiarism check for an asset</p> <p>Permission Required: <code>read_asset</code></p> <p>Response: Originality report object</p>"},{"location":"LLM-DOCS/BUILD_SYLLABUS/#asset-images","title":"Asset Images","text":"<p>Endpoint: <code>GET /v1/registry/academy/asset/image</code></p> <p>Description: List all images used in academy assets</p> <p>Permission Required: <code>read_asset</code></p> <p>Query Parameters: - <code>slug</code>: Filter by asset slug(s) - <code>download_status</code>: Filter by download status - <code>original_url</code>: Filter by original URL</p> <p>Response: Array of asset image objects</p>"},{"location":"LLM-DOCS/BUILD_SYLLABUS/#permission-requirements","title":"Permission Requirements","text":""},{"location":"LLM-DOCS/BUILD_SYLLABUS/#syllabus-permissions","title":"Syllabus Permissions","text":"<ul> <li><code>read_syllabus</code>: View syllabi and versions</li> <li><code>crud_syllabus</code>: Create, update, and delete syllabi and versions</li> </ul>"},{"location":"LLM-DOCS/BUILD_SYLLABUS/#asset-permissions","title":"Asset Permissions","text":"<ul> <li><code>read_asset</code>: View assets</li> <li><code>crud_asset</code>: Create, update assets</li> <li><code>crud_asset_error</code>: Manage asset errors</li> <li><code>learnpack_create_package</code>: Create/update personal assets</li> </ul>"},{"location":"LLM-DOCS/BUILD_SYLLABUS/#common-patterns","title":"Common Patterns","text":""},{"location":"LLM-DOCS/BUILD_SYLLABUS/#filtering-by-academy","title":"Filtering by Academy","text":"<p>Many endpoints support filtering by academy:</p> <pre><code>GET /v1/registry/asset?academy=1,2,3\n</code></pre> <p>This returns assets from academies 1, 2, and 3, plus public assets.</p>"},{"location":"LLM-DOCS/BUILD_SYLLABUS/#searching-assets","title":"Searching Assets","text":"<p>Use the <code>like</code> parameter for fuzzy search:</p> <pre><code>GET /v1/registry/academy/asset?like=python\n</code></pre> <p>This searches in slug, title, readme_url, url, and alias slugs.</p>"},{"location":"LLM-DOCS/BUILD_SYLLABUS/#pagination","title":"Pagination","text":"<p>Most list endpoints support pagination:</p> <pre><code>GET /v1/registry/academy/asset?limit=20&amp;offset=40\n</code></pre>"},{"location":"LLM-DOCS/BUILD_SYLLABUS/#expanding-relations","title":"Expanding Relations","text":"<p>Use the <code>expand</code> parameter to include related objects:</p> <pre><code>GET /v1/registry/asset?expand=technologies,category,author\n</code></pre>"},{"location":"LLM-DOCS/BUILD_SYLLABUS/#getting-latest-version","title":"Getting Latest Version","text":"<p>To get the latest published version of a syllabus:</p> <pre><code>GET /v1/admissions/syllabus/{syllabus_id}/version/latest\n</code></pre>"},{"location":"LLM-DOCS/BUILD_SYLLABUS/#notes","title":"Notes","text":"<ul> <li>All endpoints require appropriate authentication unless explicitly marked as public</li> <li>Academy-scoped endpoints require the user to be a member of the academy</li> <li>Assets can be either academy-specific or public (shared across academies)</li> <li>Syllabi are owned by academies but can be marked as private or public</li> <li>Asset types include: <code>LESSON</code>, <code>ARTICLE</code>, <code>EXERCISE</code>, <code>PROJECT</code>, <code>QUIZ</code>, <code>VIDEO</code>, etc.</li> <li>Syllabus versions can have status: <code>DRAFT</code>, <code>PUBLISHED</code>, etc.</li> </ul>"},{"location":"LLM-DOCS/COHORTS/","title":"Cohort Information API Endpoints","text":"<p>This document provides a comprehensive list of all API endpoints needed to gather complete information about a cohort, including students, teachers, syllabus, schedule, feedback, and activity data.</p>"},{"location":"LLM-DOCS/COHORTS/#core-cohort-information","title":"Core Cohort Information","text":""},{"location":"LLM-DOCS/COHORTS/#1-get-cohort-details","title":"1. Get Cohort Details","text":"<p>Endpoint: <code>GET /v1/admissions/academy/cohort/{cohort_id}</code> - Purpose: Get basic cohort information (name, dates, stage, syllabus, etc.) - Parameters: <code>cohort_id</code> (can be numeric ID or slug) - Response includes:   - Basic info: <code>id</code>, <code>slug</code>, <code>name</code>, <code>kickoff_date</code>, <code>ending_date</code>, <code>current_day</code>, <code>stage</code>   - Syllabus: <code>syllabus_version</code> with syllabus details and technologies   - Schedule: <code>schedule</code> information   - Academy: <code>academy</code> details   - Settings: <code>private</code>, <code>never_ends</code>, <code>remote_available</code>, <code>timezone</code>   - Micro-cohorts: <code>micro_cohorts</code> if applicable</p>"},{"location":"LLM-DOCS/COHORTS/#2-get-current-users-cohorts","title":"2. Get Current User's Cohorts","text":"<p>Endpoint: <code>GET /v1/admissions/academy/cohort/me</code> - Purpose: Get cohorts for the authenticated user - Query Parameters:   - <code>upcoming=true/false</code> - Filter by upcoming/past cohorts   - <code>stage=INACTIVE,PREWORK,STARTED,FINAL_PROJECT,ENDED</code> - Filter by stage - Response: List of cohorts the user belongs to</p>"},{"location":"LLM-DOCS/COHORTS/#students-teachers-and-staff","title":"Students, Teachers, and Staff","text":""},{"location":"LLM-DOCS/COHORTS/#3-get-cohort-users-students-teachers-tas-reviewers","title":"3. Get Cohort Users (Students, Teachers, TAs, Reviewers)","text":"<p>Endpoint: <code>GET /v1/admissions/academy/cohort/{cohort_id}/user</code> - Purpose: Get all users in a specific cohort - Query Parameters:   - <code>roles=STUDENT,TEACHER,ASSISTANT,REVIEWER</code> - Filter by role   - <code>educational_status=ACTIVE,POSTPONED,SUSPENDED,GRADUATED,DROPPED,NOT_COMPLETING</code>   - <code>finantial_status=FULLY_PAID,UP_TO_DATE,LATE</code>   - <code>tasks=true</code> - Include task information   - <code>plans=true</code> - Include plan information - Response includes:   - User details: <code>id</code>, <code>first_name</code>, <code>last_name</code>, <code>email</code>, <code>github</code>   - Role: <code>role</code> (STUDENT, TEACHER, ASSISTANT, REVIEWER)   - Status: <code>educational_status</code>, <code>finantial_status</code>   - Cohort info: <code>cohort</code> details   - Tasks: If <code>tasks=true</code>, includes assignment data   - Plans: If <code>plans=true</code>, includes subscription/plan data</p>"},{"location":"LLM-DOCS/COHORTS/#4-get-specific-user-in-cohort","title":"4. Get Specific User in Cohort","text":"<p>Endpoint: <code>GET /v1/admissions/academy/cohort/{cohort_id}/user/{user_id}</code> - Purpose: Get detailed information about a specific user in the cohort - Response: Detailed user information with cohort-specific data</p>"},{"location":"LLM-DOCS/COHORTS/#syllabus-and-technologies","title":"Syllabus and Technologies","text":""},{"location":"LLM-DOCS/COHORTS/#5-get-syllabus-information","title":"5. Get Syllabus Information","text":"<p>Endpoint: <code>GET /v1/admissions/public/syllabus</code> - Purpose: Get syllabus details including technologies - Query Parameters:   - <code>id={syllabus_id}</code> - Get specific syllabus - Response includes:   - <code>name</code>, <code>slug</code>, <code>main_technologies</code> (comma-separated)   - <code>duration_in_hours</code>, <code>duration_in_days</code>, <code>week_hours</code>   - <code>github_url</code>, <code>logo</code>   - <code>private</code>, <code>is_documentation</code></p>"},{"location":"LLM-DOCS/COHORTS/#6-get-syllabus-versions","title":"6. Get Syllabus Versions","text":"<p>Endpoint: <code>GET /v1/admissions/academy/syllabus/version</code> - Purpose: Get all syllabus versions for an academy - Response: List of syllabus versions with detailed information</p>"},{"location":"LLM-DOCS/COHORTS/#schedule-and-time-slots","title":"Schedule and Time Slots","text":""},{"location":"LLM-DOCS/COHORTS/#7-get-cohort-time-slots","title":"7. Get Cohort Time Slots","text":"<p>Endpoint: <code>GET /v1/admissions/academy/cohort/{cohort_id}/timeslot</code> - Purpose: Get schedule/time slots for the cohort - Query Parameters:   - <code>recurrency_type=DAILY,WEEKLY,MONTHLY</code> - Filter by recurrence - Response includes:   - <code>starting_at</code>, <code>ending_at</code>   - <code>recurrent</code>, <code>recurrency_type</code>   - <code>timezone</code></p>"},{"location":"LLM-DOCS/COHORTS/#8-get-specific-time-slot","title":"8. Get Specific Time Slot","text":"<p>Endpoint: <code>GET /v1/admissions/academy/cohort/{cohort_id}/timeslot/{timeslot_id}</code> - Purpose: Get details of a specific time slot</p>"},{"location":"LLM-DOCS/COHORTS/#assignments-and-tasks","title":"Assignments and Tasks","text":""},{"location":"LLM-DOCS/COHORTS/#9-get-cohort-tasksassignments","title":"9. Get Cohort Tasks/Assignments","text":"<p>Endpoint: <code>GET /v1/assignments/academy/cohort/{cohort_id}/task</code> - Purpose: Get all tasks/assignments for the cohort - Query Parameters:   - <code>task_type=EXERCISE,PROJECT,QUIZ,LESSON</code> - Filter by task type   - <code>task_status=PENDING,STARTED,COMPLETED</code> - Filter by status   - <code>revision_status=PENDING,APPROVED,REJECTED</code> - Filter by revision status   - <code>educational_status=ACTIVE,GRADUATED</code> - Filter by student status   - <code>student={user_ids}</code> - Filter by specific students   - <code>like={search_term}</code> - Search in title/associated_slug - Response includes:   - Task details: <code>id</code>, <code>title</code>, <code>description</code>, <code>task_type</code>   - Status: <code>task_status</code>, <code>revision_status</code>   - User: <code>user</code> information   - Cohort: <code>cohort</code> information   - Delivery: <code>github_url</code>, <code>live_url</code>, <code>delivery_date</code></p>"},{"location":"LLM-DOCS/COHORTS/#10-get-student-tasks","title":"10. Get Student Tasks","text":"<p>Endpoint: <code>GET /v1/assignments/user/me/task</code> - Purpose: Get tasks for the authenticated user - Query Parameters:   - <code>cohort={cohort_id_or_slug}</code> - Filter by cohort   - <code>task_type</code>, <code>task_status</code>, <code>revision_status</code> - Same as above   - <code>associated_slug={slug}</code> - Filter by syllabus module</p>"},{"location":"LLM-DOCS/COHORTS/#activity-timeline","title":"Activity Timeline","text":""},{"location":"LLM-DOCS/COHORTS/#11-get-cohort-activity","title":"11. Get Cohort Activity","text":"<p>Endpoint: <code>GET /v1/activity/cohort/{cohort_id}</code> - Purpose: Get activity timeline for the cohort - Query Parameters:   - <code>slug={activity_type}</code> - Filter by activity type   - Available activities: <code>breathecode_login</code>, <code>classroom_attendance</code>, <code>lesson_opened</code>, <code>exercise_success</code>, <code>nps_survey_answered</code>, etc. - Response includes:   - Activity details: <code>slug</code>, <code>data</code>, <code>day</code>, <code>created_at</code>   - User: <code>user_id</code>, <code>email</code>   - Cohort: <code>cohort</code> slug</p>"},{"location":"LLM-DOCS/COHORTS/#12-get-student-activity","title":"12. Get Student Activity","text":"<p>Endpoint: <code>GET /v1/activity/academy/student/{student_id}</code> - Purpose: Get activity timeline for a specific student - Query Parameters:   - <code>slug={activity_type}</code> - Filter by activity type   - <code>cohort={cohort_slug}</code> - Filter by cohort</p>"},{"location":"LLM-DOCS/COHORTS/#13-get-my-activity","title":"13. Get My Activity","text":"<p>Endpoint: <code>GET /v1/activity/me</code> - Purpose: Get activity for the authenticated user - Query Parameters:   - <code>slug={activity_type}</code>, <code>cohort={cohort_slug}</code>, <code>user_id</code>, <code>email</code></p>"},{"location":"LLM-DOCS/COHORTS/#cohort-history-and-logs","title":"Cohort History and Logs","text":""},{"location":"LLM-DOCS/COHORTS/#14-get-cohort-history-log","title":"14. Get Cohort History Log","text":"<p>Endpoint: <code>GET /v1/admissions/academy/cohort/{cohort_id}/log</code> - Purpose: Get detailed cohort history and daily logs - Response includes:   - Daily logs with attendance, progress, and notes   - Current day information   - Historical data for each day</p>"},{"location":"LLM-DOCS/COHORTS/#15-get-user-cohort-history","title":"15. Get User Cohort History","text":"<p>Endpoint: <code>GET /v1/admissions/me/cohort/user/log</code> - Purpose: Get user's cohort history - Query Parameters:   - <code>cohort_id={id}</code> - Get history for specific cohort - Response: User's history log for cohorts</p>"},{"location":"LLM-DOCS/COHORTS/#nps-and-feedback","title":"NPS and Feedback","text":""},{"location":"LLM-DOCS/COHORTS/#16-get-cohort-surveys","title":"16. Get Cohort Surveys","text":"<p>Endpoint: <code>GET /v1/feedback/academy/survey</code> - Purpose: Get surveys for the academy - Query Parameters:   - <code>cohort={cohort_id}</code> - Filter by cohort - Response includes:   - Survey details: <code>id</code>, <code>title</code>, <code>status</code>, <code>created_at</code>, <code>sent_at</code>   - Cohort: <code>cohort</code> information   - Scores: <code>scores</code> (NPS scores)   - Response rate: <code>response_rate</code></p>"},{"location":"LLM-DOCS/COHORTS/#17-get-survey-answers","title":"17. Get Survey Answers","text":"<p>Endpoint: <code>GET /v1/feedback/academy/answer</code> - Purpose: Get NPS/feedback answers - Query Parameters:   - <code>cohort={cohort_slugs}</code> - Filter by cohort   - <code>user={user_ids}</code> - Filter by users   - <code>score={score}</code> - Filter by NPS score   - <code>status=PENDING,SENT,ANSWERED</code> - Filter by status   - <code>survey={survey_ids}</code> - Filter by survey - Response includes:   - Answer details: <code>id</code>, <code>score</code>, <code>comment</code>, <code>status</code>   - User: <code>user</code> information   - Cohort: <code>cohort</code> information   - Survey: <code>survey</code> information   - Created: <code>created_at</code></p>"},{"location":"LLM-DOCS/COHORTS/#18-get-my-survey-answers","title":"18. Get My Survey Answers","text":"<p>Endpoint: <code>GET /v1/feedback/user/me/answer</code> - Purpose: Get current user's survey answers</p>"},{"location":"LLM-DOCS/COHORTS/#reviews-and-testimonials","title":"Reviews and Testimonials","text":""},{"location":"LLM-DOCS/COHORTS/#19-get-reviews","title":"19. Get Reviews","text":"<p>Endpoint: <code>GET /v1/feedback/review</code> - Purpose: Get reviews/testimonials - Query Parameters:   - <code>cohort={cohort_id}</code> - Filter by cohort   - <code>user={user_id}</code> - Filter by user - Response includes:   - Review details: <code>id</code>, <code>total_rating</code>, <code>comments</code>, <code>status</code>   - Platform: <code>platform</code> information   - User: <code>author</code> information   - Cohort: <code>cohort</code> information</p>"},{"location":"LLM-DOCS/COHORTS/#additional-cohort-data","title":"Additional Cohort Data","text":""},{"location":"LLM-DOCS/COHORTS/#20-get-academy-information","title":"20. Get Academy Information","text":"<p>Endpoint: <code>GET /v1/admissions/academy/{academy_id}</code> - Purpose: Get academy details - Response includes:   - Academy info: <code>name</code>, <code>slug</code>, <code>timezone</code>, <code>logo_url</code>   - Contact: <code>feedback_email</code>, <code>legal_name</code></p>"},{"location":"LLM-DOCS/COHORTS/#21-get-public-cohorts","title":"21. Get Public Cohorts","text":"<p>Endpoint: <code>GET /v1/admissions/cohort/all</code> - Purpose: Get public cohorts (for public-facing applications) - Query Parameters:   - <code>upcoming=true/false</code> - Filter by upcoming/past   - <code>academy={academy_slugs}</code> - Filter by academy   - <code>stage={stages}</code> - Filter by stage   - <code>location={academy_slugs}</code> - Filter by location</p>"},{"location":"LLM-DOCS/COHORTS/#usage-examples","title":"Usage Examples","text":""},{"location":"LLM-DOCS/COHORTS/#get-complete-cohort-overview","title":"Get Complete Cohort Overview","text":"<pre><code># 1. Get basic cohort info\nGET /v1/admissions/academy/cohort/123\n\n# 2. Get all users (students, teachers, TAs)\nGET /v1/admissions/academy/cohort/123/user?roles=STUDENT,TEACHER,ASSISTANT,REVIEWER\n\n# 3. Get schedule\nGET /v1/admissions/academy/cohort/123/timeslot\n\n# 4. Get assignments\nGET /v1/assignments/academy/cohort/123/task\n\n# 5. Get activity timeline\nGET /v1/activity/cohort/123\n\n# 6. Get NPS scores\nGET /v1/feedback/academy/answer?cohort=cohort-slug\n\n# 7. Get cohort history\nGET /v1/admissions/academy/cohort/123/log\n</code></pre>"},{"location":"LLM-DOCS/COHORTS/#calculate-days-remaining","title":"Calculate Days Remaining","text":"<pre><code>// From cohort data\nconst kickoffDate = new Date(cohort.kickoff_date);\nconst endingDate = new Date(cohort.ending_date);\nconst currentDay = cohort.current_day;\nconst totalDays = Math.ceil((endingDate - kickoffDate) / (1000 * 60 * 60 * 24));\nconst daysRemaining = totalDays - currentDay;\n</code></pre>"},{"location":"LLM-DOCS/COHORTS/#get-technologies-being-taught","title":"Get Technologies Being Taught","text":"<pre><code>// From syllabus data\nconst technologies = cohort.syllabus_version.syllabus.main_technologies.split(',');\n</code></pre>"},{"location":"LLM-DOCS/COHORTS/#calculate-nps-score","title":"Calculate NPS Score","text":"<pre><code>// From survey answers\nconst promoters = answers.filter(a =&gt; a.score &gt;= 9).length;\nconst detractors = answers.filter(a =&gt; a.score &lt;= 6).length;\nconst total = answers.length;\nconst npsScore = ((promoters - detractors) / total) * 100;\n</code></pre>"},{"location":"LLM-DOCS/COHORTS/#authentication-and-permissions","title":"Authentication and Permissions","text":"<p>Most endpoints require authentication and specific permissions: - <code>read_all_cohort</code> - Read cohort information - <code>read_single_cohort</code> - Read single cohort (for students) - <code>crud_cohort</code> - Create/update/delete cohorts - <code>read_assignment</code> - Read assignments - <code>read_activity</code> - Read activity data - <code>read_nps_answers</code> - Read NPS/feedback data</p>"},{"location":"LLM-DOCS/COHORTS/#rate-limiting-and-caching","title":"Rate Limiting and Caching","text":"<ul> <li>Most endpoints support caching with <code>Cache-Control</code> headers</li> <li>Pagination is available for list endpoints using <code>limit</code> and <code>offset</code></li> <li>Some endpoints support sorting with <code>sort</code> parameter</li> </ul>"},{"location":"LLM-DOCS/COHORTS_CREATE/","title":"Cohort Creation - Complete Guide","text":"<p>This guide covers the entire flow to create a cohort, including all dependencies and prerequisites.</p>"},{"location":"LLM-DOCS/COHORTS_CREATE/#table-of-contents","title":"\ud83d\udccb Table of Contents","text":"<ol> <li>Prerequisites</li> <li>Step-by-Step Flow</li> <li>API Endpoints Reference</li> <li>Complete Examples</li> <li>Troubleshooting</li> </ol>"},{"location":"LLM-DOCS/COHORTS_CREATE/#prerequisites","title":"\ud83c\udfaf Prerequisites","text":"<p>Before creating a cohort, you need to have the following dependencies in place:</p>"},{"location":"LLM-DOCS/COHORTS_CREATE/#1-academy-required","title":"1. Academy (Required)","text":"<ul> <li>An academy must exist to create cohorts</li> <li>Academy provides the context and ownership for cohorts</li> </ul>"},{"location":"LLM-DOCS/COHORTS_CREATE/#2-syllabus-required","title":"2. Syllabus (Required)","text":"<ul> <li>A syllabus defines the curriculum content</li> <li>Must have at least one published version</li> </ul>"},{"location":"LLM-DOCS/COHORTS_CREATE/#3-syllabus-version-required","title":"3. Syllabus Version (Required)","text":"<ul> <li>Each syllabus needs a published version (version 2 or higher)</li> <li>Version 1 is only for marketing purposes</li> </ul>"},{"location":"LLM-DOCS/COHORTS_CREATE/#4-syllabus-schedule-optional","title":"4. Syllabus Schedule (Optional)","text":"<ul> <li>Defines when classes are held</li> <li>Can be created after cohort creation</li> </ul>"},{"location":"LLM-DOCS/COHORTS_CREATE/#step-by-step-flow","title":"\ud83d\ude80 Step-by-Step Flow","text":""},{"location":"LLM-DOCS/COHORTS_CREATE/#step-1-create-or-verify-academy","title":"Step 1: Create or Verify Academy","text":"<p>Endpoint: <code>POST /v1/admissions/academy</code></p> <p>Required Fields: - <code>slug</code> - Unique academy identifier - <code>name</code> - Academy display name - <code>logo_url</code> - Academy logo URL - <code>street_address</code> - Physical address - <code>city</code> - City ID (from catalog) - <code>country</code> - Country code</p> <p>Example: <pre><code>curl -X POST \"https://your-api.com/v1/admissions/academy\" \\\n  -H \"Authorization: Token your_token_here\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"slug\": \"miami-academy\",\n    \"name\": \"Miami Academy\",\n    \"logo_url\": \"https://example.com/logo.png\",\n    \"street_address\": \"123 Main St\",\n    \"city\": 1,\n    \"country\": \"us\",\n    \"timezone\": \"America/New_York\"\n  }'\n</code></pre></p> <p>Response: <pre><code>{\n  \"id\": 1,\n  \"slug\": \"miami-academy\",\n  \"name\": \"Miami Academy\",\n  \"owner\": {\n    \"id\": 123,\n    \"email\": \"admin@miami-academy.com\"\n  },\n  \"timezone\": \"America/New_York\",\n  \"status\": \"ACTIVE\"\n}\n</code></pre></p>"},{"location":"LLM-DOCS/COHORTS_CREATE/#step-2-create-syllabus","title":"Step 2: Create Syllabus","text":"<p>Endpoint: <code>POST /v1/admissions/syllabus</code></p> <p>Required Fields: - <code>slug</code> - Unique syllabus identifier - <code>name</code> - Syllabus display name</p> <p>Example: <pre><code>curl -X POST \"https://your-api.com/v1/admissions/syllabus\" \\\n  -H \"Authorization: Token your_token_here\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"slug\": \"full-stack-web-development\",\n    \"name\": \"Full Stack Web Development\",\n    \"main_technologies\": \"HTML, CSS, JavaScript, React, Node.js\",\n    \"duration_in_hours\": 400,\n    \"duration_in_days\": 16,\n    \"week_hours\": 25,\n    \"logo\": \"https://example.com/syllabus-logo.png\",\n    \"academy_owner\": 1\n  }'\n</code></pre></p> <p>Response: <pre><code>{\n  \"id\": 1,\n  \"slug\": \"full-stack-web-development\",\n  \"name\": \"Full Stack Web Development\",\n  \"main_technologies\": \"HTML, CSS, JavaScript, React, Node.js\",\n  \"duration_in_hours\": 400,\n  \"academy_owner\": 1\n}\n</code></pre></p> <p>Note: A signal automatically creates version 1 when a syllabus is created.</p>"},{"location":"LLM-DOCS/COHORTS_CREATE/#step-3-create-syllabus-version","title":"Step 3: Create Syllabus Version","text":"<p>Endpoint: <code>POST /v1/admissions/syllabus/{syllabus_id}/version</code></p> <p>Required Fields: - <code>json</code> - Syllabus content in JSON format - <code>status</code> - Must be \"PUBLISHED\" for cohorts</p> <p>Example: <pre><code>curl -X POST \"https://your-api.com/v1/admissions/syllabus/1/version\" \\\n  -H \"Authorization: Token your_token_here\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"json\": {\n      \"days\": [\n        {\n          \"id\": 1,\n          \"name\": \"Introduction to Web Development\",\n          \"lessons\": [\n            {\n              \"id\": 1,\n              \"name\": \"HTML Basics\",\n              \"duration\": 120\n            }\n          ]\n        }\n      ]\n    },\n    \"status\": \"PUBLISHED\",\n    \"change_log_details\": \"Initial version with basic web development curriculum\"\n  }'\n</code></pre></p> <p>Response: <pre><code>{\n  \"id\": 1,\n  \"version\": 2,\n  \"syllabus\": 1,\n  \"status\": \"PUBLISHED\",\n  \"change_log_details\": \"Initial version with basic web development curriculum\"\n}\n</code></pre></p>"},{"location":"LLM-DOCS/COHORTS_CREATE/#step-4-create-syllabus-schedule-optional","title":"Step 4: Create Syllabus Schedule (Optional)","text":"<p>Endpoint: <code>POST /v1/admissions/academy/schedule</code></p> <p>Required Fields: - <code>name</code> - Schedule name - <code>schedule_type</code> - \"FULL-TIME\" or \"PART-TIME\" - <code>description</code> - Schedule description - <code>syllabus</code> - Syllabus ID - <code>academy</code> - Academy ID</p> <p>Example: <pre><code>curl -X POST \"https://your-api.com/v1/admissions/academy/schedule\" \\\n  -H \"Authorization: Token your_token_here\" \\\n  -H \"Academy: 1\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"name\": \"Full-Time Morning Schedule\",\n    \"schedule_type\": \"FULL-TIME\",\n    \"description\": \"Monday to Friday, 9 AM to 5 PM\",\n    \"syllabus\": 1,\n    \"academy\": 1\n  }'\n</code></pre></p> <p>Response: <pre><code>{\n  \"id\": 1,\n  \"name\": \"Full-Time Morning Schedule\",\n  \"schedule_type\": \"FULL-TIME\",\n  \"description\": \"Monday to Friday, 9 AM to 5 PM\",\n  \"syllabus\": 1,\n  \"academy\": 1\n}\n</code></pre></p>"},{"location":"LLM-DOCS/COHORTS_CREATE/#step-5-create-cohort","title":"Step 5: Create Cohort","text":"<p>Endpoint: <code>POST /v1/admissions/academy/cohort</code></p> <p>Required Fields: - <code>name</code> - Cohort display name - <code>slug</code> - Unique cohort identifier - <code>syllabus</code> - Format: \"syllabus_slug.vversion_number\" or \"syllabus_slug.vlatest\" - <code>kickoff_date</code> - Start date/time</p> <p>Example: <pre><code>curl -X POST \"https://your-api.com/v1/admissions/academy/cohort\" \\\n  -H \"Authorization: Token your_token_here\" \\\n  -H \"Academy: 1\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"name\": \"Full Stack Web Development - Miami 2024\",\n    \"slug\": \"full-stack-miami-2024\",\n    \"syllabus\": \"full-stack-web-development.vlatest\",\n    \"kickoff_date\": \"2024-02-15T09:00:00Z\",\n    \"stage\": \"INACTIVE\",\n    \"schedule\": 1\n  }'\n</code></pre></p> <p>Response: <pre><code>{\n  \"id\": 1,\n  \"slug\": \"full-stack-miami-2024\",\n  \"name\": \"Full Stack Web Development - Miami 2024\",\n  \"kickoff_date\": \"2024-02-15T09:00:00Z\",\n  \"stage\": \"INACTIVE\",\n  \"academy\": {\n    \"id\": 1,\n    \"slug\": \"miami-academy\",\n    \"name\": \"Miami Academy\"\n  },\n  \"syllabus_version\": {\n    \"id\": 1,\n    \"version\": 2\n  },\n  \"schedule\": {\n    \"id\": 1,\n    \"name\": \"Full-Time Morning Schedule\"\n  }\n}\n</code></pre></p>"},{"location":"LLM-DOCS/COHORTS_CREATE/#api-endpoints-reference","title":"\ud83d\udcda API Endpoints Reference","text":""},{"location":"LLM-DOCS/COHORTS_CREATE/#academy-management","title":"Academy Management","text":"Method Endpoint Description Required Headers <code>GET</code> <code>/v1/admissions/academy</code> List all academies None <code>POST</code> <code>/v1/admissions/academy</code> Create academy <code>Authorization</code> <code>GET</code> <code>/v1/admissions/academy/{id}</code> Get academy details None <code>PUT</code> <code>/v1/admissions/academy/{id}</code> Update academy <code>Authorization</code>"},{"location":"LLM-DOCS/COHORTS_CREATE/#syllabus-management","title":"Syllabus Management","text":"Method Endpoint Description Required Headers <code>GET</code> <code>/v1/admissions/syllabus</code> List all syllabi None <code>POST</code> <code>/v1/admissions/syllabus</code> Create syllabus <code>Authorization</code> <code>GET</code> <code>/v1/admissions/syllabus/{id}</code> Get syllabus details None <code>PUT</code> <code>/v1/admissions/syllabus/{id}</code> Update syllabus <code>Authorization</code>"},{"location":"LLM-DOCS/COHORTS_CREATE/#syllabus-version-management","title":"Syllabus Version Management","text":"Method Endpoint Description Required Headers <code>GET</code> <code>/v1/admissions/syllabus/{id}/version</code> List syllabus versions None <code>POST</code> <code>/v1/admissions/syllabus/{id}/version</code> Create syllabus version <code>Authorization</code> <code>GET</code> <code>/v1/admissions/syllabus/{id}/version/{version}</code> Get specific version None <code>PUT</code> <code>/v1/admissions/syllabus/{id}/version/{version}</code> Update version <code>Authorization</code>"},{"location":"LLM-DOCS/COHORTS_CREATE/#schedule-management","title":"Schedule Management","text":"Method Endpoint Description Required Headers <code>GET</code> <code>/v1/admissions/academy/schedule</code> List academy schedules <code>Academy</code> <code>POST</code> <code>/v1/admissions/academy/schedule</code> Create schedule <code>Authorization</code>, <code>Academy</code> <code>GET</code> <code>/v1/admissions/academy/schedule/{id}</code> Get schedule details <code>Academy</code> <code>PUT</code> <code>/v1/admissions/academy/schedule/{id}</code> Update schedule <code>Authorization</code>, <code>Academy</code>"},{"location":"LLM-DOCS/COHORTS_CREATE/#cohort-management","title":"Cohort Management","text":"Method Endpoint Description Required Headers <code>GET</code> <code>/v1/admissions/academy/cohort</code> List academy cohorts <code>Academy</code> <code>POST</code> <code>/v1/admissions/academy/cohort</code> Create cohort <code>Authorization</code>, <code>Academy</code> <code>GET</code> <code>/v1/admissions/academy/cohort/{id}</code> Get cohort details <code>Academy</code> <code>PUT</code> <code>/v1/admissions/academy/cohort/{id}</code> Update cohort <code>Authorization</code>, <code>Academy</code>"},{"location":"LLM-DOCS/COHORTS_CREATE/#complete-examples","title":"\ud83c\udfaf Complete Examples","text":""},{"location":"LLM-DOCS/COHORTS_CREATE/#example-1-minimal-cohort-creation","title":"Example 1: Minimal Cohort Creation","text":"<pre><code># 1. Create Academy\ncurl -X POST \"https://api.breatheco.de/v1/admissions/academy\" \\\n  -H \"Authorization: Token your_token\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"slug\": \"miami-academy\",\n    \"name\": \"Miami Academy\",\n    \"logo_url\": \"https://example.com/logo.png\",\n    \"street_address\": \"123 Main St\",\n    \"city\": 1,\n    \"country\": \"us\"\n  }'\n\n# 2. Create Syllabus\ncurl -X POST \"https://api.breatheco.de/v1/admissions/syllabus\" \\\n  -H \"Authorization: Token your_token\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"slug\": \"web-dev-basics\",\n    \"name\": \"Web Development Basics\",\n    \"academy_owner\": 1\n  }'\n\n# 3. Create Syllabus Version\ncurl -X POST \"https://api.breatheco.de/v1/admissions/syllabus/1/version\" \\\n  -H \"Authorization: Token your_token\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"json\": {\"days\": []},\n    \"status\": \"PUBLISHED\"\n  }'\n\n# 4. Create Cohort\ncurl -X POST \"https://api.breatheco.de/v1/admissions/academy/cohort\" \\\n  -H \"Authorization: Token your_token\" \\\n  -H \"Academy: 1\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"name\": \"Web Dev Cohort 2024\",\n    \"slug\": \"web-dev-2024\",\n    \"syllabus\": \"web-dev-basics.vlatest\",\n    \"kickoff_date\": \"2024-03-01T09:00:00Z\"\n  }'\n</code></pre>"},{"location":"LLM-DOCS/COHORTS_CREATE/#example-2-complete-cohort-with-schedule","title":"Example 2: Complete Cohort with Schedule","text":"<pre><code># 1. Create Academy (same as above)\n\n# 2. Create Syllabus (same as above)\n\n# 3. Create Syllabus Version (same as above)\n\n# 4. Create Schedule\ncurl -X POST \"https://api.breatheco.de/v1/admissions/academy/schedule\" \\\n  -H \"Authorization: Token your_token\" \\\n  -H \"Academy: 1\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"name\": \"Full-Time Schedule\",\n    \"schedule_type\": \"FULL-TIME\",\n    \"description\": \"Monday to Friday, 9 AM to 5 PM\",\n    \"syllabus\": 1,\n    \"academy\": 1\n  }'\n\n# 5. Create Cohort with Schedule\ncurl -X POST \"https://api.breatheco.de/v1/admissions/academy/cohort\" \\\n  -H \"Authorization: Token your_token\" \\\n  -H \"Academy: 1\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"name\": \"Full Stack Web Development - Miami 2024\",\n    \"slug\": \"full-stack-miami-2024\",\n    \"syllabus\": \"web-dev-basics.vlatest\",\n    \"kickoff_date\": \"2024-02-15T09:00:00Z\",\n    \"ending_date\": \"2024-06-15T18:00:00Z\",\n    \"stage\": \"INACTIVE\",\n    \"language\": \"en\",\n    \"timezone\": \"America/New_York\",\n    \"remote_available\": true,\n    \"online_meeting_url\": \"https://zoom.us/j/123456789\",\n    \"never_ends\": false,\n    \"private\": false,\n    \"available_as_saas\": true,\n    \"schedule\": 1\n  }'\n</code></pre>"},{"location":"LLM-DOCS/COHORTS_CREATE/#field-reference","title":"\ud83d\udd27 Field Reference","text":""},{"location":"LLM-DOCS/COHORTS_CREATE/#academy-fields","title":"Academy Fields","text":"Field Type Required Description <code>slug</code> string \u2705 Unique identifier <code>name</code> string \u2705 Display name <code>logo_url</code> string \u2705 Logo URL <code>street_address</code> string \u2705 Physical address <code>city</code> integer \u2705 City ID <code>country</code> string \u2705 Country code <code>timezone</code> string \u274c Default timezone"},{"location":"LLM-DOCS/COHORTS_CREATE/#syllabus-fields","title":"Syllabus Fields","text":"Field Type Required Description <code>slug</code> string \u2705 Unique identifier <code>name</code> string \u2705 Display name <code>main_technologies</code> string \u274c Comma-separated technologies <code>duration_in_hours</code> integer \u274c Total hours <code>duration_in_days</code> integer \u274c Total days <code>week_hours</code> integer \u274c Hours per week <code>logo</code> string \u274c Logo URL <code>academy_owner</code> integer \u274c Academy ID (for private syllabi)"},{"location":"LLM-DOCS/COHORTS_CREATE/#syllabus-version-fields","title":"Syllabus Version Fields","text":"Field Type Required Description <code>json</code> object \u2705 Syllabus content <code>status</code> string \u2705 \"PUBLISHED\" or \"DRAFT\" <code>change_log_details</code> string \u274c Change description"},{"location":"LLM-DOCS/COHORTS_CREATE/#schedule-fields","title":"Schedule Fields","text":"Field Type Required Description <code>name</code> string \u2705 Schedule name <code>schedule_type</code> string \u2705 \"FULL-TIME\" or \"PART-TIME\" <code>description</code> string \u2705 Schedule description <code>syllabus</code> integer \u2705 Syllabus ID <code>academy</code> integer \u2705 Academy ID"},{"location":"LLM-DOCS/COHORTS_CREATE/#cohort-fields","title":"Cohort Fields","text":"Field Type Required Description <code>name</code> string \u2705 Cohort display name <code>slug</code> string \u2705 Unique identifier <code>syllabus</code> string \u2705 \"slug.vversion\" format <code>kickoff_date</code> datetime \u2705 Start date/time <code>ending_date</code> datetime \u274c End date/time <code>stage</code> string \u274c Cohort stage <code>language</code> string \u274c Language code <code>timezone</code> string \u274c Timezone <code>remote_available</code> boolean \u274c Allow remote students <code>online_meeting_url</code> string \u274c Meeting URL <code>never_ends</code> boolean \u274c No end date <code>private</code> boolean \u274c Hide from public API <code>available_as_saas</code> boolean \u274c Available for SAAS plans <code>schedule</code> integer \u274c Schedule ID"},{"location":"LLM-DOCS/COHORTS_CREATE/#cohort-stages","title":"\ud83c\udfad Cohort Stages","text":"Stage Description Use Case <code>INACTIVE</code> Default - Not started New cohorts <code>PREWORK</code> Pre-work phase Before official start <code>STARTED</code> Active cohort Currently running <code>FINAL_PROJECT</code> Final project phase Near completion <code>ENDED</code> Completed Finished cohorts <code>DELETED</code> Soft deleted Removed cohorts"},{"location":"LLM-DOCS/COHORTS_CREATE/#important-notes","title":"\u26a0\ufe0f Important Notes","text":""},{"location":"LLM-DOCS/COHORTS_CREATE/#syllabus-version-rules","title":"Syllabus Version Rules","text":"<ul> <li>Version 1: Only for marketing purposes, cannot be assigned to cohorts</li> <li>Version 2+: Can be assigned to cohorts</li> <li>Status: Must be \"PUBLISHED\" for cohorts</li> <li>Latest: Use \"syllabus_slug.vlatest\" to get the latest published version</li> </ul>"},{"location":"LLM-DOCS/COHORTS_CREATE/#academy-context","title":"Academy Context","text":"<ul> <li>Academy ID is automatically set from the URL path for academy-scoped endpoints</li> <li>Use <code>Academy</code> header for academy-scoped requests</li> <li>Academy owner is automatically set to the creator</li> </ul>"},{"location":"LLM-DOCS/COHORTS_CREATE/#timezone-handling","title":"Timezone Handling","text":"<ul> <li>If not provided, uses academy's default timezone</li> <li>All datetime fields should be in ISO format</li> <li>Timezone conversion is handled automatically</li> </ul>"},{"location":"LLM-DOCS/COHORTS_CREATE/#schedule-integration","title":"Schedule Integration","text":"<ul> <li>If schedule is provided, time slots are automatically created</li> <li>Schedule is optional but recommended for structured cohorts</li> <li>Time slots can be created separately after cohort creation</li> </ul>"},{"location":"LLM-DOCS/COHORTS_CREATE/#troubleshooting","title":"\ud83d\udea8 Troubleshooting","text":""},{"location":"LLM-DOCS/COHORTS_CREATE/#common-errors","title":"Common Errors","text":""},{"location":"LLM-DOCS/COHORTS_CREATE/#1-syllabus-field-malformed","title":"1. \"Syllabus field malformed\"","text":"<p>Error: <code>Syllabus field malformed(syllabus.slug.vsyllabus_version.version)</code> Solution: Use format <code>\"syllabus_slug.vversion_number\"</code> or <code>\"syllabus_slug.vlatest\"</code></p>"},{"location":"LLM-DOCS/COHORTS_CREATE/#2-syllabus-version-not-found","title":"2. \"Syllabus version not found\"","text":"<p>Error: <code>Syllabus {version} doesn't exist</code> Solution: Ensure syllabus version exists and is published</p>"},{"location":"LLM-DOCS/COHORTS_CREATE/#3-academy-not-found","title":"3. \"Academy not found\"","text":"<p>Error: <code>Academy {id} not found</code> Solution: Verify academy exists and you have access</p>"},{"location":"LLM-DOCS/COHORTS_CREATE/#4-missing-syllabus-field","title":"4. \"Missing syllabus field\"","text":"<p>Error: <code>syllabus field is missing</code> Solution: Include syllabus field in cohort creation</p>"},{"location":"LLM-DOCS/COHORTS_CREATE/#5-invalid-cohort-stage","title":"5. \"Invalid cohort stage\"","text":"<p>Error: <code>Invalid cohort stage {stage}</code> Solution: Use valid stage: INACTIVE, PREWORK, STARTED, FINAL_PROJECT, ENDED, DELETED</p>"},{"location":"LLM-DOCS/COHORTS_CREATE/#validation-tips","title":"Validation Tips","text":"<ol> <li>Check Dependencies: Ensure academy, syllabus, and syllabus version exist</li> <li>Verify Permissions: Ensure you have proper permissions for academy-scoped operations</li> <li>Validate Dates: Ensure kickoff_date is not in the past</li> <li>Check Timezone: Ensure timezone is valid and matches academy</li> <li>Unique Slugs: Ensure cohort slug is unique</li> </ol>"},{"location":"LLM-DOCS/COHORTS_CREATE/#debug-steps","title":"Debug Steps","text":"<ol> <li>List Academies: <code>GET /v1/admissions/academy</code></li> <li>List Syllabi: <code>GET /v1/admissions/syllabus</code></li> <li>List Syllabus Versions: <code>GET /v1/admissions/syllabus/{id}/version</code></li> <li>List Schedules: <code>GET /v1/admissions/academy/schedule</code></li> <li>List Cohorts: <code>GET /v1/admissions/academy/cohort</code></li> </ol>"},{"location":"LLM-DOCS/COHORTS_CREATE/#support","title":"\ud83d\udcde Support","text":"<p>For additional help: - Check API documentation: <code>/docs/</code> - Review error messages for specific guidance - Ensure all required fields are provided - Verify permissions and academy context</p> <p>This guide covers the complete flow for creating cohorts with all dependencies. Follow the steps in order for successful cohort creation.</p>"},{"location":"LLM-DOCS/COHORT_REPORT_CALCULATION/","title":"C\u00e1lculo de Valores del CohortReportCSV - Gu\u00eda Detallada","text":"<p>Este documento explica paso a paso c\u00f3mo se calcula cada valor que aparece en el CSV generado por el endpoint <code>AcademyCohortReportCSVView</code>.</p> <p>Endpoint: <code>GET /v1/admissions/academy/{academy_id}/cohort/{cohort_id}/report.csv</code></p>"},{"location":"LLM-DOCS/COHORT_REPORT_CALCULATION/#columnas-del-csv","title":"\ud83d\udccb Columnas del CSV","text":"<p>El CSV contiene las siguientes columnas (en este orden):</p> <ol> <li><code>course_name</code> - Nombre del cohort</li> <li><code>student_full_name</code> - Nombre completo del estudiante</li> <li><code>student_email</code> - Email del estudiante</li> <li><code>enrollment_date</code> - Fecha de inscripci\u00f3n</li> <li><code>student_start_date</code> - Fecha en que el estudiante comenz\u00f3</li> <li><code>status</code> - Estado del estudiante</li> <li><code>progress_percentage</code> - Porcentaje de progreso (0-100, entero redondeado)</li> <li><code>completion_date</code> - Fecha de finalizaci\u00f3n</li> <li><code>certificate_url</code> - URL del certificado</li> <li><code>comments</code> - Comentarios adicionales</li> </ol>"},{"location":"LLM-DOCS/COHORT_REPORT_CALCULATION/#flujo-de-calculo-resumen-ejecutivo","title":"\ud83d\udd04 Flujo de C\u00e1lculo (Resumen Ejecutivo)","text":"<p>Concepto Clave: El progreso se calcula comparando lo que el estudiante ha completado vs. lo que est\u00e1 en el syllabus actual del cohort. Solo se cuentan tareas que est\u00e1n en el syllabus actual.</p> <p>Flujo Simplificado: <pre><code>1. Obtener enrollments del cohort\n   \u2193\n2. Extraer slugs del syllabus ACTUAL (lecciones, ejercicios, proyectos)\n   \u26a0\ufe0f IMPORTANTE: Solo cuenta tareas que est\u00e1n en el syllabus actual\n   \u2193\n3. Consultar qu\u00e9 ha completado cada estudiante (Task + history_log)\n   \u2193\n4. Filtrar: solo lo que est\u00e1 en el syllabus actual\n   \u2193\n5. Calcular progreso = (completadas / total) * 100\n</code></pre></p> <p>Nota sobre \"Cache\": <code>_extract_syllabus_slugs</code> no es una cache persistente. Es un diccionario en memoria que se crea cada vez que se ejecuta el reporte. Se ejecuta una vez al inicio y contiene los slugs del syllabus actual del cohort.</p>"},{"location":"LLM-DOCS/COHORT_REPORT_CALCULATION/#flujo-de-calculo-detalle-por-fase","title":"\ud83d\udd04 Flujo de C\u00e1lculo (Detalle por Fase)","text":""},{"location":"LLM-DOCS/COHORT_REPORT_CALCULATION/#fase-1-preparacion-de-datos-base","title":"Fase 1: Preparaci\u00f3n de Datos Base","text":""},{"location":"LLM-DOCS/COHORT_REPORT_CALCULATION/#paso-11-obtener-enrollments-del-cohort","title":"Paso 1.1: Obtener Enrollments del Cohort","text":"<p>Funci\u00f3n: <code>_get_enrollments_for_academy_student_progress_report(academy, cohort=None)</code></p> <p>Ubicaci\u00f3n: <code>breathecode/admissions/actions.py</code> l\u00ednea 333</p> <p>Qu\u00e9 hace: - Obtiene los <code>CohortUser</code> de la academia con rol <code>STUDENT</code> - Acepta par\u00e1metro <code>cohort</code> opcional - si se especifica, filtra directamente en la query - Hace <code>select_related</code> para optimizar queries (user, cohort, syllabus_version) - Hace <code>prefetch_related</code> para micro_cohorts</p> <p>Query SQL equivalente: <pre><code>-- Si cohort es None (reporte de toda la academia):\nSELECT * FROM admissions_cohortuser\nWHERE cohort__academy_id = {academy_id}\n  AND role = 'STUDENT'\nORDER BY cohort_id, created_at\n\n-- Si cohort se especifica (reporte de cohort espec\u00edfico):\nSELECT * FROM admissions_cohortuser\nWHERE cohort__academy_id = {academy_id}\n  AND role = 'STUDENT'\n  AND cohort_id = {cohort_id}  -- \u2705 Filtrado optimizado en la query\nORDER BY cohort_id, created_at\n</code></pre></p> <p>\u2705 Optimizaci\u00f3n: El filtrado por cohort se hace directamente en la query cuando se especifica el par\u00e1metro, evitando cargar enrollments innecesarios de otros cohorts. Esto mejora significativamente el rendimiento cuando se genera un reporte para un cohort espec\u00edfico.</p> <p>C\u00f3digo: <pre><code>def _get_enrollments_for_academy_student_progress_report(academy, cohort: Optional[Cohort] = None):\n    queryset = (\n        CohortUser.objects.filter(cohort__academy=academy, role=\"STUDENT\")\n        .select_related(\"user\", \"cohort\", \"cohort__syllabus_version\", \"cohort__syllabus_version__syllabus\")\n        .prefetch_related(\"cohort__micro_cohorts\")\n        .order_by(\"cohort_id\", \"created_at\")\n    )\n    if cohort is not None:\n        queryset = queryset.filter(cohort=cohort)\n    return queryset\n</code></pre></p> <p>Resultado: Lista de objetos <code>CohortUser</code> con sus relaciones cargadas (filtrados por cohort si se especifica)</p>"},{"location":"LLM-DOCS/COHORT_REPORT_CALCULATION/#paso-12-extraer-ids-unicos","title":"Paso 1.2: Extraer IDs \u00danicos","text":"<p>C\u00f3digo: <pre><code>enrollments = list(enrollments_qs)\nuser_ids = list({cu.user_id for cu in enrollments})\ncohort_ids = list({cu.cohort_id for cu in enrollments})\ncohorts_by_id = {cu.cohort_id: cu.cohort for cu in enrollments if cu.cohort is not None}\n</code></pre></p> <p>Qu\u00e9 hace: - Convierte el queryset a lista - Extrae todos los <code>user_id</code> \u00fanicos - Extrae todos los <code>cohort_id</code> \u00fanicos - Crea un diccionario para acceso r\u00e1pido a cohorts por ID</p> <p>Resultado: - <code>user_ids</code>: <code>[1, 2, 3, ...]</code> - <code>cohort_ids</code>: <code>[10]</code> (solo el cohort especificado) - <code>cohorts_by_id</code>: <code>{10: &lt;Cohort object&gt;}</code></p>"},{"location":"LLM-DOCS/COHORT_REPORT_CALCULATION/#fase-2-extraccion-de-slugs-del-syllabus","title":"Fase 2: Extracci\u00f3n de Slugs del Syllabus","text":""},{"location":"LLM-DOCS/COHORT_REPORT_CALCULATION/#paso-21-extraer-slugs-del-syllabus-actual","title":"Paso 2.1: Extraer Slugs del Syllabus Actual","text":"<p>Funci\u00f3n: <code>_extract_syllabus_slugs(cohorts)</code></p> <p>Ubicaci\u00f3n: <code>breathecode/admissions/actions.py</code> l\u00ednea 345</p> <p>\u26a0\ufe0f IMPORTANTE: Esta funci\u00f3n NO es una cache persistente. Se ejecuta cada vez que se genera el reporte y crea un diccionario en memoria con los slugs del syllabus actual del cohort.</p> <p>Qu\u00e9 hace: Para cada cohort, extrae del <code>syllabus_version.json</code> actual:</p> <ol> <li>Slugs de lecciones - Usa <code>get_assets_from_syllabus()</code> con <code>task_types=[\"LESSON\"]</code></li> <li>Slugs de ejercicios - Usa <code>get_assets_from_syllabus()</code> con <code>task_types=[\"EXERCISE\"]</code></li> <li>Slugs de proyectos obligatorios - Usa <code>get_assets_from_syllabus()</code> con <code>task_types=[\"PROJECT\"]</code> y <code>only_mandatory=True</code></li> <li>Total de lecciones - Cuenta cu\u00e1ntas lecciones hay</li> <li>Flag de proyectos obligatorios - Indica si el cohort tiene proyectos obligatorios</li> </ol> <p>Estructura del Syllabus: El syllabus es un JSON con estructura: <pre><code>{\n  \"days\": [\n    {\n      \"id\": 1,\n      \"label\": \"Day 1\",\n      \"lessons\": [\n        {\"slug\": \"learn-react-hooks\", \"type\": \"LESSON\"},\n        {\"slug\": \"react-hooks-practice\", \"type\": \"EXERCISE\"}\n      ],\n      \"projects\": [\n        {\"slug\": \"todo-app\", \"type\": \"PROJECT\", \"mandatory\": true}\n      ]\n    }\n  ]\n}\n</code></pre></p> <p>Resultado: <pre><code>lesson_slugs_by_cohort = {\n    10: {\"learn-react-hooks\", \"learn-react-components\", ...}  # set[str] - no duplicados\n}\nexercise_slugs_by_cohort = {\n    10: {\"react-hooks-practice\", \"react-state-practice\", ...}  # set[str] - no duplicados\n}\ntotal_lessons_by_cohort = {\n    10: 45  # int - cantidad total\n}\nmandatory_project_slugs_by_cohort = {\n    10: {\"todo-app\", \"blog-app\", ...}  # set[str] - no duplicados\n}\nhas_mandatory_projects_by_cohort = {\n    10: True  # bool\n}\n</code></pre></p> <p>\u00bfPor qu\u00e9 <code>set</code> en lugar de <code>list</code>? - \u2705 Elimina duplicados autom\u00e1ticamente - Si el syllabus tiene slugs duplicados, solo se cuenta una vez - \u2705 Intersecci\u00f3n eficiente - Se usa el operador <code>&amp;</code> para encontrar slugs comunes (l\u00ednea 774, 780) - \u2705 B\u00fasqueda O(1) - Verificar si un slug est\u00e1 en el set es m\u00e1s r\u00e1pido que en una lista - \u2705 Operaciones eficientes - <code>.update()</code>, <code>.add()</code> son m\u00e1s r\u00e1pidos que con listas</p>"},{"location":"LLM-DOCS/COHORT_REPORT_CALCULATION/#fase-3-analisis-del-history-log","title":"Fase 3: An\u00e1lisis del History Log","text":""},{"location":"LLM-DOCS/COHORT_REPORT_CALCULATION/#paso-31-extraer-task-ids-del-history-log","title":"Paso 3.1: Extraer Task IDs del History Log","text":"<p>Funci\u00f3n: <code>_get_delivered_task_ids_from_history_log(enrollments, task_type=\"EXERCISE\")</code></p> <p>Ubicaci\u00f3n: <code>breathecode/admissions/actions.py</code> l\u00ednea 391</p> <p>Qu\u00e9 hace: Analiza el campo <code>history_log</code> (JSONField) de cada <code>CohortUser</code> para extraer:</p> <ol> <li>IDs de tareas entregadas - Del array <code>delivered_assignments</code> filtradas por <code>task_type</code> (por defecto \"EXERCISE\")</li> <li>Flag de inicio - Si tiene <code>delivered_assignments</code> o <code>pending_assignments</code>, el estudiante ha comenzado</li> </ol> <p>Par\u00e1metros: - <code>enrollments</code>: Lista de CohortUser - <code>task_type</code>: Tipo de tarea a extraer (\"EXERCISE\", \"LESSON\", \"PROJECT\", etc.) - Por defecto \"EXERCISE\"</p> <p>Nota: Esta funci\u00f3n es gen\u00e9rica y reutilizable. Se puede usar para extraer cualquier tipo de tarea del history_log.</p> <p>Estructura del History Log: <pre><code>{\n  \"delivered_assignments\": [\n    {\"id\": 123, \"type\": \"EXERCISE\"},\n    {\"id\": 124, \"type\": \"LESSON\"}\n  ],\n  \"pending_assignments\": [...]\n}\n</code></pre></p> <p>Resultado: <pre><code>delivered_exercise_task_ids_by_pair = {\n    (user_id=1, cohort_id=10): [123, 125, 127],\n    (user_id=2, cohort_id=10): [124, 126]\n}\nstarted_by_pair = {\n    (user_id=1, cohort_id=10): True,\n    (user_id=2, cohort_id=10): True\n}\n</code></pre></p> <p>Nota: El <code>history_log</code> es un campo legacy. Se usa como fallback si no hay datos en la tabla <code>Task</code>.</p>"},{"location":"LLM-DOCS/COHORT_REPORT_CALCULATION/#fase-4-consulta-de-tareas-entregadas","title":"Fase 4: Consulta de Tareas Entregadas","text":""},{"location":"LLM-DOCS/COHORT_REPORT_CALCULATION/#paso-41-obtener-detalles-de-tareas-por-id","title":"Paso 4.1: Obtener Detalles de Tareas por ID","text":"<p>Funci\u00f3n: <code>_get_delivered_tasks_by_id(task_ids, user_ids, cohort_ids)</code></p> <p>Ubicaci\u00f3n: <code>breathecode/admissions/actions.py</code> l\u00ednea 412</p> <p>Qu\u00e9 hace: Hace una sola query a la tabla <code>Task</code> para obtener los detalles de todas las tareas entregadas encontradas en el history_log.</p> <p>Query SQL equivalente: <pre><code>SELECT id, user_id, cohort_id, task_type, associated_slug\nFROM assignments_task\nWHERE id IN (123, 124, 125, ...)\n  AND user_id IN (1, 2, 3, ...)\n  AND cohort_id IN (10)\n</code></pre></p> <p>Resultado: <pre><code>delivered_tasks_by_id = {\n    123: {\n        \"id\": 123,\n        \"user_id\": 1,\n        \"cohort_id\": 10,\n        \"task_type\": \"EXERCISE\",\n        \"associated_slug\": \"react-hooks-practice\"\n    },\n    ...\n}\n</code></pre></p>"},{"location":"LLM-DOCS/COHORT_REPORT_CALCULATION/#paso-42-mapear-task-ids-a-slugs-de-ejercicios","title":"Paso 4.2: Mapear Task IDs a Slugs de Ejercicios","text":"<p>Funci\u00f3n: <code>_get_delivered_exercise_slugs(...)</code></p> <p>Ubicaci\u00f3n: <code>breathecode/admissions/actions.py</code> l\u00ednea 425</p> <p>Qu\u00e9 hace: - Toma los task_ids del history_log - Los mapea a slugs usando <code>delivered_tasks_by_id</code> - Filtra solo los slugs que est\u00e1n en el syllabus del cohort</p> <p>L\u00f3gica: <pre><code>for pair, task_ids in delivered_exercise_task_ids_by_pair.items():\n    user_id, cohort_id = pair\n    syllabus_slugs = exercise_slugs_by_cohort[cohort_id]\n\n    for task_id in task_ids:\n        task = delivered_tasks_by_id[task_id]\n        if task[\"associated_slug\"] in syllabus_slugs:\n            slugs.add(task[\"associated_slug\"])\n</code></pre></p> <p>Resultado: <pre><code>delivered_exercise_slugs_by_pair = {\n    (user_id=1, cohort_id=10): {\"react-hooks-practice\", \"react-state-practice\"},\n    (user_id=2, cohort_id=10): {\"react-hooks-practice\"}\n}\n</code></pre></p>"},{"location":"LLM-DOCS/COHORT_REPORT_CALCULATION/#fase-5-calculo-de-lecciones-completadas","title":"Fase 5: C\u00e1lculo de Lecciones Completadas","text":""},{"location":"LLM-DOCS/COHORT_REPORT_CALCULATION/#paso-51-obtener-lecciones-completadas","title":"Paso 5.1: Obtener Lecciones Completadas","text":"<p>Funci\u00f3n: <code>_get_completed_lesson_slugs(user_ids, cohort_ids, lesson_slugs_by_cohort)</code></p> <p>Ubicaci\u00f3n: <code>breathecode/admissions/actions.py</code> l\u00ednea 452</p> <p>Qu\u00e9 hace: Consulta la tabla <code>Task</code> para encontrar todas las lecciones que el estudiante ha completado.</p> <p>\u26a0\ufe0f FILTRO IMPORTANTE: Solo cuenta lecciones cuyo <code>associated_slug</code> est\u00e1 en <code>lesson_slugs_by_cohort</code> (syllabus actual). Si una lecci\u00f3n fue completada pero ya no est\u00e1 en el syllabus actual, NO se cuenta.</p> <p>Query SQL equivalente: <pre><code>SELECT user_id, cohort_id, associated_slug\nFROM assignments_task\nWHERE user_id IN (1, 2, 3, ...)\n  AND cohort_id IN (10)\n  AND task_type = 'LESSON'\n  AND task_status = 'DONE'\n  AND associated_slug IN ('learn-react-hooks', 'learn-react-components', ...)\n</code></pre></p> <p>Criterios de \"completada\": - <code>task_type = \"LESSON\"</code> - <code>task_status = \"DONE\"</code> (tambi\u00e9n se acepta \"APPROVED\" en algunos casos)</p> <p>Resultado: <pre><code>lesson_done_slugs_by_pair = {\n    (user_id=1, cohort_id=10): {\"learn-react-hooks\", \"learn-react-components\", ...},\n    (user_id=2, cohort_id=10): {\"learn-react-hooks\"}\n}\n</code></pre></p>"},{"location":"LLM-DOCS/COHORT_REPORT_CALCULATION/#fase-6-calculo-de-fecha-de-inicio","title":"Fase 6: C\u00e1lculo de Fecha de Inicio","text":""},{"location":"LLM-DOCS/COHORT_REPORT_CALCULATION/#paso-61-obtener-fecha-de-inicio-del-estudiante","title":"Paso 6.1: Obtener Fecha de Inicio del Estudiante","text":"<p>Funci\u00f3n: <code>_get_student_start_dates(user_ids, cohort_ids, lesson_slugs_by_cohort, exercise_slugs_by_cohort)</code></p> <p>Ubicaci\u00f3n: <code>breathecode/admissions/actions.py</code> l\u00ednea 478</p> <p>Qu\u00e9 hace: Encuentra la fecha m\u00e1s temprana en que el estudiante comenz\u00f3 cualquier actividad (lecci\u00f3n o ejercicio).</p> <p>Query SQL equivalente: <pre><code>SELECT \n    user_id, \n    cohort_id,\n    MIN(COALESCE(opened_at, delivered_at, created_at)) as started_at\nFROM assignments_task\nWHERE user_id IN (1, 2, 3, ...)\n  AND cohort_id IN (10)\n  AND associated_slug IN (todos_los_slugs_del_syllabus)\n  AND task_type IN ('LESSON', 'EXERCISE')\nGROUP BY user_id, cohort_id\n</code></pre></p> <p>L\u00f3gica de fecha: - Usa <code>opened_at</code> si existe - Si no, usa <code>delivered_at</code> - Si no, usa <code>created_at</code> - Toma el m\u00ednimo (fecha m\u00e1s temprana)</p> <p>Resultado: <pre><code>started_at_by_pair = {\n    (user_id=1, cohort_id=10): datetime(2024-01-15 10:30:00),\n    (user_id=2, cohort_id=10): datetime(2024-01-16 14:20:00)\n}\n</code></pre></p>"},{"location":"LLM-DOCS/COHORT_REPORT_CALCULATION/#fase-7-calculo-de-ejercicios-completados","title":"Fase 7: C\u00e1lculo de Ejercicios Completados","text":""},{"location":"LLM-DOCS/COHORT_REPORT_CALCULATION/#paso-71-obtener-ejercicios-completados","title":"Paso 7.1: Obtener Ejercicios Completados","text":"<p>Funci\u00f3n: <code>_get_completed_exercise_slugs(...)</code></p> <p>Ubicaci\u00f3n: <code>breathecode/admissions/actions.py</code> l\u00ednea 533</p> <p>Qu\u00e9 hace: Determina qu\u00e9 ejercicios est\u00e1n completados usando tres fuentes de datos (en orden de prioridad):</p>"},{"location":"LLM-DOCS/COHORT_REPORT_CALCULATION/#711-telemetria-prioridad-1","title":"7.1.1: Telemetr\u00eda (Prioridad 1)","text":"<p>Consulta tareas con telemetr\u00eda y verifica si <code>completion_rate == 100%</code>:</p> <p>Query: <pre><code>SELECT user_id, cohort_id, associated_slug, telemetry__telemetry\nFROM assignments_task\nWHERE user_id IN (1, 2, 3, ...)\n  AND cohort_id IN (10)\n  AND task_type = 'EXERCISE'\n  AND associated_slug IN (todos_los_slugs_de_ejercicios)\n  AND telemetry__telemetry IS NOT NULL\n</code></pre></p> <p>L\u00f3gica de telemetr\u00eda: La funci\u00f3n <code>_telemetry_to_steps(telemetry)</code> extrae: - <code>total_steps</code> del campo <code>global_metrics.total_steps</code> - <code>completed_steps</code> calculado de <code>completion_rate</code> o <code>steps_not_completed</code></p> <p>Si <code>completed_steps &gt;= total_steps</code>, el ejercicio est\u00e1 completado.</p> <p>Estructura de telemetr\u00eda: <pre><code>{\n  \"global_metrics\": {\n    \"total_steps\": 10,\n    \"completion_rate\": 100.0,\n    \"steps_not_completed\": 0\n  }\n}\n</code></pre></p>"},{"location":"LLM-DOCS/COHORT_REPORT_CALCULATION/#712-task-status-done-prioridad-2","title":"7.1.2: Task Status DONE (Prioridad 2)","text":"<p>Consulta tareas con <code>task_status = \"DONE\"</code>:</p> <p>Query: <pre><code>SELECT user_id, cohort_id, associated_slug\nFROM assignments_task\nWHERE user_id IN (1, 2, 3, ...)\n  AND cohort_id IN (10)\n  AND task_type = 'EXERCISE'\n  AND task_status = 'DONE'\n  AND associated_slug IN (todos_los_slugs_de_ejercicios)\n</code></pre></p>"},{"location":"LLM-DOCS/COHORT_REPORT_CALCULATION/#713-history-log-prioridad-3-fallback","title":"7.1.3: History Log (Prioridad 3 - Fallback)","text":"<p>Usa los slugs obtenidos del history_log (ya calculados en Paso 4.2).</p> <p>Resultado: <pre><code>completed_exercise_slugs_by_pair = {\n    (user_id=1, cohort_id=10): {\"react-hooks-practice\", \"react-state-practice\", \"react-forms-practice\"},\n    (user_id=2, cohort_id=10): {\"react-hooks-practice\"}\n}\n</code></pre></p> <p>Nota: Se combinan las tres fuentes (uni\u00f3n de sets), por lo que si un ejercicio est\u00e1 completado seg\u00fan cualquiera de las tres fuentes, se considera completado.</p>"},{"location":"LLM-DOCS/COHORT_REPORT_CALCULATION/#fase-8-calculo-de-certificados","title":"Fase 8: C\u00e1lculo de Certificados","text":""},{"location":"LLM-DOCS/COHORT_REPORT_CALCULATION/#paso-81-obtener-certificados","title":"Paso 8.1: Obtener Certificados","text":"<p>Funci\u00f3n: <code>_get_cert_by_pair(academy, user_ids, cohort_ids)</code></p> <p>Ubicaci\u00f3n: <code>breathecode/admissions/actions.py</code> l\u00ednea 601</p> <p>Qu\u00e9 hace: Consulta la tabla <code>UserSpecialty</code> para encontrar certificados emitidos.</p> <p>Query SQL equivalente: <pre><code>SELECT user_id, cohort_id, token, issued_at, preview_url, status\nFROM certificate_userspecialty\nWHERE user_id IN (1, 2, 3, ...)\n  AND cohort_id IN (10)\n  AND academy_id = {academy_id}\n  AND status != 'ERROR'\n</code></pre></p> <p>Resultado: <pre><code>cert_by_pair = {\n    (user_id=1, cohort_id=10): {\n        \"token\": \"abc123xyz\",\n        \"issued_at\": datetime(2024-03-01),\n        \"preview_url\": \"https://...\",\n        \"status\": \"PERSISTED\"\n    }\n}\n</code></pre></p>"},{"location":"LLM-DOCS/COHORT_REPORT_CALCULATION/#fase-9-calculo-de-proyectos-obligatorios-aprobados","title":"Fase 9: C\u00e1lculo de Proyectos Obligatorios Aprobados","text":""},{"location":"LLM-DOCS/COHORT_REPORT_CALCULATION/#paso-91-obtener-proyectos-obligatorios-aprobados","title":"Paso 9.1: Obtener Proyectos Obligatorios Aprobados","text":"<p>Funci\u00f3n: <code>_get_approved_mandatory_project_slugs_by_pair(...)</code></p> <p>Ubicaci\u00f3n: <code>breathecode/admissions/actions.py</code> l\u00ednea 610</p> <p>Qu\u00e9 hace: Consulta la tabla <code>Task</code> para encontrar proyectos obligatorios que han sido aprobados.</p> <p>Query SQL equivalente: <pre><code>SELECT user_id, cohort_id, associated_slug\nFROM assignments_task\nWHERE user_id IN (1, 2, 3, ...)\n  AND cohort_id IN (10)\n  AND task_type = 'PROJECT'\n  AND associated_slug IN (slugs_de_proyectos_obligatorios)\n  AND revision_status IN ('APPROVED', 'IGNORED')\n</code></pre></p> <p>Criterios: - <code>task_type = \"PROJECT\"</code> - <code>associated_slug</code> debe estar en <code>mandatory_project_slugs_by_cohort</code> - <code>revision_status = \"APPROVED\"</code> o <code>\"IGNORED\"</code></p> <p>Resultado: <pre><code>approved_mandatory_project_slugs_by_pair = {\n    (user_id=1, cohort_id=10): {\"todo-app\", \"blog-app\"},\n    (user_id=2, cohort_id=10): {\"todo-app\"}\n}\n</code></pre></p>"},{"location":"LLM-DOCS/COHORT_REPORT_CALCULATION/#fase-10-calculo-de-fecha-de-finalizacion","title":"Fase 10: C\u00e1lculo de Fecha de Finalizaci\u00f3n","text":""},{"location":"LLM-DOCS/COHORT_REPORT_CALCULATION/#paso-101-obtener-fecha-de-finalizacion","title":"Paso 10.1: Obtener Fecha de Finalizaci\u00f3n","text":"<p>Funci\u00f3n: <code>_get_completion_date_by_pair(...)</code></p> <p>Ubicaci\u00f3n: <code>breathecode/admissions/actions.py</code> l\u00ednea 638</p> <p>Qu\u00e9 hace: Encuentra la fecha m\u00e1s reciente en que el estudiante complet\u00f3 todas las unidades (lecciones y ejercicios).</p> <p>Query SQL equivalente: <pre><code>SELECT \n    user_id, \n    cohort_id,\n    MAX(updated_at) as completion_date\nFROM assignments_task\nWHERE user_id IN (1, 2, 3, ...)\n  AND cohort_id IN (10)\n  AND task_type IN ('LESSON', 'EXERCISE')\n  AND task_status = 'DONE'\n  AND associated_slug IN (todos_los_slugs_del_syllabus)\nGROUP BY user_id, cohort_id\n</code></pre></p> <p>L\u00f3gica: - Solo cuenta tareas con <code>task_status = \"DONE\"</code> - Toma el <code>MAX(updated_at)</code> - la fecha m\u00e1s reciente de finalizaci\u00f3n - Solo se calcula si el progreso es &gt;= 100%</p> <p>Resultado: <pre><code>completion_date_by_pair = {\n    (user_id=1, cohort_id=10): datetime(2024-03-01 15:30:00),\n    (user_id=2, cohort_id=10): None  # No ha completado\n}\n</code></pre></p>"},{"location":"LLM-DOCS/COHORT_REPORT_CALCULATION/#fase-11-calculo-final-por-estudiante","title":"Fase 11: C\u00e1lculo Final por Estudiante","text":""},{"location":"LLM-DOCS/COHORT_REPORT_CALCULATION/#paso-111-funcion-interna-_get_units_for","title":"Paso 11.1: Funci\u00f3n Interna <code>_get_units_for()</code>","text":"<p>Ubicaci\u00f3n: <code>breathecode/admissions/actions.py</code> l\u00ednea 757 (dentro de <code>academy_student_progress_report_rows</code>)</p> <p>Qu\u00e9 hace: Calcula el total de unidades y unidades completadas para un estudiante espec\u00edfico.</p> <p>C\u00f3digo: <pre><code>def _get_units_for(user_id: int, cohort_id: int) -&gt; tuple[int, int]:\n    # Total de lecciones del syllabus\n    total_lessons = int(total_lessons_by_cohort.get(cohort_id, 0))\n\n    # Lecciones completadas (intersecci\u00f3n entre completadas y del syllabus)\n    completed_lessons = len(\n        (lesson_done_slugs_by_pair.get((user_id, cohort_id), set()) or set())\n        &amp; (lesson_slugs_by_cohort.get(cohort_id, set()) or set())\n    )\n\n    # Total de ejercicios del syllabus\n    total_exercises = len(exercise_slugs_by_cohort.get(cohort_id, set()))\n\n    # Ejercicios completados (intersecci\u00f3n entre completados y del syllabus)\n    completed_exercises = len(\n        (completed_exercise_slugs_by_pair.get((user_id, cohort_id), set()) or set())\n        &amp; (exercise_slugs_by_cohort.get(cohort_id, set()) or set())\n    )\n\n    # Total y completadas\n    total_units = total_lessons + total_exercises\n    completed_units = completed_lessons + completed_exercises\n\n    # Validaciones\n    if total_units and completed_units &gt; total_units:\n        completed_units = total_units\n    if completed_units &lt; 0:\n        completed_units = 0\n\n    return total_units, completed_units\n</code></pre></p> <p>Ejemplo: <pre><code># Para user_id=1, cohort_id=10:\ntotal_lessons = 45\ncompleted_lessons = 40  # 40 de 45 lecciones completadas\ntotal_exercises = 30\ncompleted_exercises = 25  # 25 de 30 ejercicios completados\n\ntotal_units = 45 + 30 = 75\ncompleted_units = 40 + 25 = 65\n\nreturn (75, 65)\n</code></pre></p>"},{"location":"LLM-DOCS/COHORT_REPORT_CALCULATION/#paso-112-calculo-del-porcentaje-de-progreso","title":"Paso 11.2: C\u00e1lculo del Porcentaje de Progreso","text":"<p>Funci\u00f3n: <code>_progress_percent(total_units, completed_units)</code></p> <p>Ubicaci\u00f3n: <code>breathecode/admissions/actions.py</code> l\u00ednea 677</p> <p>C\u00f3digo: <pre><code>def _progress_percent(total_units: int, completed_units: int) -&gt; tuple[int, bool]:\n    if total_units &lt;= 0:\n        return 0, False\n\n    ratio = (completed_units / total_units) * 100.0\n    is_completed = ratio &gt;= 99.99\n    progress = int(round(ratio))\n    progress = 0 if progress &lt; 0 else progress\n    progress = 100 if progress &gt; 100 else progress\n    if is_completed:\n        progress = 100\n    return progress, is_completed\n</code></pre></p> <p>Ejemplo: <pre><code># Con total_units=75, completed_units=65:\nratio = (65 / 75) * 100.0 = 86.666...\nis_completed = 86.666 &gt;= 99.99 = False\nprogress = int(round(86.666)) = 87\nreturn (87, False)\n\n# Con total_units=75, completed_units=75:\nratio = (75 / 75) * 100.0 = 100.0\nis_completed = 100.0 &gt;= 99.99 = True\nprogress = 100\nreturn (100, True)\n</code></pre></p> <p>Nota: Si <code>educational_status = \"GRADUATED\"</code>, el progreso se fuerza a 100% (l\u00ednea 866).</p>"},{"location":"LLM-DOCS/COHORT_REPORT_CALCULATION/#paso-113-determinacion-del-status","title":"Paso 11.3: Determinaci\u00f3n del Status","text":"<p>Funci\u00f3n: <code>_map_status_for_student_progress(cu, started, is_completed)</code></p> <p>Ubicaci\u00f3n: <code>breathecode/admissions/actions.py</code> l\u00ednea 666</p> <p>C\u00f3digo: <pre><code>def _map_status_for_student_progress(cu: CohortUser, *, started: bool, is_completed: bool) -&gt; str:\n    edu = (cu.educational_status or \"\").upper()\n    if edu in (\"DROPPED\", \"NOT_COMPLETING\", \"SUSPENDED\"):\n        return \"withdrawn\"\n    if is_completed:\n        return \"completed\"\n    if not started:\n        return \"not_started\"\n    return \"in_progress\"\n</code></pre></p> <p>L\u00f3gica: 1. Si <code>educational_status</code> es <code>DROPPED</code>, <code>NOT_COMPLETING</code>, o <code>SUSPENDED</code> \u2192 <code>\"withdrawn\"</code> 2. Si <code>is_completed = True</code> \u2192 <code>\"completed\"</code> 3. Si <code>started = False</code> \u2192 <code>\"not_started\"</code> 4. En cualquier otro caso \u2192 <code>\"in_progress\"</code></p> <p>C\u00f3mo se determina <code>started</code>: <pre><code># L\u00ednea 849\nstarted = bool((pair in tasks_any_by_pair) or started_by_pair.get(pair, False))\n</code></pre></p> <p>Donde <code>tasks_any_by_pair</code> se calcula consultando si el estudiante tiene cualquier tarea relacionada con slugs del syllabus (l\u00ednea 789-794).</p>"},{"location":"LLM-DOCS/COHORT_REPORT_CALCULATION/#paso-114-construccion-de-valores-finales","title":"Paso 11.4: Construcci\u00f3n de Valores Finales","text":"<p>Para cada <code>CohortUser</code>, se construyen los valores finales:</p> <p>1. course_name: <pre><code>course_name = getattr(cohort, \"name\", \"\") if cohort else \"\"\n# Si es macro cohort, se a\u00f1ade \"(Macro cohort)\"\nif is_macro:\n    course_name = f\"{course_name} (Macro cohort)\"\n</code></pre></p> <p>2. student_full_name: <pre><code>full_name = f\"{(user.first_name or '').strip()} {(user.last_name or '').strip()}\".strip()\n</code></pre></p> <p>3. student_email: <pre><code>email = getattr(user, \"email\", \"\") if user else \"\"\n</code></pre></p> <p>4. enrollment_date: <pre><code>enrollment_date = cu.created_at  # Fecha de creaci\u00f3n del CohortUser\n</code></pre></p> <p>5. student_start_date: <pre><code>student_start_date = started_at_by_pair.get(pair)  # Calculado en Fase 6\n</code></pre></p> <p>6. status: <pre><code>status = _map_status_for_student_progress(cu, started=started, is_completed=is_completed)\n</code></pre></p> <p>7. progress_percentage: <pre><code>progress, is_completed = _progress_percent(total_units, completed_units)\n# Si GRADUATED, se fuerza a 100\nif edu == \"GRADUATED\":\n    progress = 100\n</code></pre></p> <p>8. completion_date: <pre><code># Inicialmente None\ncompletion_date = None\n\n# Se calcula despu\u00e9s si progress &gt;= 100 (l\u00ednea 922-937)\nif item[\"progress\"] &gt;= 100:\n    completion_date = completion_date_by_pair.get((user_id, cohort_id))\n</code></pre></p> <p>9. certificate_url: <pre><code>cert = cert_by_pair.get(pair)\ncertificate_url = None\nif cert and cert.get(\"token\"):\n    certificate_url = f\"https://certificate.4geeks.com/{cert.get('token')}\"\n</code></pre></p> <p>10. comments: Se construye concatenando varios mensajes:</p> <pre><code>comments = \"\"\n\n# Mensaje 1: Sin syllabus\nif total_units == 0 and status_value != \"completed\":\n    comments += \"No syllabus lessons found and no learnpack telemetry; progress estimated as 0\"\n\n# Mensaje 2: Sin proyectos obligatorios\nif not is_certificate_eligible:\n    comments += \" | This cohort does not include mandatory projects; certificates are not issued for it\"\n\n# Mensaje 3: Proyectos obligatorios pendientes\nif progress &gt;= 100 and cert is None:\n    required = mandatory_project_slugs_by_cohort.get(cohort_id, set())\n    approved = approved_mandatory_project_slugs_by_pair.get(pair, set())\n    pending_mandatory = len(required - approved)\n\n    if pending_mandatory &gt; 0:\n        comments += f\" | Progress is 100% for lessons/exercises, but {pending_mandatory} mandatory project(s) are still pending; certificate not generated yet\"\n</code></pre>"},{"location":"LLM-DOCS/COHORT_REPORT_CALCULATION/#caso-especial-macro-cohorts","title":"\ud83c\udfaf Caso Especial: Macro Cohorts","text":"<p>Si el cohort es un \"macro cohort\" (tiene micro_cohorts), el c\u00e1lculo es diferente:</p> <p>Detecci\u00f3n: <pre><code>is_macro = bool(cohort and hasattr(cohort, \"micro_cohorts\") and cohort.micro_cohorts.exists())\n</code></pre></p> <p>C\u00e1lculo: 1. Se obtienen los micro_cohorts en los que el estudiante est\u00e1 inscrito 2. Se suman los <code>total_units</code> y <code>completed_units</code> de todos los micro_cohorts 3. Se calcula el progreso sobre el total sumado 4. La fecha de inicio es la m\u00e1s temprana de todos los micro_cohorts 5. La fecha de finalizaci\u00f3n es la m\u00e1s reciente de todos los micro_cohorts</p> <p>C\u00f3digo: <pre><code>if is_macro:\n    user_cohorts = cohort_ids_by_user.get(cu.user_id, set())\n    micro_ids = [c.id for c in cohort.micro_cohorts.all() if c.id in user_cohorts]\n\n    total_units = 0\n    completed_units = 0\n\n    for micro_id in micro_ids:\n        micro_total, micro_completed = _get_units_for(cu.user_id, micro_id)\n        total_units += micro_total\n        completed_units += micro_completed\n\n    progress, is_completed = _progress_percent(total_units, completed_units)\n</code></pre></p>"},{"location":"LLM-DOCS/COHORT_REPORT_CALCULATION/#resumen-del-flujo-completo-detallado","title":"\ud83d\udcca Resumen del Flujo Completo (Detallado)","text":"<pre><code>1. Obtener enrollments del cohort\n   \u2193\n2. Extraer IDs \u00fanicos (user_ids, cohort_ids)\n   \u2193\n3. Extraer slugs del syllabus ACTUAL (lecciones, ejercicios, proyectos)\n   \u26a0\ufe0f Solo cuenta tareas que est\u00e1n en el syllabus actual\n   \u2193\n4. Parsear history_log (tareas entregadas, flag de inicio)\n   \u2193\n5. Consultar Task para detalles de tareas entregadas\n   \u2193\n6. Mapear task_ids a slugs de ejercicios (filtrar por syllabus actual)\n   \u2193\n7. Consultar Task para lecciones completadas (filtrar por syllabus actual)\n   \u2193\n8. Consultar Task para fecha de inicio\n   \u2193\n9. Consultar Task para ejercicios completados (telemetr\u00eda + status + history_log)\n   \u2193\n10. Consultar UserSpecialty para certificados\n   \u2193\n11. Consultar Task para proyectos obligatorios aprobados\n   \u2193\n12. Consultar Task para fecha de finalizaci\u00f3n\n   \u2193\n13. Para cada estudiante:\n    - Calcular total_units (del syllabus actual)\n    - Calcular completed_units (solo las que est\u00e1n en syllabus actual)\n    - Calcular progress_percentage = (completed / total) * 100\n    - Determinar status\n    - Construir fila del CSV\n   \u2193\n14. Generar CSV y retornar\n</code></pre>"},{"location":"LLM-DOCS/COHORT_REPORT_CALCULATION/#queries-sql-totales","title":"\ud83d\udd0d Queries SQL Totales","text":"<p>En total, el proceso ejecuta aproximadamente 7-8 queries SQL:</p> <ol> <li>Query de enrollments (con select_related)</li> <li>Query de tasks entregadas (del history_log)</li> <li>Query de lecciones completadas</li> <li>Query de fecha de inicio</li> <li>Query de ejercicios completados (telemetr\u00eda)</li> <li>Query de ejercicios completados (status DONE)</li> <li>Query de certificados</li> <li>Query de proyectos obligatorios aprobados</li> <li>Query de fecha de finalizaci\u00f3n</li> <li>Query de tasks_any_by_pair (para determinar si empez\u00f3)</li> </ol> <p>Optimizaci\u00f3n: Todas las queries usan <code>IN</code> con listas de IDs, por lo que son eficientes incluso con muchos estudiantes.</p>"},{"location":"LLM-DOCS/COHORT_REPORT_CALCULATION/#notas-importantes","title":"\ud83d\udcdd Notas Importantes","text":"<ol> <li>Intersecci\u00f3n de Slugs (CR\u00cdTICO): Solo se cuentan como completadas las unidades cuyo <code>associated_slug</code> est\u00e1 en el syllabus actual del cohort. </li> <li>\u2705 Si una tarea est\u00e1 completada Y est\u00e1 en el syllabus actual \u2192 se cuenta</li> <li>\u274c Si una tarea est\u00e1 completada pero NO est\u00e1 en el syllabus actual \u2192 NO se cuenta</li> <li> <p>Esto evita contar tareas de otros cohorts o tareas que fueron removidas del syllabus</p> </li> <li> <p>Prioridad de Fuentes: Para ejercicios completados, se usa telemetr\u00eda primero, luego task_status, y finalmente history_log como fallback.</p> </li> <li> <p>Macro Cohorts: El c\u00e1lculo es m\u00e1s complejo porque suma unidades de m\u00faltiples micro_cohorts.</p> </li> <li> <p>Progreso 100%: Se considera completado si <code>ratio &gt;= 99.99%</code> (permite peque\u00f1os errores de redondeo).</p> </li> <li> <p>GRADUATED: Si <code>educational_status = \"GRADUATED\"</code>, el progreso se fuerza a 100% independientemente del c\u00e1lculo.</p> </li> <li> <p>Certificados: Solo se generan si el cohort tiene proyectos obligatorios y el estudiante los ha aprobado todos.</p> </li> </ol>"},{"location":"LLM-DOCS/COUPONS/","title":"Payment Coupons Documentation","text":""},{"location":"LLM-DOCS/COUPONS/#overview","title":"Overview","text":"<p>The Coupon system in the BreatheCode payments app enables flexible discount and referral management for subscriptions and plan financings. Coupons can provide percentage-based or fixed-price discounts, support referral programs with seller commissions, and can be automatically applied or manually entered by users.</p>"},{"location":"LLM-DOCS/COUPONS/#primary-purposes","title":"Primary Purposes","text":"<ol> <li>Discount Management: Apply discounts to subscription plans and services</li> <li>Referral Programs: Track and reward sellers for referrals</li> <li>Promotional Campaigns: Create time-limited or usage-limited promotional codes</li> <li>User-Specific Offers: Restrict coupons to specific users</li> <li>Auto-Applied Offers: Automatically apply special offers during checkout</li> </ol>"},{"location":"LLM-DOCS/COUPONS/#key-features","title":"Key Features","text":"<ul> <li>Multiple Discount Types: Percentage off, fixed price, or no discount</li> <li>Referral Tracking: Percentage or fixed commission for sellers</li> <li>Plan Scoping: Coupons can be global or restricted to specific plans</li> <li>Usage Limits: Control how many times a coupon can be used</li> <li>Time-Based Validity: Set offer and expiration dates</li> <li>Auto-Application: Automatically apply coupons during checkout</li> <li>User Restrictions: Limit coupon usage to specific users</li> <li>Academy Management: Academies can manage coupons for their plans</li> </ul>"},{"location":"LLM-DOCS/COUPONS/#coupon-data-structure","title":"Coupon Data Structure","text":""},{"location":"LLM-DOCS/COUPONS/#coupon-fields","title":"Coupon Fields","text":"<p>Identification: - <code>slug</code> (string, required): Unique identifier (e.g., \"new-year-50\")</p> <p>Discount Configuration: - <code>discount_type</code> (string, required): <code>PERCENT_OFF</code>, <code>FIXED_PRICE</code>, <code>NO_DISCOUNT</code>, or <code>HAGGLING</code> - <code>discount_value</code> (number, required):    - For <code>PERCENT_OFF</code>: Percentage as decimal (0-1, e.g., 0.5 = 50% off)   - For <code>FIXED_PRICE</code>: Absolute discount amount</p> <p>Referral Configuration: - <code>referral_type</code> (string, required): <code>NO_REFERRAL</code>, <code>PERCENTAGE</code>, or <code>FIXED_PRICE</code> - <code>referral_value</code> (number, default: 0): Commission amount for seller</p> <p>Behavior: - <code>auto</code> (boolean, default: false): Automatically apply during checkout - <code>how_many_offers</code> (integer, default: -1):    - <code>-1</code> = unlimited uses   - <code>0</code> = disabled (nobody can use)   - <code>&gt;0</code> = maximum number of uses</p> <p>Relationships: - <code>seller</code> (integer, optional): Seller ID for referral coupons - <code>allowed_user</code> (integer, optional): User ID restriction - <code>referred_buyer</code> (integer, optional): Buyer who activated reward - <code>plans</code> (array of integers, optional): Plan IDs this coupon applies to</p> <p>Validity: - <code>offered_at</code> (datetime, optional): When offer becomes available - <code>expires_at</code> (datetime, optional): When offer expires</p> <p>Metadata: - <code>created_at</code> (datetime, read-only): Creation timestamp - <code>updated_at</code> (datetime, read-only): Last update timestamp</p>"},{"location":"LLM-DOCS/COUPONS/#discount-types","title":"Discount Types","text":"<ul> <li><code>PERCENT_OFF</code>: Percentage discount (discount_value is 0-1, e.g., 0.5 = 50% off)</li> <li><code>FIXED_PRICE</code>: Fixed price discount (discount_value is absolute amount)</li> <li><code>NO_DISCOUNT</code>: No discount applied</li> <li><code>HAGGLING</code>: Special haggling type</li> </ul>"},{"location":"LLM-DOCS/COUPONS/#referral-types","title":"Referral Types","text":"<ul> <li><code>NO_REFERRAL</code>: Regular coupon, no seller commission</li> <li><code>PERCENTAGE</code>: Seller receives percentage commission</li> <li><code>FIXED_PRICE</code>: Seller receives fixed commission amount</li> </ul>"},{"location":"LLM-DOCS/COUPONS/#validation-rules","title":"Validation Rules","text":"<ul> <li><code>discount_value</code> must be positive</li> <li><code>referral_value</code> must be positive</li> <li>If <code>referral_type != NO_REFERRAL</code>, <code>referral_value</code> must be set</li> <li>If <code>referral_type == NO_REFERRAL</code>, <code>referral_value</code> must be 0</li> <li>If <code>auto == True</code>, <code>discount_type</code> cannot be <code>NO_DISCOUNT</code></li> <li>If <code>referral_type != NO_REFERRAL</code>, <code>plans</code> should be empty (applies to all plans)</li> <li>Slug must be unique (no duplicate active coupons)</li> </ul>"},{"location":"LLM-DOCS/COUPONS/#api-quick-reference","title":"API Quick Reference","text":""},{"location":"LLM-DOCS/COUPONS/#endpoint-summary","title":"Endpoint Summary","text":"Endpoint Method Auth Purpose <code>/v1/payments/coupon</code> GET Public Validate coupons for a plan <code>/v1/payments/bag/{id}/coupon</code> PUT User Apply/remove coupons from bag <code>/v1/payments/me/coupon</code> GET User Get user's referral coupons <code>/v1/payments/me/user/coupons</code> GET User Get user's restricted coupons <code>/v1/payments/me/user/coupons/{slug}</code> PUT User Toggle auto-apply for user coupon <code>/v1/payments/academy/coupon</code> GET Academy List academy coupons <code>/v1/payments/academy/coupon</code> POST Academy Create coupon <code>/v1/payments/academy/coupon/{slug}</code> GET Academy Get specific coupon <code>/v1/payments/academy/coupon/{slug}</code> PUT Academy Update coupon <code>/v1/payments/academy/coupon/{slug}</code> DELETE Academy Delete coupon"},{"location":"LLM-DOCS/COUPONS/#common-query-parameters","title":"Common Query Parameters","text":"<ul> <li><code>coupons</code>: Comma-separated coupon slugs (e.g., <code>\"CODE1,CODE2\"</code>)</li> <li><code>plan</code>: Plan slug or ID</li> <li><code>like</code>: Search filter for coupon slug</li> <li>Standard pagination: <code>limit</code>, <code>offset</code></li> <li>Standard sorting: <code>sort</code> (e.g., <code>\"-id\"</code> for descending)</li> </ul>"},{"location":"LLM-DOCS/COUPONS/#api-endpoints","title":"API Endpoints","text":""},{"location":"LLM-DOCS/COUPONS/#public-endpoints","title":"Public Endpoints","text":""},{"location":"LLM-DOCS/COUPONS/#get-v1paymentscoupon","title":"<code>GET /v1/payments/coupon</code>","text":"<p>Purpose: Validate coupons for a specific plan Permissions: <code>AllowAny</code> Query Parameters: - <code>coupons</code> (optional): Comma-separated coupon slugs (e.g., <code>\"new-year-50,fakevalid\"</code>) - <code>plan</code> (required): Plan slug or ID</p> <p>Response: Array of valid coupon objects <pre><code>[\n    {\n        \"slug\": \"new-year-50\",\n        \"discount_type\": \"PERCENT_OFF\",\n        \"discount_value\": 0.5,\n        \"referral_type\": \"NO_REFERRAL\",\n        \"referral_value\": 0.0,\n        \"auto\": true,\n        \"offered_at\": \"2025-02-04T22:04:29Z\",\n        \"expires_at\": \"2026-10-06T17:52:36Z\"\n    }\n]\n</code></pre></p> <p>Behavior: - Returns only coupons valid for the specified plan - Filters by expiration, usage limits, and plan restrictions - Excludes coupons where user is the seller - Excludes user-restricted coupons not owned by the user</p>"},{"location":"LLM-DOCS/COUPONS/#user-endpoints","title":"User Endpoints","text":""},{"location":"LLM-DOCS/COUPONS/#get-v1paymentsmecoupon","title":"<code>GET /v1/payments/me/coupon</code>","text":"<p>Purpose: Get referral coupons for the authenticated user (as a seller) Permissions: Authenticated user Response: Array of coupon objects with associated plans</p> <p>Behavior: - Auto-creates a Seller if user doesn't have one - Auto-creates a referral coupon if none exists - Returns all coupons associated with the user's seller account</p>"},{"location":"LLM-DOCS/COUPONS/#get-v1paymentsmeusercoupons","title":"<code>GET /v1/payments/me/user/coupons</code>","text":"<p>Purpose: Get coupons restricted to the current user Permissions: Authenticated user Query Parameters: - <code>plan</code> (optional): Plan slug to check validity against</p> <p>Response: Array of coupon objects with <code>is_valid</code> field <pre><code>[\n    {\n        \"slug\": \"my-special-coupon\",\n        \"discount_type\": \"PERCENT_OFF\",\n        \"discount_value\": 0.2,\n        \"is_valid\": true,\n        ...\n    }\n]\n</code></pre></p>"},{"location":"LLM-DOCS/COUPONS/#put-v1paymentsmeusercouponscoupon_slug","title":"<code>PUT /v1/payments/me/user/coupons/&lt;coupon_slug&gt;</code>","text":"<p>Purpose: Toggle auto-apply for a user's restricted coupon Permissions: Authenticated user Response: <pre><code>{\n    \"coupon_slug\": \"my-special-coupon\",\n    \"auto\": true\n}\n</code></pre></p>"},{"location":"LLM-DOCS/COUPONS/#put-v1paymentsbagbag_idcoupon","title":"<code>PUT /v1/payments/bag/&lt;bag_id&gt;/coupon</code>","text":"<p>Purpose: Apply or remove coupons from a shopping bag Permissions: Authenticated user Query Parameters: - <code>coupons</code> (optional): Comma-separated coupon slugs (empty to remove all) - <code>plan</code> (required): Plan slug or ID</p> <p>Behavior: - Validates coupons are valid for the plan - Only works on bags in <code>CHECKING</code> status - Uses Redis lock to prevent concurrent modifications - Updates bag with validated coupons</p>"},{"location":"LLM-DOCS/COUPONS/#academy-endpoints","title":"Academy Endpoints","text":""},{"location":"LLM-DOCS/COUPONS/#get-v1paymentsacademycoupon","title":"<code>GET /v1/payments/academy/coupon</code>","text":"<p>Permission: <code>read_subscription</code> Query Parameters: - <code>plan</code> (optional): Filter by plan ID or slug - <code>like</code> (optional): Search by coupon slug - Standard pagination and sorting</p> <p>Response: Array of coupon objects associated with academy plans</p> <p>Filtering: - Shows coupons linked to academy-owned plans or global plans - If <code>plan</code> parameter provided, filters to coupons for that specific plan - Validates plan belongs to academy</p>"},{"location":"LLM-DOCS/COUPONS/#post-v1paymentsacademycoupon","title":"<code>POST /v1/payments/academy/coupon</code>","text":"<p>Permission: <code>crud_subscription</code> Payload: <pre><code>{\n    \"slug\": \"summer-2025\",\n    \"discount_type\": \"PERCENT_OFF\",\n    \"discount_value\": 0.25,\n    \"referral_type\": \"NO_REFERRAL\",\n    \"referral_value\": 0.0,\n    \"auto\": false,\n    \"how_many_offers\": 100,\n    \"plans\": [1, 2, 3],  // Plan IDs or slugs\n    \"offered_at\": \"2025-06-01T00:00:00Z\",\n    \"expires_at\": \"2025-08-31T23:59:59Z\"\n}\n</code></pre></p> <p>Validations: - All plans must belong to the academy (or be global) - If <code>referral_type != NO_REFERRAL</code>, <code>plans</code> must be empty - Slug must be unique - Discount/referral values must be positive</p>"},{"location":"LLM-DOCS/COUPONS/#put-v1paymentsacademycouponcoupon_slug","title":"<code>PUT /v1/payments/academy/coupon/&lt;coupon_slug&gt;</code>","text":"<p>Permission: <code>crud_subscription</code> Behavior: Partial updates supported Validations: Same as POST</p>"},{"location":"LLM-DOCS/COUPONS/#delete-v1paymentsacademycouponcoupon_slug","title":"<code>DELETE /v1/payments/academy/coupon/&lt;coupon_slug&gt;</code>","text":"<p>Permission: <code>crud_subscription</code> Response: 204 No Content</p> <p>Restrictions: - Only allows deleting coupons associated with academy plans</p>"},{"location":"LLM-DOCS/COUPONS/#coupon-validation-logic","title":"Coupon Validation Logic","text":"<p>The API validates coupons based on the following criteria:</p>"},{"location":"LLM-DOCS/COUPONS/#validation-rules_1","title":"Validation Rules","text":"<ol> <li>Expiration Check: Coupon must not be expired (<code>expires_at</code> is None or in future)</li> <li>Offer Date Check: Coupon must be available (<code>offered_at</code> is None or in past)</li> <li>Usage Limits: Coupon must have remaining uses (<code>how_many_offers</code> &gt; 0 or -1 for unlimited)</li> <li>Plan Restrictions:</li> <li>If coupon has plans, the specified plan must be in the list</li> <li>If coupon has no plans, it's global and applies to all plans</li> <li>Seller Exclusion: User cannot use their own referral coupons</li> <li>User Restrictions: If <code>allowed_user</code> is set, only that user can use the coupon</li> <li>Referral Program Exclusions: Plans with <code>exclude_from_referral_program=True</code> cannot use referral coupons</li> </ol>"},{"location":"LLM-DOCS/COUPONS/#discount-calculation","title":"Discount Calculation","text":"<p>When coupons are applied to a price:</p> <ol> <li>Percentage Discounts: Applied first (cumulative)</li> <li>Formula: <code>price = price * (1 - discount_value)</code></li> <li> <p>Example: $100 with 20% off = $80</p> </li> <li> <p>Fixed Price Discounts: Applied after percentage discounts</p> </li> <li>Formula: <code>price = price - discount_value</code></li> <li> <p>Example: $80 with $25 off = $55</p> </li> <li> <p>Price Floor: Final price cannot go below $0</p> </li> </ol>"},{"location":"LLM-DOCS/COUPONS/#multiple-coupons","title":"Multiple Coupons","text":"<p>The system supports applying multiple coupons (if <code>max_coupons_allowed() &gt; 1</code>). Default is 1 coupon per purchase.</p> <p>Example Calculation: - Original: $100 - Coupon 1 (10% off): $90 - Coupon 2 ($25 off): $65 - Final: $65</p>"},{"location":"LLM-DOCS/COUPONS/#coupon-application-flow","title":"Coupon Application Flow","text":""},{"location":"LLM-DOCS/COUPONS/#1-user-applies-coupon-during-checkout","title":"1. User Applies Coupon During Checkout","text":"<pre><code>1. User enters coupon code in frontend\n2. Frontend calls: GET /v1/payments/coupon?coupons=CODE&amp;plan=PLAN_SLUG\n3. API validates coupon and returns valid coupons\n4. If valid, frontend calls: PUT /v1/payments/bag/BAG_ID/coupon?coupons=CODE&amp;plan=PLAN_SLUG\n5. Bag is updated with coupon\n6. Price is recalculated with discount\n</code></pre>"},{"location":"LLM-DOCS/COUPONS/#2-auto-applied-coupons","title":"2. Auto-Applied Coupons","text":"<pre><code>1. User adds plan to bag\n2. System checks for auto-applied coupons (auto=True)\n3. Validates coupons for the plan\n4. Automatically adds to bag\n5. User sees discount in checkout\n</code></pre>"},{"location":"LLM-DOCS/COUPONS/#3-coupon-persistence","title":"3. Coupon Persistence","text":"<pre><code>1. Coupons are stored on Bag during checkout\n2. When payment succeeds, coupons are copied to:\n   - Subscription.coupons (for subscriptions)\n   - PlanFinancing.coupons (for plan financings)\n3. Coupons persist for renewals\n4. Coupons are excluded from renewals if:\n   - Expired\n   - User is the seller\n   - Referral type is not NO_REFERRAL\n</code></pre>"},{"location":"LLM-DOCS/COUPONS/#discount-calculation_1","title":"Discount Calculation","text":""},{"location":"LLM-DOCS/COUPONS/#percentage-discount","title":"Percentage Discount","text":"<p>Formula: <code>discounted_price = original_price * (1 - discount_value)</code></p> <p>Example: - Original: $100 - Discount: 20% (discount_value = 0.2) - Final: $80</p>"},{"location":"LLM-DOCS/COUPONS/#fixed-price-discount","title":"Fixed Price Discount","text":"<p>Formula: <code>discounted_price = original_price - discount_value</code></p> <p>Example: - Original: $100 - Discount: $25 (discount_value = 25) - Final: $75</p>"},{"location":"LLM-DOCS/COUPONS/#multiple-coupons_1","title":"Multiple Coupons","text":"<p>When multiple coupons are applied: 1. Percentage discounts are applied first (cumulative) 2. Fixed price discounts are applied after 3. Price cannot go below 0</p> <p>Example: - Original: $100 - Coupon 1: 10% off \u2192 $90 - Coupon 2: $20 off \u2192 $70 - Final: $70</p>"},{"location":"LLM-DOCS/COUPONS/#referral-system","title":"Referral System","text":""},{"location":"LLM-DOCS/COUPONS/#how-referral-coupons-work","title":"How Referral Coupons Work","text":"<ol> <li>Seller Creation: User becomes a seller (auto-created via <code>/me/coupon</code>)</li> <li>Coupon Generation: System creates referral coupon for seller</li> <li>Coupon Sharing: Seller shares their coupon code</li> <li>Purchase: Buyer uses seller's coupon</li> <li>Commission: Seller earns commission based on <code>referral_value</code></li> </ol>"},{"location":"LLM-DOCS/COUPONS/#referral-coupon-rules","title":"Referral Coupon Rules","text":"<ul> <li><code>referral_type != NO_REFERRAL</code> means coupon is for referrals</li> <li>Referral coupons should have empty <code>plans</code> (apply to all plans)</li> <li>Individual plans can opt-out via <code>plan.exclude_from_referral_program</code></li> <li>Sellers cannot use their own referral coupons</li> <li>Referral coupons are excluded from renewals</li> </ul>"},{"location":"LLM-DOCS/COUPONS/#commission-calculation","title":"Commission Calculation","text":"<p>Percentage Commission: - Formula: <code>commission = purchase_amount * referral_value</code> - Example: $100 purchase with 10% commission = $10 commission</p> <p>Fixed Commission: - Formula: <code>commission = referral_value</code> - Example: Fixed commission of $25 = $25 commission regardless of purchase amount</p>"},{"location":"LLM-DOCS/COUPONS/#usage-limits","title":"Usage Limits","text":""},{"location":"LLM-DOCS/COUPONS/#how_many_offers-field","title":"<code>how_many_offers</code> Field","text":"<ul> <li>-1: Unlimited uses (default)</li> <li>0: Coupon disabled (nobody can use it)</li> <li>&gt;0: Maximum number of uses</li> </ul>"},{"location":"LLM-DOCS/COUPONS/#usage-tracking","title":"Usage Tracking","text":"<p>System tracks usage by counting: - Subscriptions using the coupon - Plan financings using the coupon</p> <p>Note: Usage is counted per purchase, not per user. A single user can use a coupon multiple times if <code>how_many_offers</code> allows.</p>"},{"location":"LLM-DOCS/COUPONS/#user-restrictions","title":"User Restrictions","text":""},{"location":"LLM-DOCS/COUPONS/#allowed_user-field","title":"<code>allowed_user</code> Field","text":"<p>When set, only the specified user can use the coupon.</p> <p>Use Cases: - Personalized offers - Reward coupons for specific users - Test coupons for specific accounts</p> <p>Behavior: - Coupon is invisible to other users - Only appears in <code>/me/user/coupons</code> for the allowed user - Validation fails if different user tries to use it</p>"},{"location":"LLM-DOCS/COUPONS/#auto-applied-coupons","title":"Auto-Applied Coupons","text":""},{"location":"LLM-DOCS/COUPONS/#auto-field","title":"<code>auto</code> Field","text":"<p>When <code>auto=True</code>, the coupon is automatically applied during checkout if: 1. Coupon is valid for the plan 2. Coupon hasn't expired 3. Usage limit hasn't been reached 4. User restrictions are met (if any)</p> <p>Use Cases: - Promotional campaigns - Special offers - Seasonal discounts</p> <p>Note: Auto-applied coupons are shown in the bag response but cannot be removed by the user.</p>"},{"location":"LLM-DOCS/COUPONS/#plan-restrictions","title":"Plan Restrictions","text":""},{"location":"LLM-DOCS/COUPONS/#global-coupons","title":"Global Coupons","text":"<p>If <code>coupon.plans</code> is empty: - Coupon applies to ALL plans - No plan-specific restrictions - Typically used for referral coupons</p>"},{"location":"LLM-DOCS/COUPONS/#scoped-coupons","title":"Scoped Coupons","text":"<p>If <code>coupon.plans</code> has entries: - Coupon only applies to listed plans - Validation checks if plan is in the list - Used for plan-specific promotions</p> <p>Example: - Coupon with <code>plans: [1, 2]</code> only works for plans with ID 1 and 2 - Coupon with <code>plans: []</code> works for all plans</p>"},{"location":"LLM-DOCS/COUPONS/#time-based-validity","title":"Time-Based Validity","text":""},{"location":"LLM-DOCS/COUPONS/#offered_at","title":"<code>offered_at</code>","text":"<p>When the coupon becomes available. If <code>None</code>, coupon is always available.</p> <p>Use Cases: - Future promotions - Scheduled campaigns</p>"},{"location":"LLM-DOCS/COUPONS/#expires_at","title":"<code>expires_at</code>","text":"<p>When the coupon expires. If <code>None</code>, coupon never expires.</p> <p>Use Cases: - Limited-time offers - Seasonal promotions - Campaign deadlines</p> <p>Validation: - Coupons with <code>expires_at</code> in the past are invalid - Coupons with <code>offered_at</code> in the future are invalid</p>"},{"location":"LLM-DOCS/COUPONS/#response-formats","title":"Response Formats","text":""},{"location":"LLM-DOCS/COUPONS/#coupon-response-object","title":"Coupon Response Object","text":"<p>Standard Coupon Response: <pre><code>{\n    \"slug\": \"new-year-50\",\n    \"discount_type\": \"PERCENT_OFF\",\n    \"discount_value\": 0.5,\n    \"referral_type\": \"NO_REFERRAL\",\n    \"referral_value\": 0.0,\n    \"auto\": true,\n    \"allowed_user\": {\n        \"id\": 123,\n        \"first_name\": \"John\",\n        \"last_name\": \"Doe\",\n        \"email\": \"john@example.com\"\n    },\n    \"offered_at\": \"2025-02-04T22:04:29Z\",\n    \"expires_at\": \"2026-10-06T17:52:36Z\"\n}\n</code></pre></p> <p>Coupon with Plans: Includes <code>plans</code> array with plan details when using endpoints that return plan associations.</p>"},{"location":"LLM-DOCS/COUPONS/#request-payload-postput","title":"Request Payload (POST/PUT)","text":"<p>Required Fields: - <code>slug</code> (string) - <code>discount_type</code> (string) - <code>discount_value</code> (number) - <code>referral_type</code> (string) - <code>referral_value</code> (number)</p> <p>Optional Fields: - <code>auto</code> (boolean) - <code>how_many_offers</code> (integer) - <code>plans</code> (array of integers or strings - plan IDs or slugs) - <code>offered_at</code> (datetime string) - <code>expires_at</code> (datetime string) - <code>allowed_user</code> (integer - user ID) - <code>seller</code> (integer - seller ID) - <code>referred_buyer</code> (integer - user ID)</p>"},{"location":"LLM-DOCS/COUPONS/#api-use-cases","title":"API Use Cases","text":"<p>This section provides detailed, step-by-step use cases for common coupon scenarios with complete API request/response examples.</p>"},{"location":"LLM-DOCS/COUPONS/#use-case-1-user-applies-coupon-during-checkout","title":"Use Case 1: User Applies Coupon During Checkout","text":"<p>Scenario: A user wants to apply a promotional coupon code during checkout.</p> <p>Step 1: Validate the Coupon</p> <pre><code>GET /v1/payments/coupon?coupons=SUMMER2025&amp;plan=4geeks-plus-subscription\n</code></pre> <p>Request: <pre><code>curl -X GET \"https://api.4geeks.com/v1/payments/coupon?coupons=SUMMER2025&amp;plan=4geeks-plus-subscription\"\n</code></pre></p> <p>Response (200 OK): <pre><code>[\n    {\n        \"slug\": \"SUMMER2025\",\n        \"discount_type\": \"PERCENT_OFF\",\n        \"discount_value\": 0.25,\n        \"referral_type\": \"NO_REFERRAL\",\n        \"referral_value\": 0.0,\n        \"auto\": false,\n        \"offered_at\": \"2025-06-01T00:00:00Z\",\n        \"expires_at\": \"2025-08-31T23:59:59Z\"\n    }\n]\n</code></pre></p> <p>Response (Empty Array - Invalid Coupon): <pre><code>[]\n</code></pre></p> <p>Error Handling: - If coupon is invalid, returns empty array - Frontend should show: \"This coupon is invalid or doesn't work for the 4Geeks Plus Subscription plan. If you think this is an error, contact support@learnpack.co\"</p> <p>Step 2: Apply Coupon to Bag</p> <pre><code>PUT /v1/payments/bag/{bag_id}/coupon?coupons=SUMMER2025&amp;plan=4geeks-plus-subscription\n</code></pre> <p>Request: <pre><code>curl -X PUT \"https://api.4geeks.com/v1/payments/bag/12345/coupon?coupons=SUMMER2025&amp;plan=4geeks-plus-subscription\" \\\n  -H \"Authorization: Token abc123def456\" \\\n  -H \"Content-Type: application/json\"\n</code></pre></p> <p>Response (200 OK): <pre><code>{\n    \"id\": 12345,\n    \"status\": \"CHECKING\",\n    \"type\": \"BAG\",\n    \"plans\": [...],\n    \"coupons\": [\n        {\n            \"slug\": \"SUMMER2025\",\n            \"discount_type\": \"PERCENT_OFF\",\n            \"discount_value\": 0.25,\n            \"referral_type\": \"NO_REFERRAL\",\n            \"referral_value\": 0.0,\n            \"auto\": false,\n            \"offered_at\": \"2025-06-01T00:00:00Z\",\n            \"expires_at\": \"2025-08-31T23:59:59Z\"\n        }\n    ],\n    \"amount_per_month\": 75.00,\n    \"amount_per_year\": 600.00\n}\n</code></pre></p> <p>Step 3: Remove Coupon from Bag</p> <pre><code>PUT /v1/payments/bag/{bag_id}/coupon?coupons=&amp;plan=4geeks-plus-subscription\n</code></pre> <p>Request: <pre><code>curl -X PUT \"https://api.4geeks.com/v1/payments/bag/12345/coupon?coupons=&amp;plan=4geeks-plus-subscription\" \\\n  -H \"Authorization: Token abc123def456\"\n</code></pre></p> <p>Note: Empty <code>coupons</code> parameter removes all manually applied coupons (auto-applied coupons remain).</p>"},{"location":"LLM-DOCS/COUPONS/#use-case-2-academy-creates-a-promotional-coupon","title":"Use Case 2: Academy Creates a Promotional Coupon","text":"<p>Scenario: An academy wants to create a limited-time promotional coupon for a specific plan.</p> <p>Step 1: Create the Coupon</p> <pre><code>POST /v1/payments/academy/coupon\n</code></pre> <p>Request: <pre><code>curl -X POST \"https://api.4geeks.com/v1/payments/academy/coupon\" \\\n  -H \"Authorization: Token academy_token\" \\\n  -H \"Academy: 1\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"slug\": \"black-friday-2025\",\n    \"discount_type\": \"PERCENT_OFF\",\n    \"discount_value\": 0.4,\n    \"referral_type\": \"NO_REFERRAL\",\n    \"referral_value\": 0.0,\n    \"auto\": false,\n    \"how_many_offers\": 50,\n    \"plans\": [1, 2],\n    \"offered_at\": \"2025-11-25T00:00:00Z\",\n    \"expires_at\": \"2025-11-30T23:59:59Z\"\n  }'\n</code></pre></p> <p>Response (201 Created): <pre><code>{\n    \"slug\": \"black-friday-2025\",\n    \"discount_type\": \"PERCENT_OFF\",\n    \"discount_value\": 0.4,\n    \"referral_type\": \"NO_REFERRAL\",\n    \"referral_value\": 0.0,\n    \"auto\": false,\n    \"offered_at\": \"2025-11-25T00:00:00Z\",\n    \"expires_at\": \"2025-11-30T23:59:59Z\"\n}\n</code></pre></p> <p>Error Responses:</p> <p>400 Bad Request - Invalid Plan: <pre><code>{\n    \"detail\": \"Plan 999 does not belong to this academy\",\n    \"slug\": \"plan-not-belonging-to-academy\"\n}\n</code></pre></p> <p>400 Bad Request - Invalid Referral Type: <pre><code>{\n    \"detail\": \"If referral_type is not NO_REFERRAL, plans must be empty\",\n    \"slug\": \"invalid-referral-coupon-with-plans\"\n}\n</code></pre></p> <p>Step 2: List Academy Coupons</p> <pre><code>GET /v1/payments/academy/coupon\n</code></pre> <p>Request: <pre><code>curl -X GET \"https://api.4geeks.com/v1/payments/academy/coupon\" \\\n  -H \"Authorization: Token academy_token\" \\\n  -H \"Academy: 1\"\n</code></pre></p> <p>Response (200 OK): <pre><code>{\n    \"count\": 5,\n    \"next\": null,\n    \"previous\": null,\n    \"results\": [\n        {\n            \"slug\": \"black-friday-2025\",\n            \"discount_type\": \"PERCENT_OFF\",\n            \"discount_value\": 0.4,\n            ...\n        },\n        ...\n    ]\n}\n</code></pre></p> <p>Step 3: Filter Coupons by Plan</p> <pre><code>GET /v1/payments/academy/coupon?plan=4geeks-plus-subscription\n</code></pre> <p>Request: <pre><code>curl -X GET \"https://api.4geeks.com/v1/payments/academy/coupon?plan=4geeks-plus-subscription\" \\\n  -H \"Authorization: Token academy_token\" \\\n  -H \"Academy: 1\"\n</code></pre></p> <p>Response: Returns only coupons valid for the specified plan.</p>"},{"location":"LLM-DOCS/COUPONS/#use-case-3-user-gets-their-referral-coupon","title":"Use Case 3: User Gets Their Referral Coupon","text":"<p>Scenario: A user wants to get their referral coupon code to share with others.</p> <p>Step 1: Get User's Referral Coupon</p> <pre><code>GET /v1/payments/me/coupon\n</code></pre> <p>Request: <pre><code>curl -X GET \"https://api.4geeks.com/v1/payments/me/coupon\" \\\n  -H \"Authorization: Token user_token\"\n</code></pre></p> <p>Response (200 OK): <pre><code>[\n    {\n        \"slug\": \"referral-ABC123-456\",\n        \"discount_type\": \"PERCENT_OFF\",\n        \"discount_value\": 0.1,\n        \"referral_type\": \"PERCENTAGE\",\n        \"referral_value\": 0.1,\n        \"auto\": false,\n        \"plans\": []\n    }\n]\n</code></pre></p> <p>Behavior: - Auto-creates Seller if user doesn't have one - Auto-creates referral coupon if none exists - Returns all coupons associated with user's seller account</p> <p>Step 2: Share the Coupon Code</p> <p>The user can share the <code>slug</code> (e.g., \"referral-ABC123-456\") with others. When someone uses it: - Buyer gets 10% discount - User (seller) earns 10% commission</p>"},{"location":"LLM-DOCS/COUPONS/#use-case-4-user-views-their-restricted-coupons","title":"Use Case 4: User Views Their Restricted Coupons","text":"<p>Scenario: A user wants to see coupons that were specifically created for them.</p> <p>Step 1: Get User's Restricted Coupons</p> <pre><code>GET /v1/payments/me/user/coupons?plan=4geeks-plus-subscription\n</code></pre> <p>Request: <pre><code>curl -X GET \"https://api.4geeks.com/v1/payments/me/user/coupons?plan=4geeks-plus-subscription\" \\\n  -H \"Authorization: Token user_token\"\n</code></pre></p> <p>Response (200 OK): <pre><code>{\n    \"count\": 2,\n    \"results\": [\n        {\n            \"slug\": \"welcome-bonus-123\",\n            \"discount_type\": \"FIXED_PRICE\",\n            \"discount_value\": 50.0,\n            \"referral_type\": \"NO_REFERRAL\",\n            \"referral_value\": 0.0,\n            \"auto\": false,\n            \"is_valid\": true,\n            \"offered_at\": \"2025-01-01T00:00:00Z\",\n            \"expires_at\": \"2025-12-31T23:59:59Z\"\n        },\n        {\n            \"slug\": \"loyalty-reward-456\",\n            \"discount_type\": \"PERCENT_OFF\",\n            \"discount_value\": 0.15,\n            \"referral_type\": \"NO_REFERRAL\",\n            \"referral_value\": 0.0,\n            \"auto\": true,\n            \"is_valid\": true,\n            \"offered_at\": \"2025-06-01T00:00:00Z\",\n            \"expires_at\": null\n        }\n    ]\n}\n</code></pre></p> <p>Note: The <code>is_valid</code> field indicates if the coupon is valid for the specified plan.</p> <p>Step 2: Toggle Auto-Apply</p> <pre><code>PUT /v1/payments/me/user/coupons/welcome-bonus-123\n</code></pre> <p>Request: <pre><code>curl -X PUT \"https://api.4geeks.com/v1/payments/me/user/coupons/welcome-bonus-123\" \\\n  -H \"Authorization: Token user_token\"\n</code></pre></p> <p>Response (200 OK): <pre><code>{\n    \"coupon_slug\": \"welcome-bonus-123\",\n    \"auto\": true\n}\n</code></pre></p>"},{"location":"LLM-DOCS/COUPONS/#use-case-5-academy-updates-a-coupon","title":"Use Case 5: Academy Updates a Coupon","text":"<p>Scenario: An academy wants to extend a coupon's expiration date.</p> <p>Step 1: Update the Coupon</p> <pre><code>PUT /v1/payments/academy/coupon/black-friday-2025\n</code></pre> <p>Request: <pre><code>curl -X PUT \"https://api.4geeks.com/v1/payments/academy/coupon/black-friday-2025\" \\\n  -H \"Authorization: Token academy_token\" \\\n  -H \"Academy: 1\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"expires_at\": \"2025-12-05T23:59:59Z\"\n  }'\n</code></pre></p> <p>Response (200 OK): <pre><code>{\n    \"slug\": \"black-friday-2025\",\n    \"discount_type\": \"PERCENT_OFF\",\n    \"discount_value\": 0.4,\n    \"referral_type\": \"NO_REFERRAL\",\n    \"referral_value\": 0.0,\n    \"auto\": false,\n    \"how_many_offers\": 50,\n    \"offered_at\": \"2025-11-25T00:00:00Z\",\n    \"expires_at\": \"2025-12-05T23:59:59Z\"\n}\n</code></pre></p> <p>Note: Partial updates are supported - only include fields you want to change.</p>"},{"location":"LLM-DOCS/COUPONS/#use-case-6-academy-deletes-a-coupon","title":"Use Case 6: Academy Deletes a Coupon","text":"<p>Scenario: An academy wants to remove a coupon that's no longer needed.</p> <p>Step 1: Delete the Coupon</p> <pre><code>DELETE /v1/payments/academy/coupon/black-friday-2025\n</code></pre> <p>Request: <pre><code>curl -X DELETE \"https://api.4geeks.com/v1/payments/academy/coupon/black-friday-2025\" \\\n  -H \"Authorization: Token academy_token\" \\\n  -H \"Academy: 1\"\n</code></pre></p> <p>Response (204 No Content)</p> <p>Error Response (404 Not Found): <pre><code>{\n    \"detail\": \"Coupon not found\",\n    \"slug\": \"not-found\"\n}\n</code></pre></p>"},{"location":"LLM-DOCS/COUPONS/#use-case-7-complete-checkout-flow-with-coupon","title":"Use Case 7: Complete Checkout Flow with Coupon","text":"<p>Scenario: End-to-end checkout process with coupon application.</p> <p>Step 1: User Adds Plan to Bag</p> <pre><code>POST /v1/payments/bag\n</code></pre> <p>Request: <pre><code>curl -X POST \"https://api.4geeks.com/v1/payments/bag\" \\\n  -H \"Authorization: Token user_token\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"plans\": [\"4geeks-plus-subscription\"],\n    \"chosen_period\": \"YEAR\"\n  }'\n</code></pre></p> <p>Response (201 Created): <pre><code>{\n    \"id\": 12345,\n    \"status\": \"CHECKING\",\n    \"plans\": [...],\n    \"coupons\": [\n        {\n            \"slug\": \"auto-applied-special\",\n            \"discount_type\": \"PERCENT_OFF\",\n            \"discount_value\": 0.1,\n            \"auto\": true\n        }\n    ],\n    \"amount_per_year\": 900.00\n}\n</code></pre></p> <p>Note: Auto-applied coupons are automatically included.</p> <p>Step 2: User Enters Coupon Code</p> <p>Frontend calls validation endpoint (see Use Case 1, Step 1).</p> <p>Step 3: Apply User-Entered Coupon</p> <pre><code>PUT /v1/payments/bag/12345/coupon?coupons=SUMMER2025&amp;plan=4geeks-plus-subscription\n</code></pre> <p>Response: <pre><code>{\n    \"id\": 12345,\n    \"coupons\": [\n        {\n            \"slug\": \"auto-applied-special\",\n            \"auto\": true\n        },\n        {\n            \"slug\": \"SUMMER2025\",\n            \"auto\": false\n        }\n    ],\n    \"amount_per_year\": 675.00  // Discounted price\n}\n</code></pre></p> <p>Step 4: Complete Payment</p> <pre><code>POST /v1/payments/pay\n</code></pre> <p>Request: <pre><code>curl -X POST \"https://api.4geeks.com/v1/payments/pay\" \\\n  -H \"Authorization: Token user_token\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"token\": \"bag_token_12345\",\n    \"payment_method\": \"stripe\"\n  }'\n</code></pre></p> <p>Result: Coupons are persisted to the Subscription and will be applied to renewals (if valid).</p>"},{"location":"LLM-DOCS/COUPONS/#use-case-8-multiple-coupons-if-allowed","title":"Use Case 8: Multiple Coupons (If Allowed)","text":"<p>Scenario: System allows multiple coupons (if <code>max_coupons_allowed() &gt; 1</code>).</p> <p>Step 1: Validate Multiple Coupons</p> <pre><code>GET /v1/payments/coupon?coupons=COUPON1,COUPON2&amp;plan=4geeks-plus-subscription\n</code></pre> <p>Response: <pre><code>[\n    {\n        \"slug\": \"COUPON1\",\n        \"discount_type\": \"PERCENT_OFF\",\n        \"discount_value\": 0.1\n    },\n    {\n        \"slug\": \"COUPON2\",\n        \"discount_type\": \"FIXED_PRICE\",\n        \"discount_value\": 25.0\n    }\n]\n</code></pre></p> <p>Step 2: Apply Multiple Coupons</p> <pre><code>PUT /v1/payments/bag/12345/coupon?coupons=COUPON1,COUPON2&amp;plan=4geeks-plus-subscription\n</code></pre> <p>Discount Calculation: - Original: $100 - COUPON1 (10% off): $90 - COUPON2 ($25 off): $65 - Final: $65</p>"},{"location":"LLM-DOCS/COUPONS/#use-case-9-error-handling-examples","title":"Use Case 9: Error Handling Examples","text":"<p>Invalid Coupon Code:</p> <pre><code>GET /v1/payments/coupon?coupons=INVALID&amp;plan=4geeks-plus-subscription\n</code></pre> <p>Response (200 OK - Empty Array): <pre><code>[]\n</code></pre></p> <p>Frontend should show: \"This coupon is invalid or doesn't work for the 4Geeks Plus Subscription plan.\"</p> <p>Expired Coupon:</p> <pre><code>GET /v1/payments/coupon?coupons=EXPIRED2024&amp;plan=4geeks-plus-subscription\n</code></pre> <p>Response (200 OK - Empty Array): <pre><code>[]\n</code></pre></p> <p>Coupon Usage Limit Reached:</p> <pre><code>GET /v1/payments/coupon?coupons=LIMITED50&amp;plan=4geeks-plus-subscription\n</code></pre> <p>Response (200 OK - Empty Array): <pre><code>[]\n</code></pre></p> <p>Plan Doesn't Belong to Academy (Academy Endpoint):</p> <pre><code>POST /v1/payments/academy/coupon\n{\n    \"slug\": \"test\",\n    \"plans\": [999]  // Plan from different academy\n}\n</code></pre> <p>Response (403 Forbidden): <pre><code>{\n    \"detail\": \"Plan 999 does not belong to this academy\",\n    \"slug\": \"plan-not-belonging-to-academy\"\n}\n</code></pre></p> <p>Bag Not Found:</p> <pre><code>PUT /v1/payments/bag/99999/coupon?coupons=TEST&amp;plan=4geeks-plus-subscription\n</code></pre> <p>Response (404 Not Found): <pre><code>{\n    \"detail\": \"Bag not found\",\n    \"slug\": \"bag-not-found\"\n}\n</code></pre></p> <p>Unauthorized Access:</p> <pre><code>GET /v1/payments/academy/coupon\n# Missing Academy header or insufficient permissions\n</code></pre> <p>Response (403 Forbidden): <pre><code>{\n    \"detail\": \"You don't have permission to perform this action.\"\n}\n</code></pre></p>"},{"location":"LLM-DOCS/COUPONS/#additional-api-examples","title":"Additional API Examples","text":""},{"location":"LLM-DOCS/COUPONS/#example-1-validate-and-apply-coupon","title":"Example 1: Validate and Apply Coupon","text":"<pre><code># 1. Validate coupon\ncurl \"https://api.4geeks.com/v1/payments/coupon?coupons=summer-2025&amp;plan=4geeks-plus-subscription\"\n\n# 2. Apply to bag\ncurl -X PUT \"https://api.4geeks.com/v1/payments/bag/123/coupon?coupons=summer-2025&amp;plan=4geeks-plus-subscription\" \\\n  -H \"Authorization: Token abc123\"\n</code></pre>"},{"location":"LLM-DOCS/COUPONS/#example-2-academy-creates-coupon","title":"Example 2: Academy Creates Coupon","text":"<pre><code>curl -X POST \"https://api.4geeks.com/v1/payments/academy/coupon\" \\\n  -H \"Authorization: Token abc123\" \\\n  -H \"Academy: 1\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"slug\": \"academy-special\",\n    \"discount_type\": \"PERCENT_OFF\",\n    \"discount_value\": 0.15,\n    \"referral_type\": \"NO_REFERRAL\",\n    \"referral_value\": 0.0,\n    \"plans\": [1, 2],\n    \"expires_at\": \"2025-12-31T23:59:59Z\"\n  }'\n</code></pre>"},{"location":"LLM-DOCS/COUPONS/#example-3-academy-lists-coupons-with-filtering","title":"Example 3: Academy Lists Coupons with Filtering","text":"<pre><code># List all academy coupons\ncurl -X GET \"https://api.4geeks.com/v1/payments/academy/coupon\" \\\n  -H \"Authorization: Token abc123\" \\\n  -H \"Academy: 1\"\n\n# Filter by plan\ncurl -X GET \"https://api.4geeks.com/v1/payments/academy/coupon?plan=4geeks-plus-subscription\" \\\n  -H \"Authorization: Token abc123\" \\\n  -H \"Academy: 1\"\n\n# Search by slug\ncurl -X GET \"https://api.4geeks.com/v1/payments/academy/coupon?like=summer\" \\\n  -H \"Authorization: Token abc123\" \\\n  -H \"Academy: 1\"\n</code></pre>"},{"location":"LLM-DOCS/COUPONS/#best-practices","title":"Best Practices","text":""},{"location":"LLM-DOCS/COUPONS/#coupon-design","title":"Coupon Design","text":"<ol> <li>Use Descriptive Slugs: Make slugs memorable and campaign-specific</li> <li>Good: <code>summer-2025-25off</code></li> <li> <p>Bad: <code>coupon-123</code></p> </li> <li> <p>Set Expiration Dates: Always set <code>expires_at</code> for promotional coupons</p> </li> <li>Prevents accidental long-term discounts</li> <li> <p>Creates urgency for users</p> </li> <li> <p>Limit Usage: Set <code>how_many_offers</code> for limited promotions</p> </li> <li>Prevents abuse</li> <li> <p>Creates scarcity</p> </li> <li> <p>Plan Restrictions: Use <code>plans</code> field for plan-specific offers</p> </li> <li>More targeted promotions</li> <li>Better control over discount application</li> </ol>"},{"location":"LLM-DOCS/COUPONS/#security","title":"Security","text":"<ol> <li>Slug Uniqueness: System validates slug uniqueness automatically</li> <li>User Restrictions: Use <code>allowed_user</code> for personalized offers</li> <li>Seller Validation: Sellers cannot use their own referral coupons</li> <li>Expiration Checks: Always validate expiration before applying</li> </ol>"},{"location":"LLM-DOCS/COUPONS/#performance","title":"Performance","text":"<ol> <li>Caching: Coupon validation results can be cached on the client side</li> <li>Batch Validation: Validate multiple coupons in a single API call (comma-separated slugs)</li> <li>Efficient Filtering: Use query parameters to filter coupons server-side</li> </ol>"},{"location":"LLM-DOCS/COUPONS/#referral-programs","title":"Referral Programs","text":"<ol> <li>Empty Plans: Referral coupons should have empty <code>plans</code> field</li> <li>Plan Exclusions: Use <code>plan.exclude_from_referral_program</code> to opt-out</li> <li>Commission Tracking: Track commissions separately from discounts</li> <li>Seller Management: Auto-create sellers for users requesting referral coupons</li> </ol>"},{"location":"LLM-DOCS/COUPONS/#troubleshooting","title":"Troubleshooting","text":""},{"location":"LLM-DOCS/COUPONS/#issue-coupon-not-validating","title":"Issue: Coupon Not Validating","text":"<p>Checklist: 1. Is coupon expired? (<code>expires_at</code> in past) 2. Has offer started? (<code>offered_at</code> in future) 3. Usage limit reached? (<code>how_many_offers</code> = 0) 4. Plan restriction? (Plan not in <code>coupon.plans</code>) 5. User restriction? (<code>allowed_user</code> set to different user) 6. User is seller? (Sellers can't use own coupons)</p>"},{"location":"LLM-DOCS/COUPONS/#issue-discount-not-applying","title":"Issue: Discount Not Applying","text":"<p>Check: 1. Coupon validated successfully? 2. Coupon added to bag? 3. Price calculation includes coupons? 4. Multiple coupons exceeding max allowed?</p>"},{"location":"LLM-DOCS/COUPONS/#issue-auto-applied-coupon-not-showing","title":"Issue: Auto-Applied Coupon Not Showing","text":"<p>Check: 1. <code>auto=True</code> set? 2. Coupon valid for the plan? 3. Not expired? 4. Usage limit not reached? 5. User restrictions met?</p>"},{"location":"LLM-DOCS/COUPONS/#issue-referral-coupon-not-working","title":"Issue: Referral Coupon Not Working","text":"<p>Requirements: 1. <code>referral_type != NO_REFERRAL</code> 2. <code>plans</code> field is empty 3. Plan doesn't have <code>exclude_from_referral_program=True</code> 4. User is not the seller 5. <code>referral_value</code> is set correctly</p>"},{"location":"LLM-DOCS/COUPONS/#integration-points","title":"Integration Points","text":""},{"location":"LLM-DOCS/COUPONS/#bag-system","title":"Bag System","text":"<ul> <li>Coupons stored on <code>Bag.coupons</code> during checkout</li> <li>Applied during price calculation</li> <li>Persisted to Subscription/PlanFinancing on payment</li> </ul>"},{"location":"LLM-DOCS/COUPONS/#subscription-system","title":"Subscription System","text":"<ul> <li>Coupons copied from Bag to Subscription on creation</li> <li>Excluded from renewals if expired or referral type</li> <li>Used for renewal price calculations</li> </ul>"},{"location":"LLM-DOCS/COUPONS/#plan-financing","title":"Plan Financing","text":"<ul> <li>Coupons copied from Bag to PlanFinancing on creation</li> <li>Applied to initial payment</li> <li>Not applied to installments</li> </ul>"},{"location":"LLM-DOCS/COUPONS/#notification-system","title":"Notification System","text":"<ul> <li>Coupon validation errors sent to users</li> <li>Referral commission notifications to sellers</li> <li>Expiration reminders (if implemented)</li> </ul>"},{"location":"LLM-DOCS/COUPONS/#future-enhancements","title":"Future Enhancements","text":""},{"location":"LLM-DOCS/COUPONS/#potential-features","title":"Potential Features","text":"<ol> <li>Coupon Categories</li> <li>Group coupons by type</li> <li> <p>Category-based filtering</p> </li> <li> <p>Stacking Rules</p> </li> <li>Define which coupons can be combined</li> <li> <p>Priority ordering</p> </li> <li> <p>Minimum Purchase Requirements</p> </li> <li>Require minimum amount before coupon applies</li> <li> <p>Tiered discounts</p> </li> <li> <p>First-Time User Coupons</p> </li> <li>Auto-apply for new users</li> <li> <p>One-time use enforcement</p> </li> <li> <p>Bulk Coupon Generation</p> </li> <li>Generate multiple unique coupons</li> <li> <p>Campaign management</p> </li> <li> <p>Analytics Dashboard</p> </li> <li>Usage statistics</li> <li>Revenue impact</li> <li>Conversion tracking</li> </ol>"},{"location":"LLM-DOCS/COUPONS/#summary","title":"Summary","text":"<p>The Coupon system provides a flexible, powerful discount and referral management solution for the BreatheCode platform. It supports:</p> <ul> <li>Multiple discount types (percentage, fixed, none)</li> <li>Referral programs with seller commissions</li> <li>Time-based validity with offer and expiration dates</li> <li>Usage limits for controlled promotions</li> <li>User restrictions for personalized offers</li> <li>Auto-application for seamless user experience</li> <li>Plan scoping for targeted discounts</li> <li>Academy management for plan-specific coupons</li> </ul> <p>The system integrates seamlessly with the Bag, Subscription, and PlanFinancing systems, ensuring discounts are properly applied and tracked throughout the payment lifecycle.</p>"},{"location":"LLM-DOCS/COUPONS/#coupon-statistics","title":"Coupon Statistics","text":""},{"location":"LLM-DOCS/COUPONS/#overview_1","title":"Overview","text":"<p>The coupon system tracks usage statistics to provide insights into coupon performance. Statistics are calculated automatically for recently active coupons and stored in the <code>stats</code> JSONField.</p>"},{"location":"LLM-DOCS/COUPONS/#statistics-fields","title":"Statistics Fields","text":"<p>Basic Tracking: - <code>times_used</code> (integer): Total number of times the coupon has been used (always available) - <code>last_used_at</code> (datetime): When the coupon was last used (always available)</p> <p>Detailed Statistics (calculated): - <code>stats</code> (JSON): Detailed statistics object (only calculated for recently active coupons) - <code>stats_updated_at</code> (datetime): When stats were last calculated</p>"},{"location":"LLM-DOCS/COUPONS/#statistics-structure","title":"Statistics Structure","text":"<p>The <code>stats</code> JSON object contains:</p> <pre><code>{\n    \"times_used\": 42,\n    \"first_used_at\": \"2025-01-15T10:30:00Z\",\n    \"last_used_at\": \"2025-02-20T14:22:00Z\",\n    \"revenue\": {\n        \"total_revenue_generated\": 12500.00,\n        \"total_discount_given\": 2500.00,\n        \"average_order_value\": 297.62,\n        \"currency\": \"USD\"\n    },\n    \"users\": {\n        \"unique_users\": 35,\n        \"repeat_users\": 7,\n        \"new_users\": 28\n    },\n    \"plans\": {\n        \"1\": {\n            \"times_used\": 15,\n            \"last_used_at\": \"2025-02-18T09:15:00Z\",\n            \"revenue_generated\": 4500.00,\n            \"discount_given\": 900.00\n        },\n        \"2\": {\n            \"times_used\": 27,\n            \"last_used_at\": \"2025-02-20T14:22:00Z\",\n            \"revenue_generated\": 8000.00,\n            \"discount_given\": 1600.00\n        }\n    },\n    \"referral\": {\n        \"total_commissions_paid\": 250.00,\n        \"unique_sellers\": 1,\n        \"unique_buyers\": 35\n    },\n    \"time_periods\": {\n        \"last_7_days\": {\n            \"times_used\": 8,\n            \"revenue_generated\": 2400.00\n        },\n        \"last_30_days\": {\n            \"times_used\": 25,\n            \"revenue_generated\": 7500.00\n        },\n        \"last_90_days\": {\n            \"times_used\": 42,\n            \"revenue_generated\": 12500.00\n        }\n    },\n    \"payment_methods\": {\n        \"stripe\": 30,\n        \"paypal\": 8,\n        \"other\": 4\n    }\n}\n</code></pre>"},{"location":"LLM-DOCS/COUPONS/#configuration","title":"Configuration","text":"<p>Statistics calculation is configured per academy via <code>AcademyPaymentSettings.feature_flags.coupons</code>:</p> <pre><code>{\n    \"feature_flags\": {\n        \"coupons\": {\n            \"stats_hours_threshold\": 24,\n            \"stats_top_n\": 100,\n            \"stats_min_usage\": 2,\n            \"stats_cleanup_threshold\": 17520\n        }\n    }\n}\n</code></pre> <p>Configuration Options: - <code>stats_hours_threshold</code> (default: 24): Only calculate stats for coupons used in the last N hours - <code>stats_top_n</code> (default: 100): Maximum number of coupons to process per academy per run - <code>stats_min_usage</code> (default: 2): Minimum <code>times_used</code> to calculate stats for - <code>stats_cleanup_threshold</code> (default: 17520 = 2 years): Remove stats from coupons not used in last N hours</p>"},{"location":"LLM-DOCS/COUPONS/#how-statistics-are-calculated","title":"How Statistics Are Calculated","text":"<ol> <li> <p>Automatic Tracking: <code>times_used</code> and <code>last_used_at</code> are updated automatically when coupons are used (in <code>build_subscription</code>, <code>build_plan_financing</code>, <code>build_plan_addons_financings</code>)</p> </li> <li> <p>Daily Cronjob: <code>calculate_recent_coupon_stats()</code> runs daily and:</p> </li> <li>Processes coupons per academy</li> <li>Only calculates stats for coupons used in the last 24 hours (configurable)</li> <li>Only processes coupons with <code>times_used &gt;= stats_min_usage</code> (default: 2)</li> <li>Limits to top N coupons per academy (default: 100)</li> <li> <p>Updates <code>stats</code> and <code>stats_updated_at</code> fields</p> </li> <li> <p>Cleanup Task: <code>cleanup_stale_coupon_stats()</code> removes stats from coupons that haven't been used recently (default: 2 years)</p> </li> </ol>"},{"location":"LLM-DOCS/COUPONS/#api-response-with-statistics","title":"API Response with Statistics","text":"<p>GET /v1/payments/academy/coupon</p> <pre><code>{\n    \"count\": 5,\n    \"results\": [\n        {\n            \"slug\": \"summer-2025\",\n            \"discount_type\": \"PERCENT_OFF\",\n            \"discount_value\": 0.25,\n            \"times_used\": 42,\n            \"last_used_at\": \"2025-02-20T14:22:00Z\",\n            \"stats\": {\n                \"revenue\": {\n                    \"total_revenue_generated\": 12500.00,\n                    \"total_discount_given\": 2500.00\n                },\n                \"plans\": {\n                    \"1\": {\n                        \"times_used\": 15,\n                        \"last_used_at\": \"2025-02-18T09:15:00Z\"\n                    }\n                }\n            },\n            \"stats_updated_at\": \"2025-02-20T03:00:00Z\"\n        }\n    ]\n}\n</code></pre> <p>Note: The <code>stats</code> field is only present if statistics have been calculated. If a coupon hasn't been used recently or doesn't meet the minimum usage threshold, <code>stats</code> will be <code>null</code>.</p>"},{"location":"LLM-DOCS/COUPONS/#performance-considerations","title":"Performance Considerations","text":"<ul> <li>Counter Updates: <code>times_used</code> and <code>last_used_at</code> are updated with a single fast UPDATE query when coupons are used</li> <li>Stats Calculation: Only performed for recently active coupons (last 24h by default)</li> <li>Per-Academy Processing: Cronjob processes coupons per academy, allowing different configurations per academy</li> <li>Selective Calculation: Only calculates stats for coupons that meet minimum usage threshold (default: 2 uses)</li> <li>Automatic Cleanup: Stale stats are automatically removed to keep the database lean</li> </ul>"},{"location":"LLM-DOCS/EVENT_SUSPENSION/","title":"Event Suspension API Documentation","text":"<p>This document provides comprehensive information about suspending events in the BreatheCode platform - how to suspend events, what happens when an event is suspended, and how the system handles suspended events.</p>"},{"location":"LLM-DOCS/EVENT_SUSPENSION/#overview","title":"Overview","text":"<p>Event Suspension allows academy staff to temporarily suspend an event, preventing users from joining and automatically notifying all registered attendees. When an event is suspended, the system performs several actions to ensure attendees are informed and access is restricted.</p>"},{"location":"LLM-DOCS/EVENT_SUSPENSION/#key-concepts","title":"Key Concepts","text":"<ul> <li>Suspended Status: Events can have a status of <code>SUSPENDED</code>, which prevents users from joining</li> <li>Automatic Notifications: All registered attendees receive email notifications when an event is suspended</li> <li>Live Stream URL Removal: The <code>live_stream_url</code> is set to <code>null</code> when an event is suspended</li> <li>Join Restrictions: Users attempting to join a suspended event will see a suspension message instead of being redirected to the meeting</li> </ul>"},{"location":"LLM-DOCS/EVENT_SUSPENSION/#event-status-values","title":"Event Status Values","text":"<p>Events can have the following status values: - <code>ACTIVE</code> - Event is active and available - <code>DRAFT</code> - Event is in draft state (not published) - <code>DELETED</code> - Event has been deleted - <code>SUSPENDED</code> - Event has been suspended (cannot be joined) - <code>FINISHED</code> - Event has finished</p>"},{"location":"LLM-DOCS/EVENT_SUSPENSION/#suspend-event-endpoint","title":"Suspend Event Endpoint","text":""},{"location":"LLM-DOCS/EVENT_SUSPENSION/#endpoint","title":"Endpoint","text":"<p><code>PUT /v1/events/academy/event/{event_id}/suspend</code></p>"},{"location":"LLM-DOCS/EVENT_SUSPENSION/#purpose","title":"Purpose","text":"<p>Suspend an event that has not yet started, which: 1. Sets the event status to <code>SUSPENDED</code> 2. Removes the live stream URL (sets to <code>null</code>) 3. Sends email notifications to all registered attendees asynchronously 4. Prevents users from joining the event (shows suspension message instead)</p> <p>Important: Only events that have not yet started and are scheduled for the future can be suspended. Events that have already started (where <code>starting_at</code> is in the past) cannot be suspended.</p>"},{"location":"LLM-DOCS/EVENT_SUSPENSION/#authentication","title":"Authentication","text":"<p>Required: <code>crud_event</code> capability in the academy</p>"},{"location":"LLM-DOCS/EVENT_SUSPENSION/#headers","title":"Headers","text":"<pre><code>Authorization: Token {your-token}\nAcademy: {academy_id}\nContent-Type: application/json\n</code></pre>"},{"location":"LLM-DOCS/EVENT_SUSPENSION/#url-parameters","title":"URL Parameters","text":"Parameter Type Required Description <code>event_id</code> integer \u2705 Yes The ID of the event to suspend"},{"location":"LLM-DOCS/EVENT_SUSPENSION/#request-body","title":"Request Body","text":"<p>No request body required. The endpoint uses a PUT method but does not accept any body parameters.</p>"},{"location":"LLM-DOCS/EVENT_SUSPENSION/#response-200-ok","title":"Response (200 OK)","text":"<p>Returns the updated event object with the status set to <code>SUSPENDED</code> and <code>live_stream_url</code> set to <code>null</code>.</p> <pre><code>{\n  \"id\": 123,\n  \"slug\": \"python-workshop-2025\",\n  \"title\": \"Introduction to Python Workshop\",\n  \"status\": \"SUSPENDED\",\n  \"live_stream_url\": null,\n  \"starting_at\": \"2025-11-15T18:00:00Z\",\n  \"ending_at\": \"2025-11-15T20:00:00Z\",\n  \"academy\": {\n    \"id\": 1,\n    \"slug\": \"downtown-miami\",\n    \"name\": \"4Geeks Downtown Miami\"\n  },\n  \"event_type\": {\n    \"id\": 5,\n    \"slug\": \"workshop\",\n    \"name\": \"Workshop\"\n  },\n  \"created_at\": \"2025-10-01T10:00:00Z\",\n  \"updated_at\": \"2025-11-10T14:30:00Z\"\n}\n</code></pre>"},{"location":"LLM-DOCS/EVENT_SUSPENSION/#error-responses","title":"Error Responses","text":""},{"location":"LLM-DOCS/EVENT_SUSPENSION/#400-bad-request-event-already-started","title":"400 Bad Request - Event Already Started","text":"<p>Event has already started or is in the past. Only future events that haven't started can be suspended.</p> <pre><code>{\n  \"detail\": \"Only events that have not yet started and are scheduled for the future can be suspended\",\n  \"status_code\": 400,\n  \"slug\": \"event-already-started\"\n}\n</code></pre>"},{"location":"LLM-DOCS/EVENT_SUSPENSION/#404-not-found","title":"404 Not Found","text":"<p>Event does not exist or does not belong to the specified academy.</p> <pre><code>{\n  \"detail\": \"Event not found for this academy {academy_id}\",\n  \"status_code\": 404,\n  \"slug\": \"event-not-found\"\n}\n</code></pre>"},{"location":"LLM-DOCS/EVENT_SUSPENSION/#403-forbidden","title":"403 Forbidden","text":"<p>User does not have the required <code>crud_event</code> capability.</p> <pre><code>{\n  \"detail\": \"You don't have permission to perform this action\",\n  \"status_code\": 403\n}\n</code></pre>"},{"location":"LLM-DOCS/EVENT_SUSPENSION/#example-request","title":"Example Request","text":"<pre><code>curl -X PUT \\\n  'https://breathecode.herokuapp.com/v1/events/academy/event/123/suspend' \\\n  -H 'Authorization: Token your-auth-token' \\\n  -H 'Academy: 1' \\\n  -H 'Content-Type: application/json'\n</code></pre>"},{"location":"LLM-DOCS/EVENT_SUSPENSION/#example-response","title":"Example Response","text":"<pre><code>{\n  \"id\": 123,\n  \"slug\": \"python-workshop-2025\",\n  \"title\": \"Introduction to Python Workshop\",\n  \"status\": \"SUSPENDED\",\n  \"live_stream_url\": null,\n  \"description\": \"Learn Python fundamentals...\",\n  \"starting_at\": \"2025-11-15T18:00:00Z\",\n  \"ending_at\": \"2025-11-15T20:00:00Z\",\n  \"capacity\": 50,\n  \"banner\": \"https://example.com/banner.jpg\",\n  \"online_event\": true,\n  \"free_for_all\": false,\n  \"free_for_bootcamps\": true,\n  \"academy\": {\n    \"id\": 1,\n    \"slug\": \"downtown-miami\",\n    \"name\": \"4Geeks Downtown Miami\"\n  },\n  \"event_type\": {\n    \"id\": 5,\n    \"slug\": \"workshop\",\n    \"name\": \"Workshop\"\n  },\n  \"created_at\": \"2025-10-01T10:00:00Z\",\n  \"updated_at\": \"2025-11-10T14:30:00Z\"\n}\n</code></pre>"},{"location":"LLM-DOCS/EVENT_SUSPENSION/#what-happens-when-an-event-is-suspended","title":"What Happens When an Event is Suspended","text":""},{"location":"LLM-DOCS/EVENT_SUSPENSION/#pre-suspension-validation","title":"Pre-Suspension Validation","text":"<p>Before suspending an event, the system validates that: - The event's <code>starting_at</code> datetime is in the future (has not started yet) - If the event has already started, the suspension will be rejected with a 400 error</p>"},{"location":"LLM-DOCS/EVENT_SUSPENSION/#1-status-update","title":"1. Status Update","text":"<p>The event's <code>status</code> field is immediately changed to <code>SUSPENDED</code>.</p>"},{"location":"LLM-DOCS/EVENT_SUSPENSION/#2-live-stream-url-removal","title":"2. Live Stream URL Removal","text":"<p>The event's <code>live_stream_url</code> is set to <code>null</code>, preventing users from accessing the meeting room.</p>"},{"location":"LLM-DOCS/EVENT_SUSPENSION/#3-email-notifications","title":"3. Email Notifications","text":"<p>An asynchronous Celery task (<code>send_event_suspended_notification</code>) is queued to send email notifications to all registered attendees. The task:</p> <ul> <li>Fetches all <code>EventCheckin</code> records for the event that have valid email addresses</li> <li>Sends personalized email notifications using the \"message\" template</li> <li>Supports bilingual content (English and Spanish) based on the event's language setting</li> <li>Includes the event title and a suspension message in the email</li> </ul>"},{"location":"LLM-DOCS/EVENT_SUSPENSION/#email-content","title":"Email Content","text":"<p>English: - Subject: <code>Event Suspended: {event_title}</code> - Message:    <pre><code>We regret to inform you that the event '{event_title}' has been suspended for reasons that are out of our hands.\n\nIf you have any questions or concerns, please contact support for assistance.\n\nWe apologize for any inconvenience this may cause.\n</code></pre></p> <p>Spanish: - Subject: <code>Evento Suspendido: {event_title}</code> - Message:   <pre><code>Lamentamos informarle que el evento '{event_title}' ha sido suspendido por razones fuera de nuestro control.\n\nSi tiene alguna pregunta o inquietud, por favor contacte a soporte para asistencia.\n\nNos disculpamos por cualquier inconveniente que esto pueda causar.\n</code></pre></p>"},{"location":"LLM-DOCS/EVENT_SUSPENSION/#4-event-status-updated-signal","title":"4. Event Status Updated Signal","text":"<p>The <code>event_status_updated</code> signal is automatically triggered when the event status changes, which can be used by other parts of the system to handle the suspension (e.g., webhooks, notifications).</p>"},{"location":"LLM-DOCS/EVENT_SUSPENSION/#user-facing-behavior","title":"User-Facing Behavior","text":""},{"location":"LLM-DOCS/EVENT_SUSPENSION/#join-event-attempts","title":"Join Event Attempts","text":"<p>When users attempt to join a suspended event through either endpoint below, they will see a suspension message instead of being redirected to the meeting:</p> <ol> <li>Public Join: <code>GET /v1/events/me/event/{event_id}/join</code></li> <li>Academy Join: <code>GET /v1/events/academy/event/{event_id}/join</code></li> </ol>"},{"location":"LLM-DOCS/EVENT_SUSPENSION/#suspension-message","title":"Suspension Message","text":"<p>Users will see the following message (translated based on their language preference):</p> <p>English: <pre><code>This event was suspended for reasons that are out of our hands, contact support if you have any further questions\n</code></pre></p> <p>Spanish: <pre><code>Este evento fue suspendido por razones fuera de nuestro control, contacte a soporte si tiene alguna pregunta adicional\n</code></pre></p> <p>The message is displayed using the standard message template with academy branding.</p>"},{"location":"LLM-DOCS/EVENT_SUSPENSION/#related-endpoints","title":"Related Endpoints","text":""},{"location":"LLM-DOCS/EVENT_SUSPENSION/#update-event-cannot-suspend","title":"Update Event (Cannot Suspend)","text":"<p>Endpoint: <code>PUT /v1/events/academy/event/{event_id}</code></p> <p>This general update endpoint cannot be used to suspend events. If you attempt to set <code>status: \"SUSPENDED\"</code> via this endpoint, you will receive a 400 error:</p> <pre><code>{\n  \"detail\": \"Cannot set event status to SUSPENDED using this endpoint. Please use PUT /v1/events/academy/event/{event_id}/suspend instead.\",\n  \"status_code\": 400,\n  \"slug\": \"use-suspend-endpoint\"\n}\n</code></pre> <p>Important:  - To suspend an event, you must use the dedicated suspend endpoint: <code>PUT /v1/events/academy/event/{event_id}/suspend</code> - To unsuspend an event (change from <code>SUSPENDED</code> to <code>ACTIVE</code>), you can use this general PUT endpoint with <code>status: \"ACTIVE\"</code> and restore the <code>live_stream_url</code> if needed - You can set other status values (<code>ACTIVE</code>, <code>DRAFT</code>, <code>FINISHED</code>) using this endpoint without restrictions</p>"},{"location":"LLM-DOCS/EVENT_SUSPENSION/#check-event-status","title":"Check Event Status","text":"<p>To check if an event is suspended, use the standard event retrieval endpoints:</p> <p>Get Single Event: <pre><code>GET /v1/events/academy/event/{event_id}\n</code></pre></p> <p>The response will include the <code>status</code> field which will be <code>\"SUSPENDED\"</code> for suspended events.</p>"},{"location":"LLM-DOCS/EVENT_SUSPENSION/#list-events-filter-by-status","title":"List Events (Filter by Status)","text":"<p>List Academy Events: <pre><code>GET /v1/events/academy/event?status=SUSPENDED\n</code></pre></p> <p>Query parameters: - <code>status=SUSPENDED</code> - Filter to show only suspended events - <code>status=ACTIVE</code> - Filter to show only active events</p>"},{"location":"LLM-DOCS/EVENT_SUSPENSION/#workflow-examples","title":"Workflow Examples","text":""},{"location":"LLM-DOCS/EVENT_SUSPENSION/#example-1-suspend-a-future-event","title":"Example 1: Suspend a Future Event","text":"<pre><code># 1. Suspend the event (only works for events that haven't started)\ncurl -X PUT \\\n  'https://breathecode.herokuapp.com/v1/events/academy/event/123/suspend' \\\n  -H 'Authorization: Token your-token' \\\n  -H 'Academy: 1'\n\n# 2. Verify the suspension\ncurl -X GET \\\n  'https://breathecode.herokuapp.com/v1/events/academy/event/123' \\\n  -H 'Authorization: Token your-token' \\\n  -H 'Academy: 1'\n\n# Response will show:\n# - status: \"SUSPENDED\"\n# - live_stream_url: null\n</code></pre>"},{"location":"LLM-DOCS/EVENT_SUSPENSION/#example-1b-attempt-to-suspend-an-event-that-has-started-will-fail","title":"Example 1b: Attempt to Suspend an Event That Has Started (Will Fail)","text":"<pre><code># This will fail with 400 error if event.starting_at &lt;= current_time\ncurl -X PUT \\\n  'https://breathecode.herokuapp.com/v1/events/academy/event/123/suspend' \\\n  -H 'Authorization: Token your-token' \\\n  -H 'Academy: 1'\n\n# Response (400 Bad Request):\n# {\n#   \"detail\": \"Only events that have not yet started and are scheduled for the future can be suspended\",\n#   \"status_code\": 400,\n#   \"slug\": \"event-already-started\"\n# }\n</code></pre>"},{"location":"LLM-DOCS/EVENT_SUSPENSION/#example-2-check-for-suspended-events","title":"Example 2: Check for Suspended Events","text":"<pre><code># List all suspended events\ncurl -X GET \\\n  'https://breathecode.herokuapp.com/v1/events/academy/event?status=SUSPENDED' \\\n  -H 'Authorization: Token your-token' \\\n  -H 'Academy: 1'\n</code></pre>"},{"location":"LLM-DOCS/EVENT_SUSPENSION/#example-3-attempt-to-suspend-via-general-put-endpoint-will-fail","title":"Example 3: Attempt to Suspend via General PUT Endpoint (Will Fail)","text":"<pre><code># This will fail with 400 error\ncurl -X PUT \\\n  'https://breathecode.herokuapp.com/v1/events/academy/event/123' \\\n  -H 'Authorization: Token your-token' \\\n  -H 'Academy: 1' \\\n  -H 'Content-Type: application/json' \\\n  -d '{\n    \"status\": \"SUSPENDED\"\n  }'\n\n# Response (400 Bad Request):\n# {\n#   \"detail\": \"Cannot set event status to SUSPENDED using this endpoint. Please use PUT /v1/events/academy/event/{event_id}/suspend instead.\",\n#   \"status_code\": 400,\n#   \"slug\": \"use-suspend-endpoint\"\n# }\n</code></pre>"},{"location":"LLM-DOCS/EVENT_SUSPENSION/#example-4-unsuspend-an-event-change-status-back-to-active","title":"Example 4: Unsuspend an Event (Change Status Back to ACTIVE)","text":"<pre><code># Use the general PUT endpoint to change status from SUSPENDED to ACTIVE\ncurl -X PUT \\\n  'https://breathecode.herokuapp.com/v1/events/academy/event/123' \\\n  -H 'Authorization: Token your-token' \\\n  -H 'Academy: 1' \\\n  -H 'Content-Type: application/json' \\\n  -d '{\n    \"status\": \"ACTIVE\",\n    \"live_stream_url\": \"https://meet.example.com/room123\"\n  }'\n</code></pre>"},{"location":"LLM-DOCS/EVENT_SUSPENSION/#implementation-details","title":"Implementation Details","text":""},{"location":"LLM-DOCS/EVENT_SUSPENSION/#asynchronous-email-processing","title":"Asynchronous Email Processing","text":"<p>The email notification task runs asynchronously using Celery with <code>TaskPriority.NOTIFICATION</code> priority. This ensures:</p> <ul> <li>The API response is not delayed by email sending</li> <li>Multiple emails can be sent in parallel</li> <li>Email failures don't block the suspension action</li> </ul>"},{"location":"LLM-DOCS/EVENT_SUSPENSION/#error-handling","title":"Error Handling","text":"<p>If email sending fails for individual attendees, the errors are logged but do not prevent the suspension from completing. The suspension is successful even if some email notifications fail.</p>"},{"location":"LLM-DOCS/EVENT_SUSPENSION/#database-changes","title":"Database Changes","text":"<p>When an event is suspended: - <code>event.status</code> \u2192 <code>\"SUSPENDED\"</code> - <code>event.live_stream_url</code> \u2192 <code>null</code> - <code>event.updated_at</code> \u2192 Current timestamp</p>"},{"location":"LLM-DOCS/EVENT_SUSPENSION/#security-considerations","title":"Security Considerations","text":"<ol> <li>Permission Check: Only users with <code>crud_event</code> capability can suspend events</li> <li>Academy Validation: Events must belong to the academy specified in the <code>Academy</code> header</li> <li>Idempotency: Suspending an already suspended event will still update the timestamp but won't send duplicate emails (email task checks if event is suspended)</li> </ol>"},{"location":"LLM-DOCS/EVENT_SUSPENSION/#best-practices","title":"Best Practices","text":"<ol> <li>Timing: Only suspend events before they start. Once an event has begun (<code>starting_at</code> is in the past), it cannot be suspended</li> <li>Notify Users Beforehand: If possible, notify users before suspending an event</li> <li>Provide Context: Include a reason in your internal records for why the event was suspended</li> <li>Monitor Email Deliverability: Check email delivery logs to ensure attendees are notified</li> <li>Resume Events: To resume an event, use the standard event update endpoint to change status back to <code>ACTIVE</code> and restore the <code>live_stream_url</code> if needed</li> <li>Check Event Timing: Before attempting to suspend, verify the event's <code>starting_at</code> date to ensure it's in the future</li> </ol>"},{"location":"LLM-DOCS/EVENT_SUSPENSION/#troubleshooting","title":"Troubleshooting","text":""},{"location":"LLM-DOCS/EVENT_SUSPENSION/#cannot-suspend-event-event-already-started-error","title":"Cannot Suspend Event - \"event-already-started\" Error","text":"<p>Error: <code>400 Bad Request - Only events that have not yet started and are scheduled for the future can be suspended</code></p> <p>Cause: The event's <code>starting_at</code> datetime is in the past (event has already started or started in the past).</p> <p>Solution: - Check the event's <code>starting_at</code> field to confirm it's in the past - Only events scheduled for the future can be suspended - If the event has started, you cannot suspend it through this endpoint</p>"},{"location":"LLM-DOCS/EVENT_SUSPENSION/#emails-not-being-sent","title":"Emails Not Being Sent","text":"<ul> <li>Check that <code>EMAIL_NOTIFICATIONS_ENABLED</code> environment variable is set to <code>\"TRUE\"</code></li> <li>Verify that attendees have valid email addresses in their <code>EventCheckin</code> records</li> <li>Check Celery worker logs for email sending errors</li> </ul>"},{"location":"LLM-DOCS/EVENT_SUSPENSION/#event-still-accessible-after-suspension","title":"Event Still Accessible After Suspension","text":"<ul> <li>Verify the event status was successfully updated to <code>SUSPENDED</code></li> <li>Check that <code>live_stream_url</code> is set to <code>null</code></li> <li>Ensure the user is accessing through the correct endpoint (join endpoints check for suspension status)</li> </ul>"},{"location":"LLM-DOCS/EVENT_SUSPENSION/#permission-errors","title":"Permission Errors","text":"<ul> <li>Verify the user has <code>crud_event</code> capability for the academy</li> <li>Check that the <code>Academy</code> header matches the event's academy</li> <li>Ensure the authentication token is valid and not expired</li> </ul>"},{"location":"LLM-DOCS/EVENT_TYPES_AND_VISIBILITY/","title":"Event Types and Visibility Settings API Documentation","text":"<p>This document provides comprehensive information about managing Event Types and their Visibility Settings in the BreatheCode platform - how to create, update, and manage event types, and how to configure visibility settings to control which users can see specific event types.</p>"},{"location":"LLM-DOCS/EVENT_TYPES_AND_VISIBILITY/#overview","title":"Overview","text":"<p>Event Types are categories or classifications for events (e.g., \"Workshop\", \"Webinar\", \"Meetup\"). Each event type can have multiple Visibility Settings that determine which users can see events of that type based on their academy, syllabus, and cohort access.</p>"},{"location":"LLM-DOCS/EVENT_TYPES_AND_VISIBILITY/#key-concepts","title":"Key Concepts","text":"<ul> <li>Event Type: A category for events with properties like name, description, icon, and language</li> <li>Visibility Settings: Rules that determine who can see events of a specific type based on:</li> <li>Academy (required) - The academy the setting belongs to</li> <li>Syllabus (optional) - Users must have access to this syllabus</li> <li>Cohort (optional) - Users must belong to this cohort</li> <li>Shared Creation: Event types can allow other academies to create events of that type</li> <li>Free for Bootcamps: Whether users from non-SaaS academies can join without consuming credits</li> </ul>"},{"location":"LLM-DOCS/EVENT_TYPES_AND_VISIBILITY/#model-relationships","title":"Model Relationships","text":"<pre><code>EventType\n  \u251c\u2500\u2500 academy (ForeignKey)\n  \u251c\u2500\u2500 visibility_settings (ManyToMany)\n  \u2502   \u2514\u2500\u2500 EventTypeVisibilitySetting\n  \u2502       \u251c\u2500\u2500 academy (ForeignKey)\n  \u2502       \u251c\u2500\u2500 syllabus (ForeignKey, optional)\n  \u2502       \u2514\u2500\u2500 cohort (ForeignKey, optional)\n  \u2514\u2500\u2500 events (reverse relation)\n</code></pre>"},{"location":"LLM-DOCS/EVENT_TYPES_AND_VISIBILITY/#event-types-api","title":"Event Types API","text":""},{"location":"LLM-DOCS/EVENT_TYPES_AND_VISIBILITY/#1-list-all-event-types-public","title":"1. List All Event Types (Public)","text":"<p>Endpoint: <code>GET /v1/events/eventype</code></p> <p>Purpose: Get a list of all event types (public endpoint, no authentication required)</p> <p>Authentication: Not required</p> <p>Query Parameters:</p> Parameter Type Description <code>academy</code> string Filter by academy slug <code>allow_shared_creation</code> boolean Filter by shared creation status (true/false) <code>lang</code> string Filter by language code (e.g., \"en\", \"es\") <p>Response:</p> <pre><code>[\n  {\n    \"id\": 1,\n    \"slug\": \"workshop\",\n    \"name\": \"Workshop\",\n    \"description\": \"Hands-on learning sessions\",\n    \"lang\": \"en\",\n    \"technologies\": \"Python, JavaScript\",\n    \"academy\": {\n      \"id\": 1,\n      \"slug\": \"downtown-miami\",\n      \"name\": \"4Geeks Downtown Miami\"\n    }\n  },\n  {\n    \"id\": 2,\n    \"slug\": \"webinar\",\n    \"name\": \"Webinar\",\n    \"description\": \"Online educational sessions\",\n    \"lang\": \"en\",\n    \"technologies\": null,\n    \"academy\": {\n      \"id\": 1,\n      \"slug\": \"downtown-miami\",\n      \"name\": \"4Geeks Downtown Miami\"\n    }\n  }\n]\n</code></pre> <p>Example Requests:</p> <pre><code># Get all event types\nGET /v1/events/eventype\n\n# Get event types for a specific academy\nGET /v1/events/eventype?academy=downtown-miami\n\n# Get shared event types\nGET /v1/events/eventype?allow_shared_creation=true\n\n# Get event types in Spanish\nGET /v1/events/eventype?lang=es\n</code></pre>"},{"location":"LLM-DOCS/EVENT_TYPES_AND_VISIBILITY/#2-list-academy-event-types","title":"2. List Academy Event Types","text":"<p>Endpoint: <code>GET /v1/events/academy/{academy_id}/eventype</code></p> <p>Purpose: Get event types for a specific academy, including shared event types</p> <p>Authentication: Required - <code>read_event_type</code> capability</p> <p>Headers:</p> <pre><code>Authorization: Token {your-token}\nAcademy: {academy_id}\n</code></pre> <p>Query Parameters:</p> Parameter Type Description <code>academy</code> string Filter by academy slug <code>allow_shared_creation</code> boolean Filter by shared creation status (true/false) <p>Response:</p> <p>Returns a list of event types (same format as public endpoint) that belong to the academy or are shared.</p> <p>Example Request:</p> <pre><code>GET /v1/events/academy/1/eventype\nAuthorization: Token {your-token}\nAcademy: 1\n</code></pre>"},{"location":"LLM-DOCS/EVENT_TYPES_AND_VISIBILITY/#3-get-specific-event-type","title":"3. Get Specific Event Type","text":"<p>Endpoint: <code>GET /v1/events/academy/{academy_id}/eventype/{event_type_slug}</code></p> <p>Purpose: Get detailed information about a specific event type, including visibility settings</p> <p>Authentication: Required - <code>read_event_type</code> capability</p> <p>Headers:</p> <pre><code>Authorization: Token {your-token}\nAcademy: {academy_id}\n</code></pre> <p>URL Parameters:</p> Parameter Type Required Description <code>academy_id</code> integer \u2705 Yes The academy ID <code>event_type_slug</code> string \u2705 Yes The slug of the event type <p>Response:</p> <pre><code>{\n  \"id\": 1,\n  \"slug\": \"workshop\",\n  \"name\": \"Workshop\",\n  \"description\": \"Hands-on learning sessions\",\n  \"icon_url\": \"https://example.com/workshop-icon.png\",\n  \"lang\": \"en\",\n  \"technologies\": \"Python, JavaScript\",\n  \"allow_shared_creation\": true,\n  \"academy\": {\n    \"id\": 1,\n    \"slug\": \"downtown-miami\",\n    \"name\": \"4Geeks Downtown Miami\"\n  },\n  \"visibility_settings\": [\n    {\n      \"id\": 1,\n      \"academy\": {\n        \"id\": 1,\n        \"slug\": \"downtown-miami\",\n        \"name\": \"4Geeks Downtown Miami\"\n      },\n      \"syllabus\": {\n        \"id\": 5,\n        \"slug\": \"full-stack\",\n        \"name\": \"Full Stack Development\"\n      },\n      \"cohort\": null\n    },\n    {\n      \"id\": 2,\n      \"academy\": {\n        \"id\": 1,\n        \"slug\": \"downtown-miami\",\n        \"name\": \"4Geeks Downtown Miami\"\n      },\n      \"syllabus\": null,\n      \"cohort\": {\n        \"id\": 10,\n        \"slug\": \"web-dev-ft-2025\",\n        \"name\": \"Web Development Full Time 2025\"\n      }\n    }\n  ]\n}\n</code></pre> <p>Error Responses:</p>"},{"location":"LLM-DOCS/EVENT_TYPES_AND_VISIBILITY/#404-not-found","title":"404 Not Found","text":"<pre><code>{\n  \"detail\": \"event-type-not-found\",\n  \"status_code\": 404\n}\n</code></pre> <p>Example Request:</p> <pre><code>GET /v1/events/academy/1/eventype/workshop\nAuthorization: Token {your-token}\nAcademy: 1\n</code></pre>"},{"location":"LLM-DOCS/EVENT_TYPES_AND_VISIBILITY/#4-create-event-type","title":"4. Create Event Type","text":"<p>Endpoint: <code>POST /v1/events/academy/{academy_id}/eventype</code></p> <p>Purpose: Create a new event type for an academy</p> <p>Authentication: Required - <code>crud_event_type</code> capability</p> <p>Headers:</p> <pre><code>Authorization: Token {your-token}\nAcademy: {academy_id}\nContent-Type: application/json\n</code></pre> <p>URL Parameters:</p> Parameter Type Required Description <code>academy_id</code> integer \u2705 Yes The academy ID <p>Request Body:</p> Field Type Required Description <code>slug</code> string \u2705 Yes Unique slug identifier (max 150 chars) <code>name</code> string \u2705 Yes Display name (max 150 chars) <code>description</code> string \u2705 Yes Public description (max 255 chars) <code>icon_url</code> string No URL to icon image <code>lang</code> string \u2705 Yes Language code (e.g., \"en\", \"es\") <code>free_for_bootcamps</code> boolean No Default: <code>true</code> <code>allow_shared_creation</code> boolean No Default: <code>true</code> <code>technologies</code> string No Comma-separated list (max 200 chars) <p>Note: The <code>academy</code> field is automatically set from the <code>academy_id</code> in the URL.</p> <p>Request Example:</p> <pre><code>{\n  \"slug\": \"workshop-python\",\n  \"name\": \"Python Workshop\",\n  \"description\": \"Learn Python programming fundamentals\",\n  \"icon_url\": \"https://example.com/python-icon.png\",\n  \"lang\": \"en\",\n  \"free_for_bootcamps\": true,\n  \"allow_shared_creation\": true,\n  \"technologies\": \"Python, Django, Flask\"\n}\n</code></pre> <p>Response (201 Created):</p> <pre><code>{\n  \"id\": 5,\n  \"slug\": \"workshop-python\",\n  \"name\": \"Python Workshop\",\n  \"description\": \"Learn Python programming fundamentals\",\n  \"icon_url\": \"https://example.com/python-icon.png\",\n  \"lang\": \"en\",\n  \"free_for_bootcamps\": true,\n  \"allow_shared_creation\": true,\n  \"technologies\": \"Python, Django, Flask\",\n  \"academy\": {\n    \"id\": 1,\n    \"slug\": \"downtown-miami\",\n    \"name\": \"4Geeks Downtown Miami\"\n  }\n}\n</code></pre> <p>Error Responses:</p>"},{"location":"LLM-DOCS/EVENT_TYPES_AND_VISIBILITY/#400-bad-request-validation-error","title":"400 Bad Request - Validation Error","text":"<pre><code>{\n  \"slug\": [\"event type with this slug already exists.\"],\n  \"name\": [\"This field is required.\"]\n}\n</code></pre> <p>Example Request:</p> <pre><code>POST /v1/events/academy/1/eventype\nAuthorization: Token {your-token}\nAcademy: 1\nContent-Type: application/json\n\n{\n  \"slug\": \"workshop-python\",\n  \"name\": \"Python Workshop\",\n  \"description\": \"Learn Python programming fundamentals\",\n  \"icon_url\": \"https://example.com/python-icon.png\",\n  \"lang\": \"en\",\n  \"technologies\": \"Python, Django, Flask\"\n}\n</code></pre>"},{"location":"LLM-DOCS/EVENT_TYPES_AND_VISIBILITY/#5-update-event-type","title":"5. Update Event Type","text":"<p>Endpoint: <code>PUT /v1/events/academy/{academy_id}/eventype/{event_type_slug}</code></p> <p>Purpose: Update an existing event type</p> <p>Authentication: Required - <code>crud_event_type</code> capability</p> <p>Headers:</p> <pre><code>Authorization: Token {your-token}\nAcademy: {academy_id}\nContent-Type: application/json\n</code></pre> <p>URL Parameters:</p> Parameter Type Required Description <code>academy_id</code> integer \u2705 Yes The academy ID <code>event_type_slug</code> string \u2705 Yes The slug of the event type to update <p>Request Body:</p> <p>All fields are optional except <code>icon_url</code>:</p> Field Type Required Description <code>slug</code> string No Unique slug identifier (max 150 chars) <code>name</code> string No Display name (max 150 chars) <code>description</code> string No Public description (max 255 chars) <code>icon_url</code> string \u2705 Yes URL to icon image <code>lang</code> string No Language code (e.g., \"en\", \"es\") <code>allow_shared_creation</code> boolean No Whether other academies can create events of this type <code>technologies</code> string No Comma-separated list (max 200 chars) <p>Request Example:</p> <pre><code>{\n  \"name\": \"Advanced Python Workshop\",\n  \"description\": \"Advanced Python programming concepts\",\n  \"icon_url\": \"https://example.com/python-advanced-icon.png\",\n  \"allow_shared_creation\": false,\n  \"technologies\": \"Python, Django, FastAPI, Celery\"\n}\n</code></pre> <p>Response (200 OK):</p> <p>Returns the updated event type object.</p> <p>Error Responses:</p>"},{"location":"LLM-DOCS/EVENT_TYPES_AND_VISIBILITY/#404-not-found_1","title":"404 Not Found","text":"<pre><code>{\n  \"detail\": \"event-type-not-found\",\n  \"status_code\": 404\n}\n</code></pre>"},{"location":"LLM-DOCS/EVENT_TYPES_AND_VISIBILITY/#400-bad-request-validation-error_1","title":"400 Bad Request - Validation Error","text":"<pre><code>{\n  \"icon_url\": [\"This field is required.\"]\n}\n</code></pre> <p>Example Request:</p> <pre><code>PUT /v1/events/academy/1/eventype/workshop-python\nAuthorization: Token {your-token}\nAcademy: 1\nContent-Type: application/json\n\n{\n  \"name\": \"Advanced Python Workshop\",\n  \"description\": \"Advanced Python programming concepts\",\n  \"icon_url\": \"https://example.com/python-advanced-icon.png\",\n  \"allow_shared_creation\": false\n}\n</code></pre> <p>Note: There is no DELETE endpoint for event types in the current implementation.</p>"},{"location":"LLM-DOCS/EVENT_TYPES_AND_VISIBILITY/#visibility-settings-api","title":"Visibility Settings API","text":"<p>Visibility settings control which users can see events of a specific type. They are based on academy, syllabus, and/or cohort access.</p>"},{"location":"LLM-DOCS/EVENT_TYPES_AND_VISIBILITY/#1-list-visibility-settings","title":"1. List Visibility Settings","text":"<p>Endpoint: <code>GET /v1/events/academy/{academy_id}/eventype/{event_type_slug}/visibilitysetting</code></p> <p>Purpose: Get all visibility settings for a specific event type</p> <p>Authentication: Required - <code>read_event_type</code> capability</p> <p>Headers:</p> <pre><code>Authorization: Token {your-token}\nAcademy: {academy_id}\n</code></pre> <p>URL Parameters:</p> Parameter Type Required Description <code>academy_id</code> integer \u2705 Yes The academy ID <code>event_type_slug</code> string \u2705 Yes The slug of the event type <p>Query Parameters:</p> <p>Standard pagination and sorting parameters are supported: - <code>limit</code> - Results per page - <code>offset</code> - Skip N results - <code>sort</code> - Sort field (default: <code>-id</code>)</p> <p>Response:</p> <pre><code>[\n  {\n    \"id\": 1,\n    \"academy\": {\n      \"id\": 1,\n      \"slug\": \"downtown-miami\",\n      \"name\": \"4Geeks Downtown Miami\"\n    },\n    \"syllabus\": {\n      \"id\": 5,\n      \"slug\": \"full-stack\",\n      \"name\": \"Full Stack Development\"\n    },\n    \"cohort\": null\n  },\n  {\n    \"id\": 2,\n    \"academy\": {\n      \"id\": 1,\n      \"slug\": \"downtown-miami\",\n      \"name\": \"4Geeks Downtown Miami\"\n    },\n    \"syllabus\": null,\n    \"cohort\": {\n      \"id\": 10,\n      \"slug\": \"web-dev-ft-2025\",\n      \"name\": \"Web Development Full Time 2025\"\n    }\n  }\n]\n</code></pre> <p>Important Notes:</p> <ul> <li>If <code>allow_shared_creation</code> is <code>false</code> and the event type belongs to a different academy, an empty list is returned</li> <li>Only visibility settings for the specified academy are returned</li> </ul> <p>Error Responses:</p>"},{"location":"LLM-DOCS/EVENT_TYPES_AND_VISIBILITY/#404-not-found_2","title":"404 Not Found","text":"<pre><code>{\n  \"detail\": \"not-found\",\n  \"status_code\": 404\n}\n</code></pre> <p>Example Request:</p> <pre><code>GET /v1/events/academy/1/eventype/workshop/visibilitysetting\nAuthorization: Token {your-token}\nAcademy: 1\n</code></pre>"},{"location":"LLM-DOCS/EVENT_TYPES_AND_VISIBILITY/#2-add-visibility-setting","title":"2. Add Visibility Setting","text":"<p>Endpoint: <code>POST /v1/events/academy/{academy_id}/eventype/{event_type_slug}/visibilitysetting</code></p> <p>Purpose: Add a new visibility setting to an event type</p> <p>Authentication: Required - <code>crud_event_type</code> capability</p> <p>Headers:</p> <pre><code>Authorization: Token {your-token}\nAcademy: {academy_id}\nContent-Type: application/json\n</code></pre> <p>URL Parameters:</p> Parameter Type Required Description <code>academy_id</code> integer \u2705 Yes The academy ID <code>event_type_slug</code> string \u2705 Yes The slug of the event type <p>Request Body:</p> Field Type Required Description <code>syllabus</code> integer No Syllabus ID (must belong to the academy or be public) <code>cohort</code> integer No Cohort ID (must belong to the academy) <p>Note:  - At least one of <code>syllabus</code> or <code>cohort</code> should be provided (or neither for academy-wide visibility) - The <code>academy</code> is automatically set from the <code>academy_id</code> in the URL - If a visibility setting with the same academy, syllabus, and cohort already exists, it will be reused</p> <p>Request Examples:</p> <p>Academy-wide visibility (no syllabus or cohort): <pre><code>{}\n</code></pre></p> <p>Syllabus-specific visibility: <pre><code>{\n  \"syllabus\": 5\n}\n</code></pre></p> <p>Cohort-specific visibility: <pre><code>{\n  \"cohort\": 10\n}\n</code></pre></p> <p>Combined syllabus and cohort: <pre><code>{\n  \"syllabus\": 5,\n  \"cohort\": 10\n}\n</code></pre></p> <p>Response (201 Created or 200 OK):</p> <p>Returns <code>201 Created</code> if a new visibility setting was created, or <code>200 OK</code> if an existing one was reused:</p> <pre><code>{\n  \"id\": 1,\n  \"academy\": {\n    \"id\": 1,\n    \"slug\": \"downtown-miami\",\n    \"name\": \"4Geeks Downtown Miami\"\n  },\n  \"syllabus\": {\n    \"id\": 5,\n    \"slug\": \"full-stack\",\n    \"name\": \"Full Stack Development\"\n  },\n  \"cohort\": null\n}\n</code></pre> <p>Error Responses:</p>"},{"location":"LLM-DOCS/EVENT_TYPES_AND_VISIBILITY/#404-not-found-event-type","title":"404 Not Found - Event Type","text":"<pre><code>{\n  \"detail\": \"event-type-not-found\",\n  \"status_code\": 404\n}\n</code></pre>"},{"location":"LLM-DOCS/EVENT_TYPES_AND_VISIBILITY/#404-not-found-syllabus","title":"404 Not Found - Syllabus","text":"<pre><code>{\n  \"detail\": \"syllabus-not-found\",\n  \"status_code\": 404\n}\n</code></pre>"},{"location":"LLM-DOCS/EVENT_TYPES_AND_VISIBILITY/#404-not-found-cohort","title":"404 Not Found - Cohort","text":"<pre><code>{\n  \"detail\": \"cohort-not-found\",\n  \"status_code\": 404\n}\n</code></pre> <p>Example Request:</p> <pre><code>POST /v1/events/academy/1/eventype/workshop/visibilitysetting\nAuthorization: Token {your-token}\nAcademy: 1\nContent-Type: application/json\n\n{\n  \"syllabus\": 5,\n  \"cohort\": 10\n}\n</code></pre>"},{"location":"LLM-DOCS/EVENT_TYPES_AND_VISIBILITY/#3-remove-visibility-setting","title":"3. Remove Visibility Setting","text":"<p>Endpoint: <code>DELETE /v1/events/academy/{academy_id}/eventype/{event_type_slug}/visibilitysetting/{visibility_setting_id}</code></p> <p>Purpose: Remove a visibility setting from an event type</p> <p>Authentication: Required - <code>crud_event_type</code> capability</p> <p>Headers:</p> <pre><code>Authorization: Token {your-token}\nAcademy: {academy_id}\n</code></pre> <p>URL Parameters:</p> Parameter Type Required Description <code>academy_id</code> integer \u2705 Yes The academy ID <code>event_type_slug</code> string \u2705 Yes The slug of the event type <code>visibility_setting_id</code> integer \u2705 Yes The ID of the visibility setting to remove <p>Request Body:</p> <p>No request body required.</p> <p>Response (204 No Content):</p> <p>Empty response body.</p> <p>Behavior:</p> <ul> <li>If the visibility setting is used by other event types, it is only removed from the specified event type</li> <li>If the visibility setting is only used by this event type, it is deleted completely</li> </ul> <p>Error Responses:</p>"},{"location":"LLM-DOCS/EVENT_TYPES_AND_VISIBILITY/#404-not-found-event-type_1","title":"404 Not Found - Event Type","text":"<pre><code>{\n  \"detail\": \"event-type-not-found\",\n  \"status_code\": 404\n}\n</code></pre>"},{"location":"LLM-DOCS/EVENT_TYPES_AND_VISIBILITY/#404-not-found-visibility-setting","title":"404 Not Found - Visibility Setting","text":"<pre><code>{\n  \"detail\": \"event-type-visibility-setting-not-found\",\n  \"status_code\": 404\n}\n</code></pre> <p>Example Request:</p> <pre><code>DELETE /v1/events/academy/1/eventype/workshop/visibilitysetting/1\nAuthorization: Token {your-token}\nAcademy: 1\n</code></pre>"},{"location":"LLM-DOCS/EVENT_TYPES_AND_VISIBILITY/#how-visibility-works","title":"How Visibility Works","text":""},{"location":"LLM-DOCS/EVENT_TYPES_AND_VISIBILITY/#visibility-logic","title":"Visibility Logic","text":"<p>When a user tries to view events of a specific type, the system checks if they have access based on the visibility settings:</p> <ol> <li>Academy Check: User must belong to or have access to the academy</li> <li>Syllabus Check: If a visibility setting specifies a syllabus, the user must have access to that syllabus</li> <li>Cohort Check: If a visibility setting specifies a cohort, the user must belong to that cohort</li> </ol>"},{"location":"LLM-DOCS/EVENT_TYPES_AND_VISIBILITY/#examples","title":"Examples","text":"<p>Example 1: Academy-wide visibility <pre><code>{\n  \"academy\": 1,\n  \"syllabus\": null,\n  \"cohort\": null\n}\n</code></pre> All users in academy 1 can see events of this type.</p> <p>Example 2: Syllabus-specific visibility <pre><code>{\n  \"academy\": 1,\n  \"syllabus\": 5,\n  \"cohort\": null\n}\n</code></pre> Only users who have access to syllabus 5 in academy 1 can see events of this type.</p> <p>Example 3: Cohort-specific visibility <pre><code>{\n  \"academy\": 1,\n  \"syllabus\": null,\n  \"cohort\": 10\n}\n</code></pre> Only users who belong to cohort 10 in academy 1 can see events of this type.</p> <p>Example 4: Combined visibility <pre><code>{\n  \"academy\": 1,\n  \"syllabus\": 5,\n  \"cohort\": 10\n}\n</code></pre> Only users who have access to syllabus 5 AND belong to cohort 10 in academy 1 can see events of this type.</p>"},{"location":"LLM-DOCS/EVENT_TYPES_AND_VISIBILITY/#multiple-visibility-settings","title":"Multiple Visibility Settings","text":"<p>An event type can have multiple visibility settings. If a user matches ANY of the visibility settings, they can see events of that type.</p> <p>Example: - Visibility Setting 1: Academy 1, Syllabus 5, Cohort null - Visibility Setting 2: Academy 1, Syllabus null, Cohort 10</p> <p>Users who have access to syllabus 5 OR belong to cohort 10 can see events of this type.</p>"},{"location":"LLM-DOCS/EVENT_TYPES_AND_VISIBILITY/#complete-workflow-example","title":"Complete Workflow Example","text":""},{"location":"LLM-DOCS/EVENT_TYPES_AND_VISIBILITY/#step-1-create-an-event-type","title":"Step 1: Create an Event Type","text":"<pre><code>POST /v1/events/academy/1/eventype\nAuthorization: Token {your-token}\nAcademy: 1\nContent-Type: application/json\n\n{\n  \"slug\": \"workshop-react\",\n  \"name\": \"React Workshop\",\n  \"description\": \"Learn React fundamentals\",\n  \"icon_url\": \"https://example.com/react-icon.png\",\n  \"lang\": \"en\",\n  \"technologies\": \"React, JavaScript, JSX\"\n}\n</code></pre> <p>Response: <pre><code>{\n  \"id\": 10,\n  \"slug\": \"workshop-react\",\n  \"name\": \"React Workshop\",\n  ...\n}\n</code></pre></p>"},{"location":"LLM-DOCS/EVENT_TYPES_AND_VISIBILITY/#step-2-add-visibility-settings","title":"Step 2: Add Visibility Settings","text":"<p>Add visibility for Full Stack syllabus: <pre><code>POST /v1/events/academy/1/eventype/workshop-react/visibilitysetting\nAuthorization: Token {your-token}\nAcademy: 1\nContent-Type: application/json\n\n{\n  \"syllabus\": 5\n}\n</code></pre></p> <p>Add visibility for specific cohort: <pre><code>POST /v1/events/academy/1/eventype/workshop-react/visibilitysetting\nAuthorization: Token {your-token}\nAcademy: 1\nContent-Type: application/json\n\n{\n  \"cohort\": 10\n}\n</code></pre></p>"},{"location":"LLM-DOCS/EVENT_TYPES_AND_VISIBILITY/#step-3-verify-visibility-settings","title":"Step 3: Verify Visibility Settings","text":"<pre><code>GET /v1/events/academy/1/eventype/workshop-react/visibilitysetting\nAuthorization: Token {your-token}\nAcademy: 1\n</code></pre>"},{"location":"LLM-DOCS/EVENT_TYPES_AND_VISIBILITY/#step-4-update-event-type-if-needed","title":"Step 4: Update Event Type (if needed)","text":"<pre><code>PUT /v1/events/academy/1/eventype/workshop-react\nAuthorization: Token {your-token}\nAcademy: 1\nContent-Type: application/json\n\n{\n  \"name\": \"Advanced React Workshop\",\n  \"icon_url\": \"https://example.com/react-advanced-icon.png\",\n  \"allow_shared_creation\": false\n}\n</code></pre>"},{"location":"LLM-DOCS/EVENT_TYPES_AND_VISIBILITY/#step-5-remove-a-visibility-setting-if-needed","title":"Step 5: Remove a Visibility Setting (if needed)","text":"<pre><code>DELETE /v1/events/academy/1/eventype/workshop-react/visibilitysetting/1\nAuthorization: Token {your-token}\nAcademy: 1\n</code></pre>"},{"location":"LLM-DOCS/EVENT_TYPES_AND_VISIBILITY/#important-notes","title":"Important Notes","text":""},{"location":"LLM-DOCS/EVENT_TYPES_AND_VISIBILITY/#event-type-constraints","title":"Event Type Constraints","text":"<ol> <li>Slug Uniqueness: The <code>slug</code> field must be unique across all event types</li> <li>No Delete Endpoint: There is currently no DELETE endpoint for event types</li> <li>Academy Auto-Assignment: The <code>academy</code> field is automatically set from the URL <code>academy_id</code></li> <li>Visibility Settings Exclusion: Visibility settings cannot be set directly in the event type create/update endpoints - they must be managed separately</li> </ol>"},{"location":"LLM-DOCS/EVENT_TYPES_AND_VISIBILITY/#visibility-settings-constraints","title":"Visibility Settings Constraints","text":"<ol> <li>Academy Required: Every visibility setting must have an academy (automatically set)</li> <li>Syllabus Validation: Syllabus must belong to the academy or be public</li> <li>Cohort Validation: Cohort must belong to the academy</li> <li>Reuse Logic: If a visibility setting with the same academy, syllabus, and cohort exists, it will be reused rather than creating a duplicate</li> <li>Shared Creation: If <code>allow_shared_creation</code> is <code>false</code>, only the owning academy can see and manage visibility settings</li> </ol>"},{"location":"LLM-DOCS/EVENT_TYPES_AND_VISIBILITY/#best-practices","title":"Best Practices","text":"<ol> <li>Use Descriptive Slugs: Use clear, descriptive slugs for event types (e.g., <code>workshop-python-basics</code> instead of <code>wp1</code>)</li> <li>Set Appropriate Icons: Always provide an <code>icon_url</code> for better UI presentation</li> <li>Language Consistency: Use consistent language codes across related event types</li> <li>Visibility Granularity: Start with broader visibility (academy-wide) and add more specific settings as needed</li> <li>Shared vs Private: Use <code>allow_shared_creation</code> to control whether other academies can create events of this type</li> <li>Technology Tags: Use comma-separated technology tags to help with filtering and search</li> </ol>"},{"location":"LLM-DOCS/EVENT_TYPES_AND_VISIBILITY/#error-reference","title":"Error Reference","text":""},{"location":"LLM-DOCS/EVENT_TYPES_AND_VISIBILITY/#common-error-codes","title":"Common Error Codes","text":"Error Code HTTP Status Description <code>event-type-not-found</code> 404 Event type does not exist or doesn't belong to the academy <code>syllabus-not-found</code> 404 Syllabus does not exist or is not accessible <code>cohort-not-found</code> 404 Cohort does not exist or doesn't belong to the academy <code>event-type-visibility-setting-not-found</code> 404 Visibility setting does not exist <code>not-found</code> 404 Generic not found error"},{"location":"LLM-DOCS/EVENT_TYPES_AND_VISIBILITY/#permission-errors","title":"Permission Errors","text":"<p>If you receive a <code>403 Forbidden</code> response, ensure: - You have the <code>read_event_type</code> capability for GET requests - You have the <code>crud_event_type</code> capability for POST, PUT, and DELETE requests - The <code>Academy</code> header matches the academy you're trying to access</p>"},{"location":"LLM-DOCS/EVENT_TYPES_AND_VISIBILITY/#related-documentation","title":"Related Documentation","text":"<ul> <li>Event Suspension API - How to suspend events</li> <li>Live Classes API - Information about live classes</li> <li>Cohorts API - Managing cohorts</li> <li>Syllabus API - Managing syllabi</li> </ul>"},{"location":"LLM-DOCS/FEEDBACK_TAGS_SUMMARY/","title":"Feedback Tags Feature - Summary","text":""},{"location":"LLM-DOCS/FEEDBACK_TAGS_SUMMARY/#overview","title":"Overview","text":"<p>Added comprehensive tagging and categorization system to the feedback app, allowing academies to organize and filter both Answers and Reviews using tags, syllabus associations, and course references.</p>"},{"location":"LLM-DOCS/FEEDBACK_TAGS_SUMMARY/#key-changes","title":"Key Changes","text":""},{"location":"LLM-DOCS/FEEDBACK_TAGS_SUMMARY/#1-feedbacktag-model-new","title":"1. FeedbackTag Model (New)","text":"<p>Flexible tagging system for categorizing feedback across the platform.</p> <p>Fields: - <code>slug</code> - Unique identifier (SlugField, max 100 chars) - <code>title</code> - Display name (CharField, max 200 chars) - <code>description</code> - Optional description (TextField, nullable) - <code>priority</code> - Sorting order (IntegerField, default 100, lower = higher priority) - <code>academy</code> - Owner academy (ForeignKey to Academy, nullable for shared tags) - <code>is_private</code> - Visibility control (BooleanField, default False) - <code>created_at</code> / <code>updated_at</code> - Timestamps</p> <p>Visibility Rules: 1. Shared Public (<code>academy=null, is_private=false</code>) - Available to all academies 2. Academy Public (<code>academy=X, is_private=false</code>) - Visible to owning academy 3. Academy Private (<code>academy=X, is_private=true</code>) - Only visible to owning academy</p>"},{"location":"LLM-DOCS/FEEDBACK_TAGS_SUMMARY/#2-answer-model-updates","title":"2. Answer Model Updates","text":"<p>Added three optional categorization fields:</p> <pre><code># ForeignKey to Syllabus\nsyllabus = models.ForeignKey(\"admissions.Syllabus\", null=True, blank=True)\n\n# CharField referencing marketing.Course slug\ncourse_slug = models.CharField(max_length=150, null=True, blank=True,\n    help_text=\"Optional course slug from marketing.Course model\")\n\n# ManyToMany to FeedbackTag\ntags = models.ManyToManyField(FeedbackTag, blank=True, related_name=\"answers\")\n</code></pre> <p>Usage Example: <pre><code>answer = Answer.objects.get(id=123)\nanswer.syllabus = Syllabus.objects.get(slug='full-stack')\nanswer.course_slug = 'web-development-bootcamp'\nanswer.tags.add(\n    FeedbackTag.objects.get(slug='positive-feedback'),\n    FeedbackTag.objects.get(slug='technical-issue')\n)\nanswer.save()\n</code></pre></p>"},{"location":"LLM-DOCS/FEEDBACK_TAGS_SUMMARY/#3-review-model-updates","title":"3. Review Model Updates","text":"<p>Same three fields added to the Review model:</p> <pre><code>syllabus = models.ForeignKey(\"admissions.Syllabus\", null=True, blank=True)\ncourse_slug = models.CharField(max_length=150, null=True, blank=True,\n    help_text=\"Optional course slug from marketing.Course model\")\ntags = models.ManyToManyField(FeedbackTag, blank=True, related_name=\"reviews\")\n</code></pre> <p>Usage Example: <pre><code>review = Review.objects.get(id=456)\nreview.syllabus = Syllabus.objects.get(slug='data-science')\nreview.course_slug = 'machine-learning-bootcamp'\nreview.tags.add(FeedbackTag.objects.get(slug='graduation-ready'))\nreview.save()\n</code></pre></p>"},{"location":"LLM-DOCS/FEEDBACK_TAGS_SUMMARY/#api-endpoints","title":"API Endpoints","text":"<p>All endpoints under <code>/v1/feedback/academy/tag</code> for managing tags.</p>"},{"location":"LLM-DOCS/FEEDBACK_TAGS_SUMMARY/#get-v1feedbackacademytag","title":"GET /v1/feedback/academy/tag","text":"<p>List all accessible tags</p> <p>Query Parameters: - <code>academy</code> - Filter by ownership (<code>mine</code>, <code>shared</code>, or all) - <code>sort</code> - Sort field (default: <code>priority</code>)</p> <p>Returns: Array of FeedbackTag objects sorted by priority</p>"},{"location":"LLM-DOCS/FEEDBACK_TAGS_SUMMARY/#get-v1feedbackacademytag_1","title":"GET /v1/feedback/academy/tag/ <p>Get single tag details</p> <p>Returns: Single FeedbackTag object or 404</p>","text":""},{"location":"LLM-DOCS/FEEDBACK_TAGS_SUMMARY/#post-v1feedbackacademytag","title":"POST /v1/feedback/academy/tag <p>Create new tag</p> <p>Payload: <pre><code>{\n  \"slug\": \"positive-mentor-feedback\",\n  \"title\": \"Positive Mentor Feedback\",\n  \"description\": \"Student had positive experience with mentor\",\n  \"priority\": 15,\n  \"is_private\": false,\n  \"academy\": 1  // Optional, defaults to current academy\n}\n</code></pre></p>","text":""},{"location":"LLM-DOCS/FEEDBACK_TAGS_SUMMARY/#put-v1feedbackacademytag","title":"PUT /v1/feedback/academy/tag/ <p>Update existing tag</p> <ul> <li>Can only update academy-owned tags</li> <li>Cannot change <code>slug</code></li> </ul>","text":""},{"location":"LLM-DOCS/FEEDBACK_TAGS_SUMMARY/#delete-v1feedbackacademytag","title":"DELETE /v1/feedback/academy/tag/ <p>Delete tag</p> <ul> <li>Can only delete academy-owned tags</li> <li>Supports bulk delete via query string: <code>?id=1,2,3</code></li> </ul>","text":""},{"location":"LLM-DOCS/FEEDBACK_TAGS_SUMMARY/#permissions","title":"Permissions","text":"<p>Required Capabilities: - Read Tags: <code>read_nps_answers</code> - Create/Update/Delete Tags: <code>crud_survey</code></p> <p>These capabilities are checked via the <code>@capable_of</code> decorator.</p>"},{"location":"LLM-DOCS/FEEDBACK_TAGS_SUMMARY/#database-migration","title":"Database Migration","text":"<p>File: <code>breathecode/feedback/migrations/0004_add_feedback_tags_and_optional_fields.py</code></p> <p>Changes: 1. Creates <code>FeedbackTag</code> table 2. Adds <code>syllabus</code> (FK), <code>course_slug</code> (CharField), and <code>tags</code> (M2M) to <code>Answer</code> 3. Adds <code>syllabus</code> (FK), <code>course_slug</code> (CharField), and <code>tags</code> (M2M) to <code>Review</code> 4. Creates many-to-many relationship tables</p> <p>Apply Migration: <pre><code>poetry run python manage.py migrate feedback\n</code></pre></p>"},{"location":"LLM-DOCS/FEEDBACK_TAGS_SUMMARY/#why-course_slug-is-charfield","title":"Why course_slug is CharField","text":"<p>The <code>course_slug</code> field is a CharField (not ForeignKey) for several reasons:</p> <ol> <li>Loose Coupling - Feedback app doesn't need hard dependencies on marketing app</li> <li>Flexibility - Can reference courses that may not exist in the database yet</li> <li>Performance - Avoids JOIN queries when filtering/reporting</li> <li>Data Integrity - Feedback persists even if course is deleted</li> <li>Simplicity - Easier to work with in APIs and serializers</li> </ol> <p>The field references <code>marketing.Course.slug</code> by convention, but it's not enforced at the database level.</p>"},{"location":"LLM-DOCS/FEEDBACK_TAGS_SUMMARY/#admin-interface","title":"Admin Interface","text":""},{"location":"LLM-DOCS/FEEDBACK_TAGS_SUMMARY/#feedbacktag-admin","title":"FeedbackTag Admin <p>Location: Django Admin \u2192 Feedback \u2192 Feedback Tags</p> <p>Features: - List display: slug, title, priority, academy, is_private, created_at - Filters: is_private, academy - Search: slug, title, description - Default ordering: priority (asc), title (asc)</p> <p>Fieldsets: 1. Basic Info: slug, title, description, priority 2. Visibility: academy, is_private 3. Metadata: created_at, updated_at (collapsed)</p>","text":""},{"location":"LLM-DOCS/FEEDBACK_TAGS_SUMMARY/#usage-examples","title":"Usage Examples","text":""},{"location":"LLM-DOCS/FEEDBACK_TAGS_SUMMARY/#example-1-create-academy-specific-tags","title":"Example 1: Create Academy-Specific Tags <pre><code>from breathecode.feedback.models import FeedbackTag\nfrom breathecode.admissions.models import Academy\n\nacademy = Academy.objects.get(slug='miami')\n\n# Create public tag for the academy\ntag = FeedbackTag.objects.create(\n    slug='mentor-excellence',\n    title='Mentor Excellence',\n    description='Exceptional mentor performance',\n    priority=5,\n    academy=academy,\n    is_private=False\n)\n</code></pre>","text":""},{"location":"LLM-DOCS/FEEDBACK_TAGS_SUMMARY/#example-2-create-shared-public-tag","title":"Example 2: Create Shared Public Tag <pre><code># Create tag available to all academies\nshared_tag = FeedbackTag.objects.create(\n    slug='needs-follow-up',\n    title='Needs Follow-up',\n    description='Requires staff follow-up action',\n    priority=1,\n    academy=None,  # Shared\n    is_private=False\n)\n</code></pre>","text":""},{"location":"LLM-DOCS/FEEDBACK_TAGS_SUMMARY/#example-3-tag-an-answer","title":"Example 3: Tag an Answer <pre><code>from breathecode.feedback.models import Answer, FeedbackTag\nfrom breathecode.admissions.models import Syllabus\n\nanswer = Answer.objects.get(id=123)\n\n# Set syllabus\nanswer.syllabus = Syllabus.objects.get(slug='full-stack')\n\n# Set course slug (references marketing.Course)\nanswer.course_slug = 'web-development-bootcamp'\n\n# Add tags\nanswer.tags.add(\n    FeedbackTag.objects.get(slug='positive-feedback'),\n    FeedbackTag.objects.get(slug='needs-follow-up')\n)\n\nanswer.save()\n</code></pre>","text":""},{"location":"LLM-DOCS/FEEDBACK_TAGS_SUMMARY/#example-4-query-tagged-answers","title":"Example 4: Query Tagged Answers <pre><code># Get all answers with specific tag\ntechnical_issues = Answer.objects.filter(tags__slug='technical-issue')\n\n# Get answers with multiple tags\nurgent_feedback = Answer.objects.filter(\n    tags__slug__in=['technical-issue', 'needs-follow-up']\n).distinct()\n\n# Get answers by course\nbootcamp_feedback = Answer.objects.filter(\n    course_slug='web-development-bootcamp',\n    score__gte=8\n)\n\n# Complex query combining filters\npython_positive = Answer.objects.filter(\n    syllabus__slug='full-stack',\n    course_slug='python-fundamentals',\n    tags__slug='positive-feedback',\n    score__gte=9\n).distinct()\n</code></pre>","text":""},{"location":"LLM-DOCS/FEEDBACK_TAGS_SUMMARY/#example-5-tag-a-review","title":"Example 5: Tag a Review <pre><code>from breathecode.feedback.models import Review, FeedbackTag\n\nreview = Review.objects.get(id=456)\n\n# Set categorization\nreview.syllabus = Syllabus.objects.get(slug='data-science')\nreview.course_slug = 'machine-learning-bootcamp'\n\n# Add tags\nreview.tags.add(\n    FeedbackTag.objects.get(slug='graduation-ready'),\n    FeedbackTag.objects.get(slug='excellent-experience')\n)\n\nreview.save()\n</code></pre>","text":""},{"location":"LLM-DOCS/FEEDBACK_TAGS_SUMMARY/#example-6-api-usage","title":"Example 6: API Usage <p>Create Tag: <pre><code>curl -X POST https://api.4geeks.com/v1/feedback/academy/tag \\\n  -H \"Authorization: Token abc123\" \\\n  -H \"Academy: 1\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"slug\": \"content-quality\",\n    \"title\": \"Content Quality Issue\",\n    \"description\": \"Issues with course content or materials\",\n    \"priority\": 20,\n    \"is_private\": false\n  }'\n</code></pre></p> <p>List Tags: <pre><code># Get all accessible tags\ncurl https://api.4geeks.com/v1/feedback/academy/tag \\\n  -H \"Authorization: Token abc123\" \\\n  -H \"Academy: 1\"\n\n# Get only academy-owned tags\ncurl \"https://api.4geeks.com/v1/feedback/academy/tag?academy=mine\" \\\n  -H \"Authorization: Token abc123\" \\\n  -H \"Academy: 1\"\n\n# Get only shared tags\ncurl \"https://api.4geeks.com/v1/feedback/academy/tag?academy=shared\" \\\n  -H \"Authorization: Token abc123\" \\\n  -H \"Academy: 1\"\n</code></pre></p>","text":""},{"location":"LLM-DOCS/FEEDBACK_TAGS_SUMMARY/#querying-and-filtering","title":"Querying and Filtering","text":""},{"location":"LLM-DOCS/FEEDBACK_TAGS_SUMMARY/#filter-answers-by-tags","title":"Filter Answers by Tags <pre><code># Single tag\nanswers = Answer.objects.filter(tags__slug='technical-issue')\n\n# Multiple tags (OR)\nanswers = Answer.objects.filter(\n    tags__slug__in=['positive-feedback', 'mentor-excellence']\n).distinct()\n\n# Multiple tags (AND) - requires all tags\nfrom django.db.models import Count\nanswers = Answer.objects.annotate(\n    tag_count=Count('tags', filter=Q(\n        tags__slug__in=['positive-feedback', 'high-score']\n    ))\n).filter(tag_count=2)\n</code></pre>","text":""},{"location":"LLM-DOCS/FEEDBACK_TAGS_SUMMARY/#filter-by-course","title":"Filter by Course <pre><code># Simple filter\nanswers = Answer.objects.filter(course_slug='web-development-bootcamp')\n\n# Combined with tags\nbootcamp_issues = Answer.objects.filter(\n    course_slug='web-development-bootcamp',\n    tags__slug='technical-issue',\n    score__lt=7\n).distinct()\n</code></pre>","text":""},{"location":"LLM-DOCS/FEEDBACK_TAGS_SUMMARY/#reporting-example","title":"Reporting Example <pre><code>from django.db.models import Avg, Count\n\n# Get average score by course\ncourse_stats = Answer.objects.filter(\n    course_slug__isnull=False,\n    score__isnull=False\n).values('course_slug').annotate(\n    avg_score=Avg('score'),\n    total_responses=Count('id')\n).order_by('-avg_score')\n\nfor stat in course_stats:\n    print(f\"{stat['course_slug']}: {stat['avg_score']:.2f} ({stat['total_responses']} responses)\")\n</code></pre>","text":""},{"location":"LLM-DOCS/FEEDBACK_TAGS_SUMMARY/#best-practices","title":"Best Practices","text":""},{"location":"LLM-DOCS/FEEDBACK_TAGS_SUMMARY/#tag-naming","title":"Tag Naming <ol> <li>Use descriptive kebab-case slugs: <code>mentor-excellence</code> not <code>mentorexc</code></li> <li>Keep titles concise and clear: \"Mentor Excellence\" not \"Good Mentor\"</li> <li>Use descriptions to clarify purpose</li> <li>Reserve low priorities (1-10) for critical tags</li> </ol>","text":""},{"location":"LLM-DOCS/FEEDBACK_TAGS_SUMMARY/#tag-organization","title":"Tag Organization <ol> <li>Create shared tags for common categories (positive, negative, technical-issue)</li> <li>Use academy tags for institution-specific needs</li> <li>Mark private only when absolutely necessary</li> <li>Review regularly and archive/delete unused tags</li> </ol>","text":""},{"location":"LLM-DOCS/FEEDBACK_TAGS_SUMMARY/#performance","title":"Performance <ol> <li>Use <code>.distinct()</code> when filtering by tags (many-to-many queries)</li> <li>Index on <code>course_slug</code> if heavily used for filtering</li> <li>Consider denormalizing tag counts if needed frequently</li> <li>Use <code>.select_related('academy')</code> when displaying tag lists</li> </ol>","text":""},{"location":"LLM-DOCS/FEEDBACK_TAGS_SUMMARY/#data-integrity","title":"Data Integrity <ol> <li>Validate <code>course_slug</code> references real courses (application-level)</li> <li>Keep tag slugs stable - don't change after creation</li> <li>Document tag purposes in descriptions</li> <li>Use consistent naming conventions across academies</li> </ol>","text":""},{"location":"LLM-DOCS/FEEDBACK_TAGS_SUMMARY/#backwards-compatibility","title":"Backwards Compatibility","text":"<p>\u2705 100% Backwards Compatible</p> <ul> <li>All new fields are optional (nullable)</li> <li>Existing answers/reviews work without modification</li> <li>No changes to existing API endpoints</li> <li>Old code continues to function</li> <li>Migration is additive only (no data changes)</li> </ul>"},{"location":"LLM-DOCS/FEEDBACK_TAGS_SUMMARY/#testing","title":"Testing","text":""},{"location":"LLM-DOCS/FEEDBACK_TAGS_SUMMARY/#test-tag-crud","title":"Test Tag CRUD <pre><code>def test_create_tag():\n    response = client.post(\n        '/v1/feedback/academy/tag',\n        {'slug': 'test-tag', 'title': 'Test Tag', 'priority': 10},\n        HTTP_ACADEMY=1\n    )\n    assert response.status_code == 201\n\ndef test_shared_tags_visible():\n    # Create shared tag\n    FeedbackTag.objects.create(\n        slug='shared-tag',\n        title='Shared Tag',\n        academy=None,\n        is_private=False\n    )\n\n    # Should be visible to all academies\n    response = client.get('/v1/feedback/academy/tag', HTTP_ACADEMY=1)\n    assert any(t['slug'] == 'shared-tag' for t in response.data)\n</code></pre>","text":""},{"location":"LLM-DOCS/FEEDBACK_TAGS_SUMMARY/#test-answer-tagging","title":"Test Answer Tagging <pre><code>def test_answer_with_tags():\n    answer = Answer.objects.create(user=user, cohort=cohort)\n    tag = FeedbackTag.objects.create(slug='test', title='Test')\n\n    answer.tags.add(tag)\n    answer.course_slug = 'test-course'\n    answer.save()\n\n    assert answer.tags.count() == 1\n    assert answer.course_slug == 'test-course'\n</code></pre>","text":""},{"location":"LLM-DOCS/FEEDBACK_TAGS_SUMMARY/#summary","title":"Summary","text":""},{"location":"LLM-DOCS/FEEDBACK_TAGS_SUMMARY/#what-was-added","title":"What Was Added <p>\u2705 FeedbackTag Model - Flexible tagging system \u2705 Answer Categorization - syllabus, course_slug, tags \u2705 Review Categorization - syllabus, course_slug, tags \u2705 Full CRUD API - Create, read, update, delete tags \u2705 Admin Interface - Manage tags via Django admin \u2705 Shared/Private Tags - Flexible visibility controls \u2705 Priority Sorting - Organize tags by importance  </p>","text":""},{"location":"LLM-DOCS/FEEDBACK_TAGS_SUMMARY/#migration-applied","title":"Migration Applied <p>File: <code>0004_add_feedback_tags_and_optional_fields.py</code></p> <pre><code>poetry run python manage.py migrate feedback\n</code></pre>","text":""},{"location":"LLM-DOCS/FEEDBACK_TAGS_SUMMARY/#ready-to-use","title":"Ready to Use <p>The feature is production-ready and fully tested. Start creating tags and categorizing feedback!</p>","text":""},{"location":"LLM-DOCS/Financing_Plan_Seats_Changelog/","title":"Financing Plan Seats \u2013 Implementation Changelog","text":""},{"location":"LLM-DOCS/Financing_Plan_Seats_Changelog/#overview","title":"Overview","text":"<p>This changelog documents the new seat-management capabilities added to plan financings. Objective: align financing seats with subscription seats (team ownership, per-seat/per-team strategies, consumable issuance, auto-recharge, and API surface).</p>"},{"location":"LLM-DOCS/Financing_Plan_Seats_Changelog/#data-model-changes","title":"Data Model Changes","text":"<ul> <li><code>PlanFinancingTeam</code> (one-to-one with <code>PlanFinancing</code>)</li> <li>Tracks <code>additional_seats</code>, <code>consumption_strategy</code> (PER_SEAT | PER_TEAM), and <code>seats_log</code>.</li> <li>Owner seat auto-created on financing save when a seat-bearing service is present.</li> <li><code>PlanFinancingSeat</code> (many-to-one to <code>PlanFinancingTeam</code>)</li> <li>Stores <code>user</code>, <code>email</code>, <code>is_active</code>, <code>seat_log</code> with uniqueness constraints per team.</li> <li>Added convenience <code>billing_team</code> property for parity with subscription seats.</li> <li><code>Consumable</code> / <code>ServiceStockScheduler</code></li> <li>New FKs: <code>plan_financing_team</code>, <code>plan_financing_seat</code>.</li> <li>Query helpers (<code>Consumable.list</code>, spend tracking) updated to include financing seats/teams.</li> <li>Migration <code>0019</code></li> <li>Creates new tables and wiring, adds fields to existing models.</li> </ul>"},{"location":"LLM-DOCS/Financing_Plan_Seats_Changelog/#business-logic","title":"Business Logic","text":"<ul> <li>PlanFinancing.auto_sync_team</li> <li>Creates/updates teams and the owner seat, mirrors subscription flows.</li> <li>Team strategy defaults to plan consumption strategy; BOTH collapses to PER_SEAT.</li> <li>Seat operations (<code>payments/actions.py</code>)</li> <li><code>create_plan_financing_seat</code>, <code>replace_plan_financing_seat</code>, <code>deactivate_plan_financing_seat</code>.</li> <li>Shared validation (<code>validate_seats_limit</code>) now supports financing teams.</li> <li>Grant capabilities to assigned users per plan; regenerate consumables when seats change.</li> <li>When a seat is assigned or replaced with an email that does not belong to an existing academy member, the system issues a pending academy invite for that email (mirrors subscription seat invitations).</li> <li>Financing checkout now bills per-seat add-ons (team seats) the same way subscriptions do; the seat price is added to the installment amount before coupons.</li> <li>Consumable ownership</li> <li><code>get_user_from_consumable_to_be_charged</code> handles financing seats/teams and per-seat/per-team contexts.</li> <li>Auto-recharge validations now respect plan-financing seats and allow recharge when enabled.</li> <li>Service stock scheduler</li> <li><code>build_service_stock_scheduler_from_plan_financing</code> issues schedulers per seat or team based on strategy.</li> <li><code>renew_consumables</code> copies financing seat/team metadata into new consumables and preserves user assignment.</li> </ul>"},{"location":"LLM-DOCS/Financing_Plan_Seats_Changelog/#api-surface","title":"API Surface","text":"<p>New V2 endpoints (parity with subscription team endpoints):</p> Route Method(s) Description <code>/v2/payments/plan-financing/&lt;id&gt;/team</code> GET Returns financing team summary <code>/v2/payments/plan-financing/&lt;id&gt;/team/seat</code> GET, PUT List seats, add/replace seats via <code>add_seats</code> / <code>replace_seats</code> payloads <code>/v2/payments/plan-financing/&lt;id&gt;/team/seat/&lt;seat_id&gt;</code> DELETE Deactivate a seat (frees slot, clears consumables) <p>Owner authentication mirrors subscriptions: only the financing owner can manage seats.</p>"},{"location":"LLM-DOCS/Financing_Plan_Seats_Changelog/#auto-recharge-integration","title":"Auto-Recharge Integration","text":"<ul> <li>Plan financings reuse <code>AbstractIOweYou</code> auto-recharge fields (<code>auto_recharge_enabled</code>, thresholds, limits).</li> <li>Spend aggregation counts invoices tied to financing seats/teams.</li> <li><code>process_auto_recharge</code> charges the owner but includes financing context when generating consumables.</li> </ul>"},{"location":"LLM-DOCS/Financing_Plan_Seats_Changelog/#documentation-updates","title":"Documentation Updates","text":"<ul> <li><code>docs/LLM-DOCS/SEATS_AND_TEAMS.md</code></li> <li>Added \u201cPlan Financing Seats\u201d section describing endpoints, strategies, and auto-recharge behavior.</li> </ul>"},{"location":"LLM-DOCS/Financing_Plan_Seats_Changelog/#testing","title":"Testing","text":"<p>New pytest coverage: <code>breathecode/payments/tests/views/tests_plan_financing_seat_view.py</code></p> <ul> <li>Validates team retrieval, seat listing, add/replace seat workflows, and seat deletion.</li> <li>Uses APIRequestFactory + mocking to isolate view logic.</li> </ul>"},{"location":"LLM-DOCS/Financing_Plan_Seats_Changelog/#follow-ups-considerations","title":"Follow-Ups / Considerations","text":"<ul> <li>Invitations for financing seats (similar to subscription pending invites) are not yet implemented.</li> <li>Monitor auto-recharge spend calculations now that financings share the subscription logic branch.</li> </ul>"},{"location":"LLM-DOCS/HOOKS_MANAGEMENT/","title":"Webhooks &amp; Hooks Management","text":""},{"location":"LLM-DOCS/HOOKS_MANAGEMENT/#overview","title":"Overview","text":"<p>The BreatheCode API provides a powerful webhook system that allows academies to subscribe to real-time events happening within the platform. When specific events occur (like a student completing an assignment, a new form entry, or a cohort status change), the system will automatically send HTTP POST requests to your configured endpoints with relevant data payloads.</p> <p>This webhook system is built on top of Django REST Hooks and integrated with Celery for reliable asynchronous delivery.</p>"},{"location":"LLM-DOCS/HOOKS_MANAGEMENT/#key-concepts","title":"Key Concepts","text":""},{"location":"LLM-DOCS/HOOKS_MANAGEMENT/#hooks-vs-webhooks","title":"Hooks vs Webhooks","text":"<ul> <li>Hook: A subscription record that defines which event you want to listen to and where to send the data</li> <li>Webhook: The actual HTTP POST request sent to your target URL when the event occurs</li> </ul>"},{"location":"LLM-DOCS/HOOKS_MANAGEMENT/#event-driven-architecture","title":"Event-Driven Architecture","text":"<ul> <li>Events are triggered automatically when models change or specific actions occur</li> <li>Each hook subscription is academy-scoped (you only receive events for your academy's data)</li> <li>Superadmins can subscribe to events across all academies</li> </ul>"},{"location":"LLM-DOCS/HOOKS_MANAGEMENT/#authentication","title":"Authentication","text":""},{"location":"LLM-DOCS/HOOKS_MANAGEMENT/#academy-token-required","title":"Academy Token Required","text":"<p>To manage webhooks, you must authenticate using an Academy Token. This is a special authentication token where:</p> <ul> <li>The token's <code>username</code> matches the academy's <code>slug</code></li> <li>The system validates that the user represents a valid academy</li> </ul> <pre><code># Example: Using academy token in headers\nAuthorization: Token YOUR_ACADEMY_TOKEN\n</code></pre>"},{"location":"LLM-DOCS/HOOKS_MANAGEMENT/#superadmin-access","title":"Superadmin Access","text":"<p>Superadmin users can: - Subscribe to any event without academy restrictions - Receive webhooks from all academies - Manage hooks across the entire platform</p>"},{"location":"LLM-DOCS/HOOKS_MANAGEMENT/#base-url","title":"Base URL","text":"<p>All webhook management endpoints are under:</p> <pre><code>https://api.4geeks.com/v1/notify/\n</code></pre>"},{"location":"LLM-DOCS/HOOKS_MANAGEMENT/#available-events","title":"Available Events","text":"<p>The BreatheCode API supports the following webhook events:</p>"},{"location":"LLM-DOCS/HOOKS_MANAGEMENT/#student-cohort-management","title":"Student &amp; Cohort Management","text":"Event Name Description Trigger Model <code>profile_academy.added</code> New academy member added ProfileAcademy created <code>authenticate.ProfileAcademy</code> <code>profile_academy.changed</code> Academy member profile updated ProfileAcademy updated <code>authenticate.ProfileAcademy</code> <code>cohort_user.added</code> Student added to cohort CohortUser created <code>admissions.CohortUser</code> <code>cohort_user.changed</code> Cohort user record updated CohortUser updated <code>admissions.CohortUser</code> <code>cohort_user.edu_status_updated</code> Student educational status changed Educational status field changes <code>admissions.CohortUser</code> <code>cohort.cohort_stage_updated</code> Cohort stage changed Stage field updated <code>admissions.Cohort</code> <code>user_invite.invite_status_updated</code> Invitation status changed Invite accepted/rejected <code>authenticate.UserInvite</code>"},{"location":"LLM-DOCS/HOOKS_MANAGEMENT/#assignments-learning","title":"Assignments &amp; Learning","text":"Event Name Description Trigger Model <code>assignment.assignment_status_updated</code> Assignment status changed Task status field changes <code>assignments.Task</code> <code>assignment.assignment_created</code> New assignment created New Task created <code>assignments.Task</code> <code>assignment.assignment_revision_status_updated</code> Assignment revision status changed Revision status field changes <code>assignments.Task</code> <code>asset.asset_status_updated</code> Learning asset status updated Asset status changes <code>registry.Asset</code>"},{"location":"LLM-DOCS/HOOKS_MANAGEMENT/#assessments","title":"Assessments","text":"Event Name Description Trigger Model <code>UserAssessment.userassessment_status_updated</code> Assessment status changed UserAssessment status updated <code>assessment.UserAssessment</code>"},{"location":"LLM-DOCS/HOOKS_MANAGEMENT/#events-attendance","title":"Events &amp; Attendance","text":"Event Name Description Trigger Model <code>event.event_status_updated</code> Event status changed Event status field changes <code>events.Event</code> <code>event.event_rescheduled</code> Event date/time changed Event rescheduled <code>events.Event</code> <code>event.new_event_order</code> New event registration New EventCheckin created <code>events.EventCheckin</code> <code>event.new_event_attendee</code> New event attendee Attendee added to event <code>events.EventCheckin</code>"},{"location":"LLM-DOCS/HOOKS_MANAGEMENT/#marketing-leads","title":"Marketing &amp; Leads","text":"Event Name Description Trigger Model <code>form_entry.added</code> New form submission FormEntry created <code>marketing.FormEntry</code> <code>form_entry.changed</code> Form entry updated FormEntry updated <code>marketing.FormEntry</code> <code>form_entry.won_or_lost</code> Lead won or lost Deal status changed <code>marketing.FormEntry</code> <code>form_entry.new_deal</code> New deal created New deal in CRM <code>marketing.FormEntry</code>"},{"location":"LLM-DOCS/HOOKS_MANAGEMENT/#payments-subscriptions","title":"Payments &amp; Subscriptions","text":"Event Name Description Trigger Model <code>planfinancing.planfinancing_created</code> New financing plan created PlanFinancing created <code>payments.PlanFinancing</code> <code>subscription.subscription_created</code> New subscription created Subscription created <code>payments.Subscription</code>"},{"location":"LLM-DOCS/HOOKS_MANAGEMENT/#mentorship","title":"Mentorship","text":"Event Name Description Trigger Model <code>session.mentorship_session_status</code> Mentorship session status changed Session status updated <code>mentorship.MentorshipSession</code>"},{"location":"LLM-DOCS/HOOKS_MANAGEMENT/#api-endpoints","title":"API Endpoints","text":""},{"location":"LLM-DOCS/HOOKS_MANAGEMENT/#1-get-available-events","title":"1. Get Available Events","text":"<p>Get a list of all available webhook events that can be subscribed to, including their descriptions and metadata.</p> <p>Endpoint: <code>GET /v1/notify/hook/event</code></p> <p>Authentication: Required (Academy Token)</p> <p>Headers: <pre><code>Authorization: Token YOUR_ACADEMY_TOKEN\n</code></pre></p> <p>Query Parameters: - <code>category</code> (optional): Filter by category (admissions, assignments, marketing, payments, events, mentorship, assessment, authentication, registry) - <code>like</code> (optional): Search in event name, description, or category</p> <p>Example Request: <pre><code># Get all available events\ncurl -X GET \\\n  'https://api.4geeks.com/v1/notify/hook/event' \\\n  -H 'Authorization: Token YOUR_ACADEMY_TOKEN'\n\n# Filter by app\ncurl -X GET \\\n  'https://api.4geeks.com/v1/notify/hook/event?app=assignments' \\\n  -H 'Authorization: Token YOUR_ACADEMY_TOKEN'\n\n# Search for events\ncurl -X GET \\\n  'https://api.4geeks.com/v1/notify/hook/event?like=assignment' \\\n  -H 'Authorization: Token YOUR_ACADEMY_TOKEN'\n</code></pre></p> <p>Example Response: <pre><code>[\n  {\n    \"event\": \"assignment.assignment_created\",\n    \"label\": \"Assignment Created\",\n    \"description\": \"Triggered when a new assignment is created for a student\",\n    \"app\": \"assignments\",\n    \"model\": \"assignments.Task\"\n  },\n  {\n    \"event\": \"assignment.assignment_revision_status_updated\",\n    \"label\": \"Assignment Revision Status Updated\",\n    \"description\": \"Triggered when an assignment's revision status changes (PENDING, APPROVED, REJECTED)\",\n    \"app\": \"assignments\",\n    \"model\": \"assignments.Task\"\n  },\n  {\n    \"event\": \"assignment.assignment_status_updated\",\n    \"label\": \"Assignment Status Updated\",\n    \"description\": \"Triggered when an assignment's task status changes (PENDING to DONE)\",\n    \"app\": \"assignments\",\n    \"model\": \"assignments.Task\"\n  },\n  {\n    \"event\": \"cohort.cohort_stage_updated\",\n    \"label\": \"Cohort Stage Updated\",\n    \"description\": \"Triggered when a cohort's stage changes (INACTIVE, PREWORK, STARTED, FINAL_PROJECT, ENDED)\",\n    \"app\": \"admissions\",\n    \"model\": \"admissions.Cohort\"\n  }\n]\n</code></pre></p> <p>Response Fields: - <code>event</code>: The event name to use when subscribing - <code>label</code>: Human-readable label (auto-derived by de-slugifying the action's third part, e.g., \"assignment_created\" \u2192 \"Assignment Created\") - <code>description</code>: Detailed description of when the event is triggered - <code>app</code>: The Django app that owns this event (auto-derived from action) - <code>model</code>: The Django model that triggers this event (auto-derived from action)</p> <p>Available Apps: - <code>admissions</code>: Student and cohort management events - <code>assignments</code>: Assignment and learning activity events - <code>assessment</code>: Assessment and evaluation events - <code>authenticate</code>: User authentication and invitation events - <code>events</code>: Event and attendance tracking - <code>marketing</code>: Lead generation and CRM events - <code>payments</code>: Payment and subscription events - <code>mentorship</code>: Mentorship session events - <code>registry</code>: Learning asset management events</p>"},{"location":"LLM-DOCS/HOOKS_MANAGEMENT/#2-list-all-hooks","title":"2. List All Hooks","text":"<p>Get all webhook subscriptions for the authenticated academy.</p> <p>Endpoint: <code>GET /v1/notify/hook/subscribe</code></p> <p>Headers: <pre><code>Authorization: Token YOUR_ACADEMY_TOKEN\n</code></pre></p> <p>Query Parameters: - <code>app</code> (optional): Filter by Django app name(s), comma-separated (e.g., <code>assignments,admissions</code>). Matches hooks for events belonging to the specified app(s). - <code>event</code> (optional): Filter by event name(s), comma-separated (e.g., <code>assignment.assignment_created,cohort_user.added</code>) - <code>signal</code> (optional): Filter by Django signal path(s), comma-separated. Supports partial matching (e.g., <code>assignment_created</code> matches <code>breathecode.assignments.signals.assignment_created</code>) - <code>service_id</code> (optional): Filter by service ID, comma-separated - <code>like</code> (optional): Search in event name or target URL - <code>limit</code> (optional): Number of results per page (default: pagination settings) - <code>offset</code> (optional): Pagination offset</p> <p>Example Requests: <pre><code># Filter by single event\ncurl -X GET \\\n  'https://api.4geeks.com/v1/notify/hook/subscribe?event=assignment.assignment_created' \\\n  -H 'Authorization: Token YOUR_ACADEMY_TOKEN'\n\n# Filter by multiple events (comma-separated)\ncurl -X GET \\\n  'https://api.4geeks.com/v1/notify/hook/subscribe?event=assignment.assignment_created,cohort_user.added' \\\n  -H 'Authorization: Token YOUR_ACADEMY_TOKEN'\n\n# Filter by app (all events from assignments app)\ncurl -X GET \\\n  'https://api.4geeks.com/v1/notify/hook/subscribe?app=assignments' \\\n  -H 'Authorization: Token YOUR_ACADEMY_TOKEN'\n\n# Filter by multiple apps\ncurl -X GET \\\n  'https://api.4geeks.com/v1/notify/hook/subscribe?app=assignments,admissions' \\\n  -H 'Authorization: Token YOUR_ACADEMY_TOKEN'\n\n# Filter by signal (partial match)\ncurl -X GET \\\n  'https://api.4geeks.com/v1/notify/hook/subscribe?signal=assignment_created' \\\n  -H 'Authorization: Token YOUR_ACADEMY_TOKEN'\n\n# Filter by full signal path\ncurl -X GET \\\n  'https://api.4geeks.com/v1/notify/hook/subscribe?signal=breathecode.assignments.signals.assignment_created' \\\n  -H 'Authorization: Token YOUR_ACADEMY_TOKEN'\n\n# Combine multiple filters\ncurl -X GET \\\n  'https://api.4geeks.com/v1/notify/hook/subscribe?app=assignments&amp;event=assignment.assignment_created,assignment.assignment_status_updated' \\\n  -H 'Authorization: Token YOUR_ACADEMY_TOKEN'\n</code></pre></p> <p>Example Response: <pre><code>{\n  \"count\": 2,\n  \"next\": null,\n  \"previous\": null,\n  \"results\": [\n    {\n      \"id\": 123,\n      \"event\": \"assignment.assignment_created\",\n      \"target\": \"https://your-app.com/webhooks/assignment-created\",\n      \"service_id\": \"my-service-v1\",\n      \"created_at\": \"2025-01-15T10:30:00Z\",\n      \"updated_at\": \"2025-01-15T10:30:00Z\",\n      \"total_calls\": 45,\n      \"last_call_at\": \"2025-01-20T14:22:30Z\",\n      \"last_response_code\": 200\n    },\n    {\n      \"id\": 124,\n      \"event\": \"cohort_user.added\",\n      \"target\": \"https://your-app.com/webhooks/student-added\",\n      \"service_id\": null,\n      \"created_at\": \"2025-01-16T09:15:00Z\",\n      \"updated_at\": \"2025-01-16T09:15:00Z\",\n      \"total_calls\": 12,\n      \"last_call_at\": \"2025-01-19T11:10:00Z\",\n      \"last_response_code\": 200\n    }\n  ]\n}\n</code></pre></p>"},{"location":"LLM-DOCS/HOOKS_MANAGEMENT/#3-subscribe-to-a-hook","title":"3. Subscribe to a Hook","text":"<p>Create a new webhook subscription.</p> <p>Endpoint: <code>POST /v1/notify/hook/subscribe</code></p> <p>Headers: <pre><code>Authorization: Token YOUR_ACADEMY_TOKEN\nContent-Type: application/json\n</code></pre></p> <p>Request Body: <pre><code>{\n  \"event\": \"assignment.assignment_created\",\n  \"target\": \"https://your-app.com/webhooks/assignment-created\",\n  \"service_id\": \"my-service-v1\"\n}\n</code></pre></p> <p>Fields: - <code>event</code> (required): Event name from the available events list - <code>target</code> (required): Full URL where webhook POST requests will be sent - <code>service_id</code> (optional): Custom identifier for your service (useful for managing multiple webhook endpoints)</p> <p>Example Request: <pre><code>curl -X POST \\\n  'https://api.4geeks.com/v1/notify/hook/subscribe' \\\n  -H 'Authorization: Token YOUR_ACADEMY_TOKEN' \\\n  -H 'Content-Type: application/json' \\\n  -d '{\n    \"event\": \"assignment.assignment_created\",\n    \"target\": \"https://your-app.com/webhooks/assignment-created\",\n    \"service_id\": \"production-v2\"\n  }'\n</code></pre></p> <p>Example Response: <pre><code>{\n  \"id\": 125,\n  \"event\": \"assignment.assignment_created\",\n  \"target\": \"https://your-app.com/webhooks/assignment-created\",\n  \"service_id\": \"production-v2\",\n  \"created_at\": \"2025-01-20T15:30:00Z\",\n  \"updated_at\": \"2025-01-20T15:30:00Z\",\n  \"total_calls\": 0,\n  \"last_call_at\": null,\n  \"last_response_code\": null\n}\n</code></pre></p> <p>Error Responses:</p> <p>Invalid event: <pre><code>{\n  \"detail\": \"Unexpected event unknown.event\",\n  \"slug\": \"invalid-event\",\n  \"status_code\": 400\n}\n</code></pre></p> <p>Invalid academy token: <pre><code>{\n  \"detail\": \"No valid academy token found\",\n  \"slug\": \"invalid-academy-token\",\n  \"status_code\": 400\n}\n</code></pre></p>"},{"location":"LLM-DOCS/HOOKS_MANAGEMENT/#4-update-a-hook","title":"4. Update a Hook","text":"<p>Update an existing webhook subscription.</p> <p>Endpoint: <code>PUT /v1/notify/hook/subscribe/{hook_id}</code></p> <p>Headers: <pre><code>Authorization: Token YOUR_ACADEMY_TOKEN\nContent-Type: application/json\n</code></pre></p> <p>Request Body: <pre><code>{\n  \"event\": \"assignment.assignment_status_updated\",\n  \"target\": \"https://your-app.com/webhooks/assignment-updated-v2\",\n  \"service_id\": \"production-v2\"\n}\n</code></pre></p> <p>Example Request: <pre><code>curl -X PUT \\\n  'https://api.4geeks.com/v1/notify/hook/subscribe/123' \\\n  -H 'Authorization: Token YOUR_ACADEMY_TOKEN' \\\n  -H 'Content-Type: application/json' \\\n  -d '{\n    \"event\": \"assignment.assignment_status_updated\",\n    \"target\": \"https://your-app.com/webhooks/assignment-updated\",\n    \"service_id\": \"production-v2\"\n  }'\n</code></pre></p> <p>Example Response: <pre><code>{\n  \"id\": 123,\n  \"event\": \"assignment.assignment_status_updated\",\n  \"target\": \"https://your-app.com/webhooks/assignment-updated\",\n  \"service_id\": \"production-v2\",\n  \"created_at\": \"2025-01-15T10:30:00Z\",\n  \"updated_at\": \"2025-01-20T16:45:00Z\",\n  \"total_calls\": 45,\n  \"last_call_at\": \"2025-01-20T14:22:30Z\",\n  \"last_response_code\": 200\n}\n</code></pre></p>"},{"location":"LLM-DOCS/HOOKS_MANAGEMENT/#5-delete-hooks","title":"5. Delete Hook(s)","text":"<p>Unsubscribe from webhook(s). You can delete a specific hook by ID or delete multiple hooks using filters.</p> <p>Endpoint: <code>DELETE /v1/notify/hook/subscribe/{hook_id}</code> or <code>DELETE /v1/notify/hook/subscribe</code></p> <p>Headers: <pre><code>Authorization: Token YOUR_ACADEMY_TOKEN\n</code></pre></p> <p>Delete by ID: <pre><code>curl -X DELETE \\\n  'https://api.4geeks.com/v1/notify/hook/subscribe/123' \\\n  -H 'Authorization: Token YOUR_ACADEMY_TOKEN'\n</code></pre></p> <p>Delete by filters:</p> <p>Query Parameters (at least one required): - <code>event</code>: Event name(s), comma-separated - <code>service_id</code>: Service ID(s), comma-separated</p> <pre><code># Delete all hooks for specific event\ncurl -X DELETE \\\n  'https://api.4geeks.com/v1/notify/hook/subscribe?event=assignment.assignment_created' \\\n  -H 'Authorization: Token YOUR_ACADEMY_TOKEN'\n\n# Delete all hooks for specific service\ncurl -X DELETE \\\n  'https://api.4geeks.com/v1/notify/hook/subscribe?service_id=old-service-v1' \\\n  -H 'Authorization: Token YOUR_ACADEMY_TOKEN'\n\n# Delete hooks matching multiple criteria\ncurl -X DELETE \\\n  'https://api.4geeks.com/v1/notify/hook/subscribe?event=assignment.assignment_created,assignment.assignment_status_updated&amp;service_id=staging' \\\n  -H 'Authorization: Token YOUR_ACADEMY_TOKEN'\n</code></pre> <p>Example Response: <pre><code>{\n  \"details\": \"Unsubscribed from 3 hooks\"\n}\n</code></pre></p> <p>Error Response (no filters provided): <pre><code>{\n  \"detail\": \"Please include some filter in the URL\",\n  \"slug\": \"validation-error\",\n  \"status_code\": 400\n}\n</code></pre></p>"},{"location":"LLM-DOCS/HOOKS_MANAGEMENT/#6-get-sample-data","title":"6. Get Sample Data","text":"<p>Retrieve sample payload data for a specific hook or event type. This is useful for understanding what data structure you'll receive.</p> <p>Endpoint: <code>GET /v1/notify/hook/sample</code> or <code>GET /v1/notify/hook/{hook_id}/sample</code></p> <p>Headers: <pre><code>Authorization: Token YOUR_ACADEMY_TOKEN\n</code></pre></p> <p>Get sample by hook ID: <pre><code>curl -X GET \\\n  'https://api.4geeks.com/v1/notify/hook/123/sample' \\\n  -H 'Authorization: Token YOUR_ACADEMY_TOKEN'\n</code></pre></p> <p>Get sample by filters:</p> <p>Query Parameters (at least one required if not using hook_id): - <code>event</code>: Event name(s), comma-separated - <code>service_id</code>: Service ID(s), comma-separated - <code>like</code>: Search term</p> <pre><code>curl -X GET \\\n  'https://api.4geeks.com/v1/notify/hook/sample?event=assignment.assignment_created' \\\n  -H 'Authorization: Token YOUR_ACADEMY_TOKEN'\n</code></pre> <p>Example Response: <pre><code>{\n  \"id\": 456,\n  \"title\": \"Build a Landing Page\",\n  \"task_status\": \"DONE\",\n  \"associated_slug\": \"build-landing-page\",\n  \"description\": \"Create a responsive landing page using HTML, CSS and JavaScript\",\n  \"revision_status\": \"APPROVED\",\n  \"github_url\": \"https://github.com/student/landing-page\",\n  \"live_url\": \"https://student.github.io/landing-page\",\n  \"task_type\": \"PROJECT\",\n  \"user\": {\n    \"id\": 789,\n    \"first_name\": \"Jane\",\n    \"last_name\": \"Doe\"\n  },\n  \"opened_at\": \"2025-01-15T10:00:00Z\",\n  \"read_at\": \"2025-01-16T09:30:00Z\",\n  \"reviewed_at\": \"2025-01-17T14:20:00Z\",\n  \"delivered_at\": \"2025-01-16T16:45:00Z\",\n  \"cohort\": {\n    \"id\": 12,\n    \"name\": \"Full Stack Development - Cohort 45\",\n    \"slug\": \"full-stack-45\"\n  },\n  \"assignment_telemetry\": {\n    \"session_duration\": 7200,\n    \"percentage\": 100,\n    \"completed_at\": \"2025-01-16T16:40:00Z\"\n  },\n  \"created_at\": \"2025-01-15T09:00:00Z\",\n  \"updated_at\": \"2025-01-17T14:20:00Z\"\n}\n</code></pre></p>"},{"location":"LLM-DOCS/HOOKS_MANAGEMENT/#webhook-payload-structures","title":"Webhook Payload Structures","text":""},{"location":"LLM-DOCS/HOOKS_MANAGEMENT/#common-patterns","title":"Common Patterns","text":"<p>All webhook POST requests sent to your target URL will include:</p> <p>Headers: <pre><code>Content-Type: application/json\nUser-Agent: BreatheCode-Webhooks/1.0\n</code></pre></p> <p>Payload Structure:</p> <p>The payload structure varies by event type. Below are detailed examples for each major category.</p>"},{"location":"LLM-DOCS/HOOKS_MANAGEMENT/#assignment-events","title":"Assignment Events","text":""},{"location":"LLM-DOCS/HOOKS_MANAGEMENT/#assignmentassignment_created","title":"<code>assignment.assignment_created</code>","text":"<p>Triggered when a new assignment is created for a student.</p> <pre><code>{\n  \"id\": 456,\n  \"title\": \"Build a Todo App\",\n  \"task_status\": \"PENDING\",\n  \"associated_slug\": \"build-todo-app\",\n  \"description\": \"Create a todo application with CRUD operations\",\n  \"revision_status\": \"PENDING\",\n  \"github_url\": null,\n  \"live_url\": null,\n  \"task_type\": \"PROJECT\",\n  \"user\": {\n    \"id\": 789,\n    \"first_name\": \"Jane\",\n    \"last_name\": \"Doe\"\n  },\n  \"opened_at\": null,\n  \"read_at\": null,\n  \"reviewed_at\": null,\n  \"delivered_at\": null,\n  \"cohort\": {\n    \"id\": 12,\n    \"name\": \"Full Stack Development - Cohort 45\",\n    \"slug\": \"full-stack-45\"\n  },\n  \"assignment_telemetry\": null,\n  \"created_at\": \"2025-01-15T09:00:00Z\",\n  \"updated_at\": \"2025-01-15T09:00:00Z\"\n}\n</code></pre>"},{"location":"LLM-DOCS/HOOKS_MANAGEMENT/#assignmentassignment_status_updated","title":"<code>assignment.assignment_status_updated</code>","text":"<p>Triggered when an assignment's status changes (e.g., PENDING \u2192 DONE).</p> <pre><code>{\n  \"id\": 456,\n  \"title\": \"Build a Todo App\",\n  \"task_status\": \"DONE\",\n  \"associated_slug\": \"build-todo-app\",\n  \"description\": \"Create a todo application with CRUD operations\",\n  \"revision_status\": \"PENDING\",\n  \"github_url\": \"https://github.com/student/todo-app\",\n  \"live_url\": \"https://student.github.io/todo-app\",\n  \"task_type\": \"PROJECT\",\n  \"user\": {\n    \"id\": 789,\n    \"first_name\": \"Jane\",\n    \"last_name\": \"Doe\"\n  },\n  \"opened_at\": \"2025-01-15T10:00:00Z\",\n  \"read_at\": null,\n  \"reviewed_at\": null,\n  \"delivered_at\": \"2025-01-16T16:45:00Z\",\n  \"cohort\": {\n    \"id\": 12,\n    \"name\": \"Full Stack Development - Cohort 45\",\n    \"slug\": \"full-stack-45\"\n  },\n  \"assignment_telemetry\": {\n    \"session_duration\": 7200,\n    \"percentage\": 100,\n    \"completed_at\": \"2025-01-16T16:40:00Z\"\n  },\n  \"created_at\": \"2025-01-15T09:00:00Z\",\n  \"updated_at\": \"2025-01-16T16:45:00Z\"\n}\n</code></pre> <p>Task Status Values: - <code>PENDING</code>: Not started - <code>DONE</code>: Completed by student</p> <p>Task Types: - <code>PROJECT</code>: Full project assignment - <code>EXERCISE</code>: Practice exercise - <code>LESSON</code>: Lesson or reading - <code>QUIZ</code>: Quiz or assessment</p>"},{"location":"LLM-DOCS/HOOKS_MANAGEMENT/#assignmentassignment_revision_status_updated","title":"<code>assignment.assignment_revision_status_updated</code>","text":"<p>Triggered when an assignment's revision status changes (teacher review).</p> <pre><code>{\n  \"id\": 456,\n  \"title\": \"Build a Todo App\",\n  \"task_status\": \"DONE\",\n  \"revision_status\": \"APPROVED\",\n  \"github_url\": \"https://github.com/student/todo-app\",\n  \"live_url\": \"https://student.github.io/todo-app\",\n  \"reviewed_at\": \"2025-01-17T14:20:00Z\",\n  \"user\": {\n    \"id\": 789,\n    \"first_name\": \"Jane\",\n    \"last_name\": \"Doe\"\n  },\n  \"cohort\": {\n    \"id\": 12,\n    \"name\": \"Full Stack Development - Cohort 45\",\n    \"slug\": \"full-stack-45\"\n  },\n  \"created_at\": \"2025-01-15T09:00:00Z\",\n  \"updated_at\": \"2025-01-17T14:20:00Z\"\n}\n</code></pre> <p>Revision Status Values: - <code>PENDING</code>: Awaiting review - <code>APPROVED</code>: Accepted by teacher - <code>REJECTED</code>: Needs improvements</p>"},{"location":"LLM-DOCS/HOOKS_MANAGEMENT/#cohort-student-events","title":"Cohort &amp; Student Events","text":""},{"location":"LLM-DOCS/HOOKS_MANAGEMENT/#cohort_useradded","title":"<code>cohort_user.added</code>","text":"<p>Triggered when a student is added to a cohort.</p> <pre><code>{\n  \"id\": 234,\n  \"user\": {\n    \"id\": 789,\n    \"first_name\": \"Jane\",\n    \"last_name\": \"Doe\",\n    \"email\": \"jane.doe@example.com\"\n  },\n  \"cohort\": {\n    \"id\": 12,\n    \"name\": \"Full Stack Development - Cohort 45\",\n    \"slug\": \"full-stack-45\",\n    \"kickoff_date\": \"2025-01-10T00:00:00Z\",\n    \"ending_date\": \"2025-06-30T00:00:00Z\",\n    \"stage\": \"STARTED\",\n    \"academy\": {\n      \"id\": 4,\n      \"name\": \"Downtown Campus\",\n      \"slug\": \"downtown-campus\"\n    }\n  },\n  \"role\": \"STUDENT\",\n  \"finantial_status\": \"FULLY_PAID\",\n  \"educational_status\": \"ACTIVE\",\n  \"watching\": false,\n  \"created_at\": \"2025-01-10T08:30:00Z\",\n  \"updated_at\": \"2025-01-10T08:30:00Z\",\n  \"profile_academy\": {\n    \"id\": 567,\n    \"email\": \"jane.doe@example.com\",\n    \"first_name\": \"Jane\",\n    \"last_name\": \"Doe\",\n    \"phone\": \"+1234567890\",\n    \"address\": \"123 Main St\"\n  }\n}\n</code></pre> <p>Role Values: - <code>STUDENT</code>: Regular student - <code>TEACHER</code>: Instructor - <code>ASSISTANT</code>: Teaching assistant</p> <p>Financial Status Values: - <code>FULLY_PAID</code>: Payment complete - <code>UP_TO_DATE</code>: Payment current - <code>LATE</code>: Payment overdue</p> <p>Educational Status Values: - <code>ACTIVE</code>: Currently active - <code>POSTPONED</code>: Temporarily paused - <code>SUSPENDED</code>: Suspended - <code>GRADUATED</code>: Completed program - <code>DROPPED</code>: Withdrew from program</p>"},{"location":"LLM-DOCS/HOOKS_MANAGEMENT/#cohort_useredu_status_updated","title":"<code>cohort_user.edu_status_updated</code>","text":"<p>Triggered when a student's educational status changes.</p> <pre><code>{\n  \"id\": 234,\n  \"user\": {\n    \"id\": 789,\n    \"first_name\": \"Jane\",\n    \"last_name\": \"Doe\"\n  },\n  \"cohort\": {\n    \"id\": 12,\n    \"name\": \"Full Stack Development - Cohort 45\",\n    \"slug\": \"full-stack-45\"\n  },\n  \"role\": \"STUDENT\",\n  \"educational_status\": \"GRADUATED\",\n  \"created_at\": \"2025-01-10T08:30:00Z\",\n  \"updated_at\": \"2025-06-30T16:00:00Z\"\n}\n</code></pre>"},{"location":"LLM-DOCS/HOOKS_MANAGEMENT/#cohortcohort_stage_updated","title":"<code>cohort.cohort_stage_updated</code>","text":"<p>Triggered when a cohort's stage changes.</p> <pre><code>{\n  \"id\": 12,\n  \"slug\": \"full-stack-45\",\n  \"name\": \"Full Stack Development - Cohort 45\",\n  \"language\": \"en\",\n  \"kickoff_date\": \"2025-01-10T00:00:00Z\",\n  \"ending_date\": \"2025-06-30T00:00:00Z\",\n  \"current_day\": 45,\n  \"current_module\": 3,\n  \"stage\": \"FINAL_PROJECT\",\n  \"academy\": {\n    \"id\": 4,\n    \"name\": \"Downtown Campus\",\n    \"slug\": \"downtown-campus\",\n    \"street_address\": \"123 Tech Street\",\n    \"city\": \"San Francisco\",\n    \"country\": \"USA\"\n  },\n  \"syllabus_version\": {\n    \"version\": 2,\n    \"name\": \"Full Stack Developer v2\",\n    \"syllabus\": {\n      \"slug\": \"full-stack-ft\",\n      \"name\": \"Full Stack Development\"\n    }\n  },\n  \"is_hidden_on_prework\": false,\n  \"available_as_saas\": true\n}\n</code></pre> <p>Cohort Stage Values: - <code>INACTIVE</code>: Not started - <code>PREWORK</code>: Pre-course work - <code>STARTED</code>: Active learning - <code>FINAL_PROJECT</code>: Working on final project - <code>ENDED</code>: Completed - <code>DELETED</code>: Archived</p>"},{"location":"LLM-DOCS/HOOKS_MANAGEMENT/#marketing-lead-events","title":"Marketing &amp; Lead Events","text":""},{"location":"LLM-DOCS/HOOKS_MANAGEMENT/#form_entryadded","title":"<code>form_entry.added</code>","text":"<p>Triggered when a new lead/form submission is created.</p> <pre><code>{\n  \"id\": 9876,\n  \"first_name\": \"John\",\n  \"last_name\": \"Smith\",\n  \"email\": \"john.smith@example.com\",\n  \"phone\": \"+1987654321\",\n  \"course\": \"full-stack-development\",\n  \"deal_status\": \"WON\",\n  \"location\": \"Miami, FL\",\n  \"language\": \"en\",\n  \"utm_source\": \"google\",\n  \"utm_medium\": \"cpc\",\n  \"utm_campaign\": \"summer-2025\",\n  \"utm_content\": \"ad-variant-a\",\n  \"gclid\": \"EAIaIQobChMI...\",\n  \"tags\": \"high-intent,fintech-background\",\n  \"country\": \"USA\",\n  \"city\": \"Miami\",\n  \"storage_status\": \"SYNCED\",\n  \"created_at\": \"2025-01-20T10:15:00Z\",\n  \"updated_at\": \"2025-01-20T10:15:00Z\"\n}\n</code></pre>"},{"location":"LLM-DOCS/HOOKS_MANAGEMENT/#form_entrywon_or_lost","title":"<code>form_entry.won_or_lost</code>","text":"<p>Triggered when a lead is marked as won or lost.</p> <pre><code>{\n  \"id\": 9876,\n  \"first_name\": \"John\",\n  \"last_name\": \"Smith\",\n  \"email\": \"john.smith@example.com\",\n  \"deal_status\": \"WON\",\n  \"updated_at\": \"2025-01-22T14:30:00Z\"\n}\n</code></pre> <p>Deal Status Values: - <code>WON</code>: Converted to paying student - <code>LOST</code>: Did not convert</p>"},{"location":"LLM-DOCS/HOOKS_MANAGEMENT/#payment-events","title":"Payment Events","text":""},{"location":"LLM-DOCS/HOOKS_MANAGEMENT/#subscriptionsubscription_created","title":"<code>subscription.subscription_created</code>","text":"<p>Triggered when a new subscription is created.</p> <pre><code>{\n  \"id\": 445,\n  \"status\": \"ACTIVE\",\n  \"paid_at\": \"2025-01-20T15:00:00Z\",\n  \"valid_until\": \"2026-01-20T15:00:00Z\",\n  \"is_refundable\": true,\n  \"next_payment_at\": \"2026-01-20T15:00:00Z\",\n  \"user\": {\n    \"id\": 789,\n    \"first_name\": \"Jane\",\n    \"last_name\": \"Doe\",\n    \"email\": \"jane.doe@example.com\"\n  },\n  \"academy\": {\n    \"id\": 4,\n    \"name\": \"Downtown Campus\",\n    \"slug\": \"downtown-campus\"\n  },\n  \"selected_cohort\": {\n    \"id\": 12,\n    \"name\": \"Full Stack Development - Cohort 45\",\n    \"slug\": \"full-stack-45\"\n  },\n  \"plans\": [\n    {\n      \"id\": 67,\n      \"slug\": \"full-stack-monthly\",\n      \"name\": \"Full Stack Development - Monthly\"\n    }\n  ],\n  \"invoices\": [],\n  \"created_at\": \"2025-01-20T15:00:00Z\",\n  \"updated_at\": \"2025-01-20T15:00:00Z\"\n}\n</code></pre> <p>Subscription Status Values: - <code>ACTIVE</code>: Currently active - <code>CANCELLED</code>: Cancelled - <code>PAYMENT_ISSUE</code>: Payment failed - <code>EXPIRED</code>: Expired</p>"},{"location":"LLM-DOCS/HOOKS_MANAGEMENT/#planfinancingplanfinancing_created","title":"<code>planfinancing.planfinancing_created</code>","text":"<p>Triggered when a new financing plan is created.</p> <pre><code>{\n  \"id\": 334,\n  \"status\": \"ACTIVE\",\n  \"monthly_price\": 299.00,\n  \"plan_expires_at\": \"2026-01-20T00:00:00Z\",\n  \"valid_until\": \"2026-01-20T23:59:59Z\",\n  \"next_payment_at\": \"2025-02-20T00:00:00Z\",\n  \"user\": {\n    \"id\": 789,\n    \"first_name\": \"Jane\",\n    \"last_name\": \"Doe\",\n    \"email\": \"jane.doe@example.com\"\n  },\n  \"academy\": {\n    \"id\": 4,\n    \"name\": \"Downtown Campus\",\n    \"slug\": \"downtown-campus\"\n  },\n  \"selected_cohort\": {\n    \"id\": 12,\n    \"name\": \"Full Stack Development - Cohort 45\",\n    \"slug\": \"full-stack-45\"\n  },\n  \"plans\": [\n    {\n      \"id\": 67,\n      \"slug\": \"full-stack-financing\",\n      \"name\": \"Full Stack Development - 12 Month Financing\"\n    }\n  ],\n  \"created_at\": \"2025-01-20T15:00:00Z\",\n  \"updated_at\": \"2025-01-20T15:00:00Z\"\n}\n</code></pre>"},{"location":"LLM-DOCS/HOOKS_MANAGEMENT/#event-attendance","title":"Event &amp; Attendance","text":""},{"location":"LLM-DOCS/HOOKS_MANAGEMENT/#eventnew_event_attendee","title":"<code>event.new_event_attendee</code>","text":"<p>Triggered when someone registers for an event.</p> <pre><code>{\n  \"id\": 5678,\n  \"status\": \"PENDING\",\n  \"attended_at\": null,\n  \"event\": {\n    \"id\": 234,\n    \"title\": \"Introduction to Python Workshop\",\n    \"slug\": \"intro-python-workshop-jan-2025\",\n    \"event_type\": \"workshop\",\n    \"starting_at\": \"2025-01-25T18:00:00Z\",\n    \"ending_at\": \"2025-01-25T20:00:00Z\",\n    \"capacity\": 50,\n    \"online_event\": false,\n    \"venue\": \"Downtown Campus Room 101\"\n  },\n  \"attendee\": {\n    \"id\": 789,\n    \"first_name\": \"Jane\",\n    \"last_name\": \"Doe\",\n    \"email\": \"jane.doe@example.com\"\n  },\n  \"created_at\": \"2025-01-20T12:30:00Z\",\n  \"updated_at\": \"2025-01-20T12:30:00Z\"\n}\n</code></pre>"},{"location":"LLM-DOCS/HOOKS_MANAGEMENT/#mentorship-events","title":"Mentorship Events","text":""},{"location":"LLM-DOCS/HOOKS_MANAGEMENT/#sessionmentorship_session_status","title":"<code>session.mentorship_session_status</code>","text":"<p>Triggered when a mentorship session status changes.</p> <pre><code>{\n  \"id\": 889,\n  \"status\": \"STARTED\",\n  \"started_at\": \"2025-01-20T15:00:00Z\",\n  \"ended_at\": null,\n  \"mentor\": {\n    \"id\": 456,\n    \"user\": {\n      \"id\": 123,\n      \"first_name\": \"Michael\",\n      \"last_name\": \"Chen\",\n      \"email\": \"michael.chen@example.com\"\n    },\n    \"services\": [\n      {\n        \"id\": 12,\n        \"name\": \"Code Review\",\n        \"slug\": \"code-review\"\n      }\n    ]\n  },\n  \"mentee\": {\n    \"id\": 789,\n    \"first_name\": \"Jane\",\n    \"last_name\": \"Doe\",\n    \"email\": \"jane.doe@example.com\"\n  },\n  \"service\": {\n    \"id\": 12,\n    \"name\": \"Code Review\",\n    \"slug\": \"code-review\",\n    \"duration\": 3600\n  },\n  \"bill\": null,\n  \"created_at\": \"2025-01-20T14:00:00Z\",\n  \"updated_at\": \"2025-01-20T15:00:00Z\"\n}\n</code></pre> <p>Session Status Values: - <code>PENDING</code>: Scheduled, not started - <code>STARTED</code>: Currently in progress - <code>COMPLETED</code>: Successfully completed - <code>FAILED</code>: Failed or cancelled - <code>IGNORED</code>: Ignored/no-show</p>"},{"location":"LLM-DOCS/HOOKS_MANAGEMENT/#webhook-delivery","title":"Webhook Delivery","text":""},{"location":"LLM-DOCS/HOOKS_MANAGEMENT/#how-webhooks-are-sent","title":"How Webhooks Are Sent","text":"<ol> <li>Event Trigger: When a model changes or action occurs, a signal is emitted</li> <li>Hook Lookup: System finds all hooks subscribed to that event for the relevant academy</li> <li>Payload Serialization: Data is serialized using event-specific serializers</li> <li>Async Delivery: Webhook is queued in Celery for asynchronous delivery</li> <li>HTTP POST: System sends POST request to your target URL with JSON payload</li> <li>Tracking: Response code and timestamp are recorded</li> </ol>"},{"location":"LLM-DOCS/HOOKS_MANAGEMENT/#webhook-requirements","title":"Webhook Requirements","text":"<p>Your webhook endpoint must:</p> <ol> <li>Accept POST requests with JSON body</li> <li>Respond with 2xx status code (200, 201, 204) to confirm receipt</li> <li>Respond within 30 seconds (requests will timeout after 30s)</li> <li>Use HTTPS (highly recommended for security)</li> </ol>"},{"location":"LLM-DOCS/HOOKS_MANAGEMENT/#webhook-response-handling","title":"Webhook Response Handling","text":"<p>Success Response (2xx): - Hook marked as successfully delivered - <code>last_call_at</code> updated to current timestamp - <code>last_response_code</code> set to your response code (e.g., 200) - <code>total_calls</code> incremented</p> <p>Failure Response (4xx, 5xx, timeout): - Error logged in <code>HookError</code> model - <code>last_response_code</code> set to error code - Hook remains active (no automatic disabling)</p>"},{"location":"LLM-DOCS/HOOKS_MANAGEMENT/#best-practices-for-webhook-endpoints","title":"Best Practices for Webhook Endpoints","text":"<ol> <li> <p>Acknowledge Quickly: Respond with 200 OK immediately, then process async    <pre><code># Good pattern\n@app.route('/webhook/assignment-created', methods=['POST'])\ndef handle_assignment_created():\n    data = request.json\n    # Queue processing job\n    process_assignment.delay(data)\n    return '', 200  # Respond immediately\n</code></pre></p> </li> <li> <p>Validate Payload: Check that required fields exist    <pre><code>required_fields = ['id', 'user', 'cohort']\nif not all(field in data for field in required_fields):\n    return {'error': 'Invalid payload'}, 400\n</code></pre></p> </li> <li> <p>Idempotency: Handle duplicate deliveries gracefully    <pre><code># Store processed webhook IDs\nif redis.exists(f'webhook:{data[\"id\"]}'):\n    return '', 200  # Already processed\n\nredis.setex(f'webhook:{data[\"id\"]}', 86400, '1')\n# Process webhook...\n</code></pre></p> </li> <li> <p>Error Handling: Don't let exceptions crash your endpoint    <pre><code>try:\n    process_webhook(data)\n    return '', 200\nexcept Exception as e:\n    logger.error(f'Webhook processing failed: {e}')\n    return '', 500  # Still return a response\n</code></pre></p> </li> <li> <p>Logging: Log all webhook receipts for debugging    <pre><code>logger.info(f'Received webhook: {data.get(\"id\")} - {request.path}')\n</code></pre></p> </li> </ol>"},{"location":"LLM-DOCS/HOOKS_MANAGEMENT/#security-considerations","title":"Security Considerations","text":""},{"location":"LLM-DOCS/HOOKS_MANAGEMENT/#authentication_1","title":"Authentication","text":"<p>While webhooks are sent as HTTP POST requests without authentication headers, you should:</p> <ol> <li>Use HTTPS: Always use HTTPS URLs to prevent man-in-the-middle attacks</li> <li>Validate Source IP: Consider IP whitelisting (contact support for BreatheCode IP ranges)</li> <li>Verify Payload Structure: Validate that payloads match expected schema</li> <li>Use Service IDs: Include unique service_id to identify your webhook sources</li> </ol>"},{"location":"LLM-DOCS/HOOKS_MANAGEMENT/#data-privacy","title":"Data Privacy","text":"<ul> <li>Webhooks contain real user data (names, emails, etc.)</li> <li>Store webhook data securely</li> <li>Comply with GDPR/privacy regulations</li> <li>Only subscribe to events you actually need</li> </ul>"},{"location":"LLM-DOCS/HOOKS_MANAGEMENT/#rate-limiting","title":"Rate Limiting","text":"<ul> <li>No hard rate limits on webhook creation</li> <li>Be mindful of creating too many duplicate subscriptions</li> <li>Use <code>service_id</code> to manage different environments (staging, production)</li> </ul>"},{"location":"LLM-DOCS/HOOKS_MANAGEMENT/#testing-webhooks","title":"Testing Webhooks","text":""},{"location":"LLM-DOCS/HOOKS_MANAGEMENT/#using-sample-data","title":"Using Sample Data","text":"<p>Before setting up webhooks, review sample data:</p> <pre><code># Get sample data for an event type\ncurl -X GET \\\n  'https://api.4geeks.com/v1/notify/hook/sample?event=assignment.assignment_created' \\\n  -H 'Authorization: Token YOUR_ACADEMY_TOKEN'\n</code></pre>"},{"location":"LLM-DOCS/HOOKS_MANAGEMENT/#testing-locally","title":"Testing Locally","text":"<p>For local development, use tools like:</p> <ol> <li> <p>ngrok: Expose local server to internet    <pre><code>ngrok http 3000\n# Use ngrok URL as webhook target\n</code></pre></p> </li> <li> <p>webhook.site: Test without writing code</p> </li> <li>Visit https://webhook.site</li> <li>Copy unique URL</li> <li> <p>Use as webhook target to see payloads</p> </li> <li> <p>RequestBin: Similar to webhook.site</p> </li> <li>Create temporary endpoint</li> <li>Inspect webhook payloads</li> </ol>"},{"location":"LLM-DOCS/HOOKS_MANAGEMENT/#development-vs-production","title":"Development vs Production","text":"<p>Use <code>service_id</code> to differentiate environments:</p> <pre><code>// Development\n{\n  \"event\": \"assignment.assignment_created\",\n  \"target\": \"https://dev-app.ngrok.io/webhooks/assignment\",\n  \"service_id\": \"development\"\n}\n\n// Staging\n{\n  \"event\": \"assignment.assignment_created\",\n  \"target\": \"https://staging.your-app.com/webhooks/assignment\",\n  \"service_id\": \"staging\"\n}\n\n// Production\n{\n  \"event\": \"assignment.assignment_created\",\n  \"target\": \"https://your-app.com/webhooks/assignment\",\n  \"service_id\": \"production\"\n}\n</code></pre>"},{"location":"LLM-DOCS/HOOKS_MANAGEMENT/#common-use-cases","title":"Common Use Cases","text":""},{"location":"LLM-DOCS/HOOKS_MANAGEMENT/#1-real-time-student-dashboard","title":"1. Real-time Student Dashboard","text":"<p>Subscribe to assignment and cohort events to build live student progress dashboards:</p> <pre><code>[\n  {\n    \"event\": \"assignment.assignment_status_updated\",\n    \"target\": \"https://dashboard.com/webhooks/assignment-update\"\n  },\n  {\n    \"event\": \"cohort_user.edu_status_updated\",\n    \"target\": \"https://dashboard.com/webhooks/student-status\"\n  }\n]\n</code></pre>"},{"location":"LLM-DOCS/HOOKS_MANAGEMENT/#2-crm-integration","title":"2. CRM Integration","text":"<p>Sync leads and students to your CRM:</p> <pre><code>[\n  {\n    \"event\": \"form_entry.added\",\n    \"target\": \"https://crm-sync.com/webhooks/new-lead\"\n  },\n  {\n    \"event\": \"cohort_user.added\",\n    \"target\": \"https://crm-sync.com/webhooks/student-enrolled\"\n  }\n]\n</code></pre>"},{"location":"LLM-DOCS/HOOKS_MANAGEMENT/#3-payment-notifications","title":"3. Payment Notifications","text":"<p>Track subscription and payment events:</p> <pre><code>[\n  {\n    \"event\": \"subscription.subscription_created\",\n    \"target\": \"https://billing.com/webhooks/subscription-created\"\n  },\n  {\n    \"event\": \"planfinancing.planfinancing_created\",\n    \"target\": \"https://billing.com/webhooks/financing-created\"\n  }\n]\n</code></pre>"},{"location":"LLM-DOCS/HOOKS_MANAGEMENT/#4-custom-notifications","title":"4. Custom Notifications","text":"<p>Build custom notification systems:</p> <pre><code>[\n  {\n    \"event\": \"assignment.assignment_revision_status_updated\",\n    \"target\": \"https://notify.com/webhooks/assignment-reviewed\"\n  },\n  {\n    \"event\": \"event.new_event_attendee\",\n    \"target\": \"https://notify.com/webhooks/event-registration\"\n  }\n]\n</code></pre>"},{"location":"LLM-DOCS/HOOKS_MANAGEMENT/#troubleshooting","title":"Troubleshooting","text":""},{"location":"LLM-DOCS/HOOKS_MANAGEMENT/#hook-not-receiving-events","title":"Hook Not Receiving Events","text":"<p>Check: 1. Verify event name is correct (see Available Events) 2. Confirm academy token is valid 3. Check that you're authenticated as the academy 4. Verify the entity has an <code>academy</code> relationship 5. Ensure the event actually triggered (check Django logs)</p>"},{"location":"LLM-DOCS/HOOKS_MANAGEMENT/#webhooks-timing-out","title":"Webhooks Timing Out","text":"<p>Solutions: 1. Respond with 200 OK immediately 2. Process webhook data asynchronously 3. Optimize your endpoint performance 4. Check your server isn't overloaded</p>"},{"location":"LLM-DOCS/HOOKS_MANAGEMENT/#receiving-duplicate-events","title":"Receiving Duplicate Events","text":"<p>Solutions: 1. Implement idempotency using event IDs 2. Use Redis/database to track processed events 3. Check if you have duplicate hook subscriptions</p>"},{"location":"LLM-DOCS/HOOKS_MANAGEMENT/#wrong-payload-structure","title":"Wrong Payload Structure","text":"<p>Solutions: 1. Use <code>/hook/sample</code> endpoint to see expected structure 2. Check for null/optional fields 3. Validate against serializer definitions in code</p>"},{"location":"LLM-DOCS/HOOKS_MANAGEMENT/#debug-webhook-issues","title":"Debug Webhook Issues","text":"<p>Check these: 1. Hook exists: List your hooks with GET <code>/hook/subscribe</code> 2. Last response code: Check <code>last_response_code</code> in hook details 3. Error logs: Check <code>HookError</code> records (contact support) 4. Event trigger: Verify the event is actually firing (check Celery logs)</p>"},{"location":"LLM-DOCS/HOOKS_MANAGEMENT/#monitoring-observability","title":"Monitoring &amp; Observability","text":""},{"location":"LLM-DOCS/HOOKS_MANAGEMENT/#hook-statistics","title":"Hook Statistics","text":"<p>Each hook tracks: - <code>total_calls</code>: Total number of webhook deliveries attempted - <code>last_call_at</code>: Timestamp of most recent delivery - <code>last_response_code</code>: HTTP status code from last delivery</p> <p>Use this data to monitor webhook health.</p>"},{"location":"LLM-DOCS/HOOKS_MANAGEMENT/#error-tracking","title":"Error Tracking","text":"<p>Webhook errors are logged in the <code>HookError</code> model. Each error records: - Error message - Event name - Related hooks - Timestamp</p> <p>Contact support for access to error logs.</p>"},{"location":"LLM-DOCS/HOOKS_MANAGEMENT/#rate-limits-quotas","title":"Rate Limits &amp; Quotas","text":"<ul> <li>No hard limits on number of hooks per academy</li> <li>No rate limits on webhook delivery</li> <li>Be respectful of the system and your own endpoints</li> <li>Remove unused hooks to keep things clean</li> </ul>"},{"location":"LLM-DOCS/HOOKS_MANAGEMENT/#support-resources","title":"Support &amp; Resources","text":""},{"location":"LLM-DOCS/HOOKS_MANAGEMENT/#additional-documentation","title":"Additional Documentation","text":"<ul> <li>Django REST Hooks Documentation</li> <li>BreatheCode API Documentation</li> </ul>"},{"location":"LLM-DOCS/HOOKS_MANAGEMENT/#getting-help","title":"Getting Help","text":"<ul> <li>Review webhook error logs in admin panel</li> <li>Check Celery task logs for delivery issues</li> <li>Contact BreatheCode support with hook ID for debugging</li> </ul>"},{"location":"LLM-DOCS/HOOKS_MANAGEMENT/#api-status","title":"API Status","text":"<ul> <li>Monitor API status at: https://status.4geeks.com</li> <li>Subscribe to incident notifications</li> </ul>"},{"location":"LLM-DOCS/HOOKS_MANAGEMENT/#changelog","title":"Changelog","text":""},{"location":"LLM-DOCS/HOOKS_MANAGEMENT/#version-20-current","title":"Version 2.0 (Current)","text":"<ul> <li>Academy-scoped webhooks</li> <li>Support for 25+ event types</li> <li>Sample data endpoints</li> <li>Bulk delete by filters</li> <li>Service ID support for environment management</li> </ul>"},{"location":"LLM-DOCS/HOOKS_MANAGEMENT/#appendix-complete-event-reference","title":"Appendix: Complete Event Reference","text":"Category Event Name Model Trigger Admissions <code>profile_academy.added</code> ProfileAcademy Created <code>profile_academy.changed</code> ProfileAcademy Updated <code>cohort_user.added</code> CohortUser Created <code>cohort_user.changed</code> CohortUser Updated <code>cohort_user.edu_status_updated</code> CohortUser Educational status changed <code>cohort.cohort_stage_updated</code> Cohort Stage changed Assignments <code>assignment.assignment_created</code> Task Created <code>assignment.assignment_status_updated</code> Task Task status changed <code>assignment.assignment_revision_status_updated</code> Task Revision status changed Authentication <code>user_invite.invite_status_updated</code> UserInvite Invite status changed Registry <code>asset.asset_status_updated</code> Asset Asset status changed Assessment <code>UserAssessment.userassessment_status_updated</code> UserAssessment Status updated Events <code>event.event_status_updated</code> Event Status changed <code>event.event_rescheduled</code> Event Date/time changed <code>event.new_event_order</code> EventCheckin Created <code>event.new_event_attendee</code> EventCheckin Attendee added Marketing <code>form_entry.added</code> FormEntry Created <code>form_entry.changed</code> FormEntry Updated <code>form_entry.won_or_lost</code> FormEntry Deal status changed <code>form_entry.new_deal</code> FormEntry New deal created Payments <code>planfinancing.planfinancing_created</code> PlanFinancing Created <code>subscription.subscription_created</code> Subscription Created Mentorship <code>session.mentorship_session_status</code> MentorshipSession Status changed <p>Last Updated: December 2025 API Version: v1 Document Version: 2.0</p>"},{"location":"LLM-DOCS/LIVE_CLASSES/","title":"Live Classes API Documentation","text":"<p>This document provides comprehensive information about Live Classes in BreatheCode - how they're automatically generated from cohort timeslots, how to query them, track attendance, and manage class sessions.</p>"},{"location":"LLM-DOCS/LIVE_CLASSES/#overview","title":"Overview","text":"<p>Live Classes are automatically generated instances of scheduled cohort sessions based on Cohort TimeSlots. They represent actual class meetings with specific dates and times, attendance tracking, and meeting URLs.</p>"},{"location":"LLM-DOCS/LIVE_CLASSES/#key-concepts","title":"Key Concepts","text":"<ul> <li>CohortTimeSlot: A template/schedule defining when classes occur (e.g., \"Every Monday 2-4 PM\")</li> <li>LiveClass: An actual instance of a class (e.g., \"Monday October 28, 2025 2-4 PM\")</li> <li>Automatic Generation: Live classes are created automatically via background tasks when timeslots are saved</li> <li>Attendance Tracking: Classes track when they start (<code>started_at</code>) and end (<code>ended_at</code>)</li> </ul>"},{"location":"LLM-DOCS/LIVE_CLASSES/#model-relationships","title":"Model Relationships","text":"<pre><code>Cohort\n  \u2514\u2500\u2500 CohortTimeSlot (schedule template)\n      \u2514\u2500\u2500 LiveClass (multiple instances)\n          \u251c\u2500\u2500 starting_at (scheduled start)\n          \u251c\u2500\u2500 ending_at (scheduled end)\n          \u251c\u2500\u2500 started_at (actual start - when teacher joins)\n          \u251c\u2500\u2500 ended_at (actual end - marks completion)\n          \u2514\u2500\u2500 hash (unique join URL identifier)\n</code></pre>"},{"location":"LLM-DOCS/LIVE_CLASSES/#core-endpoints","title":"Core Endpoints","text":""},{"location":"LLM-DOCS/LIVE_CLASSES/#1-list-live-classes-for-current-user","title":"1. List Live Classes for Current User","text":"<p>Endpoint: <code>GET /v1/events/me/event/liveclass</code></p> <p>Purpose: Get live classes for the authenticated user (student, teacher, or TA)</p> <p>Authentication: Required (any authenticated user)</p> <p>Query Parameters: - <code>cohort={cohort_slug}</code> - Filter by cohort slug - <code>academy={academy_slug}</code> - Filter by academy - <code>syllabus={syllabus_slug}</code> - Filter by syllabus - <code>starting_at__gte={datetime}</code> - Classes starting at or after this date - <code>starting_at__lte={datetime}</code> - Classes starting at or before this date - <code>ending_at__gte={datetime}</code> - Classes ending at or after this date - <code>ending_at__lte={datetime}</code> - Classes ending at or before this date - <code>upcoming={null}</code> - Get only upcoming classes (ended_at is null) - <code>remote_meeting_url={url}</code> - Filter by specific meeting URL - <code>start={datetime}</code> - Alias for <code>starting_at__gte</code> - <code>end={datetime}</code> - Alias for <code>ending_at__lte</code> - <code>limit={number}</code> - Results per page (pagination) - <code>offset={number}</code> - Skip N results (pagination)</p> <p>Response: <pre><code>[\n  {\n    \"id\": 123,\n    \"hash\": \"a1b2c3d4e5f6789...\",\n    \"starting_at\": \"2025-10-28T18:00:00Z\",\n    \"ending_at\": \"2025-10-28T20:00:00Z\",\n    \"started_at\": null,\n    \"ended_at\": null,\n    \"remote_meeting_url\": \"https://zoom.us/j/123456789\",\n    \"cohort\": {\n      \"id\": 45,\n      \"slug\": \"web-dev-ft-2025\",\n      \"name\": \"Web Development Full Time 2025\",\n      \"kickoff_date\": \"2025-01-15\",\n      \"ending_date\": \"2025-06-30\",\n      \"stage\": \"STARTED\",\n      \"current_day\": 85,\n      \"academy\": {\n        \"id\": 1,\n        \"slug\": \"downtown-miami\",\n        \"name\": \"4Geeks Downtown Miami\",\n        \"logo_url\": \"https://...\"\n      }\n    }\n  }\n]\n</code></pre></p> <p>Example Requests:</p> <p>Get all upcoming classes: <pre><code>GET /v1/events/me/event/liveclass?upcoming=null\nAuthorization: Token {your-token}\n</code></pre></p> <p>Get classes for specific cohort: <pre><code>GET /v1/events/me/event/liveclass?cohort=web-dev-ft-2025\nAuthorization: Token {your-token}\n</code></pre></p> <p>Get classes in date range: <pre><code>GET /v1/events/me/event/liveclass?starting_at__gte=2025-10-28&amp;starting_at__lte=2025-11-04\nAuthorization: Token {your-token}\n</code></pre></p>"},{"location":"LLM-DOCS/LIVE_CLASSES/#2-list-live-classes-for-academy-staff-view","title":"2. List Live Classes for Academy (Staff View)","text":"<p>Endpoint: <code>GET /v1/events/academy/event/liveclass</code></p> <p>Purpose: Get all live classes for an academy (staff/admin view)</p> <p>Authentication: Required - <code>start_or_end_class</code> capability</p> <p>Headers: - <code>Academy: {academy_id}</code> - Required - <code>Authorization: Token {your-token}</code> - Required</p> <p>Query Parameters: All parameters from user endpoint, plus: - <code>user={user_id}</code> - Filter by specific user ID - <code>user_email={email}</code> - Filter by user email</p> <p>Response: Same format as user endpoint</p> <p>Example Requests:</p> <p>Get all classes for academy: <pre><code>GET /v1/events/academy/event/liveclass\nHeaders:\n  Academy: 1\n  Authorization: Token {your-token}\n</code></pre></p> <p>Get classes for specific student: <pre><code>GET /v1/events/academy/event/liveclass?user=456&amp;cohort=web-dev-ft-2025\nHeaders:\n  Academy: 1\n  Authorization: Token {your-token}\n</code></pre></p> <p>Get ongoing classes: <pre><code>GET /v1/events/academy/event/liveclass?started_at__is_null=false&amp;ended_at__is_null=true\nHeaders:\n  Academy: 1\n  Authorization: Token {your-token}\n</code></pre></p>"},{"location":"LLM-DOCS/LIVE_CLASSES/#3-create-live-class-manual","title":"3. Create Live Class (Manual)","text":"<p>Endpoint: <code>POST /v1/events/academy/event/liveclass</code></p> <p>Purpose: Manually create a live class instance</p> <p>Authentication: Required - <code>start_or_end_class</code> capability</p> <p>Headers: - <code>Academy: {academy_id}</code> - Required - <code>Authorization: Token {your-token}</code> - Required</p> <p>Request Body: <pre><code>{\n  \"cohort_time_slot\": 123,\n  \"starting_at\": \"2025-10-28T18:00:00Z\",\n  \"ending_at\": \"2025-10-28T20:00:00Z\",\n  \"remote_meeting_url\": \"https://zoom.us/j/123456789\"\n}\n</code></pre></p> <p>Required Fields: - <code>cohort_time_slot</code> (integer) - The timeslot ID this class belongs to - <code>starting_at</code> (ISO datetime) - Scheduled start time - <code>ending_at</code> (ISO datetime) - Scheduled end time - <code>remote_meeting_url</code> (URL) - Meeting link</p> <p>Optional Fields: - <code>log</code> (JSON object) - Additional metadata - <code>started_at</code> (datetime) - Cannot be set on creation - <code>ended_at</code> (datetime) - Cannot be set on creation</p> <p>Response: <pre><code>{\n  \"id\": 789,\n  \"hash\": \"x9y8z7w6v5u4...\",\n  \"cohort_time_slot\": 123,\n  \"starting_at\": \"2025-10-28T18:00:00Z\",\n  \"ending_at\": \"2025-10-28T20:00:00Z\",\n  \"started_at\": null,\n  \"ended_at\": null,\n  \"remote_meeting_url\": \"https://zoom.us/j/123456789\",\n  \"log\": {},\n  \"created_at\": \"2025-10-21T20:00:00Z\",\n  \"updated_at\": \"2025-10-21T20:00:00Z\"\n}\n</code></pre></p> <p>Validation Rules: - Cannot set <code>started_at</code> on creation - The cohort must belong to the specified academy - Times must be valid ISO datetime strings</p>"},{"location":"LLM-DOCS/LIVE_CLASSES/#4-update-live-class","title":"4. Update Live Class","text":"<p>Endpoint: <code>PUT /v1/events/academy/event/liveclass/{live_class_id}</code></p> <p>Purpose: Update a live class (primarily for marking as started/ended)</p> <p>Authentication: Required - <code>start_or_end_class</code> capability</p> <p>Headers: - <code>Academy: {academy_id}</code> - Required - <code>Authorization: Token {your-token}</code> - Required</p> <p>Request Body Examples:</p> <p>Mark class as started: <pre><code>{\n  \"started_at\": \"2025-10-28T18:05:00Z\"\n}\n</code></pre></p> <p>Mark class as ended: <pre><code>{\n  \"ended_at\": \"2025-10-28T20:00:00Z\"\n}\n</code></pre></p> <p>Update meeting URL: <pre><code>{\n  \"remote_meeting_url\": \"https://meet.google.com/new-link\"\n}\n</code></pre></p> <p>Validation Rules: - Cannot start a class that's already started - <code>started_at</code> must be within 2 minutes of current time (can't backdate) - Can only update one field at a time when setting <code>started_at</code> - <code>ended_at</code> must be after <code>started_at</code> - <code>ended_at</code> cannot be more than 24 hours before current time - Must wait at least 30 minutes between start and end</p> <p>Response: Updated live class object</p>"},{"location":"LLM-DOCS/LIVE_CLASSES/#5-join-live-class","title":"5. Join Live Class","text":"<p>Endpoint: <code>GET /v1/events/me/event/liveclass/join/{hash}</code></p> <p>Purpose: Join a live class (redirects to meeting URL or shows countdown)</p> <p>Authentication: Required (private view with token)</p> <p>URL Parameters: - <code>hash</code> - The unique hash identifier from the live class</p> <p>Query Parameters: - <code>token={auth_token}</code> - Authentication token</p> <p>Behavior: 1. If class hasn't started yet: Shows countdown page with class details 2. If class is ready: Redirects to <code>cohort.online_meeting_url</code> 3. If user is teacher/assistant: Automatically marks class as started</p> <p>Example: <pre><code>GET /v1/events/me/event/liveclass/join/a1b2c3d4e5f6789?token={auth_token}\n</code></pre></p> <p>Response: - HTML countdown page (if early) - HTTP 302 Redirect to meeting URL (if ready)</p>"},{"location":"LLM-DOCS/LIVE_CLASSES/#6-academy-staff-join-live-class","title":"6. Academy Staff Join Live Class","text":"<p>Endpoint: <code>GET /v1/events/academy/event/liveclass/join/{hash}</code></p> <p>Purpose: Same as user endpoint but for academy staff</p> <p>Authentication: Required - <code>start_or_end_class</code> capability</p> <p>Headers: - <code>Academy: {academy_id}</code> - Required - <code>Authorization: Token {your-token}</code> - Required</p>"},{"location":"LLM-DOCS/LIVE_CLASSES/#automatic-generation-workflow","title":"Automatic Generation Workflow","text":""},{"location":"LLM-DOCS/LIVE_CLASSES/#how-live-classes-are-generated","title":"How Live Classes are Generated","text":"<p>Live classes are automatically created when: 1. A <code>CohortTimeSlot</code> is created 2. A <code>CohortTimeSlot</code> is updated 3. The management command <code>build_live_classes</code> is run</p>"},{"location":"LLM-DOCS/LIVE_CLASSES/#generation-process","title":"Generation Process","text":"<p>Trigger: <code>post_save</code> signal on <code>CohortTimeSlot</code> model</p> <p>Background Task: <code>build_live_classes_from_timeslot(timeslot_id)</code></p> <p>Algorithm: 1. Load the timeslot and associated cohort 2. Calculate start/end dates:    - Start: <code>cohort.kickoff_date</code>    - End: <code>timeslot.removed_at</code> or <code>cohort.ending_date</code> 3. Determine recurrence interval:    - <code>DAILY</code>: +1 day    - <code>WEEKLY</code>: +1 week    - <code>MONTHLY</code>: +1 month 4. Generate classes:    - Start from first occurrence after kickoff date    - Create <code>LiveClass</code> for each recurrence    - Stop at end date or if <code>recurrent=false</code>    - Use <code>get_or_create()</code> to avoid duplicates 5. Delete obsolete future classes</p> <p>Example: <pre><code>Cohort: kickoff_date=2025-01-15, ending_date=2025-06-30\nTimeSlot: starting_at=1400 (2 PM), ending_at=1600 (4 PM), \n          recurrent=true, recurrency_type=WEEKLY, timezone=America/New_York\n\nGenerated Classes:\n- 2025-01-15 14:00 - 16:00 EST\n- 2025-01-22 14:00 - 16:00 EST\n- 2025-01-29 14:00 - 16:00 EST\n- ... (continues weekly until 2025-06-30)\n</code></pre></p>"},{"location":"LLM-DOCS/LIVE_CLASSES/#creating-live-classes-complete-flows","title":"Creating Live Classes: Complete Flows","text":""},{"location":"LLM-DOCS/LIVE_CLASSES/#flow-1-automatic-creation-recommended","title":"Flow 1: Automatic Creation (Recommended)","text":"<p>This is the standard workflow - live classes are created automatically when you create timeslots.</p> <p>Step 1: Create Cohort TimeSlot <pre><code>POST /v1/admissions/academy/cohort/{cohort_id}/timeslot\nHeaders:\n  Academy: 1\n  Authorization: Token {your-token}\n\nBody:\n{\n  \"starting_at\": 1400,\n  \"ending_at\": 1600,\n  \"recurrent\": true,\n  \"recurrency_type\": \"WEEKLY\",\n  \"timezone\": \"America/New_York\"\n}\n</code></pre></p> <p>Step 2: System Automatically: - Saves the <code>CohortTimeSlot</code> - Triggers <code>post_save_cohort_time_slot</code> signal - Queues <code>build_live_classes_from_timeslot.delay(timeslot_id)</code> task - Background task generates all future <code>LiveClass</code> instances</p> <p>Step 3: Verify Classes Were Created <pre><code>GET /v1/events/academy/event/liveclass?cohort={cohort_slug}\nHeaders:\n  Academy: 1\n  Authorization: Token {your-token}\n</code></pre></p> <p>Prerequisites: - Cohort must have <code>kickoff_date</code> set - Cohort must have <code>ending_date</code> set (or <code>never_ends=false</code>) - Cohort should have <code>online_meeting_url</code> set - Celery workers must be running</p>"},{"location":"LLM-DOCS/LIVE_CLASSES/#flow-2-manual-creation","title":"Flow 2: Manual Creation","text":"<p>For one-off classes or special sessions.</p> <p>Step 1: Get TimeSlot ID <pre><code>GET /v1/admissions/academy/cohort/{cohort_id}/timeslot\nHeaders:\n  Academy: 1\n  Authorization: Token {your-token}\n</code></pre></p> <p>Step 2: Create Live Class <pre><code>POST /v1/events/academy/event/liveclass\nHeaders:\n  Academy: 1\n  Authorization: Token {your-token}\n\nBody:\n{\n  \"cohort_time_slot\": 123,\n  \"starting_at\": \"2025-10-28T18:00:00Z\",\n  \"ending_at\": \"2025-10-28T20:00:00Z\",\n  \"remote_meeting_url\": \"https://zoom.us/j/special-session\"\n}\n</code></pre></p> <p>Use Cases: - Special workshops - Make-up classes - Guest speaker sessions - Classes outside regular schedule</p>"},{"location":"LLM-DOCS/LIVE_CLASSES/#flow-3-bulk-regeneration","title":"Flow 3: Bulk Regeneration","text":"<p>For maintenance or fixing issues.</p> <p>Management Command: <pre><code>poetry run python manage.py build_live_classes\n</code></pre></p> <p>What It Does: - Finds all active cohorts (not DELETED or PREWORK stage) - Finds all timeslots for each cohort - Triggers <code>build_live_classes_from_timeslot</code> for each - Regenerates all future classes - Cleans up obsolete classes</p> <p>When to Use: - After bulk cohort updates - After changing cohort end dates - After fixing timeslot issues - Database migration or recovery</p>"},{"location":"LLM-DOCS/LIVE_CLASSES/#attendance-tracking-flow","title":"Attendance Tracking Flow","text":""},{"location":"LLM-DOCS/LIVE_CLASSES/#teacher-starts-class","title":"Teacher Starts Class","text":"<p>Scenario: Teacher clicks join link at class time</p> <p>Step 1: Teacher Joins <pre><code>GET /v1/events/me/event/liveclass/join/{hash}?token={teacher-token}\n</code></pre></p> <p>Step 2: System Automatically: - Checks if user is TEACHER or ASSISTANT role - Checks if <code>started_at</code> is null - Queues <code>mark_live_class_as_started.delay(live_class_id)</code> - Redirects to meeting URL</p> <p>Step 3: Task Marks Class Started <pre><code># Background task updates:\nlive_class.started_at = timezone.now()\nlive_class.save()\n</code></pre></p>"},{"location":"LLM-DOCS/LIVE_CLASSES/#class-ends","title":"Class Ends","text":"<p>Option A: Automatic (Scheduled)</p> <p>Background tasks can automatically mark classes as ended 30 minutes after scheduled end time.</p> <p>Option B: Manual (Staff) <pre><code>PUT /v1/events/academy/event/liveclass/{live_class_id}\nHeaders:\n  Academy: 1\n  Authorization: Token {your-token}\n\nBody:\n{\n  \"ended_at\": \"2025-10-28T20:00:00Z\"\n}\n</code></pre></p> <p>Step 3: System Triggers Survey - <code>liveclass_ended</code> signal is sent - <code>send_liveclass_survey</code> task is queued - Surveys sent to students who attended - Attendance tracked from cohort <code>history_log</code></p>"},{"location":"LLM-DOCS/LIVE_CLASSES/#integration-with-other-systems","title":"Integration with Other Systems","text":""},{"location":"LLM-DOCS/LIVE_CLASSES/#1-cohort-history-tracking","title":"1. Cohort History Tracking","text":"<p>When a class ends, the system checks: - <code>cohort.history_log</code> for attendance data - Students present within 24 hours of class end - Creates survey answers for attendees</p> <p>History Log Format: <pre><code>{\n  \"2025-10-28\": {\n    \"updated_at\": \"2025-10-28T20:00:00Z\",\n    \"attendance_ids\": [101, 102, 103, 104]\n  }\n}\n</code></pre></p>"},{"location":"LLM-DOCS/LIVE_CLASSES/#2-feedback-surveys","title":"2. Feedback Surveys","text":"<p>Automatic Survey Creation: - Triggered when <code>ended_at</code> is set - Only if ended within last 24 hours - Only if no survey exists for this class - Checks academy feedback settings - Respects excluded cohorts</p> <p>Survey Template: - Uses <code>liveclass_survey_template</code> from academy settings - Falls back to default template - Survey language matches cohort language</p>"},{"location":"LLM-DOCS/LIVE_CLASSES/#3-ical-calendar-integration","title":"3. iCal Calendar Integration","text":"<p>Endpoint: <code>GET /v1/events/ical/cohorts/{cohort_ids}</code></p> <p>Purpose: Generate iCal feed with all live classes</p> <p>Format: <pre><code>BEGIN:VCALENDAR\nVERSION:2.0\nBEGIN:VEVENT\nUID:liveclass-123@breathecode.com\nDTSTART:20251028T180000Z\nDTEND:20251028T200000Z\nSUMMARY:Web Development - Live Class\nDESCRIPTION:Join: https://zoom.us/j/123456789\nEND:VEVENT\nEND:VCALENDAR\n</code></pre></p>"},{"location":"LLM-DOCS/LIVE_CLASSES/#query-examples","title":"Query Examples","text":""},{"location":"LLM-DOCS/LIVE_CLASSES/#get-todays-classes","title":"Get Today's Classes","text":"<pre><code>GET /v1/events/me/event/liveclass?starting_at__gte=2025-10-28T00:00:00Z&amp;starting_at__lte=2025-10-28T23:59:59Z\n</code></pre>"},{"location":"LLM-DOCS/LIVE_CLASSES/#get-this-weeks-classes","title":"Get This Week's Classes","text":"<pre><code>GET /v1/events/me/event/liveclass?starting_at__gte=2025-10-28&amp;starting_at__lte=2025-11-03\n</code></pre>"},{"location":"LLM-DOCS/LIVE_CLASSES/#get-currently-active-classes","title":"Get Currently Active Classes","text":"<pre><code>GET /v1/events/academy/event/liveclass?started_at__is_null=false&amp;ended_at__is_null=true\nHeaders:\n  Academy: 1\n</code></pre>"},{"location":"LLM-DOCS/LIVE_CLASSES/#get-past-classes-for-analysis","title":"Get Past Classes for Analysis","text":"<pre><code>GET /v1/events/academy/event/liveclass?ended_at__is_null=false&amp;ending_at__gte=2025-10-01\nHeaders:\n  Academy: 1\n</code></pre>"},{"location":"LLM-DOCS/LIVE_CLASSES/#get-all-classes-for-multiple-cohorts","title":"Get All Classes for Multiple Cohorts","text":"<pre><code>GET /v1/events/academy/event/liveclass?cohort__in=cohort-1,cohort-2,cohort-3\nHeaders:\n  Academy: 1\n</code></pre>"},{"location":"LLM-DOCS/LIVE_CLASSES/#field-reference","title":"Field Reference","text":""},{"location":"LLM-DOCS/LIVE_CLASSES/#liveclass-model-fields","title":"LiveClass Model Fields","text":"Field Type Description <code>id</code> Integer Unique identifier <code>hash</code> String (40) Unique hash for join URLs <code>cohort_time_slot</code> ForeignKey Related timeslot template <code>starting_at</code> DateTime Scheduled start time <code>ending_at</code> DateTime Scheduled end time <code>started_at</code> DateTime Actual start (when teacher joined) <code>ended_at</code> DateTime Actual end (marks completion) <code>remote_meeting_url</code> URL Meeting link (Zoom, Google Meet, etc.) <code>log</code> JSON Additional metadata/logs <code>created_at</code> DateTime Record creation time <code>updated_at</code> DateTime Last update time"},{"location":"LLM-DOCS/LIVE_CLASSES/#cohorttimeslot-model-fields-reference","title":"CohortTimeSlot Model Fields (Reference)","text":"Field Type Description <code>starting_at</code> Integer Start time in HHMM format (1400 = 2 PM) <code>ending_at</code> Integer End time in HHMM format (1600 = 4 PM) <code>recurrent</code> Boolean Whether this repeats <code>recurrency_type</code> String DAILY, WEEKLY, or MONTHLY <code>timezone</code> String Timezone (e.g., \"America/New_York\") <code>removed_at</code> DateTime When timeslot was removed"},{"location":"LLM-DOCS/LIVE_CLASSES/#validation-rules","title":"Validation Rules","text":""},{"location":"LLM-DOCS/LIVE_CLASSES/#creation-validations","title":"Creation Validations","text":"<ol> <li>\u2705 <code>cohort_time_slot</code> must exist and belong to academy</li> <li>\u2705 <code>starting_at</code> and <code>ending_at</code> are required</li> <li>\u2705 <code>ending_at</code> must be after <code>starting_at</code></li> <li>\u2705 <code>remote_meeting_url</code> must be valid URL</li> <li>\u274c Cannot set <code>started_at</code> on creation</li> <li>\u274c Cannot set <code>ended_at</code> on creation</li> </ol>"},{"location":"LLM-DOCS/LIVE_CLASSES/#update-validations","title":"Update Validations","text":"<ol> <li>\u2705 Can update <code>remote_meeting_url</code> anytime</li> <li>\u2705 Can set <code>started_at</code> once (within \u00b12 minutes of current time)</li> <li>\u2705 Can set <code>ended_at</code> after class started</li> <li>\u274c Cannot change <code>started_at</code> once set</li> <li>\u274c Cannot backdate <code>started_at</code> more than 2 minutes</li> <li>\u274c Must wait 30 minutes between start and end</li> <li>\u274c Cannot set <code>ended_at</code> more than 24 hours in past</li> </ol>"},{"location":"LLM-DOCS/LIVE_CLASSES/#error-handling","title":"Error Handling","text":""},{"location":"LLM-DOCS/LIVE_CLASSES/#common-errors","title":"Common Errors","text":"<p>404 - Live Class Not Found <pre><code>{\n  \"detail\": \"Live class not found for this academy\",\n  \"slug\": \"not-found\"\n}\n</code></pre></p> <p>400 - Already Started <pre><code>{\n  \"detail\": \"This class has already been started\",\n  \"slug\": \"started-at-already-set\"\n}\n</code></pre></p> <p>400 - Too Early/Late to Start <pre><code>{\n  \"detail\": \"You can only start a class within 2 minutes of the current time\",\n  \"slug\": \"started-at-not-now\"\n}\n</code></pre></p> <p>400 - Class Not Started Yet <pre><code>{\n  \"detail\": \"The class must be started before you can end it\",\n  \"slug\": \"started-at-not-set\"\n}\n</code></pre></p> <p>400 - Ended Too Soon <pre><code>{\n  \"detail\": \"You cannot end a class less than 30 minutes after it started\",\n  \"slug\": \"ended-at-too-soon\"\n}\n</code></pre></p>"},{"location":"LLM-DOCS/LIVE_CLASSES/#best-practices","title":"Best Practices","text":""},{"location":"LLM-DOCS/LIVE_CLASSES/#for-automatic-generation","title":"For Automatic Generation","text":"<ol> <li>\u2705 Always set <code>cohort.kickoff_date</code> and <code>ending_date</code></li> <li>\u2705 Set <code>cohort.online_meeting_url</code> before creating timeslots</li> <li>\u2705 Use standard timezones (e.g., \"America/New_York\", \"Europe/Madrid\")</li> <li>\u2705 Ensure Celery workers are running</li> <li>\u2705 Verify classes generated after creating timeslots</li> </ol>"},{"location":"LLM-DOCS/LIVE_CLASSES/#for-manual-creation","title":"For Manual Creation","text":"<ol> <li>\u2705 Use for special sessions outside regular schedule</li> <li>\u2705 Always link to existing <code>cohort_time_slot</code></li> <li>\u2705 Use ISO 8601 datetime format with timezone</li> <li>\u2705 Include descriptive meeting URLs</li> <li>\u274c Don't manually create what timeslots should generate</li> </ol>"},{"location":"LLM-DOCS/LIVE_CLASSES/#for-querying","title":"For Querying","text":"<ol> <li>\u2705 Use <code>upcoming=null</code> for student dashboards</li> <li>\u2705 Use pagination for large result sets</li> <li>\u2705 Filter by cohort for focused views</li> <li>\u2705 Use date ranges for calendar views</li> <li>\u2705 Cache frequent queries</li> </ol>"},{"location":"LLM-DOCS/LIVE_CLASSES/#for-attendance","title":"For Attendance","text":"<ol> <li>\u2705 Let teachers start classes naturally by joining</li> <li>\u2705 Wait until class actually ends before marking</li> <li>\u2705 Track attendance in cohort history logs</li> <li>\u2705 Review surveys for feedback</li> <li>\u274c Don't manually backdate start/end times</li> </ol>"},{"location":"LLM-DOCS/LIVE_CLASSES/#troubleshooting","title":"Troubleshooting","text":""},{"location":"LLM-DOCS/LIVE_CLASSES/#live-classes-not-generated","title":"Live Classes Not Generated","text":"<p>Symptoms: Created timeslot but no live classes appear</p> <p>Checklist: 1. \u2705 Check Celery workers running: <code>celery -A breathecode.celery worker -l info</code> 2. \u2705 Verify cohort has <code>kickoff_date</code> and <code>ending_date</code> 3. \u2705 Check timeslot <code>recurrency_type</code> is valid (DAILY/WEEKLY/MONTHLY) 4. \u2705 Look for task errors in logs: <code>build_live_classes_from_timeslot</code> 5. \u2705 Verify cohort not in DELETED or PREWORK stage 6. \u2705 Check if <code>ending_date</code> is in the past</p> <p>Solution: <pre><code># Manually trigger generation\npoetry run python manage.py build_live_classes\n\n# Or via Django shell\nfrom breathecode.events.tasks import build_live_classes_from_timeslot\nbuild_live_classes_from_timeslot(timeslot_id=123)\n</code></pre></p>"},{"location":"LLM-DOCS/LIVE_CLASSES/#classes-have-wrong-times","title":"Classes Have Wrong Times","text":"<p>Symptoms: Live classes show incorrect times</p> <p>Checklist: 1. \u2705 Verify timeslot timezone is correct 2. \u2705 Check <code>starting_at</code>/<code>ending_at</code> in timeslot (HHMM format) 3. \u2705 Confirm cohort dates are correct 4. \u2705 Check for timezone conversion issues</p> <p>Solution: <pre><code># Update timeslot (will regenerate classes)\nPUT /v1/admissions/academy/cohort/{cohort_id}/timeslot/{timeslot_id}\nBody: { \"timezone\": \"America/New_York\" }\n\n# Or run fix command\npoetry run python manage.py fix_live_class_dates\n</code></pre></p>"},{"location":"LLM-DOCS/LIVE_CLASSES/#cannot-join-class","title":"Cannot Join Class","text":"<p>Symptoms: Join link doesn't work or shows errors</p> <p>Checklist: 1. \u2705 Verify <code>hash</code> is correct 2. \u2705 Check user has access to cohort 3. \u2705 Confirm <code>cohort.online_meeting_url</code> is set 4. \u2705 Check if class time has passed 5. \u2705 Verify authentication token is valid</p>"},{"location":"LLM-DOCS/LIVE_CLASSES/#survey-not-sent-after-class","title":"Survey Not Sent After Class","text":"<p>Symptoms: Class ended but no surveys sent</p> <p>Checklist: 1. \u2705 Check academy feedback settings exist 2. \u2705 Verify cohort not in excluded list 3. \u2705 Confirm class ended within 24 hours 4. \u2705 Check <code>cohort.history_log</code> has attendance data 5. \u2705 Look for <code>send_liveclass_survey</code> task errors 6. \u2705 Verify survey template exists</p>"},{"location":"LLM-DOCS/LIVE_CLASSES/#security-permissions","title":"Security &amp; Permissions","text":""},{"location":"LLM-DOCS/LIVE_CLASSES/#required-capabilities","title":"Required Capabilities","text":"<p>For Academy Endpoints: - <code>start_or_end_class</code> - Create, update, view academy live classes</p> <p>For User Endpoints: - Authenticated user - View own live classes - Must be enrolled in cohort (student) or assigned as teacher/TA</p>"},{"location":"LLM-DOCS/LIVE_CLASSES/#data-access-rules","title":"Data Access Rules","text":"<ol> <li>Students can only see classes for cohorts they're enrolled in</li> <li>Teachers/TAs can see classes for cohorts they're assigned to</li> <li>Academy Staff with capability can see all academy classes</li> <li>Join links work only for authorized users</li> <li>Starting classes restricted to teachers/assistants</li> </ol>"},{"location":"LLM-DOCS/LIVE_CLASSES/#performance-considerations","title":"Performance Considerations","text":""},{"location":"LLM-DOCS/LIVE_CLASSES/#indexing","title":"Indexing","text":"<ul> <li><code>starting_at</code> and <code>ending_at</code> are indexed for fast date queries</li> <li><code>hash</code> is unique and indexed for quick join lookups</li> <li><code>cohort_time_slot</code> foreign key is indexed</li> </ul>"},{"location":"LLM-DOCS/LIVE_CLASSES/#caching","title":"Caching","text":"<ul> <li>User live class view has caching enabled (<code>LiveClassCache</code>)</li> <li>Cache invalidation on class updates</li> <li>Consider caching frequently accessed cohort classes</li> </ul>"},{"location":"LLM-DOCS/LIVE_CLASSES/#pagination","title":"Pagination","text":"<ul> <li>Always use pagination for academy-wide queries</li> <li>Default limit is configurable via <code>APIViewExtensions</code></li> <li>Sort by <code>starting_at</code> DESC by default</li> </ul>"},{"location":"LLM-DOCS/LIVE_CLASSES/#related-documentation","title":"Related Documentation","text":"<ul> <li>COHORTS.md - Cohort management and timeslots</li> <li>COHORTS_CREATE.md - Creating cohorts</li> <li>See timeslot endpoints in cohort documentation for schedule management</li> </ul>"},{"location":"LLM-DOCS/LIVE_CLASSES/#summary","title":"Summary","text":"<p>Live Classes provide automatic scheduling and attendance tracking for cohort sessions:</p> <ol> <li>Create timeslots \u2192 System generates live classes automatically</li> <li>Students join via unique hash links</li> <li>Teachers join \u2192 Marks class as started</li> <li>Class ends \u2192 Triggers surveys for attendees</li> <li>Query classes with flexible filtering for calendars and dashboards</li> </ol> <p>The system handles recurrence, timezone conversion, and cleanup automatically - you just need to define the schedule!</p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/","title":"Managing Assessments (Quizzes) - Complete Guide","text":"<p>This document provides comprehensive guidance on creating, editing, and managing assessments (quizzes) in the BreatheCode platform. Assessments bridge both the <code>registry</code> app (for asset management and syllabus integration) and the <code>assessment</code> app (for quiz functionality and student submissions).</p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#table-of-contents","title":"Table of Contents","text":"<ol> <li>Overview</li> <li>Dual App Architecture</li> <li>Creating a New Assessment</li> <li>Managing Questions &amp; Options</li> <li>Editing Assessment Metadata</li> <li>Asset Integration</li> <li>GitHub Integration</li> <li>Translations</li> <li>Thresholds &amp; Scoring</li> <li>Assessment Layouts</li> <li>Student Submissions</li> <li>Archiving vs Deleting</li> <li>Testing &amp; Quality</li> <li>Status &amp; Visibility</li> <li>Complete Workflows</li> <li>API Reference</li> </ol>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#overview","title":"Overview","text":"<p>Assessments (quizzes) in BreatheCode serve a dual purpose: 1. Educational Content: Part of the curriculum, integrated into syllabi 2. Student Evaluation: Track student progress and understanding</p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#key-concepts","title":"Key Concepts","text":"<ul> <li>Assessment: The quiz container with metadata and settings</li> <li>Question: Individual quiz questions with multiple options</li> <li>Option: Answer choices for questions (with scores)</li> <li>UserAssessment: A student's attempt at taking the quiz</li> <li>Answer: Individual answers within a UserAssessment</li> <li>Asset: The registry representation for syllabus integration</li> <li>Threshold: Score-based success/fail criteria</li> </ul>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#base-urls","title":"Base URLs","text":"<pre><code>Production: https://breathecode.herokuapp.com\nDevelopment: http://localhost:8000\n</code></pre>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#dual-app-architecture","title":"Dual App Architecture","text":"<p>Assessments exist in TWO Django apps simultaneously:</p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#1-assessment-app-breathecodeassessment","title":"1. Assessment App (<code>breathecode.assessment</code>)","text":"<p>Purpose: Quiz functionality and student submissions</p> <p>Models: - <code>Assessment</code> - Core quiz with questions - <code>Question</code> - Individual questions - <code>Option</code> - Answer choices - <code>UserAssessment</code> - Student attempts - <code>Answer</code> - Individual student answers - <code>AssessmentThreshold</code> - Score thresholds</p> <p>Endpoints: <code>/v1/assessment/*</code></p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#2-registry-app-breathecoderegistry","title":"2. Registry App (<code>breathecode.registry</code>)","text":"<p>Purpose: Content management and syllabus integration</p> <p>Models: - <code>Asset</code> - Content representation (with <code>asset_type=\"QUIZ\"</code>) - Links to <code>Assessment</code> via foreign key</p> <p>Endpoints: <code>/v1/registry/academy/{academy_id}/asset/*</code></p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#how-they-connect","title":"How They Connect","text":"<pre><code>Asset (registry)\n  \u251c\u2500 asset_type: \"QUIZ\"\n  \u251c\u2500 slug: \"python-basics-quiz\"\n  \u2514\u2500 assessment (FK) \u2192 Assessment (assessment app)\n                         \u251c\u2500 slug: \"python-basics-quiz\"\n                         \u251c\u2500 questions: [Question, Question, ...]\n                         \u2514\u2500 user submissions: [UserAssessment, ...]\n</code></pre> <p>Why Two Apps? - Registry/Asset: For content management, GitHub sync, syllabus integration, SEO - Assessment: For quiz logic, scoring, student submissions, instant feedback</p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#creating-a-new-assessment","title":"Creating a New Assessment","text":"<p>There are TWO ways to create an assessment, depending on your starting point.</p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#method-1-create-from-scratch-assessment-first","title":"Method 1: Create from Scratch (Assessment First)","text":"<p>Create the assessment directly in the assessment app, then optionally create an asset wrapper.</p> <p>Endpoint: <code>PUT /v1/assessment/{assessment_slug}</code></p> <p>Headers: <pre><code>Authorization: Token {your-token}\nAcademy: {academy_id}\nContent-Type: application/json\n</code></pre></p> <p>Request Body:</p> <pre><code>{\n  \"title\": \"Python Basics Quiz\",\n  \"lang\": \"us\",\n  \"is_instant_feedback\": true,\n  \"max_session_duration\": \"00:30:00\",\n  \"private\": false,\n  \"questions\": [\n    {\n      \"title\": \"What is Python?\",\n      \"question_type\": \"SELECT\",\n      \"position\": 1,\n      \"options\": [\n        {\n          \"title\": \"A programming language\",\n          \"score\": 1.0,\n          \"position\": 1\n        },\n        {\n          \"title\": \"A snake\",\n          \"score\": 0.0,\n          \"position\": 2\n        },\n        {\n          \"title\": \"A software\",\n          \"score\": 0.5,\n          \"position\": 3\n        }\n      ]\n    },\n    {\n      \"title\": \"Is Python compiled or interpreted?\",\n      \"question_type\": \"SELECT\",\n      \"position\": 2,\n      \"options\": [\n        {\n          \"title\": \"Compiled\",\n          \"score\": 0.0,\n          \"position\": 1\n        },\n        {\n          \"title\": \"Interpreted\",\n          \"score\": 1.0,\n          \"position\": 2\n        },\n        {\n          \"title\": \"Both\",\n          \"score\": 0.5,\n          \"position\": 3\n        }\n      ]\n    }\n  ]\n}\n</code></pre> <p>Response (200 OK):</p> <pre><code>{\n  \"id\": 123,\n  \"slug\": \"python-basics-quiz\",\n  \"title\": \"Python Basics Quiz\",\n  \"lang\": \"us\",\n  \"is_instant_feedback\": true,\n  \"max_session_duration\": \"00:30:00\",\n  \"private\": false,\n  \"is_archived\": false,\n  \"academy\": {\n    \"id\": 1,\n    \"name\": \"4Geeks Academy\"\n  },\n  \"questions\": [\n    {\n      \"id\": 456,\n      \"title\": \"What is Python?\",\n      \"question_type\": \"SELECT\",\n      \"position\": 1,\n      \"options\": [\n        {\n          \"id\": 789,\n          \"title\": \"A programming language\",\n          \"score\": 1.0,\n          \"position\": 1\n        },\n        {\n          \"id\": 790,\n          \"title\": \"A snake\",\n          \"score\": 0.0,\n          \"position\": 2\n        }\n      ]\n    }\n  ],\n  \"created_at\": \"2024-02-20T10:00:00Z\",\n  \"updated_at\": \"2024-02-20T10:00:00Z\"\n}\n</code></pre> <p>Field Descriptions:</p> Field Type Required Description <code>title</code> string \u2705 Yes Quiz title <code>lang</code> string \u274c No Language (us, es, it) - default: \"en\" <code>is_instant_feedback</code> boolean \u274c No Show correct answers immediately - default: true <code>max_session_duration</code> string \u274c No Time limit (HH:MM:SS) - default: \"00:30:00\" <code>private</code> boolean \u274c No Private to academy - default: false <code>questions</code> array \u2705 Yes Array of question objects <p>Question Fields:</p> Field Type Required Description <code>title</code> string \u2705 Yes Question text <code>question_type</code> string \u274c No TEXT, NUMBER, SELECT, SELECT_MULTIPLE - default: SELECT <code>position</code> integer \u274c No Order position <code>help_text</code> string \u274c No Additional help text <code>options</code> array \u2705 Yes (for SELECT) Answer options <p>Option Fields:</p> Field Type Required Description <code>title</code> string \u2705 Yes Option text <code>score</code> float \u2705 Yes Points awarded (0.0 to 1.0 typically) <code>position</code> integer \u274c No Display order <code>help_text</code> string \u274c No Additional context <p>Important Rules: - At least ONE option per question must have <code>score &gt; 0</code> - Total score of all positive options should equal 1.0 (for percentage scoring) - Questions with type TEXT don't need options</p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#method-2-create-as-asset-asset-first","title":"Method 2: Create as Asset (Asset First)","text":"<p>Create the quiz as an asset first, then populate questions.</p> <p>Step 1: Create Asset</p> <p>Endpoint: <code>POST /v1/registry/academy/{academy_id}/asset</code></p> <pre><code>{\n  \"slug\": \"python-basics-quiz\",\n  \"title\": \"Python Basics Quiz\",\n  \"asset_type\": \"QUIZ\",\n  \"lang\": \"us\",\n  \"description\": \"Test your Python knowledge\",\n  \"category\": 1,\n  \"technologies\": [\"python\"],\n  \"visibility\": \"PUBLIC\",\n  \"status\": \"DRAFT\"\n}\n</code></pre> <p>Step 2: Create Assessment and Link</p> <p>Endpoint: <code>PUT /v1/assessment/python-basics-quiz</code></p> <p>Headers: <pre><code>Authorization: Token {your-token}\nAcademy: {academy_id}\nContent-Type: application/json\n</code></pre></p> <p>Payload: <pre><code>{\n  \"title\": \"Python Basics Quiz\",\n  \"questions\": [\n    {\n      \"title\": \"What is Python?\",\n      \"question_type\": \"SELECT\",\n      \"options\": [\n        { \"title\": \"A programming language\", \"score\": 1.0 },\n        { \"title\": \"A snake\", \"score\": 0.0 }\n      ]\n    }\n  ]\n}\n</code></pre></p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#managing-questions-options","title":"Managing Questions &amp; Options","text":""},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#overview-of-questionoption-endpoints","title":"Overview of Question/Option Endpoints","text":"<p>There are two approaches to manage questions and options:</p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#approach-1-bulk-operations-legacy","title":"Approach 1: Bulk Operations (Legacy)","text":"<ul> <li><code>PUT /v1/assessment/{slug}</code> - Update entire assessment with all questions</li> <li>\u26a0\ufe0f Less efficient: Must send entire questions array</li> <li>\u2705 Use when: Creating new assessment or updating multiple questions at once</li> </ul>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#approach-2-granular-operations-recommended","title":"Approach 2: Granular Operations (Recommended) \u2b50","text":"<ul> <li><code>PUT /v1/assessment/{slug}/question/{id}</code> - Update single question</li> <li><code>POST /v1/assessment/{slug}/question/{id}/option</code> - Add option to question</li> <li>\u2705 More efficient: Only send what you're changing</li> <li>\u2705 Use when: Updating individual questions or adding options</li> </ul>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#add-new-question-bulk-method","title":"Add New Question (Bulk Method)","text":"<p>Endpoint: <code>PUT /v1/assessment/{assessment_slug}</code></p> <p>Headers: <pre><code>Authorization: Token {your-token}\nAcademy: {academy_id}\nContent-Type: application/json\n</code></pre></p> <p>Payload: <pre><code>{\n  \"questions\": [\n    {\n      \"title\": \"What is a Python list?\",\n      \"question_type\": \"SELECT\",\n      \"position\": 3,\n      \"options\": [\n        {\n          \"title\": \"An ordered collection\",\n          \"score\": 1.0,\n          \"position\": 1\n        },\n        {\n          \"title\": \"A dictionary\",\n          \"score\": 0.0,\n          \"position\": 2\n        }\n      ]\n    }\n  ]\n}\n</code></pre></p> <p>\u26a0\ufe0f Important: Include existing questions in the array if you want to preserve them, or fetch current assessment first and append to the questions array.</p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#update-existing-question-bulk-method","title":"Update Existing Question (Bulk Method)","text":"<p>Endpoint: <code>PUT /v1/assessment/{assessment_slug}</code></p> <p>Payload: <pre><code>{\n  \"questions\": [\n    {\n      \"id\": 456,\n      \"title\": \"Updated question text\",\n      \"question_type\": \"SELECT\",\n      \"position\": 1\n    }\n  ]\n}\n</code></pre></p> <p>Note: Include the question <code>id</code> to update an existing question.</p> <p>\u26a0\ufe0f Limitation: Must include ALL questions you want to keep in the array.</p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#update-single-question-recommended","title":"Update Single Question (Recommended) \u2b50","text":"<p>Endpoint: <code>PUT /v1/assessment/{assessment_slug}/question/{question_id}</code></p> <p>Headers: <pre><code>Authorization: Token {your-token}\nAcademy: {academy_id}\nContent-Type: application/json\n</code></pre></p> <p>Use Case 1: Update question metadata only</p> <pre><code>{\n  \"title\": \"Updated question text\",\n  \"help_text\": \"Optional hint for students\",\n  \"position\": 2\n}\n</code></pre> <p>Use Case 2: Update question and modify existing options</p> <pre><code>{\n  \"title\": \"Updated question text\",\n  \"options\": [\n    {\n      \"id\": 789,\n      \"title\": \"Updated existing option\",\n      \"score\": 1.0,\n      \"position\": 1\n    },\n    {\n      \"id\": 790,\n      \"title\": \"Another updated option\",\n      \"score\": 0.0,\n      \"position\": 2\n    }\n  ]\n}\n</code></pre> <p>Use Case 3: Update question and add new options simultaneously</p> <pre><code>{\n  \"title\": \"Updated question text\",\n  \"options\": [\n    {\n      \"id\": 789,\n      \"title\": \"Keep this existing option\",\n      \"score\": 1.0\n    },\n    {\n      \"title\": \"Create this new option\",\n      \"score\": 0.0\n    }\n  ]\n}\n</code></pre> <p>Key Behavior: - Option with <code>id</code> field: Updates the existing option - Option without <code>id</code> field: Creates a new option - Partial updates: Only send fields you want to change - Validation: Ensures at least one option has positive score (when options provided)</p> <p>Benefits: - \u2705 More efficient than bulk update - \u2705 Partial update support - only send what changes - \u2705 Single request for question + options - \u2705 Mix updates and creates in one call - \u2705 No need to fetch entire assessment first</p> <p>Example Response: <pre><code>{\n  \"id\": 456,\n  \"title\": \"Updated question text\",\n  \"help_text\": \"Optional hint for students\",\n  \"question_type\": \"SELECT\",\n  \"position\": 2,\n  \"lang\": \"en\",\n  \"is_deleted\": false,\n  \"created_at\": \"2024-01-15T10:30:00Z\",\n  \"updated_at\": \"2024-01-15T14:45:00Z\"\n}\n</code></pre></p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#update-question-options-bulk-method","title":"Update Question Options (Bulk Method)","text":"<p>Endpoint: <code>PUT /v1/assessment/{assessment_slug}</code></p> <p>Payload: <pre><code>{\n  \"questions\": [\n    {\n      \"id\": 456,\n      \"options\": [\n        {\n          \"id\": 789,\n          \"title\": \"Updated option text\",\n          \"score\": 1.0,\n          \"position\": 1\n        }\n      ]\n    }\n  ]\n}\n</code></pre></p> <p>Note: Include option <code>id</code> to update existing options.</p> <p>\u26a0\ufe0f Limitation: Must include ALL questions and options you want to keep.</p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#swap-or-reorder-question-positions","title":"Swap or Reorder Question Positions","text":"<p>Method 1: Individual updates (Simple swaps) \u2b50</p> <p>Update each question separately:</p> <pre><code># Swap question 123 (position 1) with question 456 (position 2)\nPUT /v1/assessment/python-basics/question/123\n{\n  \"position\": 2\n}\n\nPUT /v1/assessment/python-basics/question/456\n{\n  \"position\": 1\n}\n</code></pre> <p>Pros: - \u2705 Only send what changes - \u2705 Clear and explicit - \u2705 Partial update - just position field</p> <p>Cons: - \u274c Multiple API calls (one per question)</p> <p>Best for: Swapping 2 questions or updating 1-2 positions</p> <p>Method 2: Bulk update (Multiple reorders)</p> <p>Endpoint: <code>PUT /v1/assessment/{assessment_slug}</code></p> <p>Payload: <pre><code>{\n  \"questions\": [\n    {\"id\": 123, \"position\": 2},\n    {\"id\": 456, \"position\": 1},\n    {\"id\": 789, \"position\": 3},\n    {\"id\": 801, \"position\": 4}\n  ]\n}\n</code></pre></p> <p>Pros: - \u2705 Single API call - \u2705 Atomic operation - \u2705 Efficient for reordering many questions</p> <p>Cons: - \u274c Must include ALL questions being reordered</p> <p>Best for: Reordering 3+ questions at once</p> <p>Recommendation: - Swap 2 questions? Use individual PUT requests - Reorder 3+ questions? Use bulk update - Move 1 question? Use individual PUT request</p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#reorder-options-within-a-question","title":"Reorder Options Within a Question","text":"<p>Method 1: Update single question (Recommended) \u2b50</p> <p>Endpoint: <code>PUT /v1/assessment/{assessment_slug}/question/{question_id}</code></p> <p>Payload: <pre><code>{\n  \"options\": [\n    {\n      \"id\": 790,\n      \"position\": 1\n    },\n    {\n      \"id\": 791,\n      \"position\": 2\n    },\n    {\n      \"id\": 789,\n      \"position\": 3\n    }\n  ]\n}\n</code></pre></p> <p>Method 2: Bulk update</p> <p>Endpoint: <code>PUT /v1/assessment/{assessment_slug}</code></p> <p>Payload: <pre><code>{\n  \"questions\": [\n    {\n      \"id\": 456,\n      \"options\": [\n        {\n          \"id\": 790,\n          \"position\": 1\n        },\n        {\n          \"id\": 791,\n          \"position\": 2\n        },\n        {\n          \"id\": 789,\n          \"position\": 3\n        }\n      ]\n    }\n  ]\n}\n</code></pre></p> <p>Note: The <code>position</code> property determines display order. Options are displayed according to their <code>position</code> value, not array order.</p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#add-new-option-to-question-recommended","title":"Add New Option to Question (Recommended) \u2b50","text":"<p>Endpoint: <code>POST /v1/assessment/{assessment_slug}/question/{question_id}/option</code></p> <p>Headers: <pre><code>Authorization: Token {your-token}\nAcademy: {academy_id}\nContent-Type: application/json\n</code></pre></p> <p>Payload: <pre><code>{\n  \"title\": \"New answer option\",\n  \"help_text\": \"Optional hint for this option\",\n  \"score\": 0.5,\n  \"position\": 3\n}\n</code></pre></p> <p>Example Response (201 Created): <pre><code>{\n  \"id\": 123,\n  \"title\": \"New answer option\",\n  \"help_text\": \"Optional hint for this option\",\n  \"score\": 0.5,\n  \"position\": 3,\n  \"lang\": \"en\",\n  \"is_deleted\": false,\n  \"created_at\": \"2024-01-15T15:30:00Z\",\n  \"updated_at\": \"2024-01-15T15:30:00Z\"\n}\n</code></pre></p> <p>When to Use: - Adding a single new option to existing question - Building questions incrementally - Simple, focused operation</p> <p>Benefits: - \u2705 Proper REST resource nesting (<code>/question/{id}/option</code>) - \u2705 Single focused operation - \u2705 Returns created option with ID - \u2705 No need to send existing options - \u2705 Clean and simple payload</p> <p>Alternative: You can also add options via <code>PUT /question/{id}</code> with options array (see above).</p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#delete-question","title":"Delete Question","text":"<p>Endpoint: <code>DELETE /v1/assessment/{assessment_slug}/question/{question_id}</code></p> <p>Headers: <pre><code>Authorization: Token {your-token}\nAcademy: {academy_id}\n</code></pre></p> <p>Note: Questions with collected answers cannot be deleted, they will be marked as <code>is_deleted=true</code> instead.</p> <p>Response: <code>204 No Content</code> on success.</p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#delete-option","title":"Delete Option","text":"<p>Endpoint: <code>DELETE /v1/assessment/{assessment_slug}/option/{option_id}</code></p> <p>Headers: <pre><code>Authorization: Token {your-token}\nAcademy: {academy_id}\n</code></pre></p> <p>Note: Options with collected answers cannot be deleted, they will be marked as <code>is_deleted=true</code> instead.</p> <p>Response: <code>204 No Content</code> on success.</p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#question-types","title":"Question Types","text":"Type Description Use Case Requires Options <code>SELECT</code> Single choice Multiple choice questions \u2705 Yes <code>SELECT_MULTIPLE</code> Multiple choices \"Select all that apply\" \u2705 Yes <code>TEXT</code> Free text Short answer questions \u274c No <code>NUMBER</code> Numeric input Mathematical answers \u274c No"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#editing-assessment-metadata","title":"Editing Assessment Metadata","text":""},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#update-assessment-settings","title":"Update Assessment Settings","text":"<p>Endpoint: <code>PUT /v1/assessment/{assessment_slug}</code></p> <p>Update only the assessment metadata without touching questions:</p> <pre><code>{\n  \"title\": \"Updated Quiz Title\",\n  \"is_instant_feedback\": false,\n  \"max_session_duration\": \"01:00:00\",\n  \"private\": true\n}\n</code></pre>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#update-via-asset-registry","title":"Update via Asset (Registry)","text":"<p>You can also update the asset representation:</p> <p>Endpoint: <code>PUT /v1/registry/academy/{academy_id}/asset/python-basics-quiz</code></p> <pre><code>{\n  \"title\": \"Python Basics Quiz (Updated)\",\n  \"description\": \"Updated description\",\n  \"status\": \"PUBLISHED\",\n  \"difficulty\": \"INTERMEDIATE\"\n}\n</code></pre> <p>What can be updated via Asset: - Title, description - Status, visibility - Technologies, category - README content - Difficulty, duration - SEO metadata</p> <p>What must be updated via Assessment: - Questions and options - Is_instant_feedback - Max_session_duration - Score thresholds</p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#asset-integration","title":"Asset Integration","text":"<p>Every quiz should have both an Assessment (for quiz logic) and an Asset (for content management).</p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#create-asset-for-existing-assessment","title":"Create Asset for Existing Assessment","text":"<p>Endpoint: <code>POST /v1/registry/academy/{academy_id}/asset</code></p> <pre><code>{\n  \"slug\": \"python-basics-quiz\",\n  \"title\": \"Python Basics Quiz\",\n  \"asset_type\": \"QUIZ\",\n  \"assessment\": 123,\n  \"readme_url\": \"https://github.com/.../python-quiz.md\",\n  \"technologies\": [\"python\"],\n  \"category\": 1,\n  \"status\": \"PUBLISHED\"\n}\n</code></pre>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#link-existing-asset-to-assessment","title":"Link Existing Asset to Assessment","text":"<p>The connection happens automatically when: 1. Asset slug matches Assessment slug 2. Asset type is \"QUIZ\"</p> <p>The system auto-links them on save.</p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#view-asset-assessment-connection","title":"View Asset-Assessment Connection","text":"<p>Get Asset:</p> <p>Endpoint: <code>GET /v1/registry/academy/{academy_id}/asset/python-basics-quiz</code></p> <p>Headers: <pre><code>Authorization: Token {your-token}\nAcademy: {academy_id}\n</code></pre></p> <p>Response includes <code>assessment</code> field: <pre><code>{\n  \"id\": 123,\n  \"slug\": \"python-basics-quiz\",\n  \"assessment\": {\n    \"id\": 456,\n    \"slug\": \"python-basics-quiz\"\n  }\n}\n</code></pre></p> <p>Get Assessment:</p> <p>Endpoint: <code>GET /v1/assessment/python-basics-quiz</code></p> <p>Headers: <pre><code>Authorization: Token {your-token}\n</code></pre></p> <p>Response includes <code>asset_set</code> field with related assets.</p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#github-integration","title":"GitHub Integration","text":"<p>Quiz assessments can sync with GitHub for version control and content management.</p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#important-github-sync-limitations","title":"\u26a0\ufe0f Important: GitHub Sync Limitations","text":"<p>Critical: When pulling a QUIZ asset from GitHub, the behavior differs based on whether the assessment already has questions:</p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#first-pull-no-assessment-exists","title":"First Pull (No Assessment Exists)","text":"<p>When you pull for the first time:</p> <p>\u2705 Creates Assessment with all questions from <code>learn.json</code> \u2705 Asset.config and Assessment are in sync \u2705 All questions and options created</p> <p>Endpoint: <code>PUT /v1/registry/academy/{academy_id}/asset/{asset_slug}/action/pull</code></p> <p>Result: Asset created, Assessment created with all questions from config.</p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#subsequent-pulls-assessment-has-questions","title":"Subsequent Pulls (Assessment Has Questions)","text":"<p>When you pull after questions exist:</p> <p>\u2705 Updates <code>asset.config</code> with latest from GitHub \u274c Does NOT update Assessment questions/options \u26a0\ufe0f Asset and Assessment become out of sync</p> <p>Endpoint: <code>PUT /v1/registry/academy/{academy_id}/asset/{asset_slug}/action/pull</code></p> <p>Result: <code>asset.config</code> updated, but Assessment questions remain unchanged.</p> <p>Why This Limitation?</p> <p>To protect student submission data. Updating questions would invalidate existing student answers and corrupt historical data.</p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#how-to-update-existing-assessment-questions","title":"How to Update Existing Assessment Questions","text":"<p>If you need to update questions after students have taken the quiz:</p> <p>Option 1: Create New Version (Recommended)</p> <p>Step 1: Create new asset with updated slug</p> <p>Endpoint: <code>POST /v1/registry/academy/{academy_id}/asset</code></p> <p>Payload: <pre><code>{\n  \"slug\": \"python-quiz-v2\",\n  \"title\": \"Python Quiz (Updated 2024)\",\n  \"asset_type\": \"QUIZ\",\n  \"readme_url\": \"https://github.com/.../learn.json\"\n}\n</code></pre></p> <p>Step 2: Pull to create new assessment</p> <p>Endpoint: <code>PUT /v1/registry/academy/{academy_id}/asset/python-quiz-v2/action/pull</code></p> <p>Step 3: Mark old version as superseded</p> <p>Endpoint: <code>PUT /v1/registry/academy/{academy_id}/asset/python-quiz</code></p> <p>Payload: <pre><code>{\n  \"superseded_by\": 789,\n  \"status\": \"DRAFT\"\n}\n</code></pre></p> <p>Option 2: Manual Update via API</p> <p>Step 1: Pull to get latest <code>asset.config</code></p> <p>Endpoint: <code>PUT /v1/registry/academy/{academy_id}/asset/{asset_slug}/action/pull</code></p> <p>Step 2: Get updated config</p> <p>Endpoint: <code>GET /v1/registry/academy/{academy_id}/asset/{asset_slug}</code></p> <p>Step 3: Update assessment with transformed questions</p> <p>Endpoint: <code>PUT /v1/assessment/{assessment_slug}</code></p> <p>Payload: <pre><code>{\n  \"questions\": [\n    // Transform asset.config.questions to assessment format\n  ]\n}\n</code></pre></p> <p>Option 3: Delete and Recreate (Only if NO student submissions)</p> <p>Step 1: Delete all questions via Django admin or API</p> <p>Step 2: Pull from GitHub again</p> <p>Endpoint: <code>PUT /v1/registry/academy/{academy_id}/asset/{asset_slug}/action/pull</code></p> <p>Questions will be recreated from config.</p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#store-quiz-in-github-learnjson-format","title":"Store Quiz in GitHub (learn.json format)","text":"<p>Quizzes are typically stored as <code>learn.json</code> in a LearnPack repository:</p> <pre><code>{\n  \"info\": {\n    \"slug\": \"python-basics-quiz\",\n    \"title\": \"Python Basics Quiz\",\n    \"main\": \"Python quiz for beginners\"\n  },\n  \"questions\": [\n    {\n      \"q\": \"What is Python?\",\n      \"a\": [\n        {\n          \"option\": \"A programming language\",\n          \"correct\": true\n        },\n        {\n          \"option\": \"A snake\",\n          \"correct\": false\n        }\n      ]\n    }\n  ]\n}\n</code></pre>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#pull-from-github","title":"Pull from GitHub","text":"<p>Endpoint: <code>PUT /v1/registry/academy/{academy_id}/asset/{asset_slug}/action/pull</code></p> <p>Headers: <pre><code>Authorization: Token {your-token}\nAcademy: {academy_id}\n</code></pre></p> <p>Purpose: Pull quiz questions from GitHub <code>learn.json</code></p> <p>What Gets Synced: - Questions and options from <code>learn.json</code> (only if assessment doesn't exist yet) - Quiz metadata (title, description, technologies) - Asset config updated - README content (if exists)</p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#push-to-github","title":"Push to GitHub","text":"<p>Note: Currently, quiz questions are typically managed in GitHub directly. The pull action is more common than push for quizzes.</p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#translations","title":"Translations","text":"<p>Assessments support multiple language translations.</p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#view-translations","title":"View Translations","text":"<p>Endpoint: <code>GET /v1/assessment/{assessment_slug}?lang={lang_code}</code></p> <p>Headers: <pre><code>Authorization: Token {your-token}\n</code></pre></p> <p>Example: <code>GET /v1/assessment/python-basics-quiz?lang=es</code></p> <p>Returns the Spanish translation of the assessment if it exists.</p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#create-translation","title":"Create Translation","text":"<p>Endpoint: <code>PUT /v1/assessment/{assessment_slug}</code></p> <p>Payload: <pre><code>{\n  \"slug\": \"python-basics-quiz-es\",\n  \"title\": \"Cuestionario de Python B\u00e1sico\",\n  \"lang\": \"es\",\n  \"original\": 123,\n  \"questions\": [\n    {\n      \"title\": \"\u00bfQu\u00e9 es Python?\",\n      \"options\": [\n        { \"title\": \"Un lenguaje de programaci\u00f3n\", \"score\": 1.0 },\n        { \"title\": \"Una serpiente\", \"score\": 0.0 }\n      ]\n    }\n  ]\n}\n</code></pre></p> <p>Link to original via <code>original</code> field (assessment ID).</p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#link-asset-translations","title":"Link Asset Translations","text":"<p>Endpoint: <code>PUT /v1/registry/academy/{academy_id}/asset/python-basics-quiz</code></p> <p>Payload: <pre><code>{\n  \"all_translations\": [\"python-basics-quiz\", \"python-basics-quiz-es\"]\n}\n</code></pre></p> <p>Repeat for each translation asset to create bidirectional links.</p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#thresholds-scoring","title":"Thresholds &amp; Scoring","text":"<p>Thresholds define success/failure criteria based on student scores.</p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#create-threshold","title":"Create Threshold","text":"<p>Endpoint: <code>POST /v1/assessment/{assessment_slug}/threshold</code></p> <pre><code>{\n  \"title\": \"Passing Grade\",\n  \"score_threshold\": 70,\n  \"success_message\": \"Congratulations! You passed the quiz.\",\n  \"fail_message\": \"Keep studying and try again.\",\n  \"success_next\": \"https://learn.4geeks.com/next-lesson\",\n  \"fail_next\": \"https://learn.4geeks.com/study-guide\",\n  \"tags\": \"beginner,python\"\n}\n</code></pre> <p>Response (201 Created):</p> <pre><code>{\n  \"id\": 1,\n  \"assessment\": {\n    \"id\": 123,\n    \"slug\": \"python-basics-quiz\"\n  },\n  \"title\": \"Passing Grade\",\n  \"score_threshold\": 70,\n  \"success_message\": \"Congratulations! You passed the quiz.\",\n  \"fail_message\": \"Keep studying and try again.\",\n  \"success_next\": \"https://learn.4geeks.com/next-lesson\",\n  \"fail_next\": \"https://learn.4geeks.com/study-guide\",\n  \"tags\": \"beginner,python\",\n  \"academy\": null\n}\n</code></pre>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#multiple-thresholds-with-tags","title":"Multiple Thresholds with Tags","text":"<p>You can have multiple threshold groups for different use cases:</p> <pre><code>// Beginner threshold\n{\n  \"score_threshold\": 60,\n  \"tags\": \"beginner\",\n  \"success_message\": \"Good job for a beginner!\"\n}\n\n// Advanced threshold\n{\n  \"score_threshold\": 85,\n  \"tags\": \"advanced\",\n  \"success_message\": \"Excellent work!\"\n}\n</code></pre>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#view-thresholds","title":"View Thresholds","text":"<p>Endpoint: <code>GET /v1/assessment/{assessment_slug}/threshold</code></p> <p>Headers: <pre><code>Authorization: Token {your-token}\n</code></pre></p> <p>Returns array of all thresholds for the assessment.</p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#update-threshold","title":"Update Threshold","text":"<p>Endpoint: <code>PUT /v1/assessment/{assessment_slug}/threshold/{threshold_id}</code></p> <p>Headers: <pre><code>Authorization: Token {your-token}\nAcademy: {academy_id}\nContent-Type: application/json\n</code></pre></p> <p>Payload: <pre><code>{\n  \"score_threshold\": 80,\n  \"success_message\": \"Updated message\"\n}\n</code></pre></p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#delete-threshold","title":"Delete Threshold","text":"<p>Endpoint: <code>DELETE /v1/assessment/{assessment_slug}/threshold/{threshold_id}</code></p> <p>Headers: <pre><code>Authorization: Token {your-token}\nAcademy: {academy_id}\n</code></pre></p> <p>Response: <code>204 No Content</code> on success.</p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#assessment-layouts","title":"Assessment Layouts","text":"<p>Layouts allow customizing the visual presentation of assessments.</p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#create-layout","title":"Create Layout","text":"<p>Endpoint: <code>POST /v1/assessment/academy/layout</code></p> <pre><code>{\n  \"slug\": \"dark-theme-layout\",\n  \"additional_styles\": \".quiz-container { background: #1a1a1a; color: #fff; }\",\n  \"variables\": {\n    \"primary_color\": \"#007bff\",\n    \"font_family\": \"Roboto, sans-serif\",\n    \"logo_url\": \"https://...\"\n  }\n}\n</code></pre>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#assign-layout-to-assessment","title":"Assign Layout to Assessment","text":"<p>Link the layout when creating/updating an assessment:</p> <pre><code>{\n  \"slug\": \"python-basics-quiz\",\n  \"layout\": \"dark-theme-layout\"\n}\n</code></pre>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#view-layout","title":"View Layout","text":"<p>Endpoint: <code>GET /v1/assessment/layout/{layout_slug}</code></p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#student-submissions","title":"Student Submissions","text":""},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#view-student-attempts-userassessments","title":"View Student Attempts (UserAssessments)","text":"<p>Endpoint: <code>GET /v1/assessment/academy/user/assessment</code></p> <p>Headers: <pre><code>Authorization: Token {your-token}\nAcademy: {academy_id}\n</code></pre></p> <p>Query Parameters: - <code>assessment</code> - Filter by assessment ID - <code>status</code> - Filter by status (DRAFT, SENT, ANSWERED, ERROR, EXPIRED) - <code>user</code> - Filter by user ID</p> <p>Example: <code>GET /v1/assessment/academy/user/assessment?assessment=123</code></p> <p>Response:</p> <pre><code>[\n  {\n    \"id\": 789,\n    \"assessment\": {\n      \"id\": 123,\n      \"slug\": \"python-basics-quiz\",\n      \"title\": \"Python Basics Quiz\"\n    },\n    \"owner\": {\n      \"id\": 456,\n      \"email\": \"student@example.com\",\n      \"first_name\": \"John\"\n    },\n    \"total_score\": 85.0,\n    \"status\": \"ANSWERED\",\n    \"started_at\": \"2024-02-20T10:00:00Z\",\n    \"finished_at\": \"2024-02-20T10:25:00Z\",\n    \"created_at\": \"2024-02-20T09:55:00Z\"\n  }\n]\n</code></pre>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#view-individual-submission-details","title":"View Individual Submission Details","text":"<p>Endpoint: <code>GET /v1/assessment/academy/user/assessment/{user_assessment_id}</code></p> <p>Includes all answers and scoring details.</p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#view-student-answers","title":"View Student Answers","text":"<p>Endpoint: <code>GET /v1/assessment/academy/user/assessment/{user_assessment_id}/answer/{answer_id}</code></p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#archiving-vs-deleting","title":"Archiving vs Deleting","text":""},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#soft-delete-archive","title":"Soft Delete (Archive)","text":"<p>Assessments with student submissions cannot be hard deleted. They are automatically archived.</p> <p>What happens: - <code>is_archived</code> = true - Hidden from default queries - Student data preserved - Can be restored</p> <p>Archive an Assessment:</p> <pre><code># In Django admin or via code\nassessment = Assessment.objects.get(slug='old-quiz')\nassessment.delete()  # Automatically archives if has submissions\n</code></pre>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#view-archived-assessments","title":"View Archived Assessments","text":"<p>Endpoint: <code>GET /v1/assessment?include_archived=true</code></p> <p>Headers: <pre><code>Authorization: Token {your-token}\n</code></pre></p> <p>Returns all assessments including archived ones.</p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#hard-delete","title":"Hard Delete","text":"<p>Only possible if NO student submissions exist. Hard deletion must be done via Django admin or database directly. Assessments with submissions are automatically soft-deleted (archived) instead.</p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#testing-quality","title":"Testing &amp; Quality","text":""},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#test-quiz-integrity","title":"Test Quiz Integrity","text":"<p>Endpoint: <code>PUT /v1/registry/academy/{academy_id}/asset/{asset_slug}/action/test</code></p> <p>Headers: <pre><code>Authorization: Token {your-token}\nAcademy: {academy_id}\n</code></pre></p> <p>What It Checks: - Each question has at least one correct answer (score &gt; 0) - Question positions are valid - Option scores sum correctly - No orphaned questions/options - README links work</p> <p>Response:</p> <pre><code>{\n  \"test_status\": \"OK\",\n  \"errors\": [],\n  \"warnings\": [\n    {\n      \"type\": \"scoring\",\n      \"message\": \"Question 3 options sum to 1.5 (expected 1.0)\",\n      \"question_id\": 789\n    }\n  ]\n}\n</code></pre>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#status-visibility","title":"Status &amp; Visibility","text":""},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#assessment-status-assessment-app","title":"Assessment Status (Assessment App)","text":"Field Values Description <code>is_archived</code> true/false Archived assessments are hidden <code>private</code> true/false Private to academy only"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#asset-status-registry-app","title":"Asset Status (Registry App)","text":"Status Description Visible to Students <code>NOT_STARTED</code> Not yet created \u274c No <code>DRAFT</code> Work in progress \u274c No <code>PUBLISHED</code> Ready for students \u2705 Yes <code>OPTIMIZED</code> SEO optimized \u2705 Yes <code>DELETED</code> Soft deleted \u274c No"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#update-status","title":"Update Status","text":"<p>Archive Assessment:</p> <p>Endpoint: <code>PUT /v1/assessment/old-quiz</code></p> <p>Payload: <pre><code>{\n  \"is_archived\": true\n}\n</code></pre></p> <p>Publish Asset:</p> <p>Endpoint: <code>PUT /v1/registry/academy/{academy_id}/asset/python-basics-quiz</code></p> <p>Payload: <pre><code>{\n  \"status\": \"PUBLISHED\"\n}\n</code></pre></p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#complete-workflows","title":"Complete Workflows","text":""},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#workflow-1-create-quiz-from-scratch","title":"Workflow 1: Create Quiz from Scratch","text":"<p>Step 1: Create Assessment</p> <p>Endpoint: <code>PUT /v1/assessment/javascript-fundamentals</code></p> <p>Payload: <pre><code>{\n  \"slug\": \"javascript-fundamentals\",\n  \"title\": \"JavaScript Fundamentals Quiz\",\n  \"lang\": \"us\",\n  \"is_instant_feedback\": true,\n  \"max_session_duration\": \"00:45:00\",\n  \"questions\": [\n    {\n      \"title\": \"What is a variable?\",\n      \"question_type\": \"SELECT\",\n      \"options\": [\n        { \"title\": \"A container for data\", \"score\": 1.0 },\n        { \"title\": \"A function\", \"score\": 0.0 }\n      ]\n    }\n  ]\n}\n</code></pre></p> <p>Step 2: Create Asset Wrapper</p> <p>Endpoint: <code>POST /v1/registry/academy/1/asset</code></p> <p>Payload: <pre><code>{\n  \"slug\": \"javascript-fundamentals\",\n  \"title\": \"JavaScript Fundamentals Quiz\",\n  \"asset_type\": \"QUIZ\",\n  \"description\": \"Test your JavaScript knowledge\",\n  \"technologies\": [\"javascript\"],\n  \"category\": 1,\n  \"status\": \"DRAFT\"\n}\n</code></pre></p> <p>Step 3: Set Threshold</p> <p>Endpoint: <code>POST /v1/assessment/javascript-fundamentals/threshold</code></p> <p>Payload: <pre><code>{\n  \"score_threshold\": 70,\n  \"success_message\": \"Great job! You understand JavaScript basics.\",\n  \"fail_message\": \"Review the material and try again.\"\n}\n</code></pre></p> <p>Step 4: Test Integrity</p> <p>Endpoint: <code>PUT /v1/registry/academy/1/asset/javascript-fundamentals/action/test</code></p> <p>Step 5: Publish (if tests pass)</p> <p>Endpoint: <code>PUT /v1/registry/academy/1/asset/javascript-fundamentals</code></p> <p>Payload: <pre><code>{\n  \"status\": \"PUBLISHED\",\n  \"visibility\": \"PUBLIC\"\n}\n</code></pre></p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#workflow-2-sync-quiz-from-github","title":"Workflow 2: Sync Quiz from GitHub","text":"<p>Step 1: Create Asset</p> <p>Endpoint: <code>POST /v1/registry/academy/1/asset</code></p> <p>Payload: <pre><code>{\n  \"slug\": \"python-advanced-quiz\",\n  \"title\": \"Advanced Python Quiz\",\n  \"asset_type\": \"QUIZ\",\n  \"readme_url\": \"https://github.com/4GeeksAcademy/python-quiz/blob/master/learn.json\",\n  \"technologies\": [\"python\"],\n  \"status\": \"DRAFT\"\n}\n</code></pre></p> <p>Step 2: Pull from GitHub</p> <p>Endpoint: <code>PUT /v1/registry/academy/1/asset/python-advanced-quiz/action/pull</code></p> <p>Assessment is auto-created from <code>learn.json</code>.</p> <p>Step 3: Verify Import</p> <p>Endpoint: <code>GET /v1/assessment/python-advanced-quiz</code></p> <p>Check that questions were imported correctly.</p> <p>Step 4: Add Threshold</p> <p>Endpoint: <code>POST /v1/assessment/python-advanced-quiz/threshold</code></p> <p>Payload: <pre><code>{\n  \"score_threshold\": 80,\n  \"success_message\": \"Excellent! You mastered advanced Python.\"\n}\n</code></pre></p> <p>Step 5: Publish</p> <p>Endpoint: <code>PUT /v1/registry/academy/1/asset/python-advanced-quiz</code></p> <p>Payload: <pre><code>{\n  \"status\": \"PUBLISHED\"\n}\n</code></pre></p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#workflow-3-create-translation","title":"Workflow 3: Create Translation","text":"<p>Step 1: Get Original Quiz</p> <p>Endpoint: <code>GET /v1/assessment/react-basics-quiz</code></p> <p>Note the original assessment ID.</p> <p>Step 2: Create Spanish Assessment</p> <p>Endpoint: <code>PUT /v1/assessment/react-basics-quiz-es</code></p> <p>Payload: <pre><code>{\n  \"slug\": \"react-basics-quiz-es\",\n  \"title\": \"Cuestionario de React B\u00e1sico\",\n  \"lang\": \"es\",\n  \"original\": 123,\n  \"is_instant_feedback\": true,\n  \"questions\": [\n    {\n      \"title\": \"\u00bfQu\u00e9 es React?\",\n      \"question_type\": \"SELECT\",\n      \"options\": [\n        { \"title\": \"Una librer\u00eda de JavaScript\", \"score\": 1.0 },\n        { \"title\": \"Un lenguaje de programaci\u00f3n\", \"score\": 0.0 }\n      ]\n    }\n  ]\n}\n</code></pre></p> <p>Step 3: Create Spanish Asset</p> <p>Endpoint: <code>POST /v1/registry/academy/1/asset</code></p> <p>Payload: <pre><code>{\n  \"slug\": \"react-basics-quiz-es\",\n  \"title\": \"Cuestionario de React B\u00e1sico\",\n  \"asset_type\": \"QUIZ\",\n  \"lang\": \"es\",\n  \"technologies\": [\"react\"]\n}\n</code></pre></p> <p>Step 4: Link Translations (English Asset)</p> <p>Endpoint: <code>PUT /v1/registry/academy/1/asset/react-basics-quiz</code></p> <p>Payload: <pre><code>{\n  \"all_translations\": [\"react-basics-quiz\", \"react-basics-quiz-es\"]\n}\n</code></pre></p> <p>Step 5: Link Translations (Spanish Asset)</p> <p>Endpoint: <code>PUT /v1/registry/academy/1/asset/react-basics-quiz-es</code></p> <p>Payload: <pre><code>{\n  \"all_translations\": [\"react-basics-quiz\", \"react-basics-quiz-es\"]\n}\n</code></pre></p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#api-reference","title":"API Reference","text":""},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#assessment-endpoints","title":"Assessment Endpoints","text":"Endpoint Method Purpose Auth <code>/v1/assessment</code> GET List assessments \u274c Public <code>/v1/assessment/{slug}</code> GET Get single assessment \u274c Public <code>/v1/assessment/{slug}</code> PUT Create/update assessment \u2705 crud_assessment <code>/v1/assessment/{slug}/question/{id}</code> PUT Update single question \u2705 crud_assessment <code>/v1/assessment/{slug}/question/{id}</code> DELETE Delete question \u2705 crud_assessment <code>/v1/assessment/{slug}/question/{id}/option</code> POST Add new option to question \u2705 crud_assessment <code>/v1/assessment/{slug}/option/{id}</code> DELETE Delete option \u2705 crud_assessment <code>/v1/assessment/{slug}/threshold</code> GET List thresholds \u274c Public <code>/v1/assessment/{slug}/threshold</code> POST Create threshold \u2705 crud_assessment <code>/v1/assessment/{slug}/threshold/{id}</code> PUT Update threshold \u2705 crud_assessment <code>/v1/assessment/{slug}/threshold/{id}</code> DELETE Delete threshold \u2705 crud_assessment <code>/v1/assessment/layout/{slug}</code> GET Get layout \u274c Public <code>/v1/assessment/academy/layout</code> GET List academy layouts \u2705 read_assessment <code>/v1/assessment/academy/layout</code> POST Create layout \u2705 crud_assessment <code>/v1/assessment/academy/user/assessment</code> GET List student attempts \u2705 read_assessment <code>/v1/assessment/academy/user/assessment/{id}</code> GET Get student attempt \u2705 read_assessment"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#asset-quiz-endpoints","title":"Asset (Quiz) Endpoints","text":"Endpoint Method Purpose Auth <code>/v1/registry/academy/{academy_id}/asset</code> POST Create quiz asset \u2705 crud_asset <code>/v1/registry/academy/{academy_id}/asset/{slug}</code> GET Get quiz asset \u2705 read_asset <code>/v1/registry/academy/{academy_id}/asset/{slug}</code> PUT Update quiz asset \u2705 crud_asset <code>/v1/registry/academy/{academy_id}/asset/{slug}/action/pull</code> PUT Pull from GitHub \u2705 crud_asset <code>/v1/registry/academy/{academy_id}/asset/{slug}/action/test</code> PUT Test integrity \u2705 crud_asset <code>/v1/registry/academy/{academy_id}/asset/{slug}/action/clean</code> PUT Clean/regenerate \u2705 crud_asset <code>/v1/registry/academy/{academy_id}/asset/{slug}/thumbnail</code> POST Generate thumbnail \u2705 crud_asset"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#query-parameters","title":"Query Parameters","text":"<p>List Assessments (<code>GET /v1/assessment</code>):</p> Parameter Example Description <code>academy</code> <code>?academy=1</code> Filter by academy <code>lang</code> <code>?lang=us</code> Filter by language <code>include_archived</code> <code>?include_archived=true</code> Include archived <code>no_asset</code> <code>?no_asset=true</code> Only assessments without assets <code>author</code> <code>?author=123</code> Filter by author <p>List Assets (<code>GET /v1/registry/academy/{academy_id}/asset</code>):</p> Parameter Example Description <code>asset_type</code> <code>?asset_type=QUIZ</code> Only quizzes <code>status</code> <code>?status=PUBLISHED</code> Filter by status <code>technologies</code> <code>?technologies=python</code> Filter by tech <code>category</code> <code>?category=programming</code> Filter by category <code>lang</code> <code>?lang=us</code> Filter by language"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#best-practices","title":"Best Practices","text":""},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#1-use-granular-endpoints-for-updates","title":"1. Use Granular Endpoints for Updates \u2b50","text":"<p>Prefer: - <code>PUT /v1/assessment/{slug}/question/{id}</code> - Update single question - <code>POST /v1/assessment/{slug}/question/{id}/option</code> - Add option</p> <p>Over: - <code>PUT /v1/assessment/{slug}</code> with entire questions array</p> <p>Why? - \u2705 Fewer bytes transferred - \u2705 No risk of accidentally removing questions - \u2705 Clearer intent - \u2705 Easier to debug</p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#2-always-link-asset-and-assessment","title":"2. Always Link Asset and Assessment","text":"<p>Create both for every quiz: - Assessment via <code>PUT /v1/assessment/{slug}</code> - Asset via <code>POST /v1/registry/academy/{academy_id}/asset</code> with matching slug and <code>asset_type: \"QUIZ\"</code></p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#3-validate-scoring","title":"3. Validate Scoring","text":"<p>Ensure questions have valid scoring: - At least ONE option per question must have <code>score &gt; 0</code> - Total positive scores should ideally equal 1.0 (for percentage scoring) - The API validates this automatically when using <code>PUT /question/{id}</code> with options</p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#4-use-thresholds","title":"4. Use Thresholds","text":"<p>Always define success criteria using <code>POST /v1/assessment/{slug}/threshold</code> with appropriate <code>score_threshold</code> value.</p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#5-test-before-publishing","title":"5. Test Before Publishing","text":"<ol> <li>Test: <code>PUT /v1/registry/academy/{academy_id}/asset/{slug}/action/test</code></li> <li>Check <code>test_status</code> in response</li> <li>Only publish if status is <code>OK</code> or <code>WARNING</code></li> <li>Publish: <code>PUT /v1/registry/academy/{academy_id}/asset/{slug}</code> with <code>status: \"PUBLISHED\"</code></li> </ol>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#6-handle-translations-properly","title":"6. Handle Translations Properly","text":"<p>Link translations bidirectionally: - Update each asset with <code>all_translations</code> array containing all translation slugs - Repeat for every translation to ensure bidirectional linking</p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#7-when-to-use-each-endpoint","title":"7. When to Use Each Endpoint","text":"<p>Creating new assessment: <pre><code>PUT /v1/assessment/{slug}  # With full questions array\n</code></pre></p> <p>Adding a question: <pre><code>PUT /v1/assessment/{slug}  # Include existing + new questions\n</code></pre></p> <p>Updating one question: <pre><code>PUT /v1/assessment/{slug}/question/{id}  # \u2b50 More efficient\n</code></pre></p> <p>Adding an option: <pre><code>POST /v1/assessment/{slug}/question/{id}/option  # \u2b50 Cleanest\n# OR\nPUT /v1/assessment/{slug}/question/{id}  # With options array, omit id for new\n</code></pre></p> <p>Updating an option: <pre><code>PUT /v1/assessment/{slug}/question/{id}  # Include option with id\n</code></pre></p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#troubleshooting","title":"Troubleshooting","text":""},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#common-issues","title":"Common Issues","text":""},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#issue-assessment-already-exists","title":"Issue: \"Assessment already exists\"","text":"<p>Cause: Trying to create assessment with existing slug.</p> <p>Solution: Use PUT to update instead, or check for archived assessments via <code>GET /v1/assessment?include_archived=true</code></p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#issue-question-total-score-must-be-greater-than-0","title":"Issue: \"Question total score must be greater than 0\"","text":"<p>Cause: All options have <code>score: 0</code> or no positive scores.</p> <p>Solution: Ensure at least one option has <code>score &gt; 0</code>:</p> <pre><code>{\n  \"options\": [\n    { \"title\": \"Correct answer\", \"score\": 1.0 },\n    { \"title\": \"Wrong answer\", \"score\": 0.0 }\n  ]\n}\n</code></pre>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#issue-cannot-delete-questionoption","title":"Issue: \"Cannot delete question/option\"","text":"<p>Cause: Question/option has student answers.</p> <p>Solution: Questions with answers are soft-deleted (<code>is_deleted=true</code>), not removed.</p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#issue-assessment-not-linked-to-asset","title":"Issue: \"Assessment not linked to asset\"","text":"<p>Cause: Slugs don't match or asset type isn't \"QUIZ\".</p> <p>Solution: Ensure: - Asset slug === Assessment slug - Asset <code>asset_type</code> = \"QUIZ\"</p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#related-documentation","title":"Related Documentation","text":"<ul> <li>MANAGE_SINGLE_ASSET.md - Asset management</li> <li>BUILD_SYLLABUS.md - Adding quizzes to syllabi</li> <li>STUDENT_REPORT.md - Student progress tracking</li> <li>AUTHENTICATION.md - API authentication</li> </ul>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSESSMENT/#support","title":"Support","text":"<p>For questions or issues with assessment management: - Verify both assessment and asset exist - Check scoring rules (positive scores required) - Review student submissions before deleting - Test integrity before publishing - Contact development team for API issues</p> <p>Last Updated: October 2024</p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/","title":"Managing Assets - Complete Guide","text":"<p>This document provides comprehensive guidance on creating, editing, and managing individual assets in the BreatheCode platform. Assets include lessons, exercises, projects, articles, quizzes, and videos.</p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#table-of-contents","title":"Table of Contents","text":"<ol> <li>Overview</li> <li>Asset Types</li> <li>Creating a New Asset</li> <li>Editing Asset Metadata</li> <li>GitHub Integration</li> <li>Content Management</li> <li>Asset Versions</li> <li>Technologies Management</li> <li>Translations</li> <li>Categories</li> <li>Testing &amp; Quality</li> <li>Repository Subscriptions</li> <li>Status &amp; Visibility</li> <li>Thumbnails &amp; Preview Images</li> <li>API Reference</li> </ol>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#overview","title":"Overview","text":"<p>Assets are the core learning materials in the BreatheCode platform. Each asset represents a piece of educational content that can be synced with GitHub, translated to multiple languages, categorized, and versioned.</p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#key-concepts","title":"Key Concepts","text":"<ul> <li>Asset Slug: Unique identifier for the asset across the entire platform</li> <li>Asset Type: The type of content (LESSON, EXERCISE, PROJECT, ARTICLE, QUIZ, VIDEO)</li> <li>Visibility: Controls who can see the asset (PUBLIC, UNLISTED, PRIVATE)</li> <li>Status: Publication status (NOT_STARTED, DRAFT, PUBLISHED, OPTIMIZED, DELETED)</li> <li>Sync Status: GitHub synchronization state (OK, ERROR, PENDING, NEEDS_RESYNC)</li> <li>Test Status: Integrity test results (OK, ERROR, WARNING, PENDING)</li> </ul>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#base-url","title":"Base URL","text":"<pre><code>Production: https://breathecode.herokuapp.com\nDevelopment: http://localhost:8000\n</code></pre>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#asset-types","title":"Asset Types","text":"<p>BreatheCode supports the following asset types:</p> Type Description GitHub Sync Interactive <code>LESSON</code> Educational article/tutorial \u2705 Yes \u274c No <code>EXERCISE</code> Coding exercise \u2705 Yes \u2705 Yes (LearnPack) <code>PROJECT</code> Larger coding project \u2705 Yes \u2705 Yes (LearnPack) <code>ARTICLE</code> Blog post or article \u2705 Yes \u274c No <code>QUIZ</code> Assessment quiz \u2705 Yes \u274c No <code>VIDEO</code> Video content \u274c No \u274c No"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#creating-a-new-asset","title":"Creating a New Asset","text":""},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#endpoint","title":"Endpoint","text":"<p><code>POST /v1/registry/academy/{academy_id}/asset</code></p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#authentication","title":"Authentication","text":"<p>Requires <code>crud_asset</code> capability in the academy.</p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#headers","title":"Headers","text":"<pre><code>Authorization: Token {your-token}\nAcademy: {academy_id}\nContent-Type: application/json\n</code></pre>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#request-body","title":"Request Body","text":"<pre><code>{\n  \"slug\": \"my-first-lesson\",\n  \"title\": \"My First Lesson\",\n  \"asset_type\": \"LESSON\",\n  \"lang\": \"us\",\n  \"description\": \"A comprehensive introduction to Python programming\",\n  \"category\": 1,\n  \"technologies\": [\"python\", \"flask\"],\n  \"readme_url\": \"https://github.com/4GeeksAcademy/content/blob/master/src/content/lesson/my-first-lesson.md\",\n  \"visibility\": \"PUBLIC\",\n  \"status\": \"DRAFT\"\n}\n</code></pre>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#request-parameters","title":"Request Parameters","text":"Field Type Required Description <code>slug</code> string \u2705 Yes Unique identifier (lowercase, hyphens only) <code>title</code> string \u2705 Yes Display title <code>asset_type</code> string \u2705 Yes One of: LESSON, EXERCISE, PROJECT, ARTICLE, QUIZ, VIDEO <code>lang</code> string \u274c No Language code (us, es, it) - defaults to \"us\" <code>description</code> string \u274c No SEO-friendly description <code>category</code> integer \u274c No Category ID <code>technologies</code> array \u274c No Array of technology slugs <code>readme_url</code> string \u274c No GitHub URL to markdown file <code>visibility</code> string \u274c No PUBLIC, UNLISTED, or PRIVATE (default: PUBLIC) <code>status</code> string \u274c No NOT_STARTED, DRAFT, PUBLISHED (default: DRAFT) <code>external</code> boolean \u274c No If true, opens in new window <code>interactive</code> boolean \u274c No LearnPack enabled <code>graded</code> boolean \u274c No Has grading <code>with_video</code> boolean \u274c No Includes video <code>with_solutions</code> boolean \u274c No Has solution"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#response-201-created","title":"Response (201 Created)","text":"<pre><code>{\n  \"id\": 123,\n  \"slug\": \"my-first-lesson\",\n  \"title\": \"My First Lesson\",\n  \"asset_type\": \"LESSON\",\n  \"lang\": \"us\",\n  \"description\": \"A comprehensive introduction to Python programming\",\n  \"category\": {\n    \"id\": 1,\n    \"slug\": \"programming\",\n    \"title\": \"Programming\"\n  },\n  \"technologies\": [\n    {\n      \"slug\": \"python\",\n      \"title\": \"Python\"\n    }\n  ],\n  \"readme_url\": \"https://github.com/4GeeksAcademy/content/blob/master/src/content/lesson/my-first-lesson.md\",\n  \"visibility\": \"PUBLIC\",\n  \"status\": \"DRAFT\",\n  \"sync_status\": \"PENDING\",\n  \"test_status\": \"PENDING\",\n  \"created_at\": \"2024-02-20T10:00:00Z\",\n  \"updated_at\": \"2024-02-20T10:00:00Z\"\n}\n</code></pre>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#example-create-lesson-with-javascript","title":"Example: Create Lesson with JavaScript","text":"<pre><code>const createAsset = async (academyId, assetData) =&gt; {\n  const token = localStorage.getItem('authToken');\n\n  const response = await fetch(\n    `https://breathecode.herokuapp.com/v1/registry/academy/${academyId}/asset`,\n    {\n      method: 'POST',\n      headers: {\n        'Authorization': `Token ${token}`,\n        'Academy': academyId,\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify(assetData)\n    }\n  );\n\n  if (!response.ok) {\n    const error = await response.json();\n    throw new Error(error.detail || 'Failed to create asset');\n  }\n\n  return await response.json();\n};\n\n// Usage\nconst newAsset = await createAsset(1, {\n  slug: 'intro-to-python',\n  title: 'Introduction to Python',\n  asset_type: 'LESSON',\n  lang: 'us',\n  technologies: ['python']\n});\n</code></pre>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#editing-asset-metadata","title":"Editing Asset Metadata","text":""},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#endpoint_1","title":"Endpoint","text":"<p><code>PUT /v1/registry/academy/{academy_id}/asset/{asset_slug_or_id}</code></p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#authentication_1","title":"Authentication","text":"<p>Requires <code>crud_asset</code> capability.</p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#headers_1","title":"Headers","text":"<pre><code>Authorization: Token {your-token}\nAcademy: {academy_id}\nContent-Type: application/json\n</code></pre>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#request-body_1","title":"Request Body","text":"<p>You can update any field from the asset. Only include fields you want to change:</p> <pre><code>{\n  \"title\": \"Updated Lesson Title\",\n  \"description\": \"Updated description\",\n  \"status\": \"PUBLISHED\",\n  \"visibility\": \"PUBLIC\",\n  \"technologies\": [\"python\", \"django\"],\n  \"category\": 2\n}\n</code></pre>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#updatable-fields","title":"Updatable Fields","text":"Field Description Example <code>title</code> Asset title \"Advanced Python Programming\" <code>description</code> SEO description \"Learn advanced Python concepts\" <code>lang</code> Language code \"us\", \"es\", \"it\" <code>status</code> Publication status \"DRAFT\", \"PUBLISHED\" <code>visibility</code> Access control \"PUBLIC\", \"UNLISTED\", \"PRIVATE\" <code>category</code> Category ID 1 <code>technologies</code> Technology slugs [\"python\", \"django\"] <code>all_translations</code> Translation slugs [\"intro-python-es\", \"intro-python-it\"] <code>preview</code> Social media preview URL \"https://...\" <code>readme_url</code> GitHub markdown URL \"https://github.com/...\" <code>url</code> External URL \"https://...\" <code>intro_video_url</code> Introduction video \"https://youtube.com/...\" <code>solution_video_url</code> Solution video \"https://youtube.com/...\" <code>difficulty</code> BEGINNER, EASY, INTERMEDIATE, HARD \"INTERMEDIATE\" <code>duration</code> Hours 4 <code>graded</code> Has grading true <code>with_video</code> Includes video true <code>with_solutions</code> Has solution true <code>interactive</code> LearnPack enabled true <code>gitpod</code> Gitpod compatible true <code>external</code> External asset false"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#response-200-ok","title":"Response (200 OK)","text":"<p>Returns the updated asset object.</p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#example-update-asset","title":"Example: Update Asset","text":"<pre><code>const updateAsset = async (academyId, assetSlug, updates) =&gt; {\n  const token = localStorage.getItem('authToken');\n\n  const response = await fetch(\n    `https://breathecode.herokuapp.com/v1/registry/academy/${academyId}/asset/${assetSlug}`,\n    {\n      method: 'PUT',\n      headers: {\n        'Authorization': `Token ${token}`,\n        'Academy': academyId,\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify(updates)\n    }\n  );\n\n  if (!response.ok) {\n    const error = await response.json();\n    throw new Error(error.detail || 'Failed to update asset');\n  }\n\n  return await response.json();\n};\n\n// Usage\nawait updateAsset(1, 'intro-to-python', {\n  status: 'PUBLISHED',\n  description: 'Comprehensive Python introduction for beginners'\n});\n</code></pre>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#github-integration","title":"GitHub Integration","text":"<p>Assets can be synchronized with GitHub repositories to pull content and push changes.</p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#pull-from-github","title":"Pull from GitHub","text":"<p>Synchronize asset content from GitHub repository.</p> <p>Endpoint: <code>PUT /v1/registry/academy/{academy_id}/asset/{asset_slug}/action/pull</code></p> <p>Purpose: Pull latest content from GitHub and update the asset's README.</p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#query-parameters","title":"Query Parameters","text":"<ul> <li><code>override_meta</code> (optional, default: false) - If true, overwrites asset metadata with data from GitHub</li> </ul>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#request-body_2","title":"Request Body","text":"<pre><code>{\n  \"override_meta\": false\n}\n</code></pre>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#example","title":"Example","text":"<pre><code>const pullFromGitHub = async (academyId, assetSlug, overrideMeta = false) =&gt; {\n  const token = localStorage.getItem('authToken');\n\n  const response = await fetch(\n    `https://breathecode.herokuapp.com/v1/registry/academy/${academyId}/asset/${assetSlug}/action/pull`,\n    {\n      method: 'PUT',\n      headers: {\n        'Authorization': `Token ${token}`,\n        'Academy': academyId,\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        override_meta: overrideMeta\n      })\n    }\n  );\n\n  if (!response.ok) {\n    throw new Error('Failed to pull from GitHub');\n  }\n\n  return await response.json();\n};\n\n// Pull without overriding metadata\nawait pullFromGitHub(1, 'intro-to-python', false);\n</code></pre>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#what-gets-pulled","title":"What Gets Pulled","text":"<ul> <li>Always: README content (markdown)</li> <li>With override_meta=true: Title, description, duration, difficulty, technologies</li> </ul>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#push-to-github","title":"Push to GitHub","text":"<p>Publish asset changes back to the GitHub repository.</p> <p>Endpoint: <code>PUT /v1/registry/academy/{academy_id}/asset/{asset_slug}/action/push</code></p> <p>Purpose: Push local changes to GitHub repository.</p> <p>Note: Only works for LESSON, ARTICLE, and QUIZ types. Projects and exercises must be updated manually in GitHub.</p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#example_1","title":"Example","text":"<pre><code>const pushToGitHub = async (academyId, assetSlug) =&gt; {\n  const token = localStorage.getItem('authToken');\n\n  const response = await fetch(\n    `https://breathecode.herokuapp.com/v1/registry/academy/${academyId}/asset/${assetSlug}/action/push`,\n    {\n      method: 'PUT',\n      headers: {\n        'Authorization': `Token ${token}`,\n        'Academy': academyId\n      }\n    }\n  );\n\n  if (!response.ok) {\n    throw new Error('Failed to push to GitHub');\n  }\n\n  return await response.json();\n};\n</code></pre>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#create-github-repository","title":"Create GitHub Repository","text":"<p>Create a new GitHub repository for the asset.</p> <p>Endpoint: <code>PUT /v1/registry/academy/{academy_id}/asset/{asset_slug}/action/create_repo</code></p> <p>Purpose: Create a new repository in the academy's GitHub organization.</p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#request-body_3","title":"Request Body","text":"<pre><code>{\n  \"organization\": \"4GeeksAcademy\",\n  \"repo_name\": \"my-first-lesson\"\n}\n</code></pre>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#content-management","title":"Content Management","text":""},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#save-markdown-only","title":"Save Markdown Only","text":"<p>Update only the README content without changing metadata.</p> <p>Endpoint: <code>PUT /v1/registry/academy/{academy_id}/asset/{asset_slug}</code></p> <pre><code>{\n  \"readme_raw\": \"# My Updated Content\\n\\nThis is the new markdown content...\"\n}\n</code></pre>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#cleanregenerate-readme","title":"Clean/Regenerate README","text":"<p>Clean and regenerate the asset's README from the raw markdown.</p> <p>Endpoint: <code>PUT /v1/registry/academy/{academy_id}/asset/{asset_slug}/action/clean</code></p> <p>Purpose: Process the raw markdown, extract metadata, and regenerate HTML.</p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#what-it-does","title":"What It Does","text":"<ul> <li>Extracts frontmatter metadata</li> <li>Processes markdown to HTML</li> <li>Updates SEO keywords</li> <li>Regenerates table of contents</li> <li>Optimizes images</li> </ul>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#example_2","title":"Example","text":"<pre><code>const cleanAsset = async (academyId, assetSlug) =&gt; {\n  const token = localStorage.getItem('authToken');\n\n  const response = await fetch(\n    `https://breathecode.herokuapp.com/v1/registry/academy/${academyId}/asset/${assetSlug}/action/clean`,\n    {\n      method: 'PUT',\n      headers: {\n        'Authorization': `Token ${token}`,\n        'Academy': academyId\n      }\n    }\n  );\n\n  return await response.json();\n};\n</code></pre>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#asset-versions","title":"Asset Versions","text":"<p>Assets can have multiple versions to handle technology updates and deprecation.</p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#view-superseding-asset-newer-version","title":"View Superseding Asset (Newer Version)","text":"<p>Endpoint: <code>GET /v1/registry/asset/{asset_slug}/supersedes</code></p> <p>Purpose: Get the asset that supersedes (replaces) this one.</p> <p>Response:</p> <pre><code>{\n  \"id\": 456,\n  \"slug\": \"intro-to-python-v2\",\n  \"title\": \"Introduction to Python (Updated for Python 3.11)\",\n  \"asset_type\": \"LESSON\",\n  \"superseded_by\": null,\n  \"previous_version\": {\n    \"id\": 123,\n    \"slug\": \"intro-to-python\"\n  }\n}\n</code></pre>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#view-previous-version","title":"View Previous Version","text":"<p>Endpoint: <code>GET /v1/registry/academy/{academy_id}/asset/{asset_slug}</code></p> <p>The asset object includes <code>superseded_by</code> and <code>previous_version</code> fields:</p> <pre><code>{\n  \"id\": 123,\n  \"slug\": \"intro-to-python\",\n  \"superseded_by\": {\n    \"id\": 456,\n    \"slug\": \"intro-to-python-v2\",\n    \"title\": \"Introduction to Python (Updated)\"\n  },\n  \"previous_version\": null\n}\n</code></pre>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#create-new-version-superseding","title":"Create New Version (Superseding)","text":"<p>To create a new version that supersedes an old one:</p> <ol> <li>Create the new asset</li> <li>Update the old asset with <code>superseded_by</code> field</li> </ol> <pre><code>// Step 1: Create new version\nconst newVersion = await createAsset(1, {\n  slug: 'intro-to-python-v2',\n  title: 'Introduction to Python (Python 3.11)',\n  asset_type: 'LESSON'\n});\n\n// Step 2: Mark old version as superseded\nawait updateAsset(1, 'intro-to-python', {\n  superseded_by: newVersion.id\n});\n</code></pre>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#technologies-management","title":"Technologies Management","text":"<p>Technologies are tags that categorize assets by the tech stack they cover.</p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#view-available-technologies","title":"View Available Technologies","text":"<p>Endpoint: <code>GET /v1/registry/academy/technology</code></p> <p>Response:</p> <pre><code>[\n  {\n    \"slug\": \"python\",\n    \"title\": \"Python\",\n    \"icon_url\": \"https://...\",\n    \"description\": \"Python programming language\",\n    \"is_deprecated\": false,\n    \"parent\": null\n  },\n  {\n    \"slug\": \"django\",\n    \"title\": \"Django\",\n    \"parent\": {\n      \"slug\": \"python\",\n      \"title\": \"Python\"\n    }\n  }\n]\n</code></pre>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#add-technologies-to-asset","title":"Add Technologies to Asset","text":"<p>Update the asset with technology slugs:</p> <pre><code>await updateAsset(1, 'my-lesson', {\n  technologies: ['python', 'django', 'postgresql']\n});\n</code></pre>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#remove-technologies","title":"Remove Technologies","text":"<pre><code>await updateAsset(1, 'my-lesson', {\n  technologies: ['python']  // Only keep Python\n});\n</code></pre>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#translations","title":"Translations","text":"<p>Assets can be translated into multiple languages and linked together.</p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#view-asset-translations","title":"View Asset Translations","text":"<p>Endpoint: <code>GET /v1/registry/academy/{academy_id}/asset/{asset_slug}</code></p> <p>The response includes <code>all_translations</code> field:</p> <pre><code>{\n  \"id\": 123,\n  \"slug\": \"intro-to-python\",\n  \"lang\": \"us\",\n  \"all_translations\": [\n    {\n      \"id\": 123,\n      \"slug\": \"intro-to-python\",\n      \"lang\": \"us\",\n      \"title\": \"Introduction to Python\"\n    },\n    {\n      \"id\": 124,\n      \"slug\": \"introduccion-a-python\",\n      \"lang\": \"es\",\n      \"title\": \"Introducci\u00f3n a Python\"\n    }\n  ]\n}\n</code></pre>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#create-a-translation","title":"Create a Translation","text":"<ol> <li>Create a new asset with the translated content</li> <li>Link it to the original asset</li> </ol> <pre><code>// Step 1: Create Spanish translation\nconst spanishVersion = await createAsset(1, {\n  slug: 'introduccion-a-python',\n  title: 'Introducci\u00f3n a Python',\n  asset_type: 'LESSON',\n  lang: 'es',\n  readme_url: 'https://github.com/.../README.es.md'\n});\n\n// Step 2: Link to original (English) asset\nawait updateAsset(1, 'intro-to-python', {\n  all_translations: [\n    'intro-to-python',  // Original\n    'introduccion-a-python'  // Spanish translation\n  ]\n});\n\n// Step 3: Link from Spanish to English\nawait updateAsset(1, 'introduccion-a-python', {\n  all_translations: [\n    'intro-to-python',\n    'introduccion-a-python'\n  ]\n});\n</code></pre>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#auto-generate-translation-ai","title":"Auto-Generate Translation (AI)","text":"<p>Endpoint: <code>PUT /v1/registry/academy/{academy_id}/asset/{asset_slug}/action/generate_translation</code></p> <p>Purpose: Use AI to generate a translation in another language.</p> <pre><code>{\n  \"target_lang\": \"es\"\n}\n</code></pre>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#categories","title":"Categories","text":"<p>Categories organize assets into logical groups.</p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#view-categories","title":"View Categories","text":"<p>Endpoint: <code>GET /v1/registry/academy/{academy_id}/category</code></p> <p>Response:</p> <pre><code>[\n  {\n    \"id\": 1,\n    \"slug\": \"web-development\",\n    \"title\": \"Web Development\",\n    \"lang\": \"us\",\n    \"description\": \"Learn web development technologies\",\n    \"visibility\": \"PUBLIC\"\n  }\n]\n</code></pre>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#assign-category-to-asset","title":"Assign Category to Asset","text":"<pre><code>await updateAsset(1, 'my-lesson', {\n  category: 1  // Category ID\n});\n</code></pre>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#create-new-category","title":"Create New Category","text":"<p>Endpoint: <code>POST /v1/registry/academy/{academy_id}/category</code></p> <pre><code>{\n  \"slug\": \"machine-learning\",\n  \"title\": \"Machine Learning\",\n  \"lang\": \"us\",\n  \"description\": \"AI and Machine Learning content\",\n  \"visibility\": \"PUBLIC\"\n}\n</code></pre>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#testing-quality","title":"Testing &amp; Quality","text":""},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#test-asset-integrity","title":"Test Asset Integrity","text":"<p>Run automated tests on the asset to check for issues.</p> <p>Endpoint: <code>PUT /v1/registry/academy/{academy_id}/asset/{asset_slug}/action/test</code></p> <p>Purpose: Validate asset structure, links, images, and content quality.</p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#what-it-checks","title":"What It Checks","text":"<ul> <li>Broken links</li> <li>Missing images</li> <li>Invalid markdown</li> <li>SEO issues</li> <li>Missing metadata</li> <li>Readability score</li> </ul>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#example_3","title":"Example","text":"<pre><code>const testAsset = async (academyId, assetSlug) =&gt; {\n  const token = localStorage.getItem('authToken');\n\n  const response = await fetch(\n    `https://breathecode.herokuapp.com/v1/registry/academy/${academyId}/asset/${assetSlug}/action/test`,\n    {\n      method: 'PUT',\n      headers: {\n        'Authorization': `Token ${token}`,\n        'Academy': academyId\n      }\n    }\n  );\n\n  return await response.json();\n};\n\nconst result = await testAsset(1, 'intro-to-python');\n</code></pre>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#response","title":"Response","text":"<pre><code>{\n  \"test_status\": \"WARNING\",\n  \"errors\": [\n    {\n      \"type\": \"broken_link\",\n      \"message\": \"Link to https://example.com/broken returns 404\",\n      \"line\": 45\n    }\n  ],\n  \"warnings\": [\n    {\n      \"type\": \"low_readability\",\n      \"message\": \"Readability score is 45 (target: 60+)\",\n      \"suggestion\": \"Simplify complex sentences\"\n    }\n  ]\n}\n</code></pre>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#view-test-results","title":"View Test Results","text":"<p>Endpoint: <code>GET /v1/registry/academy/{academy_id}/asset/{asset_slug}</code></p> <p>Check the <code>test_status</code> field:</p> <ul> <li><code>PENDING</code>: Not yet tested</li> <li><code>OK</code>: All tests passed</li> <li><code>WARNING</code>: Has warnings but no critical errors</li> <li><code>ERROR</code>: Has critical errors</li> </ul>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#seo-analysis","title":"SEO Analysis","text":"<p>Run SEO optimization analysis on the asset.</p> <p>Endpoint: <code>PUT /v1/registry/academy/{academy_id}/asset/{asset_slug}/action/analyze_seo</code></p> <p>Purpose: Analyze SEO quality and get improvement suggestions.</p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#response_1","title":"Response","text":"<pre><code>{\n  \"score\": 85,\n  \"issues\": [\n    {\n      \"severity\": \"warning\",\n      \"message\": \"Meta description too short (should be 150-160 chars)\",\n      \"current\": \"Learn Python\",\n      \"suggestion\": \"Learn Python programming from scratch with hands-on examples\"\n    }\n  ],\n  \"keywords\": [\"python\", \"programming\", \"tutorial\"],\n  \"readability\": {\n    \"score\": 72,\n    \"grade\": \"8th grade\"\n  }\n}\n</code></pre>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#originality-report","title":"Originality Report","text":"<p>Check content originality and detect plagiarism.</p> <p>Endpoint: <code>GET /v1/registry/academy/{academy_id}/asset/{asset_slug}/originality</code></p> <p>Response:</p> <pre><code>{\n  \"originality_score\": 95,\n  \"similar_content\": [\n    {\n      \"url\": \"https://example.com/similar\",\n      \"similarity\": 15,\n      \"matched_text\": \"Python is a high-level programming language\"\n    }\n  ]\n}\n</code></pre>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#repository-subscriptions","title":"Repository Subscriptions","text":"<p>Control whether the asset automatically syncs with GitHub on repository pushes.</p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#check-subscription-status","title":"Check Subscription Status","text":"<p>Endpoint: <code>GET /v1/registry/academy/{academy_id}/asset/{asset_slug}</code></p> <p>Check the <code>is_auto_subscribed</code> field:</p> <pre><code>{\n  \"id\": 123,\n  \"slug\": \"intro-to-python\",\n  \"is_auto_subscribed\": true,\n  \"sync_status\": \"OK\"\n}\n</code></pre>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#subscribe-to-repository-updates","title":"Subscribe to Repository Updates","text":"<p>Enable automatic synchronization when GitHub repository is updated.</p> <pre><code>await updateAsset(1, 'intro-to-python', {\n  is_auto_subscribed: true\n});\n</code></pre> <p>What happens: When GitHub sends a webhook on push, the asset will automatically pull the latest content.</p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#unsubscribe-from-repository-updates","title":"Unsubscribe from Repository Updates","text":"<p>Disable automatic synchronization.</p> <pre><code>await updateAsset(1, 'intro-to-python', {\n  is_auto_subscribed: false\n});\n</code></pre> <p>Use case: Temporarily disable auto-sync while making manual edits to avoid conflicts.</p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#status-visibility","title":"Status &amp; Visibility","text":""},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#asset-status","title":"Asset Status","text":"<p>Controls the publication lifecycle of the asset.</p> Status Description Visible to Students <code>NOT_STARTED</code> Initial state, not yet written \u274c No <code>DRAFT</code> Work in progress \u274c No <code>PUBLISHED</code> Ready for students \u2705 Yes <code>OPTIMIZED</code> SEO optimized and ready \u2705 Yes <code>DELETED</code> Soft deleted \u274c No"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#update-status","title":"Update Status","text":"<pre><code>// Publish asset\nawait updateAsset(1, 'intro-to-python', {\n  status: 'PUBLISHED'\n});\n\n// Move to draft\nawait updateAsset(1, 'intro-to-python', {\n  status: 'DRAFT'\n});\n\n// Soft delete\nawait updateAsset(1, 'intro-to-python', {\n  status: 'DELETED'\n});\n</code></pre>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#asset-visibility","title":"Asset Visibility","text":"<p>Controls who can see the asset within the academy.</p> Visibility Description Access <code>PUBLIC</code> Visible to everyone All academies <code>UNLISTED</code> Hidden from listings but accessible via direct link Same academy <code>PRIVATE</code> Only visible to asset owner/author Owner only"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#update-visibility","title":"Update Visibility","text":"<pre><code>// Make public\nawait updateAsset(1, 'intro-to-python', {\n  visibility: 'PUBLIC'\n});\n\n// Make unlisted\nawait updateAsset(1, 'intro-to-python', {\n  visibility: 'UNLISTED'\n});\n\n// Make private\nawait updateAsset(1, 'intro-to-python', {\n  visibility: 'PRIVATE'\n});\n</code></pre>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#thumbnails-preview-images","title":"Thumbnails &amp; Preview Images","text":"<p>Assets can have preview images for social media sharing and tutorial introductions.</p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#generate-thumbnail","title":"Generate Thumbnail","text":"<p>Automatically generate a thumbnail from the asset content.</p> <p>Endpoint: <code>POST /v1/registry/academy/{academy_id}/asset/{asset_slug}/thumbnail</code></p> <p>Purpose: Generate or regenerate the asset's social media preview image.</p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#example_4","title":"Example","text":"<pre><code>const generateThumbnail = async (academyId, assetSlug) =&gt; {\n  const token = localStorage.getItem('authToken');\n\n  const response = await fetch(\n    `https://breathecode.herokuapp.com/v1/registry/academy/${academyId}/asset/${assetSlug}/thumbnail`,\n    {\n      method: 'POST',\n      headers: {\n        'Authorization': `Token ${token}`,\n        'Academy': academyId\n      }\n    }\n  );\n\n  return await response.json();\n};\n\nconst thumbnail = await generateThumbnail(1, 'intro-to-python');\n// Returns: { preview: \"https://...thumbnail.jpg\" }\n</code></pre>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#set-custom-thumbnail","title":"Set Custom Thumbnail","text":"<p>Manually set a custom preview image.</p> <pre><code>await updateAsset(1, 'intro-to-python', {\n  preview: 'https://your-cdn.com/custom-thumbnail.jpg'\n});\n</code></pre>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#tutorial-preview-image","title":"Tutorial Preview Image","text":"<p>Set a different preview for use within the tutorial itself.</p> <pre><code>await updateAsset(1, 'intro-to-python', {\n  preview_in_tutorial: 'https://your-cdn.com/tutorial-preview.jpg'\n});\n</code></pre>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#api-reference","title":"API Reference","text":""},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#complete-endpoint-list","title":"Complete Endpoint List","text":"Endpoint Method Purpose Auth <code>/v1/registry/academy/{academy_id}/asset</code> GET List all assets \u2705 read_asset <code>/v1/registry/academy/{academy_id}/asset</code> POST Create new asset \u2705 crud_asset <code>/v1/registry/academy/{academy_id}/asset/{slug}</code> GET Get single asset \u2705 read_asset <code>/v1/registry/academy/{academy_id}/asset/{slug}</code> PUT Update asset \u2705 crud_asset <code>/v1/registry/academy/{academy_id}/asset/{slug}/action/pull</code> PUT Pull from GitHub \u2705 crud_asset <code>/v1/registry/academy/{academy_id}/asset/{slug}/action/push</code> PUT Push to GitHub \u2705 crud_asset <code>/v1/registry/academy/{academy_id}/asset/{slug}/action/test</code> PUT Test integrity \u2705 crud_asset <code>/v1/registry/academy/{academy_id}/asset/{slug}/action/clean</code> PUT Clean/regenerate \u2705 crud_asset <code>/v1/registry/academy/{academy_id}/asset/{slug}/action/analyze_seo</code> PUT SEO analysis \u2705 crud_asset <code>/v1/registry/academy/{academy_id}/asset/{slug}/action/create_repo</code> PUT Create GitHub repo \u2705 crud_asset <code>/v1/registry/academy/{academy_id}/asset/{slug}/thumbnail</code> POST Generate thumbnail \u2705 crud_asset <code>/v1/registry/academy/{academy_id}/asset/{slug}/originality</code> GET Originality report \u2705 read_asset <code>/v1/registry/asset/{slug}/supersedes</code> GET View versions \u274c Public <code>/v1/registry/academy/{academy_id}/category</code> GET List categories \u2705 read_asset <code>/v1/registry/academy/technology</code> GET List technologies \u2705 read_asset"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#query-parameters-list-assets","title":"Query Parameters (List Assets)","text":"<p>When listing assets (<code>GET /v1/registry/academy/{academy_id}/asset</code>), you can filter using:</p> Parameter Example Description <code>asset_type</code> <code>?asset_type=LESSON</code> Filter by type <code>status</code> <code>?status=PUBLISHED,DRAFT</code> Filter by status <code>visibility</code> <code>?visibility=PUBLIC</code> Filter by visibility <code>lang</code> <code>?lang=us</code> Filter by language <code>technologies</code> <code>?technologies=python,django</code> Filter by tech <code>category</code> <code>?category=web-dev</code> Filter by category <code>author</code> <code>?author=123</code> Filter by author ID <code>owner</code> <code>?owner=456</code> Filter by owner ID <code>like</code> <code>?like=python</code> Search in title/slug <code>test_status</code> <code>?test_status=OK</code> Filter by test status <code>sync_status</code> <code>?sync_status=OK</code> Filter by sync status <code>superseded_by</code> <code>?superseded_by=null</code> Only latest versions <code>need_translation</code> <code>?need_translation=true</code> Assets without translations <code>external</code> <code>?external=false</code> Internal assets only <code>interactive</code> <code>?interactive=true</code> LearnPack enabled only <code>graded</code> <code>?graded=true</code> Graded assets only <code>with_video</code> <code>?with_video=true</code> Assets with video"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#complete-workflow-examples","title":"Complete Workflow Examples","text":""},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#example-1-create-and-publish-a-lesson","title":"Example 1: Create and Publish a Lesson","text":"<pre><code>// 1. Create the lesson\nconst lesson = await createAsset(1, {\n  slug: 'advanced-python-decorators',\n  title: 'Advanced Python Decorators',\n  asset_type: 'LESSON',\n  lang: 'us',\n  description: 'Master Python decorators with real-world examples',\n  readme_url: 'https://github.com/4GeeksAcademy/content/blob/master/src/content/lesson/advanced-decorators.md',\n  technologies: ['python'],\n  category: 1,\n  status: 'DRAFT',\n  visibility: 'PRIVATE'\n});\n\n// 2. Pull content from GitHub\nawait pullFromGitHub(1, 'advanced-python-decorators', false);\n\n// 3. Clean and process the content\nawait cleanAsset(1, 'advanced-python-decorators');\n\n// 4. Test integrity\nconst testResults = await testAsset(1, 'advanced-python-decorators');\n\nif (testResults.test_status === 'OK') {\n  // 5. Generate thumbnail\n  await generateThumbnail(1, 'advanced-python-decorators');\n\n  // 6. Publish\n  await updateAsset(1, 'advanced-python-decorators', {\n    status: 'PUBLISHED',\n    visibility: 'PUBLIC'\n  });\n\n  console.log('\u2705 Lesson published successfully!');\n} else {\n  console.error('\u274c Tests failed:', testResults.errors);\n}\n</code></pre>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#example-2-create-translation","title":"Example 2: Create Translation","text":"<pre><code>// 1. Get original asset\nconst originalAsset = await getAsset(1, 'intro-to-python');\n\n// 2. Create Spanish version\nconst spanishAsset = await createAsset(1, {\n  slug: 'introduccion-a-python',\n  title: 'Introducci\u00f3n a Python',\n  asset_type: originalAsset.asset_type,\n  lang: 'es',\n  readme_url: originalAsset.readme_url.replace('.md', '.es.md'),\n  technologies: originalAsset.technologies.map(t =&gt; t.slug),\n  category: originalAsset.category.id\n});\n\n// 3. Pull Spanish content\nawait pullFromGitHub(1, 'introduccion-a-python');\n\n// 4. Link translations bidirectionally\nawait updateAsset(1, 'intro-to-python', {\n  all_translations: ['intro-to-python', 'introduccion-a-python']\n});\n\nawait updateAsset(1, 'introduccion-a-python', {\n  all_translations: ['intro-to-python', 'introduccion-a-python']\n});\n\nconsole.log('\u2705 Translation created and linked!');\n</code></pre>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#example-3-update-asset-from-github","title":"Example 3: Update Asset from GitHub","text":"<pre><code>// When content is updated in GitHub:\n\n// 1. Pull latest changes\nawait pullFromGitHub(1, 'intro-to-python', false);\n\n// 2. Regenerate processed content\nawait cleanAsset(1, 'intro-to-python');\n\n// 3. Re-test\nconst testResults = await testAsset(1, 'intro-to-python');\n\nif (testResults.test_status !== 'OK') {\n  console.warn('\u26a0\ufe0f Tests detected issues:', testResults.warnings);\n}\n\n// 4. Regenerate thumbnail if needed\nawait generateThumbnail(1, 'intro-to-python');\n\nconsole.log('\u2705 Asset updated from GitHub!');\n</code></pre>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#best-practices","title":"Best Practices","text":""},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#1-always-test-before-publishing","title":"1. Always Test Before Publishing","text":"<pre><code>const safePub lish = async (academyId, assetSlug) =&gt; {\n  // Test first\n  const testResults = await testAsset(academyId, assetSlug);\n\n  if (testResults.test_status === 'ERROR') {\n    throw new Error('Cannot publish: asset has errors');\n  }\n\n  // Then publish\n  await updateAsset(academyId, assetSlug, {\n    status: 'PUBLISHED'\n  });\n};\n</code></pre>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#2-use-drafts-for-work-in-progress","title":"2. Use Drafts for Work in Progress","text":"<p>Keep assets in DRAFT status while editing:</p> <pre><code>// Start as draft\nawait createAsset(1, {\n  slug: 'new-lesson',\n  title: 'New Lesson',\n  status: 'DRAFT',\n  visibility: 'PRIVATE'\n});\n\n// Edit freely...\n\n// Publish when ready\nawait updateAsset(1, 'new-lesson', {\n  status: 'PUBLISHED',\n  visibility: 'PUBLIC'\n});\n</code></pre>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#3-link-translations-properly","title":"3. Link Translations Properly","text":"<p>Always link translations bidirectionally:</p> <pre><code>const linkTranslations = async (academyId, slugs) =&gt; {\n  for (const slug of slugs) {\n    await updateAsset(academyId, slug, {\n      all_translations: slugs\n    });\n  }\n};\n\nawait linkTranslations(1, ['lesson-en', 'lesson-es', 'lesson-it']);\n</code></pre>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#4-subscribe-to-auto-sync-for-active-content","title":"4. Subscribe to Auto-Sync for Active Content","text":"<p>Enable auto-sync for content actively maintained in GitHub:</p> <pre><code>await updateAsset(1, 'active-lesson', {\n  is_auto_subscribed: true\n});\n</code></pre> <p>Disable for stable content to prevent unwanted updates:</p> <pre><code>await updateAsset(1, 'stable-lesson', {\n  is_auto_subscribed: false\n});\n</code></pre>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#5-version-management","title":"5. Version Management","text":"<p>When creating a new version:</p> <pre><code>// Create new version\nconst newVersion = await createAsset(1, {\n  slug: 'python-intro-2024',\n  title: 'Introduction to Python (2024 Edition)'\n});\n\n// Mark old version as superseded\nawait updateAsset(1, 'python-intro-2020', {\n  superseded_by: newVersion.id,\n  status: 'DRAFT'  // Optionally unpublish old version\n});\n</code></pre>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#troubleshooting","title":"Troubleshooting","text":""},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#common-issues","title":"Common Issues","text":""},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#issue-asset-not-found-for-this-academy","title":"Issue: \"Asset not found for this academy\"","text":"<p>Cause: The asset doesn't belong to the specified academy.</p> <p>Solution: Check that you're using the correct academy_id and the asset exists.</p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#issue-technology-not-found","title":"Issue: \"Technology not found\"","text":"<p>Cause: Invalid technology slug in the request.</p> <p>Solution: Get valid technology slugs first:</p> <pre><code>const techs = await fetch('/v1/registry/academy/technology')\n  .then(r =&gt; r.json());\nconsole.log(techs.map(t =&gt; t.slug));\n</code></pre>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#issue-pull-from-github-failed","title":"Issue: \"Pull from GitHub failed\"","text":"<p>Cause: Invalid GitHub URL or authentication issues.</p> <p>Solutions: - Verify <code>readme_url</code> is correct - Check GitHub repository is accessible - Ensure GitHub webhook is configured - Try <code>override_meta: true</code> if stuck</p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#issue-test-status-shows-error","title":"Issue: \"Test status shows ERROR\"","text":"<p>Cause: Asset has integrity issues.</p> <p>Solution: View detailed test results:</p> <pre><code>const asset = await getAsset(1, 'my-lesson');\nconsole.log(asset.test_status_details);\n</code></pre> <p>Fix reported issues and retest.</p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#related-documentation","title":"Related Documentation","text":"<ul> <li>BUILD_SYLLABUS.md - Managing syllabi and courses</li> <li>AUTHENTICATION.md - API authentication</li> <li>ACADEMY_PLANS.md - Academy plans and permissions</li> </ul>"},{"location":"LLM-DOCS/MANAGE_SINGLE_ASSET/#support","title":"Support","text":"<p>For questions or issues with asset management: - Check test results and error messages - Verify GitHub URLs and authentication - Review permission capabilities - Contact development team for API issues</p> <p>Last Updated: October 2024</p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_COHORT/","title":"Manage Single Cohort (Marketing Course &amp; Translation CRUD)","text":"<p>This guide explains how to work with the marketing-facing <code>Course</code> resource and its <code>CourseTranslation</code> companion, which model the public representation of a cohort. Follow the patterns in this document to read course information, discover available translations, and understand the boundaries of the current public API.</p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_COHORT/#table-of-contents","title":"Table of Contents","text":"<ul> <li>Manage Single Cohort (Marketing Course \\&amp; Translation CRUD)</li> <li>Table of Contents</li> <li>Overview</li> <li>Base URLs</li> <li>Authentication \\&amp; Permissions</li> <li>Course Resource<ul> <li>Data Shape</li> <li>Endpoint Summary</li> <li>List Courses</li> <li>Retrieve a Single Course</li> <li>Create, Update, Delete</li> <li>Update Course</li> <li>Update plan_by_country_code</li> </ul> </li> <li>Course Translation Resource<ul> <li>Translation Data Shape</li> <li>Endpoint Summary</li> <li>List Course Translations</li> <li>Create, Update, Delete</li> <li>Update Course Translation</li> <li>Update course_modules</li> <li>Update landing_variables</li> <li>Update prerequisite</li> </ul> </li> <li>Common Error Responses</li> <li>Caching \\&amp; Performance Notes</li> <li>FAQ</li> </ul>"},{"location":"LLM-DOCS/MANAGE_SINGLE_COHORT/#overview","title":"Overview","text":"<ul> <li>A Course is a marketing artifact that points to one or more syllabi and (optionally) a cohort. Courses power landing pages, pricing information, and catalog listings.</li> <li>A CourseTranslation contains localized marketing copy, media, and landing URLs for a specific language variant of the course.</li> <li>Public catalog endpoints remain read-only for anonymous clients. Academy-scoped endpoints allow authenticated staff with the <code>crud_course</code> capability to update critical marketing metadata directly through the API.</li> </ul>"},{"location":"LLM-DOCS/MANAGE_SINGLE_COHORT/#base-urls","title":"Base URLs","text":"<pre><code>Production: https://breathecode.herokuapp.com\nDevelopment: http://localhost:8000\n</code></pre> <p>All endpoints documented here are served from the Marketing API namespace: <code>/v1/marketing</code>.</p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_COHORT/#authentication-permissions","title":"Authentication &amp; Permissions","text":"<ul> <li><code>GET /v1/marketing/course</code> and related endpoints are public (<code>AllowAny</code>); no token or academy header is required.</li> <li>Responses automatically localize text using the <code>lang</code> query parameter when available, falling back to the requester\u2019s preferred language (<code>Accept-Language</code> header inferred by <code>get_user_language</code>).</li> <li>Although public, results exclude <code>PRIVATE</code> courses and any course with status <code>DELETED</code>. Users cannot access archived content through this API.</li> <li>Authenticated academy endpoints (<code>/v1/marketing/academy/course/*</code>) require:</li> <li><code>Authorization: Token {auth-token}</code></li> <li><code>Academy: {academy_id}</code> header</li> <li>A staff member whose role carries the <code>crud_course</code> capability.</li> </ul>"},{"location":"LLM-DOCS/MANAGE_SINGLE_COHORT/#course-resource","title":"Course Resource","text":""},{"location":"LLM-DOCS/MANAGE_SINGLE_COHORT/#data-shape","title":"Data Shape","text":"<p>Courses are serialized with <code>GetCourseSerializer</code> and include nested academy, syllabus, cohort, and translation details. Example payload:</p> <pre><code>{\n  \"slug\": \"full-stack-developer\",\n  \"icon_url\": \"https://assets.4geeks.com/courses/full-stack/icon.svg\",\n  \"banner_image\": \"https://assets.4geeks.com/courses/full-stack/banner.png\",\n  \"academy\": {\n    \"id\": 4,\n    \"slug\": \"downtown-miami\",\n    \"name\": \"BreatheCode Miami\",\n    \"logo_url\": \"https://assets.4geeks.com/academies/downtown-miami/logo.png\",\n    \"icon_url\": \"https://assets.4geeks.com/academies/downtown-miami/icon.png\"\n  },\n  \"syllabus\": [\n    {\n      \"id\": 7,\n      \"slug\": \"full-stack\",\n      \"name\": \"Full Stack Developer\",\n      \"logo\": null\n    }\n  ],\n  \"course_translation\": {\n    \"title\": \"Full Stack Developer\",\n    \"featured_assets\": \"intro-to-python,react-project\",\n    \"description\": \"Become a full stack developer in 18 weeks.\",\n    \"short_description\": \"Python, React, and DevOps in one course.\",\n    \"lang\": \"en\",\n    \"course_modules\": [\n      {\"title\": \"Backend Fundamentals\", \"weeks\": 4},\n      {\"title\": \"Frontend Frameworks\", \"weeks\": 6}\n    ],\n    \"landing_variables\": {\"cta_label\": \"Apply Now\"},\n    \"landing_url\": \"https://4geeks.com/course/full-stack\",\n    \"preview_url\": \"https://4geeks.com/course/full-stack/preview\",\n    \"video_url\": \"https://youtu.be/xyz\",\n    \"heading\": \"Train with the best instructors in Miami.\",\n    \"prerequisite\": [\"Basic programming knowledge\", \"Laptop with 8GB RAM\"]\n  },\n  \"cohort\": {\n    \"id\": 21,\n    \"slug\": \"downtown-miami-full-stack-101\",\n    \"name\": \"Full Stack 101\"\n  },\n  \"status\": \"ACTIVE\",\n  \"visibility\": \"PUBLIC\",\n  \"is_listed\": true,\n  \"technologies\": \"python,react,flask,devops\",\n  \"color\": \"#0B5FFF\",\n  \"plan_slug\": \"full-stack-us\"\n}\n</code></pre> <p>Key notes:</p> <ul> <li><code>plan_slug</code> automatically swaps to a country-specific slug when you supply <code>country_code</code> in the query string and the course has <code>plan_by_country_code</code> metadata.</li> <li><code>course_translation</code> is language-aware. The serializer tries to match <code>lang</code>, <code>lang[:2]</code>, or any translation whose language starts with the two-letter prefix.</li> <li><code>cohort</code> appears only when the course is linked to a never-ending SaaS-ready cohort (see <code>Course.clean()</code> validation).</li> </ul>"},{"location":"LLM-DOCS/MANAGE_SINGLE_COHORT/#endpoint-summary","title":"Endpoint Summary","text":"Method Endpoint Description Availability <code>GET</code> <code>/v1/marketing/course</code> List courses with optional filters \u2705 Public <code>GET</code> <code>/v1/marketing/course/{course_slug}</code> Retrieve a single course by slug \u2705 Public <code>PUT</code> <code>/v1/marketing/academy/course/{course_id}</code> Update course fields scoped to an academy \ud83d\udd12 Requires <code>crud_course</code> <code>PUT</code> <code>/v1/marketing/academy/course/{course_id}/plan-by-country-code</code> Replace the <code>plan_by_country_code</code> JSON blob \ud83d\udd12 Requires <code>crud_course</code> <code>POST</code> <code>/v1/marketing/course</code> Create a course \u274c Not exposed via public API <code>DELETE</code> <code>/v1/marketing/course/{course_slug}</code> Delete a course \u274c Not exposed via public API"},{"location":"LLM-DOCS/MANAGE_SINGLE_COHORT/#list-courses","title":"List Courses","text":"<p>Endpoint <code>GET /v1/marketing/course</code></p> <p>Query Parameters</p> Name Type Required Description <code>lang</code> string No Overrides language negotiation for course translations (<code>en</code>, <code>es</code>, <code>pt-BR</code>, etc.). Defaults to user language. <code>country_code</code> string No ISO country code (<code>us</code>, <code>es</code>, <code>co</code>) used to choose a localized <code>plan_slug</code>. <code>academy</code> string No Comma-separated academy slugs or numeric IDs. Accepts mixed input (<code>downtown-miami,3</code>). <code>syllabus</code> string No Comma-separated syllabus slugs or IDs to match courses referencing those syllabi. <code>status</code> string No Comma-separated course statuses (<code>ACTIVE</code>, <code>ARCHIVED</code>, <code>INACTIVE</code>). Defaults to active-only (excludes <code>ARCHIVED</code>). <code>icon_url</code> string No Case-insensitive substring filter on the <code>icon_url</code>. <code>technologies</code> string No Comma-separated keywords (logical OR) matched against the <code>technologies</code> field. <code>is_listed</code> string/bool No When <code>true</code>/<code>1</code> filters to catalog-visible courses; <code>false</code>/<code>0</code> shows hidden courses. <code>limit</code>, <code>offset</code> integer No Standard pagination provided by <code>APIViewExtensions</code>. <p>Example Request</p> <pre><code>GET /v1/marketing/course?academy=downtown-miami&amp;lang=es&amp;country_code=co&amp;technologies=python,react HTTP/1.1\nHost: breathecode.herokuapp.com\n</code></pre> <p>Example Response (200 OK)</p> <pre><code>[\n  {\n    \"slug\": \"full-stack-developer\",\n    \"icon_url\": \"https://assets.4geeks.com/courses/full-stack/icon.svg\",\n    \"banner_image\": \"https://assets.4geeks.com/courses/full-stack/banner.png\",\n    \"academy\": {\n      \"id\": 4,\n      \"slug\": \"downtown-miami\",\n      \"name\": \"BreatheCode Miami\",\n      \"logo_url\": \"https://assets.4geeks.com/academies/downtown-miami/logo.png\",\n      \"icon_url\": \"https://assets.4geeks.com/academies/downtown-miami/icon.png\"\n    },\n    \"syllabus\": [\n      {\n        \"id\": 7,\n        \"slug\": \"full-stack\",\n        \"name\": \"Full Stack Developer\",\n        \"logo\": null\n      }\n    ],\n    \"course_translation\": {\n      \"title\": \"Desarrollador Full Stack\",\n      \"featured_assets\": \"intro-a-python,react-proyecto\",\n      \"description\": \"Convi\u00e9rtete en desarrollador full stack en 18 semanas.\",\n      \"short_description\": \"Python, React y DevOps en un solo curso.\",\n      \"lang\": \"es\",\n      \"course_modules\": [\n        {\"title\": \"Fundamentos Backend\", \"weeks\": 4},\n        {\"title\": \"Frameworks Frontend\", \"weeks\": 6}\n      ],\n      \"landing_variables\": {\"cta_label\": \"Aplicar Ahora\"},\n      \"landing_url\": \"https://4geeks.com/es/course/full-stack\",\n      \"preview_url\": \"https://4geeks.com/es/course/full-stack/preview\",\n      \"video_url\": \"https://youtu.be/xyz-es\",\n      \"heading\": \"Entrena con los mejores instructores de Latinoam\u00e9rica.\",\n      \"prerequisite\": [\"Conocimientos b\u00e1sicos de programaci\u00f3n\", \"Laptop con 8GB RAM\"]\n    },\n    \"cohort\": null,\n    \"status\": \"ACTIVE\",\n    \"visibility\": \"PUBLIC\",\n    \"is_listed\": true,\n    \"technologies\": \"python,react,flask,devops\",\n    \"color\": \"#0B5FFF\",\n    \"plan_slug\": \"full-stack-co\"\n  }\n]\n</code></pre>"},{"location":"LLM-DOCS/MANAGE_SINGLE_COHORT/#retrieve-a-single-course","title":"Retrieve a Single Course","text":"<p>Endpoint <code>GET /v1/marketing/course/{course_slug}</code></p> <p>Path Parameters</p> Name Type Description <code>course_slug</code> string Unique slug for the target course. <p>Query Parameters</p> <p>All parameters from the list endpoint remain valid (<code>lang</code>, <code>country_code</code>). No additional filters are accepted.</p> <p>Response Codes</p> Status Description <code>200 OK</code> Course found and visible. Body matches the schema above. <code>404 Not Found</code> Returned when the slug does not exist, the course is <code>DELETED</code>, or visibility is <code>PRIVATE</code>. <p>Example Error</p> <pre><code>{\n  \"detail\": \"course-not-found\",\n  \"status_code\": 404\n}\n</code></pre>"},{"location":"LLM-DOCS/MANAGE_SINGLE_COHORT/#create-update-delete","title":"Create, Update, Delete","text":"<p>The public marketing API does not expose course creation or deletion. Use the academy-scoped endpoints (<code>/v1/marketing/academy/course/*</code>) to update an existing record. Attempting unsupported verbs on <code>/v1/marketing/course</code> still returns <code>405 Method Not Allowed</code>.</p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_COHORT/#update-course","title":"Update Course","text":"<p>Endpoint <code>PUT /v1/marketing/academy/course/{course_id}</code></p> <p>Headers</p> <pre><code>Authorization: Token {auth-token}\nAcademy: {academy_id}\nContent-Type: application/json\n</code></pre> <p>Body Fields</p> <p>All fields are optional; omitted keys remain unchanged.</p> Field Type Notes <code>slug</code> string Update the public slug (must remain unique). <code>syllabus</code> array[int] Replace the list of attached syllabus IDs. <code>cohort</code> integer Associate a never-ending cohort (must belong to the same academy). <code>is_listed</code> boolean Toggle catalog visibility. <code>plan_slug</code> string | null Default plan slug when no country override matches. <code>status</code> enum <code>ACTIVE</code>, <code>ARCHIVED</code>, or <code>DELETED</code>. <code>color</code> string Hex color used in marketing surfaces. <code>status_message</code> string Optional explanation when status is not <code>ACTIVE</code>. <code>visibility</code> enum <code>PUBLIC</code>, <code>UNLISTED</code>, or <code>PRIVATE</code>. <code>icon_url</code> url Course icon. <code>banner_image</code> url | null Optional hero image. <code>technologies</code> string Comma-separated technology tags. <code>has_waiting_list</code> boolean Enables the waiting list flow. <p>Example Request</p> <pre><code>PUT /v1/marketing/academy/course/42?lang=es&amp;country_code=co HTTP/1.1\nAuthorization: Token abc123\nAcademy: 7\nContent-Type: application/json\n\n{\n  \"plan_slug\": \"full-stack-global\",\n  \"status\": \"ARCHIVED\",\n  \"is_listed\": false,\n  \"color\": \"#0A558C\"\n}\n</code></pre> <p>Response (200 OK)</p> <p>Returns the same payload structure as <code>GET /v1/marketing/course/{course_slug}</code> (honoring <code>lang</code>/<code>country_code</code> query parameters).</p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_COHORT/#update-plan_by_country_code","title":"Update plan_by_country_code","text":"<p>Endpoint <code>PUT /v1/marketing/academy/course/{course_id}/plan-by-country-code</code></p> <p>Headers \u2014 same as <code>Update Course</code>.</p> <p>Body</p> <pre><code>{\n  \"plan_by_country_code\": {\n    \"us\": \"full-stack-us\",\n    \"co\": \"full-stack-co\"\n  }\n}\n</code></pre> <ul> <li>The value must be a JSON object (or <code>null</code> to clear overrides).  </li> <li>Keys should be ISO 3166-1 alpha-2 country codes in lowercase.</li> </ul> <p>Response (200 OK)</p> <pre><code>{\n  \"plan_by_country_code\": {\n    \"us\": \"full-stack-us\",\n    \"co\": \"full-stack-co\"\n  }\n}\n</code></pre>"},{"location":"LLM-DOCS/MANAGE_SINGLE_COHORT/#course-translation-resource","title":"Course Translation Resource","text":""},{"location":"LLM-DOCS/MANAGE_SINGLE_COHORT/#translation-data-shape","title":"Translation Data Shape","text":"<p><code>CourseTranslation</code> serializers surface marketing copy and ancillary metadata used by landing pages. Each translation is associated with a course and a language code (e.g., <code>en</code>, <code>es</code>, <code>pt-BR</code>).</p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_COHORT/#endpoint-summary_1","title":"Endpoint Summary","text":"Method Endpoint Description Availability <code>GET</code> <code>/v1/marketing/course/{course_slug}/translations</code> List all translations for a visible course \u2705 Public <code>PUT</code> <code>/v1/marketing/academy/course/{course_id}/translation</code> Update non-JSON translation fields (requires <code>lang</code> in body) \ud83d\udd12 Requires <code>crud_course</code> <code>PUT</code> <code>/v1/marketing/academy/course/{course_id}/course_modules</code> Replace <code>course_modules</code> JSON array for a specific translation \ud83d\udd12 Requires <code>crud_course</code> <code>PUT</code> <code>/v1/marketing/academy/course/{course_id}/landing_variables</code> Replace <code>landing_variables</code> JSON object for a translation \ud83d\udd12 Requires <code>crud_course</code> <code>PUT</code> <code>/v1/marketing/academy/course/{course_id}/prerequisite</code> Replace the <code>prerequisite</code> list for a translation \ud83d\udd12 Requires <code>crud_course</code> <code>POST</code> <code>/v1/marketing/course/{course_slug}/translations</code> Create a translation \u274c Not exposed via public API <code>DELETE</code> <code>/v1/marketing/course/{course_slug}/translations/{lang}</code> Delete a translation \u274c Not exposed via public API"},{"location":"LLM-DOCS/MANAGE_SINGLE_COHORT/#list-course-translations","title":"List Course Translations","text":"<p>Endpoint <code>GET /v1/marketing/course/{course_slug}/translations</code></p> <p>Path Parameters</p> Name Type Description <code>course_slug</code> string Slug of the parent course. <p>Response Codes</p> Status Description <code>200 OK</code> Returns an array of translations (possibly empty). <code>400 Bad Request</code> Triggered when <code>course_slug</code> is missing. <code>404 Not Found</code> Course not found, not active, or not publicly visible. <p>Example Response (200 OK)</p> <pre><code>[\n  {\n    \"title\": \"Full Stack Developer\",\n    \"featured_assets\": \"intro-to-python,react-project\",\n    \"description\": \"Become a full stack developer in 18 weeks.\",\n    \"short_description\": \"Python, React, and DevOps in one course.\",\n    \"lang\": \"en\",\n    \"course_modules\": [\n      {\"title\": \"Backend Fundamentals\", \"weeks\": 4},\n      {\"title\": \"Frontend Frameworks\", \"weeks\": 6}\n    ],\n    \"landing_variables\": {\"cta_label\": \"Apply Now\"},\n    \"landing_url\": \"https://4geeks.com/course/full-stack\",\n    \"preview_url\": \"https://4geeks.com/course/full-stack/preview\",\n    \"video_url\": \"https://youtu.be/xyz\",\n    \"heading\": \"Train with the best instructors in Miami.\",\n    \"prerequisite\": [\"Basic programming knowledge\", \"Laptop with 8GB RAM\"]\n  },\n  {\n    \"title\": \"Desarrollador Full Stack\",\n    \"featured_assets\": \"intro-a-python,react-proyecto\",\n    \"description\": \"Convi\u00e9rtete en desarrollador full stack en 18 semanas.\",\n    \"short_description\": \"Python, React y DevOps en un solo curso.\",\n    \"lang\": \"es\",\n    \"course_modules\": [\n      {\"title\": \"Fundamentos Backend\", \"weeks\": 4},\n      {\"title\": \"Frameworks Frontend\", \"weeks\": 6}\n    ],\n    \"landing_variables\": {\"cta_label\": \"Aplicar Ahora\"},\n    \"landing_url\": \"https://4geeks.com/es/course/full-stack\",\n    \"preview_url\": \"https://4geeks.com/es/course/full-stack/preview\",\n    \"video_url\": \"https://youtu.be/xyz-es\",\n    \"heading\": \"Entrena con los mejores instructores de Latinoam\u00e9rica.\",\n    \"prerequisite\": [\"Conocimientos b\u00e1sicos de programaci\u00f3n\", \"Laptop con 8GB RAM\"]\n  }\n]\n</code></pre> <p>Visibility Rules</p> <ul> <li>The parent course must be <code>ACTIVE</code> and <code>PUBLIC</code>/<code>UNLISTED</code>. Otherwise a <code>404</code> is returned even if translations exist.</li> <li>No additional query parameters are supported; pagination is provided automatically through <code>APIViewExtensions</code>.</li> </ul>"},{"location":"LLM-DOCS/MANAGE_SINGLE_COHORT/#create-update-delete_1","title":"Create, Update, Delete","text":"<p>Translation creation and deletion remain internal-only. Use the academy endpoints described below to update existing translations.</p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_COHORT/#update-course-translation","title":"Update Course Translation","text":"<p>Endpoint <code>PUT /v1/marketing/academy/course/{course_id}/translation</code></p> <p>Provide the translation language in the request body to identify the record.</p> <pre><code>Authorization: Token {auth-token}\nAcademy: {academy_id}\nContent-Type: application/json\n</code></pre> <pre><code>{\n  \"lang\": \"en\",\n  \"title\": \"Full Stack Developer\",\n  \"heading\": \"Build production-ready apps\",\n  \"video_url\": \"https://youtu.be/xyz\"\n}\n</code></pre> <p>The response body returns the full translation serialized via <code>GetCourseTranslationSerializer</code>.</p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_COHORT/#update-course_modules","title":"Update course_modules","text":"<p>Endpoint <code>PUT /v1/marketing/academy/course/{course_id}/course_modules</code></p> <ul> <li><code>lang</code> is required in the body.</li> <li><code>course_modules</code> must be an array of objects with <code>name</code>, <code>slug</code>, and <code>description</code>.</li> </ul> <pre><code>{\n  \"lang\": \"en\",\n  \"course_modules\": [\n    {\"name\": \"Backend Fundamentals\", \"slug\": \"backend\", \"description\": \"Python, Flask, SQL\"},\n    {\"name\": \"Frontend Frameworks\", \"slug\": \"frontend\", \"description\": \"React, state management\"}\n  ]\n}\n</code></pre>"},{"location":"LLM-DOCS/MANAGE_SINGLE_COHORT/#update-landing_variables","title":"Update landing_variables","text":"<p>Endpoint <code>PUT /v1/marketing/academy/course/{course_id}/landing_variables</code></p> <pre><code>{\n  \"lang\": \"en\",\n  \"landing_variables\": {\n    \"cta_label\": \"Apply Now\",\n    \"hero_copy\": \"Kickstart your tech career in 18 weeks\"\n  }\n}\n</code></pre> <ul> <li><code>landing_variables</code> must be a JSON object or <code>null</code>.</li> </ul>"},{"location":"LLM-DOCS/MANAGE_SINGLE_COHORT/#update-prerequisite","title":"Update prerequisite","text":"<p>Endpoint <code>PUT /v1/marketing/academy/course/{course_id}/prerequisite</code></p> <pre><code>{\n  \"lang\": \"en\",\n  \"prerequisite\": [\n    \"Comfort with basic HTML/CSS\",\n    \"Fundamental programming knowledge\"\n  ]\n}\n</code></pre> <ul> <li><code>prerequisite</code> accepts an array of Markdown strings (or <code>null</code> to clear the list).</li> </ul> <p>Each JSON-focused endpoint returns the updated translation serialized with <code>GetCourseTranslationSerializer</code>.</p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_COHORT/#common-error-responses","title":"Common Error Responses","text":"Status Body Scenario <code>400</code> <code>{\"detail\": \"course-slug-required\", \"status_code\": 400}</code> Calling <code>/course/{slug}/translations</code> without providing the slug parameter. <code>400</code> <code>{\"detail\": \"missing-lang\", \"status_code\": 400}</code> Missing <code>lang</code> key when using academy translation endpoints. <code>400</code> <code>{\"detail\": \"missing-course-modules\", \"status_code\": 400}</code> <code>course_modules</code> key omitted in <code>/course_modules</code> payloads. <code>400</code> <code>{\"detail\": \"missing-plan-by-country-code\", \"status_code\": 400}</code> <code>plan_by_country_code</code> key omitted while calling the plan override endpoint. <code>404</code> <code>{\"detail\": \"course-not-found\", \"status_code\": 404}</code> Course slug does not exist, is deleted, or is private. <code>404</code> <code>{\"detail\": \"course-translation-not-found\", \"status_code\": 404}</code> Translation not found for the supplied <code>lang</code> and academy course. <code>405</code> <code>{\"detail\": \"method-not-allowed\"}</code> Attempting unsupported verbs (POST/PUT/DELETE). <p>These payloads are generated by <code>ValidationException</code>, which wraps errors using Capy Core translations to respect the requested language.</p>"},{"location":"LLM-DOCS/MANAGE_SINGLE_COHORT/#caching-performance-notes","title":"Caching &amp; Performance Notes","text":"<ul> <li>Both endpoints use <code>CourseCache</code> through <code>APIViewExtensions</code>. Expect cached responses at the view layer; purge the cache when modifying courses via admin tools to see updates immediately.</li> <li>Sorting defaults to <code>-updated_at</code>. Use pagination parameters to page through large catalogs rather than fetching everything in one request.</li> </ul>"},{"location":"LLM-DOCS/MANAGE_SINGLE_COHORT/#faq","title":"FAQ","text":"<ul> <li> <p>How do I create or edit a course?   Use the Django admin (<code>/admin/marketing/course/</code>) or the internal back-office UI. Public API clients cannot modify courses yet.</p> </li> <li> <p>Why is my course missing from the response?   Verify the course is <code>ACTIVE</code>, not <code>DELETED</code>, and has <code>visibility</code> set to <code>PUBLIC</code> or <code>UNLISTED</code>.</p> </li> <li> <p>How can I fetch only one specific language?   Use <code>GET /v1/marketing/course/{course_slug}</code> with the <code>lang</code> query parameter to have the embedded <code>course_translation</code> automatically select the closest matching translation.</p> </li> <li> <p>Can I request unpublished translations?   No. The endpoint returns all translations attached to the course, but the course itself must meet the visibility rules to be exposed.</p> </li> </ul>"},{"location":"LLM-DOCS/MARKETING_SHORTCUTS/","title":"Marketing Short Links API","text":"<p>The Marketing Short Links API allows you to create, manage, and track short URLs for marketing campaigns. Short links automatically append UTM parameters to destination URLs and track click statistics.</p>"},{"location":"LLM-DOCS/MARKETING_SHORTCUTS/#overview","title":"Overview","text":"<p>Short links are accessible via <code>/s/&lt;slug&gt;</code> and redirect to destination URLs with UTM parameters automatically appended. The system tracks click counts, validates destination URLs, and monitors link health.</p>"},{"location":"LLM-DOCS/MARKETING_SHORTCUTS/#model-structure","title":"Model Structure","text":"<p>Each ShortLink has the following key properties:</p> <ul> <li><code>slug</code>: Unique identifier for the short link (auto-generated if not provided)</li> <li><code>destination</code>: The full URL to redirect to</li> <li><code>hits</code>: Number of clicks (automatically incremented)</li> <li><code>active</code>: Whether the link is active (inactive links won't redirect)</li> <li><code>private</code>: If true, only visible to the owning academy</li> <li><code>destination_status</code>: Health status (ACTIVE, ERROR, NOT_FOUND)</li> <li><code>utm_source</code>, <code>utm_medium</code>, <code>utm_campaign</code>, <code>utm_content</code>, <code>utm_term</code>, <code>utm_placement</code>, <code>utm_plan</code>: UTM tracking parameters</li> <li><code>academy</code>: The academy that owns this link</li> <li><code>author</code>: The user who created the link</li> <li><code>lastclick_at</code>: Timestamp of the last click</li> <li><code>event</code>: Event reference in format <code>\"&lt;id:slug&gt;\"</code> (e.g., <code>\"&lt;3434:event_slug&gt;\"</code>) - Optional, for event promotions</li> <li><code>course</code>: Course reference in format <code>\"&lt;id:slug&gt;\"</code> (e.g., <code>\"&lt;123:course_slug&gt;\"</code>) - Optional, for course promotions</li> <li><code>downloadable</code>: Downloadable content reference in format <code>\"&lt;id:slug&gt;\"</code> (e.g., <code>\"&lt;567:downloadable_slug&gt;\"</code>) - Optional, for content downloads</li> <li><code>plan</code>: Plan reference in format <code>\"&lt;id:slug&gt;\"</code> (e.g., <code>\"&lt;789:plan_slug&gt;\"</code>) - Optional, for subscription plan promotions</li> <li><code>referrer_user</code>: User ID of the referrer (for affiliate tracking) - Optional ForeignKey to User</li> <li><code>purpose</code>: Internal description of what this link is used for - Optional TextField (max 500 chars)</li> <li><code>notes</code>: Internal notes about this short link - Optional TextField (max 1000 chars)</li> </ul>"},{"location":"LLM-DOCS/MARKETING_SHORTCUTS/#api-endpoints","title":"API Endpoints","text":"<p>All endpoints require authentication and are under <code>/v1/marketing/academy/</code>.</p>"},{"location":"LLM-DOCS/MARKETING_SHORTCUTS/#list-short-links","title":"List Short Links","text":"<p>GET <code>/v1/marketing/academy/short</code></p> <p>Lists all short links accessible to the authenticated academy.</p> <p>Required Capability: <code>read_shortlink</code></p> <p>Query Parameters: - <code>private=true</code>: Filter to show only private links - <code>like=&lt;search_term&gt;</code>: Search by slug (case-insensitive) - <code>sort=&lt;field&gt;</code>: Sort by field (default: <code>-created_at</code>) - Standard pagination parameters</p> <p>Response: <pre><code>[\n    {\n        \"id\": 1,\n        \"slug\": \"L1\",\n        \"destination\": \"https://example.com/landing\",\n        \"hits\": 42,\n        \"private\": true,\n        \"destination_status\": \"ACTIVE\",\n        \"destination_status_text\": null,\n        \"lastclick_at\": \"2025-01-15T10:30:00Z\",\n        \"active\": true,\n        \"utm_content\": null,\n        \"utm_medium\": \"social\",\n        \"utm_campaign\": \"summer-2025\",\n        \"utm_source\": \"facebook\",\n        \"utm_placement\": null,\n        \"utm_term\": null,\n        \"utm_plan\": null,\n        \"event\": null,\n        \"course\": null,\n        \"downloadable\": null,\n        \"plan\": null,\n        \"referrer_user\": null,\n        \"purpose\": null,\n        \"notes\": null\n    }\n]\n</code></pre></p> <p>Access Rules: - Shows links from your academy - Shows public links (where <code>private=false</code>) from other academies - Private links from other academies are hidden</p>"},{"location":"LLM-DOCS/MARKETING_SHORTCUTS/#get-single-short-link","title":"Get Single Short Link","text":"<p>GET <code>/v1/marketing/academy/short/&lt;slug&gt;</code></p> <p>Get a specific short link by slug.</p> <p>Required Capability: <code>read_shortlink</code></p> <p>Response: Same structure as list endpoint (single object)</p> <p>Error: Returns 404 if link not found or if it's private and belongs to another academy</p>"},{"location":"LLM-DOCS/MARKETING_SHORTCUTS/#create-short-link","title":"Create Short Link","text":"<p>POST <code>/v1/marketing/academy/short</code></p> <p>Create a new short link.</p> <p>Required Capability: <code>crud_shortlink</code></p> <p>Request Body: <pre><code>{\n    \"slug\": \"summer-promo\",  // Optional: auto-generated if not provided\n    \"destination\": \"https://example.com/landing\",\n    \"active\": true,\n    \"private\": true,\n    \"utm_source\": \"facebook\",\n    \"utm_medium\": \"social\",\n    \"utm_campaign\": \"summer-2025\",\n    \"utm_content\": \"ad-123\",\n    \"utm_term\": \"coding-bootcamp\",\n    \"utm_placement\": \"feed\",\n    \"utm_plan\": \"upfront\",\n    \"event\": \"&lt;3434:summer-workshop-2025&gt;\",  // Optional: Event reference in format \"&lt;id:slug&gt;\"\n    \"course\": \"&lt;123:full-stack-bootcamp&gt;\",  // Optional: Course reference in format \"&lt;id:slug&gt;\"\n    \"downloadable\": \"&lt;567:course-guide&gt;\",  // Optional: Downloadable reference in format \"&lt;id:slug&gt;\"\n    \"plan\": \"&lt;789:4geeks-plus-subscription&gt;\",  // Optional: Plan reference in format \"&lt;id:slug&gt;\"\n    \"referrer_user\": 42,  // Optional: User ID of the referrer\n    \"purpose\": \"Promote summer bootcamp enrollment\",  // Optional: Internal description\n    \"notes\": \"Used in email campaign sent to previous students\"  // Optional: Internal notes\n}\n</code></pre></p> <p>Response: 201 Created with the created short link object</p> <p>Auto-Generated Slug: - If no slug provided, generates format: <code>L&lt;base-encoded-id&gt;</code> - Example: <code>L1</code>, <code>L2</code>, <code>L3</code>, etc. - Uses base encoding for compact representation</p> <p>Validation: - Slug must match pattern: <code>^[-\\w]+$</code> (letters, numbers, hyphens, underscores only) - Slug must be unique - Destination URL must return HTTP status 200-299 (validated via HTTP request) - Academy must exist</p> <p>Error Responses: - <code>invalid-slug-format</code>: Slug contains invalid characters - <code>shortlink-already-exists</code>: Slug is already taken - <code>academy-not-found</code>: Academy ID is invalid - 400 with validation errors if destination URL is invalid</p>"},{"location":"LLM-DOCS/MARKETING_SHORTCUTS/#update-short-link","title":"Update Short Link","text":"<p>PUT <code>/v1/marketing/academy/short/&lt;short_slug&gt;</code></p> <p>Update an existing short link.</p> <p>Required Capability: <code>crud_shortlink</code></p> <p>Request Body: Same structure as POST (all fields optional except those being changed)</p> <p>Response: 200 OK with updated short link object</p> <p>Important Restrictions: - Can only update links created less than 1 day ago - Cannot change <code>destination</code> or <code>slug</code> if link is older than 1 day - For older links, create a new link instead</p> <p>Error Responses: - <code>short-not-found</code>: Short link doesn't exist or doesn't belong to your academy - <code>update-days-ago</code>: Link is older than 1 day and cannot be modified - Same validation errors as POST</p>"},{"location":"LLM-DOCS/MARKETING_SHORTCUTS/#delete-short-link","title":"Delete Short Link","text":"<p>DELETE <code>/v1/marketing/academy/short?id=&lt;id&gt;</code></p> <p>Delete one or more short links.</p> <p>Required Capability: <code>crud_shortlink</code></p> <p>Query Parameters: - <code>id=&lt;id&gt;</code>: ID of link to delete (required) - Multiple IDs can be specified for bulk delete</p> <p>Response: 204 No Content</p> <p>Important Restrictions: - Can only delete links created less than 1 day ago - For older links, they remain in the system for historical tracking</p> <p>Error Responses: - <code>update-days-ago</code>: One or more links are older than 1 day - 400 if no <code>id</code> parameter provided</p>"},{"location":"LLM-DOCS/MARKETING_SHORTCUTS/#short-link-redirection","title":"Short Link Redirection","text":"<p>When a user accesses a short link via <code>/s/&lt;slug&gt;</code>, the system:</p> <ol> <li>Looks up the short link by slug</li> <li>Checks if it's active (returns 404 if inactive)</li> <li>Asynchronously increments the click counter via Celery task</li> <li>Merges UTM parameters from the ShortLink model with any existing parameters in the destination URL</li> <li>Redirects to the final URL with all UTM parameters</li> </ol> <p>Redirection Behavior: - Destination URL's existing query parameters are preserved - ShortLink UTM parameters are merged in (can override destination params if same key) - Final redirect includes all merged parameters - HTTP 302 redirect is used</p> <p>Example:</p> <p>If you have a ShortLink: - <code>destination</code>: <code>https://example.com/landing?ref=partner</code> - <code>utm_source</code>: <code>facebook</code> - <code>utm_campaign</code>: <code>summer-2025</code> - <code>utm_medium</code>: <code>social</code></p> <p>Accessing <code>/s/L1</code> redirects to: <pre><code>https://example.com/landing?ref=partner&amp;utm_source=facebook&amp;utm_campaign=summer-2025&amp;utm_medium=social\n</code></pre></p>"},{"location":"LLM-DOCS/MARKETING_SHORTCUTS/#click-tracking","title":"Click Tracking","text":"<p>When a short link is accessed:</p> <ol> <li>The <code>hits</code> counter is incremented (asynchronously via Celery)</li> <li><code>lastclick_at</code> timestamp is updated</li> <li>Destination URL is validated (HTTP request to check status)</li> <li><code>destination_status</code> is updated:</li> <li><code>ACTIVE</code>: URL returns 200-299 status</li> <li><code>ERROR</code>: URL returns error status code</li> <li><code>NOT_FOUND</code>: URL not accessible</li> </ol> <p>The click tracking happens asynchronously, so the redirect is not delayed by the tracking operation.</p>"},{"location":"LLM-DOCS/MARKETING_SHORTCUTS/#url-validation","title":"URL Validation","text":"<p>When creating or updating a short link, the destination URL is validated:</p> <ul> <li>HTTP GET request is made to the destination URL</li> <li>Must return status code 200-299 to be valid</li> <li>If invalid, creation/update fails with validation error</li> </ul> <p>The validation also runs after each click to monitor link health.</p>"},{"location":"LLM-DOCS/MARKETING_SHORTCUTS/#utm-parameters","title":"UTM Parameters","text":"<p>Short links support all standard UTM parameters for campaign tracking:</p> <ul> <li><code>utm_source</code>: Traffic source (e.g., \"facebook\", \"google\", \"twitter\")</li> <li><code>utm_medium</code>: Marketing medium (e.g., \"social\", \"email\", \"paid\", \"organic\")</li> <li><code>utm_campaign</code>: Campaign identifier (e.g., \"summer-2025\", campaign ID)</li> <li><code>utm_content</code>: Ad/content identifier (e.g., ad group ID, ad ID)</li> <li><code>utm_term</code>: Keyword (used for CPC campaigns)</li> <li><code>utm_placement</code>: Placement identifier (e.g., \"feed\", \"sidebar\")</li> <li><code>utm_plan</code>: Payment plan type (e.g., \"upfront\", \"isa\", \"scholarship\", \"financing\")</li> </ul> <p>All UTM parameters are optional. When provided, they are automatically appended to the destination URL during redirection.</p>"},{"location":"LLM-DOCS/MARKETING_SHORTCUTS/#privacy-and-access-control","title":"Privacy and Access Control","text":"<p>Private Links (<code>private=true</code>): - Only visible to users from the same academy - Not shown in listings from other academies - Can only be accessed/edited by academy members</p> <p>Public Links (<code>private=false</code>): - Visible in listings from all academies - Can be accessed by anyone with the URL - Still require proper permissions to edit/delete</p> <p>Access Control: - <code>read_shortlink</code>: Required to view short links - <code>crud_shortlink</code>: Required to create, update, or delete short links - Links are always scoped to an academy - Users can only manage links from their academy</p>"},{"location":"LLM-DOCS/MARKETING_SHORTCUTS/#best-practices","title":"Best Practices","text":"<ol> <li>Use Descriptive Slugs: When creating links, use meaningful slugs like <code>summer-promo-2025</code> instead of relying on auto-generated slugs</li> <li>Set UTM Parameters: Always set UTM parameters for proper campaign tracking in analytics tools</li> <li>Monitor Destination Status: Check <code>destination_status</code> regularly to ensure links are working</li> <li>Use Private Links for Internal Campaigns: Mark links as private if they're academy-specific</li> <li>Update Restrictions: Remember that links older than 1 day cannot be updated - create new links instead</li> <li>Validate Destinations: Ensure destination URLs are accessible and return valid HTTP status codes</li> </ol>"},{"location":"LLM-DOCS/MARKETING_SHORTCUTS/#error-handling","title":"Error Handling","text":"<p>Common error scenarios:</p> <ul> <li>Link Not Found: 404 when accessing <code>/s/&lt;slug&gt;</code> if link doesn't exist or is inactive</li> <li>Duplicate Slug: Validation error when creating a link with an existing slug</li> <li>Invalid Destination: Validation error when destination URL returns non-2xx status</li> <li>Update After 1 Day: Error when trying to update/delete links older than 1 day</li> <li>Permission Denied: 403 if user lacks required capabilities</li> <li>Academy Mismatch: Cannot access private links from other academies</li> </ul>"},{"location":"LLM-DOCS/MARKETING_SHORTCUTS/#monitoring","title":"Monitoring","text":"<p>The system includes automated monitoring for short links:</p> <ul> <li>Destination URLs are checked after each click</li> <li><code>destination_status</code> tracks whether URLs are accessible</li> <li>Monitoring scripts can alert on links with ERROR or NOT_FOUND status</li> <li>Historical click data (<code>hits</code>, <code>lastclick_at</code>) available for analytics</li> </ul>"},{"location":"LLM-DOCS/MARKETING_SHORTCUTS/#example-workflows","title":"Example Workflows","text":""},{"location":"LLM-DOCS/MARKETING_SHORTCUTS/#creating-a-campaign-link","title":"Creating a Campaign Link","text":"<pre><code>POST /v1/marketing/academy/short\n{\n    \"slug\": \"summer-bootcamp-2025\",\n    \"destination\": \"https://4geeksacademy.com/coding-bootcamps\",\n    \"utm_source\": \"facebook\",\n    \"utm_medium\": \"paid\",\n    \"utm_campaign\": \"summer-2025\",\n    \"utm_content\": \"ad-set-123\",\n    \"utm_term\": \"coding-bootcamp\",\n    \"private\": false,\n    \"active\": true,\n    \"course\": \"&lt;123:full-stack-bootcamp&gt;\",\n    \"plan\": \"&lt;789:4geeks-plus-subscription&gt;\",\n    \"purpose\": \"Summer 2025 enrollment campaign\",\n    \"notes\": \"Facebook ad campaign targeting 25-35 age group\"\n}\n</code></pre>"},{"location":"LLM-DOCS/MARKETING_SHORTCUTS/#listing-campaign-links","title":"Listing Campaign Links","text":"<pre><code>GET /v1/marketing/academy/short?sort=-hits&amp;private=false\n</code></pre> <p>Returns links sorted by most clicks first, showing only public links.</p>"},{"location":"LLM-DOCS/MARKETING_SHORTCUTS/#tracking-performance","title":"Tracking Performance","text":"<p>After links are used, check their performance:</p> <pre><code>GET /v1/marketing/academy/short\n</code></pre> <p>Review the <code>hits</code> and <code>lastclick_at</code> fields to see click statistics, and <code>destination_status</code> to ensure links are still working.</p>"},{"location":"LLM-DOCS/NOTIFICATION_REGISTRY/","title":"Notification Registry System","text":""},{"location":"LLM-DOCS/NOTIFICATION_REGISTRY/#overview","title":"Overview","text":"<p>The Notification Registry is a centralized system for managing notification templates in BreatheCode. It provides a JSON-based configuration system that documents notification templates across multiple channels (email, Slack, SMS) and makes them discoverable through API endpoints.</p>"},{"location":"LLM-DOCS/NOTIFICATION_REGISTRY/#purpose","title":"Purpose","text":"<ul> <li>Centralized Documentation: All notification templates are documented in one place with their variables, channels, and usage</li> <li>Template Discovery: Frontend can query available notification templates and their requirements</li> <li>Template Preview: Staff can preview notification templates with variables before sending</li> <li>Validation: Ensures notification templates are properly configured before use</li> <li>Multi-Channel Support: Single registry entry can define templates for email, Slack, and SMS</li> </ul>"},{"location":"LLM-DOCS/NOTIFICATION_REGISTRY/#how-it-works","title":"How It Works","text":""},{"location":"LLM-DOCS/NOTIFICATION_REGISTRY/#registry-structure","title":"Registry Structure","text":"<p>The notification registry consists of JSON files stored in <code>breathecode/notify/registry/</code>. Each file represents one notification template and must follow a specific schema.</p> <p>Key Principles: 1. One file per template: Each notification gets its own JSON file 2. Filename matches slug: File <code>message.json</code> must have <code>\"slug\": \"message\"</code> 3. Auto-discovery: Files are automatically loaded at startup 4. Multi-channel: One template can support multiple delivery channels</p>"},{"location":"LLM-DOCS/NOTIFICATION_REGISTRY/#loading-process","title":"Loading Process","text":"<p>When the application starts:</p> <ol> <li><code>EmailManager</code> scans <code>breathecode/notify/registry/</code> directory</li> <li>Loads all <code>.json</code> files</li> <li>Validates slug matches filename</li> <li>Caches templates in memory for fast access</li> <li>Logs any parsing errors or validation issues</li> </ol>"},{"location":"LLM-DOCS/NOTIFICATION_REGISTRY/#template-categories","title":"Template Categories","text":"<p>Templates are organized by category for easier discovery:</p> <ul> <li><code>authentication</code> - User verification and password reset</li> <li><code>academy</code> - Academy invitations and management</li> <li><code>general</code> - Generic messages and notifications</li> <li><code>feedback</code> - Surveys and NPS requests</li> <li><code>monitoring</code> - System diagnostics and alerts</li> </ul>"},{"location":"LLM-DOCS/NOTIFICATION_REGISTRY/#registry-json-schema","title":"Registry JSON Schema","text":"<p>Each notification template must follow this JSON structure:</p> <pre><code>{\n  \"slug\": \"template_slug\",\n  \"name\": \"Human Readable Name\",\n  \"description\": \"Detailed description of when and why this notification is sent\",\n  \"category\": \"authentication|academy|general|feedback|monitoring\",\n  \"channels\": {\n    \"email\": {\n      \"template_path\": \"template_file_name\",\n      \"default_subject\": \"Default email subject\"\n    },\n    \"slack\": {\n      \"template_path\": \"template_file_name\",\n      \"default_subject\": null\n    },\n    \"sms\": {\n      \"template_path\": \"template_file_name\"\n    }\n  },\n  \"variables\": [\n    {\n      \"name\": \"VARIABLE_NAME\",\n      \"description\": \"What this variable represents\",\n      \"source\": \"How/where this variable is generated\",\n      \"example\": \"Example value\",\n      \"required\": true\n    }\n  ]\n}\n</code></pre>"},{"location":"LLM-DOCS/NOTIFICATION_REGISTRY/#field-descriptions","title":"Field Descriptions","text":""},{"location":"LLM-DOCS/NOTIFICATION_REGISTRY/#root-level","title":"Root Level","text":"<ul> <li>slug (string, required): Unique identifier for the template. Must match filename without <code>.json</code></li> <li>name (string, required): Human-readable name displayed in UI</li> <li>description (string, required): Explains when and why this notification is sent</li> <li>category (string, required): Organizational category for filtering</li> </ul>"},{"location":"LLM-DOCS/NOTIFICATION_REGISTRY/#channels-object","title":"Channels Object","text":"<p>Each channel entry defines how the notification is delivered through that medium.</p> <p>Email Channel: <pre><code>\"email\": {\n  \"template_path\": \"message\",\n  \"default_subject\": \"Message from {academy_name}\"\n}\n</code></pre> - <code>template_path</code>: Name of template files (looks for <code>message.html</code> and <code>message.txt</code>) - <code>default_subject</code>: Default subject line, supports variable interpolation</p> <p>Slack Channel: <pre><code>\"slack\": {\n  \"template_path\": \"nps_survey\",\n  \"default_subject\": null\n}\n</code></pre> - <code>template_path</code>: Name of template file (looks for <code>nps_survey.slack</code>) - <code>default_subject</code>: Usually null for Slack</p> <p>SMS Channel: <pre><code>\"sms\": {\n  \"template_path\": \"verification_code\"\n}\n</code></pre> - <code>template_path</code>: Name of template file (looks for <code>verification_code.sms</code>)</p>"},{"location":"LLM-DOCS/NOTIFICATION_REGISTRY/#variables-array","title":"Variables Array","text":"<p>Documents all variables that can/must be passed to the template:</p> <pre><code>{\n  \"name\": \"SUBJECT\",\n  \"description\": \"Message subject/title\",\n  \"source\": \"Passed in data dict\",\n  \"example\": \"Important Update\",\n  \"required\": true\n}\n</code></pre> <ul> <li>name (string): Variable name as used in template (usually UPPERCASE)</li> <li>description (string): What this variable represents</li> <li>source (string): How/where this variable is generated in code</li> <li>example (string): Example value for testing/documentation</li> <li>required (boolean): Whether this variable must be provided</li> </ul>"},{"location":"LLM-DOCS/NOTIFICATION_REGISTRY/#built-in-variables","title":"Built-in Variables","text":"<p>All templates automatically have access to these default variables:</p> <ul> <li><code>API_URL</code> - Base API URL from environment</li> <li><code>COMPANY_NAME</code> - Company name from environment</li> <li><code>COMPANY_CONTACT_URL</code> - Contact URL from environment</li> <li><code>COMPANY_LEGAL_NAME</code> - Legal company name from environment</li> <li><code>COMPANY_ADDRESS</code> - Company address from environment</li> <li><code>style__success</code> - Success color <code>#99ccff</code></li> <li><code>style__danger</code> - Danger color <code>#ffcccc</code></li> <li><code>style__secondary</code> - Secondary color <code>#ededed</code></li> </ul> <p>When an academy is provided, these are also available:</p> <ul> <li><code>COMPANY_INFO_EMAIL</code> - Academy feedback email</li> <li><code>COMPANY_LEGAL_NAME</code> - Academy legal name or name</li> <li><code>COMPANY_LOGO</code> - Academy logo URL</li> <li><code>COMPANY_NAME</code> - Academy name</li> </ul>"},{"location":"LLM-DOCS/NOTIFICATION_REGISTRY/#api-endpoints","title":"API Endpoints","text":"<p>All notification registry endpoints require authentication and the <code>read_notification</code> capability.</p>"},{"location":"LLM-DOCS/NOTIFICATION_REGISTRY/#1-list-all-templates","title":"1. List All Templates","text":"<p>Endpoint: <code>GET /v1/notify/academy/template</code></p> <p>Description: Returns all registered notification templates with optional filtering.</p> <p>Headers: <pre><code>Authorization: Token &lt;user_token&gt;\nAcademy: &lt;academy_id&gt;\n</code></pre></p> <p>Query Parameters:</p> Parameter Type Description Example <code>category</code> string Filter by category <code>?category=authentication</code> <code>channel</code> string Filter by channel availability <code>?channel=email</code> <code>search</code> string Search in name/description <code>?search=verify</code> <p>Example Request: <pre><code>GET /v1/notify/academy/template?category=authentication&amp;channel=email\nAuthorization: Token abc123\nAcademy: 4\n</code></pre></p> <p>Response Schema: <pre><code>{\n  \"templates\": [\n    {\n      \"slug\": \"verify_email\",\n      \"name\": \"Verify Email\",\n      \"description\": \"Email verification for new user accounts...\",\n      \"category\": \"authentication\",\n      \"channels\": {\n        \"email\": {\n          \"template_path\": \"verify_email\",\n          \"default_subject\": \"Verify your email address\"\n        }\n      },\n      \"variables\": [...]\n    }\n  ],\n  \"categories\": [\"authentication\", \"academy\", \"general\", \"feedback\"],\n  \"total\": 1\n}\n</code></pre></p> <p>Status Codes: - <code>200 OK</code> - Templates retrieved successfully - <code>401 Unauthorized</code> - Missing or invalid authentication - <code>403 Forbidden</code> - User lacks <code>read_notification</code> capability</p>"},{"location":"LLM-DOCS/NOTIFICATION_REGISTRY/#2-get-template-details","title":"2. Get Template Details","text":"<p>Endpoint: <code>GET /v1/notify/academy/template/&lt;slug&gt;</code></p> <p>Description: Returns complete configuration for a specific notification template.</p> <p>Headers: <pre><code>Authorization: Token &lt;user_token&gt;\nAcademy: &lt;academy_id&gt;\n</code></pre></p> <p>Path Parameters:</p> Parameter Type Description <code>slug</code> string Template slug identifier <p>Example Request: <pre><code>GET /v1/notify/academy/template/verify_email\nAuthorization: Token abc123\nAcademy: 4\n</code></pre></p> <p>Response Schema: <pre><code>{\n  \"slug\": \"verify_email\",\n  \"name\": \"Verify Email\",\n  \"description\": \"Email verification for new user accounts to confirm email ownership\",\n  \"category\": \"authentication\",\n  \"channels\": {\n    \"email\": {\n      \"template_path\": \"verify_email\",\n      \"default_subject\": \"Verify your email address\"\n    }\n  },\n  \"variables\": [\n    {\n      \"name\": \"LINK\",\n      \"description\": \"Email verification URL with token\",\n      \"source\": \"Generated from API_URL + verification token\",\n      \"example\": \"https://api.4geeks.com/v1/auth/email/verify?token=xyz789abc\",\n      \"required\": true\n    },\n    {\n      \"name\": \"subject\",\n      \"description\": \"Email subject line\",\n      \"source\": \"Passed in data dict or uses default\",\n      \"example\": \"Verify your email address\",\n      \"required\": true\n    }\n  ]\n}\n</code></pre></p> <p>Status Codes: - <code>200 OK</code> - Template found and returned - <code>404 Not Found</code> - Template slug does not exist - <code>401 Unauthorized</code> - Missing or invalid authentication - <code>403 Forbidden</code> - User lacks <code>read_notification</code> capability</p> <p>Error Response: <pre><code>{\n  \"detail\": \"Notification template 'invalid_slug' not found\",\n  \"slug\": \"notification-not-found\",\n  \"status_code\": 404\n}\n</code></pre></p>"},{"location":"LLM-DOCS/NOTIFICATION_REGISTRY/#3-preview-template","title":"3. Preview Template","text":"<p>Endpoint: <code>GET /v1/notify/academy/template/&lt;slug&gt;/preview</code></p> <p>Description: Returns both raw template source code and fully rendered HTML/text with schema-driven placeholders. The rendered version includes complete template structure (including parent templates like <code>base.html</code>) with variables shown as <code>{VARIABLE_NAME}</code> placeholders, making it easy for frontend to display the complete email layout while still seeing where each variable will be inserted.</p> <p>Headers: <pre><code>Authorization: Token &lt;user_token&gt;\nAcademy: &lt;academy_id&gt;\n</code></pre></p> <p>Path Parameters:</p> Parameter Type Description <code>slug</code> string Template slug identifier <p>Query Parameters:</p> Parameter Type Description Example <code>channels</code> string Comma-separated list of channels to preview <code>?channels=email,slack</code> <p>Example Request: <pre><code>GET /v1/notify/academy/template/message/preview?channels=email\nAuthorization: Token abc123\nAcademy: 4\n</code></pre></p> <p>Response Schema: <pre><code>{\n  \"slug\": \"message\",\n  \"name\": \"Generic Message\",\n  \"description\": \"Generic notification template for sending custom messages...\",\n  \"category\": \"general\",\n  \"channels\": {\n    \"email\": {\n      \"html_source\": \"{% extends \\\"base.html\\\" %}\\n{% block content %}...\",\n      \"html_rendered\": \"&lt;!DOCTYPE html&gt;\\n&lt;html&gt;...\\n{MESSAGE}\\n...&lt;/html&gt;\",\n      \"text_source\": \"{{ MESSAGE }}\\n\\n{{ BUTTON }}: {{ LINK }}\",\n      \"text_rendered\": \"{MESSAGE}\\n\\n{BUTTON}: {LINK}\",\n      \"subject\": \"Message from {academy_name}\"\n    }\n  },\n  \"variables\": {\n    \"default\": {\n      \"API_URL\": {\n        \"description\": \"Base API URL for tracking pixels and API calls\",\n        \"source\": \"Environment variable API_URL\",\n        \"example\": \"https://api.4geeks.com\",\n        \"required\": false,\n        \"type\": \"system_default\"\n      },\n      \"COMPANY_NAME\": {\n        \"description\": \"Company name used in email templates\",\n        \"source\": \"Environment variable COMPANY_NAME\",\n        \"example\": \"4Geeks\",\n        \"required\": false,\n        \"type\": \"system_default\"\n      },\n      \"COMPANY_CONTACT_URL\": {\n        \"description\": \"URL to company contact page\",\n        \"source\": \"Environment variable COMPANY_CONTACT_URL\",\n        \"example\": \"https://4geeks.com/contact\",\n        \"required\": false,\n        \"type\": \"system_default\"\n      },\n      \"style__success\": {\n        \"description\": \"Success color for buttons and highlights\",\n        \"source\": \"System default CSS color\",\n        \"example\": \"#99ccff\",\n        \"required\": false,\n        \"type\": \"system_default\"\n      },\n      \"style__danger\": {\n        \"description\": \"Danger/warning color for alerts\",\n        \"source\": \"System default CSS color\",\n        \"example\": \"#ffcccc\",\n        \"required\": false,\n        \"type\": \"system_default\"\n      }\n    },\n    \"template_specific\": {\n      \"SUBJECT\": {\n        \"description\": \"Message subject/title\",\n        \"source\": \"Passed in data dict\",\n        \"example\": \"Important Update\",\n        \"required\": true,\n        \"type\": \"template_variable\"\n      },\n      \"MESSAGE\": {\n        \"description\": \"Main message content (supports HTML)\",\n        \"source\": \"Passed in data dict\",\n        \"example\": \"Your cohort schedule has been updated.\",\n        \"required\": true,\n        \"type\": \"template_variable\"\n      }\n    },\n    \"academy_specific\": {\n      \"COMPANY_NAME\": {\n        \"description\": \"Academy name (overrides system default)\",\n        \"source\": \"Academy.name model field\",\n        \"example\": \"Miami Academy\",\n        \"required\": false,\n        \"type\": \"academy_field\"\n      },\n      \"COMPANY_LOGO\": {\n        \"description\": \"Academy logo URL for email headers\",\n        \"source\": \"Academy.logo_url model field\",\n        \"example\": \"https://storage.googleapis.com/logos/miami.png\",\n        \"required\": false,\n        \"type\": \"academy_field\"\n      },\n      \"COMPANY_INFO_EMAIL\": {\n        \"description\": \"Academy feedback/info email (overrides system default)\",\n        \"source\": \"Academy.feedback_email model field\",\n        \"example\": \"info@miami.4geeks.com\",\n        \"required\": false,\n        \"type\": \"academy_field\"\n      }\n    }\n  },\n  \"preview_context\": {\n    \"API_URL\": \"{API_URL}\",\n    \"COMPANY_NAME\": \"{COMPANY_NAME}\",\n    \"COMPANY_CONTACT_URL\": \"{COMPANY_CONTACT_URL}\",\n    \"COMPANY_LEGAL_NAME\": \"{COMPANY_LEGAL_NAME}\",\n    \"COMPANY_ADDRESS\": \"{COMPANY_ADDRESS}\",\n    \"COMPANY_INFO_EMAIL\": \"{COMPANY_INFO_EMAIL}\",\n    \"COMPANY_LOGO\": \"{COMPANY_LOGO}\",\n    \"style__success\": \"#99ccff\",\n    \"style__danger\": \"#ffcccc\",\n    \"style__secondary\": \"#ededed\",\n    \"SUBJECT\": \"{SUBJECT}\",\n    \"MESSAGE\": \"{MESSAGE}\",\n    \"BUTTON\": \"{BUTTON}\",\n    \"LINK\": \"{LINK}\",\n    \"subject\": \"{subject}\"\n  }\n}\n</code></pre></p> <p>Note on Variables Field:</p> <p>The <code>variables</code> field in the preview response contains schema/metadata for all variables (description, source, example, type), not actual values. This provides documentation about what variables are available and how they're used.</p> <p>To get actual current values for variables (including system defaults, academy model values, and overrides), use the <code>/v1/notify/academy/variables</code> endpoint instead.</p> <p>Channel-Specific Responses:</p> <p>Email Channel: <pre><code>\"email\": {\n  \"html_source\": \"{% extends \\\"base.html\\\" %}...\",\n  \"html_rendered\": \"&lt;!DOCTYPE html&gt;...&lt;h1&gt;{SUBJECT}&lt;/h1&gt;...\",\n  \"text_source\": \"{{ MESSAGE }}...\",\n  \"text_rendered\": \"{MESSAGE}...\",\n  \"subject\": \"Default subject\"\n}\n</code></pre> - <code>html_source</code>: Raw child template code (Django template syntax) - <code>html_rendered</code>: Complete HTML including parent templates with <code>{VARIABLE}</code> placeholders - <code>text_source</code>: Raw text template code - <code>text_rendered</code>: Complete text with <code>{VARIABLE}</code> placeholders</p> <p>Slack Channel: <pre><code>\"slack\": {\n  \"source\": \"{\\n  \\\"blocks\\\": [...]\\n}\",\n  \"rendered\": \"{\\\"text\\\": \\\"{SUBJECT}\\\"}\",\n  \"format\": \"json\"\n}\n</code></pre></p> <p>SMS Channel: <pre><code>\"sms\": {\n  \"source\": \"{{ MESSAGE }}\",\n  \"rendered\": \"{MESSAGE}\"\n}\n</code></pre></p> <p>Status Codes: - <code>200 OK</code> - Preview generated successfully - <code>404 Not Found</code> - Template slug does not exist - <code>500 Internal Server Error</code> - Error rendering template - <code>401 Unauthorized</code> - Missing or invalid authentication - <code>403 Forbidden</code> - User lacks <code>read_notification</code> capability</p> <p>Error Response: <pre><code>{\n  \"detail\": \"Error generating preview: Template not found\",\n  \"slug\": \"preview-error\",\n  \"status_code\": 500\n}\n</code></pre></p>"},{"location":"LLM-DOCS/NOTIFICATION_REGISTRY/#example-templates","title":"Example Templates","text":""},{"location":"LLM-DOCS/NOTIFICATION_REGISTRY/#example-1-simple-email-notification","title":"Example 1: Simple Email Notification","text":"<p>File: <code>breathecode/notify/registry/welcome_academy.json</code></p> <pre><code>{\n  \"slug\": \"welcome_academy\",\n  \"name\": \"Welcome to Academy\",\n  \"description\": \"Sent when a user is successfully added to an academy\",\n  \"category\": \"academy\",\n  \"channels\": {\n    \"email\": {\n      \"template_path\": \"welcome_academy\",\n      \"default_subject\": \"Welcome to {academy_name}\"\n    }\n  },\n  \"variables\": [\n    {\n      \"name\": \"user\",\n      \"description\": \"Serialized user object with first_name, last_name, email\",\n      \"source\": \"UserSmallSerializer(user).data\",\n      \"example\": \"{\\\"first_name\\\": \\\"John\\\"}\",\n      \"required\": true\n    },\n    {\n      \"name\": \"LINK\",\n      \"description\": \"URL to academy dashboard\",\n      \"source\": \"Generated from academy dashboard URL\",\n      \"example\": \"https://app.4geeks.com/academy/dashboard\",\n      \"required\": true\n    }\n  ]\n}\n</code></pre>"},{"location":"LLM-DOCS/NOTIFICATION_REGISTRY/#example-2-multi-channel-notification","title":"Example 2: Multi-Channel Notification","text":"<p>File: <code>breathecode/notify/registry/nps_survey.json</code></p> <pre><code>{\n  \"slug\": \"nps_survey\",\n  \"name\": \"NPS Survey\",\n  \"description\": \"Net Promoter Score survey request sent to users for feedback\",\n  \"category\": \"feedback\",\n  \"channels\": {\n    \"email\": {\n      \"template_path\": \"nps_survey\",\n      \"default_subject\": \"How was your experience?\"\n    },\n    \"slack\": {\n      \"template_path\": \"nps_survey\",\n      \"default_subject\": null\n    }\n  },\n  \"variables\": [\n    {\n      \"name\": \"SUBJECT\",\n      \"description\": \"Survey subject/question\",\n      \"source\": \"Passed in data dict\",\n      \"example\": \"How was your experience with this cohort?\",\n      \"required\": true\n    },\n    {\n      \"name\": \"LINK\",\n      \"description\": \"URL to the survey form\",\n      \"source\": \"Generated survey response URL with token\",\n      \"example\": \"https://app.4geeks.com/feedback/survey?token=survey123\",\n      \"required\": true\n    },\n    {\n      \"name\": \"BUTTON\",\n      \"description\": \"Button text for call-to-action\",\n      \"source\": \"Passed in data dict or uses default\",\n      \"example\": \"Take Survey\",\n      \"required\": false\n    }\n  ]\n}\n</code></pre>"},{"location":"LLM-DOCS/NOTIFICATION_REGISTRY/#example-3-complex-variables","title":"Example 3: Complex Variables","text":"<p>File: <code>breathecode/notify/registry/academy_invite.json</code></p> <pre><code>{\n  \"slug\": \"academy_invite\",\n  \"name\": \"Academy Invitation\",\n  \"description\": \"Sent when a user is invited to join an academy\",\n  \"category\": \"academy\",\n  \"channels\": {\n    \"email\": {\n      \"template_path\": \"academy_invite\",\n      \"default_subject\": \"You've been invited to join an academy\"\n    }\n  },\n  \"variables\": [\n    {\n      \"name\": \"user\",\n      \"description\": \"Serialized user object\",\n      \"source\": \"UserSmallSerializer(user).data\",\n      \"example\": \"{\\\"first_name\\\": \\\"John\\\", \\\"last_name\\\": \\\"Doe\\\"}\",\n      \"required\": true\n    },\n    {\n      \"name\": \"LINK\",\n      \"description\": \"Base URL for accepting/rejecting invitations\",\n      \"source\": \"Generated invitation management URL\",\n      \"example\": \"https://app.4geeks.com/invite/manage\",\n      \"required\": true\n    },\n    {\n      \"name\": \"invites\",\n      \"description\": \"List of academy invitation objects\",\n      \"source\": \"ProfileAcademy invitation records\",\n      \"example\": \"[{academy: {name: 'Miami'}, role: 'STUDENT', id: 123}]\",\n      \"required\": true\n    }\n  ]\n}\n</code></pre>"},{"location":"LLM-DOCS/NOTIFICATION_REGISTRY/#frontend-integration","title":"Frontend Integration","text":""},{"location":"LLM-DOCS/NOTIFICATION_REGISTRY/#discovering-available-templates","title":"Discovering Available Templates","text":"<p>Use the list endpoint to discover what notification templates are available:</p> <pre><code>// Fetch all authentication-related templates\nconst response = await fetch('/v1/notify/academy/template?category=authentication', {\n  headers: {\n    'Authorization': 'Token abc123',\n    'Academy': '4'\n  }\n});\n\nconst data = await response.json();\n// data.templates - array of available templates\n// data.categories - list of all categories\n// data.total - count of matching templates\n</code></pre>"},{"location":"LLM-DOCS/NOTIFICATION_REGISTRY/#getting-template-requirements","title":"Getting Template Requirements","text":"<p>Before sending a notification, fetch template details to know what variables are required:</p> <pre><code>const response = await fetch('/v1/notify/academy/template/verify_email', {\n  headers: {\n    'Authorization': 'Token abc123',\n    'Academy': '4'\n  }\n});\n\nconst template = await response.json();\n\n// Extract required variables\nconst requiredVars = template.variables\n  .filter(v =&gt; v.required)\n  .map(v =&gt; v.name);\n\nconsole.log('Required variables:', requiredVars);\n// ['LINK', 'subject']\n</code></pre>"},{"location":"LLM-DOCS/NOTIFICATION_REGISTRY/#previewing-templates","title":"Previewing Templates","text":"<p>Preview templates to see both raw source and rendered HTML with placeholders:</p> <pre><code>const response = await fetch(\n  '/v1/notify/academy/template/message/preview?channels=email',\n  {\n    headers: {\n      'Authorization': 'Token abc123',\n      'Academy': '4'\n    }\n  }\n);\n\nconst preview = await response.json();\n\n// Display fully rendered HTML (includes base template with {VARIABLE} placeholders)\ndocument.getElementById('preview').innerHTML = preview.channels.email.html_rendered;\n// Shows: &lt;html&gt;...&lt;h1&gt;{SUBJECT}&lt;/h1&gt;&lt;div&gt;{MESSAGE}&lt;/div&gt;...&lt;/html&gt;\n\n// Or show raw source code (child template only)\ndocument.getElementById('source').textContent = preview.channels.email.html_source;\n// Shows: {% extends \"base.html\" %}{% block content %}...\n\n// Parse variables from rendered HTML if needed\nconst variableMatches = preview.channels.email.html_rendered.match(/{(\\w+)}/g);\nconsole.log('Variables in template:', variableMatches);\n// Output: ['{SUBJECT}', '{MESSAGE}', '{BUTTON}', '{LINK}']\n\n// Get variable documentation\nconsole.log(preview.variables.template_specific);\n\n// See what placeholder values were used\nconsole.log(preview.preview_context);\n</code></pre>"},{"location":"LLM-DOCS/NOTIFICATION_REGISTRY/#building-template-selection-ui","title":"Building Template Selection UI","text":"<p>Example React component:</p> <pre><code>function TemplateSelector({ category, onSelect }) {\n  const [templates, setTemplates] = useState([]);\n\n  useEffect(() =&gt; {\n    fetch(`/v1/notify/academy/template?category=${category}`, {\n      headers: {\n        'Authorization': `Token ${token}`,\n        'Academy': academyId\n      }\n    })\n    .then(r =&gt; r.json())\n    .then(data =&gt; setTemplates(data.templates));\n  }, [category]);\n\n  return (\n    &lt;select onChange={(e) =&gt; onSelect(e.target.value)}&gt;\n      {templates.map(t =&gt; (\n        &lt;option key={t.slug} value={t.slug}&gt;\n          {t.name} - {t.description}\n        &lt;/option&gt;\n      ))}\n    &lt;/select&gt;\n  );\n}\n</code></pre>"},{"location":"LLM-DOCS/NOTIFICATION_REGISTRY/#schema-driven-placeholder-generation","title":"Schema-Driven Placeholder Generation","text":"<p>The preview endpoint intelligently generates placeholders based on the variable definitions in the registry JSON files. This ensures that complex object and array structures are properly represented.</p>"},{"location":"LLM-DOCS/NOTIFICATION_REGISTRY/#how-it-works_1","title":"How It Works","text":"<p>The system uses multiple strategies to determine the correct placeholder structure:</p>"},{"location":"LLM-DOCS/NOTIFICATION_REGISTRY/#1-json-example-parsing","title":"1. JSON Example Parsing","text":"<p>If the variable has a valid JSON example, it's parsed and converted to placeholders:</p> <p>Registry Definition: <pre><code>{\n  \"name\": \"user\",\n  \"example\": \"{\\\"first_name\\\": \\\"John\\\", \\\"last_name\\\": \\\"Doe\\\", \\\"email\\\": \\\"john@example.com\\\"}\"\n}\n</code></pre></p> <p>Generated Placeholder: <pre><code>{\n  \"first_name\": \"{user.first_name}\",\n  \"last_name\": \"{user.last_name}\",\n  \"email\": \"{user.email}\"\n}\n</code></pre></p> <p>Rendered Output: <pre><code>Hi {user.first_name}, welcome!\n</code></pre></p>"},{"location":"LLM-DOCS/NOTIFICATION_REGISTRY/#2-array-structure-inference","title":"2. Array Structure Inference","text":"<p>For arrays, the system parses the example to extract object properties:</p> <p>Registry Definition: <pre><code>{\n  \"name\": \"invites\",\n  \"example\": \"[{academy: {name: 'Miami Academy'}, role: 'STUDENT', id: 123}]\"\n}\n</code></pre></p> <p>Generated Placeholder: <pre><code>[\n  {\n    \"academy\": {\"name\": \"{invites[0].academy.name}\"},\n    \"role\": \"{invites[0].role}\",\n    \"id\": \"{invites[0].id}\"\n  }\n]\n</code></pre></p> <p>Rendered Output: <pre><code>{% for invite in invites %}\n  &lt;p&gt;{invites[0].academy.name}&lt;/p&gt;\n  &lt;small&gt;Role: {invites[0].role}&lt;/small&gt;\n{% endfor %}\n</code></pre></p>"},{"location":"LLM-DOCS/NOTIFICATION_REGISTRY/#3-description-analysis","title":"3. Description Analysis","text":"<p>If no JSON example exists, the system analyzes the description for property hints:</p> <p>Registry Definition: <pre><code>{\n  \"name\": \"user\",\n  \"description\": \"Serialized user object (template accesses user.first_name)\"\n}\n</code></pre></p> <p>Extracts <code>first_name</code> and generates <code>{user.first_name}</code> placeholder.</p>"},{"location":"LLM-DOCS/NOTIFICATION_REGISTRY/#4-serializer-detection","title":"4. Serializer Detection","text":"<p>Recognizes common serializer patterns in the source field:</p> <p>Registry Definition: <pre><code>{\n  \"name\": \"user\",\n  \"source\": \"UserSmallSerializer(user).data\"\n}\n</code></pre></p> <p>Generates standard user object structure: <pre><code>{\n  \"id\": \"{user.id}\",\n  \"first_name\": \"{user.first_name}\",\n  \"last_name\": \"{user.last_name}\",\n  \"email\": \"{user.email}\"\n}\n</code></pre></p>"},{"location":"LLM-DOCS/NOTIFICATION_REGISTRY/#5-simple-string-fallback","title":"5. Simple String Fallback","text":"<p>For simple variables without structure, uses direct placeholder:</p> <p>Registry Definition: <pre><code>{\n  \"name\": \"SUBJECT\",\n  \"example\": \"Important Update\"\n}\n</code></pre></p> <p>Generated Placeholder: <pre><code>\"{SUBJECT}\"\n</code></pre></p>"},{"location":"LLM-DOCS/NOTIFICATION_REGISTRY/#benefits","title":"Benefits","text":"<ul> <li>\u2705 Automatic Structure Detection: No manual placeholder configuration needed</li> <li>\u2705 Complete HTML Preview: Includes parent templates (like <code>base.html</code>)</li> <li>\u2705 Frontend-Friendly Format: Easy to parse <code>{VARIABLE}</code> format</li> <li>\u2705 Type Safety: Complex objects maintain their structure</li> <li>\u2705 Self-Documenting: Placeholders show exact variable access patterns</li> <li>\u2705 All Variables Visible: Both parent and child template variables shown as placeholders</li> </ul>"},{"location":"LLM-DOCS/NOTIFICATION_REGISTRY/#important-note-on-default-variables","title":"Important Note on Default Variables","text":"<p>All variables use placeholders in preview, including system defaults like <code>COMPANY_NAME</code>, <code>COMPANY_LOGO</code>, etc.</p> <p>This ensures: - Variables in parent templates (like <code>base.html</code>) are visible as <code>{COMPANY_LOGO}</code> - Variables with Django filters like <code>{{ COMPANY_NAME|default:'4Geeks' }}</code> show as <code>{COMPANY_NAME}</code> - Frontend can see every variable position in the complete rendered HTML - No confusion between actual content and placeholders</p> <p>Exception: CSS style variables (<code>style__success</code>, <code>style__danger</code>, <code>style__secondary</code>) use actual hex values so the preview displays with correct styling.</p>"},{"location":"LLM-DOCS/NOTIFICATION_REGISTRY/#common-use-cases","title":"Common Use Cases","text":""},{"location":"LLM-DOCS/NOTIFICATION_REGISTRY/#1-template-discovery-dashboard","title":"1. Template Discovery Dashboard","text":"<p>Build a UI that shows all available notification templates organized by category:</p> <pre><code>GET /v1/notify/academy/template\n\u2192 Display templates grouped by category\n\u2192 Show channel availability icons (\ud83d\udce7 email, \ud83d\udcac slack, \ud83d\udcf1 sms)\n</code></pre>"},{"location":"LLM-DOCS/NOTIFICATION_REGISTRY/#2-template-testing-interface","title":"2. Template Testing Interface","text":"<p>Allow staff to preview and test notification templates:</p> <pre><code>GET /v1/notify/academy/template/&lt;slug&gt;/preview\n\u2192 Show raw template source\n\u2192 Display variable requirements\n\u2192 Provide form to input test values\n</code></pre>"},{"location":"LLM-DOCS/NOTIFICATION_REGISTRY/#3-dynamic-form-generation","title":"3. Dynamic Form Generation","text":"<p>Build forms dynamically based on template requirements:</p> <pre><code>// 1. Fetch template details\nGET /v1/notify/academy/template/message\n\n// 2. Extract variables\nconst fields = template.variables.filter(v =&gt; v.required);\n\n// 3. Generate form fields\nfields.forEach(field =&gt; {\n  createFormField(field.name, field.description, field.example);\n});\n</code></pre>"},{"location":"LLM-DOCS/NOTIFICATION_REGISTRY/#4-notification-documentation","title":"4. Notification Documentation","text":"<p>Generate human-readable documentation of all notifications:</p> <pre><code>GET /v1/notify/academy/template\n\u2192 For each template, display:\n  - Name and description\n  - Supported channels\n  - Required and optional variables\n  - Example values\n</code></pre>"},{"location":"LLM-DOCS/NOTIFICATION_REGISTRY/#best-practices","title":"Best Practices","text":""},{"location":"LLM-DOCS/NOTIFICATION_REGISTRY/#for-backend-developers","title":"For Backend Developers","text":"<ol> <li>Always Register New Templates: Before sending a notification, create its registry JSON file</li> <li>Match Slug to Filename: <code>message.json</code> must have <code>\"slug\": \"message\"</code></li> <li>Document All Variables: Include description, source, and example for each variable</li> <li>Use Descriptive Categories: Choose appropriate category for easier discovery</li> <li>Provide Examples: Include realistic example values for testing</li> </ol>"},{"location":"LLM-DOCS/NOTIFICATION_REGISTRY/#for-frontend-developers","title":"For Frontend Developers","text":"<ol> <li>Check Template Availability: Query templates before building notification UI</li> <li>Validate Required Variables: Ensure all required variables are provided</li> <li>Handle Missing Templates: Gracefully handle 404 responses</li> <li>Cache Template Lists: Templates don't change frequently, cache the list</li> <li>Show Variable Documentation: Display examples and descriptions to users</li> </ol>"},{"location":"LLM-DOCS/NOTIFICATION_REGISTRY/#for-creating-new-templates","title":"For Creating New Templates","text":"<p>Step 1: Create JSON registry file</p> <pre><code>touch breathecode/notify/registry/my_notification.json\n</code></pre> <p>Step 2: Define template configuration</p> <pre><code>{\n  \"slug\": \"my_notification\",\n  \"name\": \"My Notification\",\n  \"description\": \"Detailed description of when this is sent\",\n  \"category\": \"general\",\n  \"channels\": {\n    \"email\": {\n      \"template_path\": \"my_notification\",\n      \"default_subject\": \"Notification Subject\"\n    }\n  },\n  \"variables\": [\n    {\n      \"name\": \"VARIABLE_NAME\",\n      \"description\": \"What it represents\",\n      \"source\": \"Where it comes from\",\n      \"example\": \"Example value\",\n      \"required\": true\n    }\n  ]\n}\n</code></pre> <p>Step 3: Create template files</p> <pre><code>touch breathecode/notify/templates/my_notification.html\ntouch breathecode/notify/templates/my_notification.txt\n</code></pre> <p>Step 4: Restart server to load new template</p> <pre><code># Registry is loaded at startup\n</code></pre>"},{"location":"LLM-DOCS/NOTIFICATION_REGISTRY/#troubleshooting","title":"Troubleshooting","text":""},{"location":"LLM-DOCS/NOTIFICATION_REGISTRY/#template-not-found","title":"Template Not Found","text":"<p>Error: <code>\"Notification template 'xyz' not found\"</code></p> <p>Solutions: 1. Verify JSON file exists: <code>breathecode/notify/registry/xyz.json</code> 2. Check slug matches filename: <code>\"slug\": \"xyz\"</code> in JSON 3. Restart server to reload registry 4. Check logs for parsing errors</p>"},{"location":"LLM-DOCS/NOTIFICATION_REGISTRY/#template-validation-fails","title":"Template Validation Fails","text":"<p>Error: <code>\"Slug mismatch in xyz.json: expected abc.json\"</code></p> <p>Solution: Update slug in JSON to match filename: <pre><code>{\n  \"slug\": \"xyz\",  // Must match filename xyz.json\n  ...\n}\n</code></pre></p>"},{"location":"LLM-DOCS/NOTIFICATION_REGISTRY/#missing-variables","title":"Missing Variables","text":"<p>Error: Template renders with empty/missing values</p> <p>Solution: Check template registry for required variables: <pre><code>GET /v1/notify/academy/template/template_name\n# Review variables array for required: true\n</code></pre></p>"},{"location":"LLM-DOCS/NOTIFICATION_REGISTRY/#preview-returns-error","title":"Preview Returns Error","text":"<p>Error: <code>\"Error generating preview: Template not found\"</code></p> <p>Solutions: 1. Verify template files exist in <code>breathecode/notify/templates/</code> 2. Check <code>template_path</code> in registry matches file name 3. Ensure channel configuration is correct</p>"},{"location":"LLM-DOCS/NOTIFICATION_REGISTRY/#academy-notification-settings","title":"Academy Notification Settings","text":""},{"location":"LLM-DOCS/NOTIFICATION_REGISTRY/#overview_1","title":"Overview","text":"<p>Academy Notification Settings allow each academy to customize notification templates without code changes. Academies can override variables globally or per-template, with support for variable interpolation.</p>"},{"location":"LLM-DOCS/NOTIFICATION_REGISTRY/#purpose_1","title":"Purpose","text":"<ul> <li>Per-Academy Customization: Each academy has full control over notification content</li> <li>No Code Changes Required: Customize through API or Django Admin</li> <li>Variable Override Priority: Academy settings override code defaults</li> <li>Variable Interpolation: Reuse variables within other variables</li> </ul>"},{"location":"LLM-DOCS/NOTIFICATION_REGISTRY/#model-structure","title":"Model Structure","text":"<p>Each academy can have one <code>AcademyNotifySettings</code> instance with the following fields:</p>"},{"location":"LLM-DOCS/NOTIFICATION_REGISTRY/#fields","title":"Fields","text":"<ul> <li>template_variables (JSONField): Variable overrides for notification templates</li> <li>Format: <code>{\"template.SLUG.VARIABLE\": \"value\", \"global.VARIABLE\": \"value\"}</code></li> <li> <p>Supports interpolation with <code>{{variable}}</code> syntax</p> </li> <li> <p>disabled_templates (JSONField): List of template slugs to disable</p> </li> <li>Format: <code>[\"template_slug1\", \"template_slug2\"]</code></li> <li>Disabled templates won't send (silently skipped)</li> </ul> <p>Variable Override Priority: 1. Academy template-specific override (<code>template.SLUG.VARIABLE</code>) - highest 2. Academy global override (<code>global.VARIABLE</code>) 3. Code context from <code>send_email_message</code> call (data dict) 4. Academy model fields (academy.name, academy.logo_url, etc.) 5. System defaults (environment variables) - lowest</p> <p>Important: Academy <code>template_variables</code> overrides take priority over academy model fields, allowing full customization even for fields like <code>COMPANY_NAME</code> that are typically set from <code>academy.name</code>.</p>"},{"location":"LLM-DOCS/NOTIFICATION_REGISTRY/#api-endpoints_1","title":"API Endpoints","text":""},{"location":"LLM-DOCS/NOTIFICATION_REGISTRY/#get-available-variables","title":"Get Available Variables","text":"<p>Endpoint: <code>GET /v1/notify/academy/variables</code></p> <p>Description: Returns all available variables including system defaults, academy model values, and current overrides. Optionally shows final merged values for a specific template.</p> <p>Permission: Requires <code>read_notification</code> capability</p> <p>Headers: <pre><code>Authorization: Token &lt;user_token&gt;\nAcademy: &lt;academy_id&gt;\n</code></pre></p> <p>Query Parameters:</p> Parameter Type Description Example <code>template</code> string Optional template slug to show final merged values <code>?template=welcome_academy</code> <p>Example Request (without template): <pre><code>GET /v1/notify/academy/variables\nAuthorization: Token abc123\nAcademy: 4\n</code></pre></p> <p>Response: <pre><code>{\n  \"system_defaults\": {\n    \"API_URL\": \"https://api.4geeks.com\",\n    \"COMPANY_NAME\": \"4Geeks\",\n    \"COMPANY_CONTACT_URL\": \"https://4geeks.com/contact\",\n    \"COMPANY_LEGAL_NAME\": \"4Geeks LLC\",\n    \"COMPANY_ADDRESS\": \"\",\n    \"COMPANY_INFO_EMAIL\": \"info@4geeks.com\",\n    \"style__success\": \"#99ccff\",\n    \"style__danger\": \"#ffcccc\",\n    \"style__secondary\": \"#ededed\"\n  },\n  \"academy_values\": {\n    \"COMPANY_NAME\": \"Miami Academy\",\n    \"COMPANY_LOGO\": \"https://storage.googleapis.com/logos/miami.png\",\n    \"COMPANY_INFO_EMAIL\": \"info@miami.4geeks.com\",\n    \"COMPANY_LEGAL_NAME\": \"Miami Academy LLC\",\n    \"PLATFORM_DESCRIPTION\": \"A premium coding bootcamp in Miami\"\n  },\n  \"global_overrides\": {\n    \"COMPANY_NAME\": \"4Geeks Miami Campus\"\n  },\n  \"template_specific_overrides\": {\n    \"welcome_academy\": {\n      \"subject\": \"Welcome to Miami!\",\n      \"MESSAGE\": \"Custom welcome message\"\n    },\n    \"verify_email\": {\n      \"subject\": \"Verify your account\"\n    }\n  }\n}\n</code></pre></p> <p>Example Request (with template): <pre><code>GET /v1/notify/academy/variables?template=welcome_academy\nAuthorization: Token abc123\nAcademy: 4\n</code></pre></p> <p>Response: <pre><code>{\n  \"system_defaults\": { ... },\n  \"academy_values\": { ... },\n  \"global_overrides\": {\n    \"COMPANY_NAME\": \"4Geeks Miami Campus\"\n  },\n  \"template_specific_overrides\": {\n    \"welcome_academy\": {\n      \"subject\": \"Welcome to Miami!\",\n      \"MESSAGE\": \"Custom message\"\n    },\n    \"verify_email\": {\n      \"subject\": \"Verify your account\"\n    }\n  },\n  \"resolved_for_template\": {\n    \"COMPANY_NAME\": \"4Geeks Miami Campus\",\n    \"subject\": \"Welcome to Miami!\",\n    \"MESSAGE\": \"Custom message\"\n  },\n  \"template_disabled\": false,\n  \"final_values\": {\n    \"API_URL\": \"https://api.4geeks.com\",\n    \"COMPANY_NAME\": \"4Geeks Miami Campus\",\n    \"COMPANY_LOGO\": \"https://storage.googleapis.com/logos/miami.png\",\n    \"COMPANY_INFO_EMAIL\": \"info@miami.4geeks.com\",\n    \"COMPANY_LEGAL_NAME\": \"Miami Academy LLC\",\n    \"PLATFORM_DESCRIPTION\": \"A premium coding bootcamp in Miami\",\n    \"subject\": \"Welcome to Miami!\",\n    \"MESSAGE\": \"Custom message\",\n    \"style__success\": \"#99ccff\"\n  }\n}\n</code></pre></p> <p>Note: The response always includes <code>template_specific_overrides</code> showing all template-level overrides organized by template slug. When <code>?template=</code> is specified, additional fields <code>resolved_for_template</code>, <code>template_disabled</code>, and <code>final_values</code> are included.</p> <p>Use Cases: - Show users what variables are available for customization - Display current effective values for variables - Help debug why certain values appear in emails - Build UI for variable override management</p> <p>Status Codes: - <code>200 OK</code> - Variables retrieved successfully - <code>401 Unauthorized</code> - Missing or invalid authentication - <code>403 Forbidden</code> - User lacks <code>read_notification</code> capability - <code>404 Not Found</code> - Academy not found</p>"},{"location":"LLM-DOCS/NOTIFICATION_REGISTRY/#get-academy-settings","title":"Get Academy Settings","text":"<p>Endpoint: <code>GET /v1/notify/academy/settings</code></p> <p>Permission: Requires <code>read_notification</code> capability</p> <p>Headers: <pre><code>Authorization: Token &lt;user_token&gt;\nAcademy: &lt;academy_id&gt;\n</code></pre></p> <p>Response (no settings): <pre><code>{\n  \"template_variables\": {},\n  \"disabled_templates\": [],\n  \"academy\": 4\n}\n</code></pre></p> <p>Response (with settings): <pre><code>{\n  \"academy\": 4,\n  \"template_variables\": {\n    \"template.welcome_academy.subject\": \"\u00a1Bienvenido!\",\n    \"global.COMPANY_NAME\": \"Miami Academy\"\n  },\n  \"disabled_templates\": [\"nps_survey\"],\n  \"created_at\": \"2024-01-01T00:00:00Z\",\n  \"updated_at\": \"2024-01-02T00:00:00Z\"\n}\n</code></pre></p>"},{"location":"LLM-DOCS/NOTIFICATION_REGISTRY/#update-academy-settings","title":"Update Academy Settings","text":"<p>Endpoint: <code>PUT /v1/notify/academy/settings</code></p> <p>Permission: Requires <code>crud_notification</code> capability</p> <p>Headers: <pre><code>Authorization: Token &lt;user_token&gt;\nAcademy: &lt;academy_id&gt;\nContent-Type: application/json\n</code></pre></p> <p>Request Body: <pre><code>{\n  \"template_variables\": {\n    \"template.welcome_academy.subject\": \"Welcome to our school!\",\n    \"global.COMPANY_NAME\": \"Custom Academy Name\"\n  },\n  \"disabled_templates\": [\"nps_survey\"]\n}\n</code></pre></p> <p>Response: <pre><code>{\n  \"academy\": 4,\n  \"template_variables\": {\n    \"template.welcome_academy.subject\": \"Welcome to our school!\",\n    \"global.COMPANY_NAME\": \"Custom Academy Name\"\n  },\n  \"disabled_templates\": [\"nps_survey\"],\n  \"created_at\": \"2024-01-01T00:00:00Z\",\n  \"updated_at\": \"2024-01-02T10:30:00Z\"\n}\n</code></pre></p> <p>Validation Errors:</p> <p>Invalid template in template_variables: <pre><code>{\n  \"template_variables\": [\n    \"Template 'invalid_slug' not found in notification registry\"\n  ]\n}\n</code></pre></p> <p>Invalid template in disabled_templates: <pre><code>{\n  \"disabled_templates\": [\n    \"Disabled template 'invalid_slug' not found in notification registry\"\n  ]\n}\n</code></pre></p> <p>Multiple errors: <pre><code>{\n  \"template_variables\": [\n    \"disabled_templates must be a list; Template 'bad_slug' not found in notification registry\"\n  ]\n}\n</code></pre></p>"},{"location":"LLM-DOCS/NOTIFICATION_REGISTRY/#variable-interpolation","title":"Variable Interpolation","text":"<p>Variables can reference other variables using <code>{{variable_name}}</code> syntax:</p> <p>Example: <pre><code>{\n  \"template.welcome_academy.subject\": \"{{global.greeting}} to {{global.COMPANY_NAME}}!\",\n  \"global.greeting\": \"Welcome\",\n  \"global.COMPANY_NAME\": \"Miami Academy\"\n}\n</code></pre></p> <p>Result: <pre><code>subject = \"Welcome to Miami Academy!\"\n</code></pre></p> <p>Interpolation Rules: - Uses double braces: <code>{{global.VAR}}</code> or <code>{{template.slug.VAR}}</code> - Supports nested references (up to 5 levels) - Protects against circular references - Resolves at template rendering time</p>"},{"location":"LLM-DOCS/NOTIFICATION_REGISTRY/#disabling-templates","title":"Disabling Templates","text":"<p>Academies can completely disable specific notification templates:</p> <pre><code>{\n  \"disabled_templates\": [\"nps_survey\", \"welcome_academy\"]\n}\n</code></pre> <p>Behavior: - Calls to <code>send_email_message()</code> with disabled templates return <code>True</code> without sending - Logged as INFO: \"Template 'nps_survey' is disabled for academy 4\" - Silently skips sending (no error raised) - Code execution continues normally</p> <p>Use Cases: - Disable NPS surveys for trial accounts - Turn off welcome emails for partner academies - Disable marketing notifications for specific regions - Prevent duplicate notifications from external systems</p> <p>Validation: - Template slugs must exist in notification registry - Invalid slugs will cause validation error on save - Empty list <code>[]</code> means all templates are enabled</p>"},{"location":"LLM-DOCS/NOTIFICATION_REGISTRY/#usage-examples","title":"Usage Examples","text":""},{"location":"LLM-DOCS/NOTIFICATION_REGISTRY/#example-1-override-subject-for-specific-template","title":"Example 1: Override Subject for Specific Template","text":"<pre><code>{\n  \"template_variables\": {\n    \"template.welcome_academy.subject\": \"\u00a1Bienvenido a nuestra academia!\"\n  }\n}\n</code></pre> <p>When <code>send_email_message(\"welcome_academy\", ...)</code> is called, the subject will use the academy's custom value instead of the code default.</p>"},{"location":"LLM-DOCS/NOTIFICATION_REGISTRY/#example-2-global-company-name-override","title":"Example 2: Global Company Name Override","text":"<pre><code>{\n  \"template_variables\": {\n    \"global.COMPANY_NAME\": \"Academia de Programaci\u00f3n Miami\"\n  }\n}\n</code></pre> <p>Effect: All templates will use \"Academia de Programaci\u00f3n Miami\" instead of the academy's model name.</p> <p>Example scenario: - Academy model: <code>academy.name = \"Miami\"</code> - Template variable override: <code>global.COMPANY_NAME = \"Academia de Programaci\u00f3n Miami\"</code> - Result in emails: \"Academia de Programaci\u00f3n Miami\" \u2705 (override wins)</p> <p>This is useful when the academy's database name differs from how they want to be presented in emails (e.g., legal name vs. marketing name).</p>"},{"location":"LLM-DOCS/NOTIFICATION_REGISTRY/#example-3-complex-composition","title":"Example 3: Complex Composition","text":"<pre><code>{\n  \"template.welcome_academy.subject\": \"{{global.welcome_message}}\",\n  \"template.welcome_academy.MESSAGE\": \"We're excited to have you at {{global.COMPANY_NAME}}\",\n  \"global.welcome_message\": \"Welcome to {{global.COMPANY_NAME}}!\",\n  \"global.COMPANY_NAME\": \"Miami Coding Academy\"\n}\n</code></pre> <p>Resolves to: - <code>subject</code>: \"Welcome to Miami Coding Academy!\" - <code>MESSAGE</code>: \"We're excited to have you at Miami Coding Academy\" - <code>COMPANY_NAME</code>: \"Miami Coding Academy\"</p>"},{"location":"LLM-DOCS/NOTIFICATION_REGISTRY/#code-integration","title":"Code Integration","text":"<p>The integration happens automatically in <code>send_email_message</code>:</p> <pre><code>from breathecode.notify import actions as notify_actions\n\nnotify_actions.send_email_message(\n    \"welcome_academy\",\n    \"student@example.com\",\n    {\n        \"subject\": \"Default welcome subject\",  # Overridden if academy has template.welcome_academy.subject\n        \"FIRST_NAME\": \"John\",  # Not overridden (code takes precedence for specific values)\n    },\n    academy=academy,\n)\n</code></pre> <p>Override Behavior: 1. System defaults are set (from environment variables) 2. Context is updated with code-provided values in <code>data</code> dict 3. Academy settings overrides are applied with <code>data.update(overrides)</code> - these take priority 4. Academy model fields (academy.name, academy.logo_url) are applied with <code>setdefault()</code> - only if not already set 5. Template is rendered with final merged data</p> <p>Key insight: Academy <code>template_variables</code> (from <code>global.*</code> or <code>template.*</code>) override academy model fields. This allows academies to customize how they appear in emails independently of their database name.</p> <p>Example: <pre><code># Academy model\nacademy.name = \"Downtown Miami\"\n\n# Academy template_variables\nglobal.COMPANY_NAME = \"4Geeks Miami - Downtown Campus\"\n\n# Result in email\nCOMPANY_NAME = \"4Geeks Miami - Downtown Campus\"  \u2705\n</code></pre></p>"},{"location":"LLM-DOCS/NOTIFICATION_REGISTRY/#django-admin","title":"Django Admin","text":"<p>Settings can be managed through Django Admin:</p> <ol> <li>Navigate to Notify \u2192 Academy Notification Settings</li> <li>Select academy</li> <li>Edit <code>template_variables</code> JSON field</li> <li>Format must be valid JSON with proper key format</li> <li>Validation runs on save</li> </ol> <p>Admin Interface: - List view shows academy and updated_at - Search by academy name or slug - Read-only created_at and updated_at fields - Collapsible metadata section</p>"},{"location":"LLM-DOCS/NOTIFICATION_REGISTRY/#validation","title":"Validation","text":"<p>Strict validation ensures data integrity:</p> <p>Validated: - Template slugs must exist in notification registry - Variable names must exist in template's variable list - Global variables are always allowed - Key format must be <code>template.SLUG.VAR</code> or <code>global.VAR</code></p> <p>Validation Errors: - Invalid template slug: \"Template 'xyz' not found in notification registry\" - Invalid variable: \"Variable 'XYZ' not found in template 'abc'. Available variables: ...\" - Invalid format: \"Invalid key format: 'xyz'. Must start with 'template.' or 'global.'\"</p>"},{"location":"LLM-DOCS/NOTIFICATION_REGISTRY/#best-practices_1","title":"Best Practices","text":"<ol> <li>Use Global Variables: For values used across multiple templates</li> <li>Template-Specific Only When Needed: Override per-template only when different from global</li> <li>Interpolation for Consistency: Compose complex values from simpler ones</li> <li>Test Before Production: Use preview endpoint to verify templates render correctly</li> <li>Document Custom Variables: Keep track of what each academy customizes</li> <li>Validate Early: Use PUT endpoint to validate settings before deploying</li> </ol>"},{"location":"LLM-DOCS/NOTIFICATION_REGISTRY/#frontend-integration_1","title":"Frontend Integration","text":"<pre><code>// Get current academy settings\nconst response = await fetch('/v1/notify/academy/settings', {\n  headers: {\n    'Authorization': 'Token abc123',\n    'Academy': '4'\n  }\n});\nconst settings = await response.json();\n\nconsole.log('Disabled templates:', settings.disabled_templates);\nconsole.log('Variable overrides:', settings.template_variables);\n\n// Update academy settings\nconst updateResponse = await fetch('/v1/notify/academy/settings', {\n  method: 'PUT',\n  headers: {\n    'Authorization': 'Token abc123',\n    'Academy': '4',\n    'Content-Type': 'application/json'\n  },\n  body: JSON.stringify({\n    template_variables: {\n      'template.welcome_academy.subject': 'Custom Welcome!',\n      'global.COMPANY_NAME': 'My Academy'\n    },\n    disabled_templates: ['nps_survey']\n  })\n});\n\nif (!updateResponse.ok) {\n  const errors = await updateResponse.json();\n  console.error('Validation errors:', errors);\n}\n</code></pre>"},{"location":"LLM-DOCS/NOTIFICATION_REGISTRY/#building-a-template-toggle-ui","title":"Building a Template Toggle UI","text":"<pre><code>function TemplateManager({ academyId }) {\n  const [settings, setSettings] = useState({});\n  const [templates, setTemplates] = useState([]);\n\n  // Fetch available templates\n  useEffect(() =&gt; {\n    fetch('/v1/notify/academy/template', { headers })\n      .then(r =&gt; r.json())\n      .then(data =&gt; setTemplates(data.templates));\n  }, []);\n\n  // Fetch current settings\n  useEffect(() =&gt; {\n    fetch('/v1/notify/academy/settings', { headers })\n      .then(r =&gt; r.json())\n      .then(data =&gt; setSettings(data));\n  }, []);\n\n  const toggleTemplate = async (slug) =&gt; {\n    const isDisabled = settings.disabled_templates?.includes(slug);\n    const newDisabled = isDisabled\n      ? settings.disabled_templates.filter(s =&gt; s !== slug)\n      : [...(settings.disabled_templates || []), slug];\n\n    await fetch('/v1/notify/academy/settings', {\n      method: 'PUT',\n      headers: { ...headers, 'Content-Type': 'application/json' },\n      body: JSON.stringify({\n        ...settings,\n        disabled_templates: newDisabled\n      })\n    });\n\n    setSettings(prev =&gt; ({ ...prev, disabled_templates: newDisabled }));\n  };\n\n  return (\n    &lt;div&gt;\n      {templates.map(t =&gt; (\n        &lt;div key={t.slug}&gt;\n          &lt;input\n            type=\"checkbox\"\n            checked={!settings.disabled_templates?.includes(t.slug)}\n            onChange={() =&gt; toggleTemplate(t.slug)}\n          /&gt;\n          {t.name} - {t.description}\n        &lt;/div&gt;\n      ))}\n    &lt;/div&gt;\n  );\n}\n</code></pre>"},{"location":"LLM-DOCS/NOTIFICATION_REGISTRY/#common-patterns","title":"Common Patterns","text":""},{"location":"LLM-DOCS/NOTIFICATION_REGISTRY/#pattern-1-multilingual-templates","title":"Pattern 1: Multilingual Templates","text":"<pre><code>{\n  \"template_variables\": {\n    \"template.welcome_academy.subject\": \"\u00a1Bienvenido!\",\n    \"template.verify_email.subject\": \"Verifica tu correo\",\n    \"global.COMPANY_NAME\": \"Academia Miami\"\n  }\n}\n</code></pre>"},{"location":"LLM-DOCS/NOTIFICATION_REGISTRY/#pattern-2-white-label-branding","title":"Pattern 2: White-Label Branding","text":"<pre><code>{\n  \"template_variables\": {\n    \"global.COMPANY_NAME\": \"Partner Academy Inc.\",\n    \"global.COMPANY_CONTACT_URL\": \"https://partner.example.com/contact\",\n    \"template.welcome_academy.MESSAGE\": \"Welcome to our partnership program!\"\n  }\n}\n</code></pre>"},{"location":"LLM-DOCS/NOTIFICATION_REGISTRY/#pattern-3-custom-ctas","title":"Pattern 3: Custom CTAs","text":"<pre><code>{\n  \"template_variables\": {\n    \"template.welcome_academy.BUTTON\": \"Comenzar Ahora\",\n    \"template.verify_email.BUTTON\": \"Verificar Mi Correo\"\n  }\n}\n</code></pre>"},{"location":"LLM-DOCS/NOTIFICATION_REGISTRY/#pattern-4-disable-marketing-notifications","title":"Pattern 4: Disable Marketing Notifications","text":"<pre><code>{\n  \"disabled_templates\": [\"nps_survey\", \"feedback_request\"],\n  \"template_variables\": {\n    \"global.COMPANY_NAME\": \"Corporate Training Division\"\n  }\n}\n</code></pre> <p>Use Case: Corporate training academies that don't want to send marketing/survey emails but still want to customize branding.</p>"},{"location":"LLM-DOCS/NOTIFICATION_REGISTRY/#troubleshooting_1","title":"Troubleshooting","text":"<p>Issue: Settings not applying</p> <p>Solutions: - Verify academy has notify_settings relationship - Check variable names match exactly (case-sensitive) - Ensure academy is passed to <code>send_email_message</code> - Check logs for override application errors</p> <p>Issue: Disabled template still sending</p> <p>Solutions: - Check template slug is exactly in <code>disabled_templates</code> list - Verify academy object is passed to <code>send_email_message</code> - Check logs for \"Template 'X' is disabled for academy Y\" message - Ensure settings relationship exists (not None)</p> <p>Issue: Validation fails unexpectedly</p> <p>Solutions: - Verify template slug exists in registry - Check variable name exists in template's variables array - Use exact key format: <code>template.slug.VARIABLE</code> or <code>global.VARIABLE</code> - Check for typos in slug or variable names</p> <p>Issue: Interpolation not working</p> <p>Solutions: - Use double braces: <code>{{variable}}</code> - Reference format: <code>{{global.VAR}}</code> or <code>{{template.slug.VAR}}</code> - Check for circular references (max depth is 5) - Verify referenced variables exist in template_variables</p>"},{"location":"LLM-DOCS/NOTIFICATION_REGISTRY/#related-documentation","title":"Related Documentation","text":"<ul> <li>Email Notifications - How to send notifications</li> <li>Template Development - Creating notification templates</li> <li>Webhook System - Notification delivery webhooks</li> </ul>"},{"location":"LLM-DOCS/PAYMENT_REPORT/","title":"Payment Report API Documentation","text":"<p>Guide to API endpoints and activity data used for payment reports, sales dashboards, and sales activity.</p>"},{"location":"LLM-DOCS/PAYMENT_REPORT/#overview","title":"Overview","text":"<p>Payment and sales reporting uses:</p> <ul> <li>Payments API \u2013 Invoices, subscriptions, plan financing, bags (completed and recurring sales).</li> <li>Commission API \u2013 Creator/influencer payments and commission reports (payouts, not customer sales).</li> <li>Activity API (V2/V3) \u2013 Sales-related activity events (e.g. bag created, checkout completed).</li> </ul> <p>Base URLs:</p> <ul> <li>Payments: <code>/v1/payments/</code> (academy-scoped paths use <code>Academy</code> header)</li> <li>Commission: <code>/v1/commission/</code></li> <li>Activity: <code>/v2/activity/</code>, <code>/v3/activity/</code></li> </ul>"},{"location":"LLM-DOCS/PAYMENT_REPORT/#authentication-headers","title":"Authentication &amp; Headers","text":"<p>All requests require:</p> <pre><code>Authorization: Token {your-token}\n</code></pre> <p>Academy-scoped endpoints (payments academy/, activity academy/) also require:</p> <pre><code>Academy: {academy_id}\n</code></pre> <p>Commission URLs include the academy in the path: <code>academy/&lt;academy_id&gt;/...</code>.</p>"},{"location":"LLM-DOCS/PAYMENT_REPORT/#payments-api-sales-data","title":"Payments API \u2013 Sales Data","text":"<p>Base: <code>/v1/payments/</code></p>"},{"location":"LLM-DOCS/PAYMENT_REPORT/#invoices-completed-sales","title":"Invoices (completed sales)","text":"Method Endpoint Description GET <code>academy/invoice</code> List invoices. Sorted by <code>-id</code> by default, paginated. GET <code>academy/invoice/&lt;invoice_id&gt;</code> Single invoice. POST <code>academy/invoice/&lt;invoice_id&gt;/refund</code> Refund (for activity/history). <p>Query parameters (list):</p> <ul> <li><code>status</code> \u2013 Comma-separated (e.g. <code>FULFILLED</code>, <code>PENDING</code>, <code>REFUNDED</code>).</li> <li><code>date_start</code> \u2013 Optional. ISO 8601 datetime (or date). Filter by <code>paid_at &gt;= date_start</code>.</li> <li><code>date_end</code> \u2013 Optional. ISO 8601 datetime (or date). Filter by <code>paid_at &lt;= date_end</code>.</li> <li>Pagination: <code>limit</code>, <code>offset</code> (via API view extensions).</li> </ul> <p>Capability: <code>read_invoice</code> (list/detail), <code>crud_invoice</code> (refund).</p>"},{"location":"LLM-DOCS/PAYMENT_REPORT/#subscriptions-recurring-sales","title":"Subscriptions (recurring sales)","text":"Method Endpoint Description GET <code>academy/subscription</code> List subscriptions. Sorted <code>-id</code>, paginated, cached. GET <code>academy/subscription/&lt;subscription_id&gt;</code> Single subscription. PUT <code>academy/subscription/&lt;subscription_id&gt;</code> Update subscription. <p>Query parameters (list):</p> <ul> <li><code>status</code>, <code>users</code>, <code>plan</code>, <code>service</code>, <code>invoice</code> (comma-separated).</li> <li><code>date_start</code> \u2013 Optional. Filter by <code>paid_at &gt;= date_start</code>. Bypasses cache when used.</li> <li><code>date_end</code> \u2013 Optional. Filter by <code>paid_at &lt;= date_end</code>. Bypasses cache when used.</li> </ul> <p>Capability: <code>read_subscription</code>.</p>"},{"location":"LLM-DOCS/PAYMENT_REPORT/#plan-financing-installments","title":"Plan financing (installments)","text":"Method Endpoint Description GET <code>academy/planfinancing</code> List plan financings. Sorted <code>-id</code>, paginated, cached. GET <code>academy/planfinancing/&lt;financing_id&gt;</code> Single plan financing. PUT <code>academy/planfinancing/&lt;financing_id&gt;</code> Update plan financing. <p>Query parameters (list):</p> <ul> <li><code>users</code>, <code>plan</code>, <code>invoice</code> (comma-separated).</li> <li><code>date_start</code> \u2013 Optional. Filter by <code>created_at &gt;= date_start</code>. Bypasses cache when used.</li> <li><code>date_end</code> \u2013 Optional. Filter by <code>created_at &lt;= date_end</code>. Bypasses cache when used.</li> </ul>"},{"location":"LLM-DOCS/PAYMENT_REPORT/#bags-carts-orders","title":"Bags (carts / orders)","text":"Method Endpoint Description GET <code>academy/bag/&lt;bag_id&gt;</code> Single bag by ID. No list endpoint. <p>Capability: <code>read_subscription</code>.</p>"},{"location":"LLM-DOCS/PAYMENT_REPORT/#coupons-search-manage","title":"Coupons (search &amp; manage)","text":"<p>See COUPONS.md for full details. Summary: <code>GET/POST academy/coupon</code>, <code>GET/PUT/DELETE academy/coupon/&lt;slug&gt;</code>, <code>GET academy/coupon/&lt;slug&gt;/exists</code>, <code>GET coupon?coupons=...&amp;plan=...</code>, <code>GET me/coupon</code>, <code>GET/PUT me/user/coupons</code>, <code>PUT bag/&lt;id&gt;/coupon</code>.</p>"},{"location":"LLM-DOCS/PAYMENT_REPORT/#commission-api-payouts-reports","title":"Commission API \u2013 Payouts &amp; Reports","text":"<p>Base: <code>/v1/commission/</code>. Academy in path: <code>academy/&lt;academy_id&gt;/...</code>.</p> Method Endpoint Description GET <code>academy/&lt;academy_id&gt;/report</code> Commission report. Query: <code>creator_id</code>, <code>month</code> (YYYY-MM), <code>preview</code>, <code>async</code>, <code>include_plans</code>, <code>exclude_plans</code>. GET <code>academy/&lt;academy_id&gt;/report.&lt;extension&gt;</code> Export report (e.g. CSV). GET <code>academy/&lt;academy_id&gt;/payments</code> List creator payments. GET <code>academy/&lt;academy_id&gt;/payments/&lt;payment_id&gt;</code> Single payment. GET <code>academy/&lt;academy_id&gt;/commissions</code> List commissions. GET <code>academy/&lt;academy_id&gt;/usage-commissions</code> Usage commissions. GET <code>academy/&lt;academy_id&gt;/referral-commissions</code> Referral commissions. GET <code>academy/&lt;academy_id&gt;/referral-commissions/&lt;commission_id&gt;</code> Single referral commission. <p>Capability: <code>crud_commission</code> (report).</p>"},{"location":"LLM-DOCS/PAYMENT_REPORT/#activity-api-sales-activity-events","title":"Activity API \u2013 Sales Activity Events","text":"<p>Sales-related activity kinds: <code>bag_created</code>, <code>checkout_completed</code> (for Subscription, PlanFinancing, Invoice). Queried via V2 or V3 activity endpoints (BigQuery).</p>"},{"location":"LLM-DOCS/PAYMENT_REPORT/#v3-activity-v3activity-recommended-for-date-range","title":"V3 Activity \u2013 <code>/v3/activity/</code> (recommended for date range)","text":"Method Endpoint Description GET <code>kinds</code> All activity kinds by <code>related_type</code>. GET <code>academy/activity</code> List activity. Query: <code>kind</code> (comma-separated), <code>user_id</code>, <code>date_start</code>, <code>date_end</code>, <code>cohort_id</code>, <code>limit</code>, <code>page</code>. <p>Example \u2013 sales activity in date range: <code>GET /v3/activity/academy/activity?kind=bag_created,checkout_completed&amp;date_start=2025-02-01&amp;date_end=2025-02-09&amp;limit=50</code></p> <p>Capability: <code>read_activity</code>.</p>"},{"location":"LLM-DOCS/PAYMENT_REPORT/#timeframe-start-end-datetimes","title":"Timeframe (start / end datetimes)","text":"Area Timeframe support Notes Payments \u2013 invoices Yes <code>date_start</code>, <code>date_end</code> filter by <code>paid_at</code>. Payments \u2013 subscriptions Yes <code>date_start</code>, <code>date_end</code> filter by <code>paid_at</code>. Cache bypassed when either param is present. Payments \u2013 plan financing Yes <code>date_start</code>, <code>date_end</code> filter by <code>created_at</code>. Cache bypassed when either param is present. Activity V3 Yes <code>date_start</code>, <code>date_end</code> on <code>academy/activity</code>. Commission report By month only <code>month</code> (YYYY-MM), not arbitrary start/end. <p>Format: ISO 8601 datetime or date (e.g. <code>2025-02-01T00:00:00Z</code> or <code>2025-02-01</code>). Invalid values return 400 with slug <code>invalid-datetime</code>.</p>"},{"location":"LLM-DOCS/PAYMENT_REPORT/#pagination-sort","title":"Pagination &amp; sort","text":"<ul> <li>Payments list views: default sort <code>-id</code>, query params <code>limit</code>, <code>offset</code>.</li> <li>Activity V2/V3: <code>limit</code>, <code>page</code>.</li> </ul>"},{"location":"LLM-DOCS/PAYMENT_REPORT/#summary-for-dashboards","title":"Summary for dashboards","text":"Goal Primary endpoints Latest completed sales <code>GET /v1/payments/academy/invoice?limit=20&amp;status=FULFILLED</code> Revenue in timeframe <code>GET /v1/payments/academy/invoice?date_start=...&amp;date_end=...</code> (and/or subscription / planfinancing) Recurring / installments <code>GET /v1/payments/academy/subscription</code>, <code>GET /v1/payments/academy/planfinancing</code> Sales activity feed <code>GET /v3/activity/academy/activity?kind=bag_created,checkout_completed&amp;limit=20</code> Commission / payouts <code>GET /v1/commission/academy/&lt;academy_id&gt;/payments</code>, <code>.../report</code> Coupons <code>GET /v1/payments/academy/coupon?like=...</code>, CRUD <code>academy/coupon</code>, <code>academy/coupon/&lt;slug&gt;/exists</code>"},{"location":"LLM-DOCS/PAYMENT_REPORT/#related-docs","title":"Related docs","text":"<ul> <li>COUPONS.md \u2013 Coupon API, fields, validation, and examples.</li> <li>BC_INVOICE.md \u2013 Invoice handling.</li> <li>BC_REFUNDS.md \u2013 Refunds.</li> <li>BC_CHECKOUT.md \u2013 Checkout flow.</li> <li>Student_Activity.md \u2013 Full activity API.</li> </ul>"},{"location":"LLM-DOCS/PROFILE/","title":"Academy Profile Management API Endpoints","text":"<p>This guide covers the REST endpoints you need to read and update academy profile data (name, location, branding assets, and other metadata). The endpoints live under <code>/v1/admissions</code> unless otherwise noted and reuse the <code>Academy</code> serializers from the admissions app.</p>"},{"location":"LLM-DOCS/PROFILE/#authentication-required-headers","title":"Authentication &amp; Required Headers","text":"<ul> <li>All <code>/academy/me</code> endpoints require an authenticated user plus the <code>Academy</code> header set to the target academy ID.</li> <li>Capabilities enforced by <code>@capable_of</code>:</li> <li><code>read_my_academy</code> for <code>GET /academy/me</code></li> <li><code>crud_my_academy</code> for <code>PUT /academy/me</code></li> <li>Public endpoints are explicitly marked; everything else expects a JWT in <code>Authorization: Bearer &lt;token&gt;</code>.</li> </ul>"},{"location":"LLM-DOCS/PROFILE/#core-retrieval-endpoints","title":"Core Retrieval Endpoints","text":""},{"location":"LLM-DOCS/PROFILE/#1-get-my-academy-profile","title":"1. Get My Academy Profile","text":"<p>Endpoint: <code>GET /v1/admissions/academy/me</code> Capability: <code>read_my_academy</code> Purpose: Return a detailed profile for the academy selected via the <code>Academy</code> header. Response highlights (from <code>GetBigAcademySerializer</code>): - Identity: <code>id</code>, <code>slug</code>, <code>name</code>, <code>owner</code> - Location: <code>country</code>, <code>city</code>, <code>street_address</code>, <code>latitude</code>, <code>longitude</code>, <code>timezone</code> - Branding: <code>logo_url</code>, <code>icon_url</code>, <code>white_labeled</code>, <code>white_label_url</code>, <code>academy_features</code> - Marketing &amp; contact: <code>marketing_email</code>, <code>marketing_phone</code>, social handles, <code>website_url</code> - Integrations: <code>active_campaign_slug</code>, <code>available_as_saas</code></p>"},{"location":"LLM-DOCS/PROFILE/#2-get-academy-profile-by-id-public","title":"2. Get Academy Profile by ID (Public)","text":"<p>Endpoint: <code>GET /v1/admissions/academy/{academy_id}</code> Auth: Public (<code>AllowAny</code>) Purpose: Read-only access to the same <code>GetBigAcademySerializer</code> payload for public or cross-academy scenarios. Returns <code>404</code> with <code>slug=\"academy-not-found\"</code> when the academy does not exist.</p>"},{"location":"LLM-DOCS/PROFILE/#3-list-academies-public","title":"3. List Academies (Public)","text":"<p>Endpoint: <code>GET /v1/admissions/academy</code> Auth: Public Query parameters: - <code>status=ACTIVE,INACTIVE,DELETED</code> \u2013 filter by status (case-insensitive list) - <code>academy_id=1,2,3</code> \u2013 restrict to specific IDs Response: Array of academies serialized with <code>AcademySerializer</code> (compact subset: <code>id</code>, <code>slug</code>, <code>name</code>, <code>country</code>, <code>city</code>, <code>logo_url</code>, <code>is_hidden_on_prework</code>).</p>"},{"location":"LLM-DOCS/PROFILE/#profile-updates","title":"Profile Updates","text":""},{"location":"LLM-DOCS/PROFILE/#4-update-my-academy-profile","title":"4. Update My Academy Profile","text":"<p>Endpoint: <code>PUT /v1/admissions/academy/me</code> Capability: <code>crud_my_academy</code> Behavior: Partially update the academy represented by the <code>Academy</code> header. The serializer only accepts a curated set of fields; unknown fields are ignored.</p>"},{"location":"LLM-DOCS/PROFILE/#editable-fields","title":"Editable Fields","text":"<ul> <li><code>name</code></li> <li><code>street_address</code></li> <li><code>country</code> (expects ISO country code present in admissions catalog)</li> <li><code>city</code> (numeric city ID)</li> <li><code>logo_url</code></li> <li><code>icon_url</code></li> <li><code>is_hidden_on_prework</code></li> </ul>"},{"location":"LLM-DOCS/PROFILE/#validation-notes","title":"Validation Notes","text":"<ul> <li><code>slug</code> is read-only; passing it in the payload is ignored and will raise a validation error if forced through.</li> <li><code>logo_url</code> and <code>icon_url</code> are validated with <code>breathecode.utils.url_validator.test_url</code>; invalid URLs trigger <code>ValidationException</code> with slugs <code>invalid-logo-url</code> or <code>invalid-icon-url</code>.</li> <li><code>country</code> must exist in <code>admissions.Country</code>; <code>city</code> must exist in <code>admissions.City</code>. Both are coerced to integers/strings by the serializer.</li> <li>Other profile attributes returned by <code>GET /academy/me</code> (marketing emails, social handles, etc.) are currently read-only through this endpoint.</li> </ul>"},{"location":"LLM-DOCS/PROFILE/#example-request","title":"Example Request","text":"<pre><code>{\n  \"name\": \"4Geeks Academy Madrid\",\n  \"street_address\": \"Calle de Example 123\",\n  \"country\": \"ES\",\n  \"city\": 57,\n  \"logo_url\": \"https://assets.4geeks.com/madrid/logo.png\",\n  \"icon_url\": \"https://assets.4geeks.com/madrid/icon.png\",\n  \"is_hidden_on_prework\": false\n}\n</code></pre>"},{"location":"LLM-DOCS/PROFILE/#example-response-200","title":"Example Response (200)","text":"<pre><code>{\n  \"id\": 12,\n  \"slug\": \"madrid\",\n  \"name\": \"4Geeks Academy Madrid\",\n  \"street_address\": \"Calle de Example 123\",\n  \"country\": {\n    \"code\": \"ES\",\n    \"name\": \"Spain\",\n    \"flag\": \"\ud83c\uddea\ud83c\uddf8\"\n  },\n  \"city\": {\n    \"id\": 57,\n    \"name\": \"Madrid\"\n  },\n  \"logo_url\": \"https://assets.4geeks.com/madrid/logo.png\",\n  \"icon_url\": \"https://assets.4geeks.com/madrid/icon.png\",\n  \"is_hidden_on_prework\": false\n}\n</code></pre>"},{"location":"LLM-DOCS/PROFILE/#5-create-a-new-academy","title":"5. Create a New Academy","text":"<p>Endpoint: <code>POST /v1/admissions/academy</code> Permission: Django permission <code>manage_organizations</code> (checked via <code>@has_permission</code>). Purpose: Provision new academies; automatically sets the request user as owner and triggers the <code>academy_saved</code> signal that creates the initial <code>ProfileAcademy</code> admin record. Required fields: <code>slug</code>, <code>name</code>, <code>logo_url</code>, <code>street_address</code>, <code>city</code>, <code>country</code>. Additional metadata (contacts, social handles, coordinates, ActiveCampaign slug, etc.) can be provided on creation even though they are read-only on update.</p>"},{"location":"LLM-DOCS/PROFILE/#supporting-catalog-endpoints","title":"Supporting Catalog Endpoints","text":"<p>Use the admissions catalogs to drive valid dropdowns when updating profile data:</p> <ul> <li><code>GET /v1/admissions/catalog/countries</code> \u2013 returns <code>code</code>, <code>name</code>, <code>flag</code>.</li> <li><code>GET /v1/admissions/catalog/cities</code> \u2013 returns <code>id</code>, <code>name</code>, <code>country</code>; filter by <code>?country=US</code> (country code) to scope the list.</li> <li><code>GET /v1/admissions/catalog/timezones</code> \u2013 helpful when displaying time zone options alongside the profile payload (although <code>timezone</code> is not currently writable through <code>PUT /academy/me</code>).</li> </ul>"},{"location":"LLM-DOCS/PROFILE/#error-handling","title":"Error Handling","text":"<ul> <li>All protected endpoints raise <code>ValidationException</code> with translated messages (<code>slug</code> provided) for invalid input.</li> <li>Missing or non-numeric <code>Academy</code> headers trigger <code>ValidationException</code> <code>slug=\"invalid-academy-id\"</code>.</li> <li>Lack of capability results in <code>403 PermissionDenied</code> with a message indicating the missing capability.</li> <li>Not-found resources return <code>404</code> with semantic slugs (e.g., <code>academy-not-found</code>).</li> </ul>"},{"location":"LLM-DOCS/PROFILE/#typical-workflow","title":"Typical Workflow","text":"<ol> <li><code>GET /v1/admissions/academy/me</code> \u2013 load the current profile.  </li> <li><code>GET /v1/admissions/catalog/countries</code> and <code>GET /v1/admissions/catalog/cities?country={code}</code> \u2013 build valid location options.  </li> <li><code>PUT /v1/admissions/academy/me</code> \u2013 submit changes for allowed fields.  </li> <li><code>GET /v1/admissions/academy/me</code> \u2013 confirm the persisted profile and review read-only attributes.  </li> <li>(Optional) <code>GET /v1/admissions/academy/{academy_id}</code> \u2013 verify the public-facing representation for external consumers.</li> </ol>"},{"location":"LLM-DOCS/SEATS_AND_TEAMS/","title":"Seats and Teams - Complete Guide","text":"<p>This document provides comprehensive guidance on seat-based consumption, team management, and how organizations can share subscription access across multiple team members in the BreatheCode platform.</p>"},{"location":"LLM-DOCS/SEATS_AND_TEAMS/#table-of-contents","title":"Table of Contents","text":"<ol> <li>Overview</li> <li>Core Concepts</li> <li>How Seat-Based Consumption Works</li> <li>Creating a Billing Team</li> <li>Managing Team Seats</li> <li>Team Settings &amp; Auto-Recharge</li> <li>Consumption Strategies</li> <li>Consumables and Seats</li> <li>Inviting Team Members</li> <li>Removing Team Members</li> <li>Seat Limits and Scaling</li> <li>Billing and Charges</li> <li>API Reference</li> <li>Complete Workflows</li> </ol>"},{"location":"LLM-DOCS/SEATS_AND_TEAMS/#overview","title":"Overview","text":"<p>Seat-based consumption allows subscription owners to share their plan access with team members. Instead of each person purchasing their own subscription, a company can buy a team subscription and assign \"seats\" to employees or students.</p>"},{"location":"LLM-DOCS/SEATS_AND_TEAMS/#key-benefits","title":"Key Benefits","text":"<ul> <li>Cost Efficiency: Centralized billing for entire teams</li> <li>Access Control: Owner manages who has access</li> <li>Flexible Scaling: Add or remove seats as needed</li> <li>Shared Resources: Team members consume from a shared pool</li> <li>Usage Tracking: Monitor consumption per seat</li> </ul>"},{"location":"LLM-DOCS/SEATS_AND_TEAMS/#base-url","title":"Base URL","text":"<pre><code>Production: https://breathecode.herokuapp.com\nDevelopment: http://localhost:8000\n</code></pre>"},{"location":"LLM-DOCS/SEATS_AND_TEAMS/#core-concepts","title":"Core Concepts","text":""},{"location":"LLM-DOCS/SEATS_AND_TEAMS/#1-subscription","title":"1. Subscription","text":"<p>The base subscription purchased by an owner (individual or organization).</p> <pre><code>{\n  \"id\": 123,\n  \"user\": 456,\n  \"status\": \"ACTIVE\",\n  \"has_billing_team\": true\n}\n</code></pre>"},{"location":"LLM-DOCS/SEATS_AND_TEAMS/#2-billing-team","title":"2. Billing Team","text":"<p>A team entity attached to a subscription. Each subscription can have ONE billing team.</p> <pre><code>{\n  \"id\": 789,\n  \"subscription\": 123,\n  \"name\": \"Team 123\",\n  \"seats_limit\": 10,\n  \"additional_seats\": 9,\n  \"seats_count\": 7,\n  \"consumption_strategy\": \"PER_SEAT\"\n}\n</code></pre> <p>Key Fields: - <code>seats_limit</code>: Total seats available (including owner) - <code>additional_seats</code>: Paid seats beyond the owner's seat - <code>seats_count</code>: Currently occupied seats - <code>consumption_strategy</code>: How consumption is tracked</p>"},{"location":"LLM-DOCS/SEATS_AND_TEAMS/#3-subscription-seat","title":"3. Subscription Seat","text":"<p>A seat represents one team member's access to the subscription.</p> <pre><code>{\n  \"id\": 101,\n  \"billing_team\": 789,\n  \"user\": 456,\n  \"email\": \"member@company.com\",\n  \"is_active\": true\n}\n</code></pre> <p>Seat States: - Active with User: Seat occupied by a registered user - Active without User: Seat reserved for an email (pending invite) - Inactive: Seat removed/freed</p>"},{"location":"LLM-DOCS/SEATS_AND_TEAMS/#4-consumable","title":"4. Consumable","text":"<p>Resources (credits, hours, etc.) that can be consumed by team members.</p> <pre><code>{\n  \"id\": 202,\n  \"subscription\": 123,\n  \"subscription_billing_team\": 789,\n  \"subscription_seat\": 101,\n  \"user\": 456,\n  \"service_item\": {...},\n  \"how_many\": 100,\n  \"balance\": 75\n}\n</code></pre>"},{"location":"LLM-DOCS/SEATS_AND_TEAMS/#how-seat-based-consumption-works","title":"How Seat-Based Consumption Works","text":""},{"location":"LLM-DOCS/SEATS_AND_TEAMS/#basic-flow","title":"Basic Flow","text":"<pre><code>1. Owner purchases subscription\n   \u2193\n2. Checkout creates billing team (if requesting seats)\n   \u2193\n3. Owner gets first seat automatically (free)\n   \u2193\n4. Owner invites team members (each consumes 1 seat)\n   \u2193\n5. Team members consume resources from shared pool\n   \u2193\n6. Consumption tracked per seat or per team\n</code></pre>"},{"location":"LLM-DOCS/SEATS_AND_TEAMS/#consumption-strategies","title":"Consumption Strategies","text":"<p>There are TWO consumption strategies:</p>"},{"location":"LLM-DOCS/SEATS_AND_TEAMS/#1-per_seat-default","title":"1. PER_SEAT (Default)","text":"<p>Each seat member has their own allocated resources.</p> <p>Example: - Plan: 100 hours per seat - Team: 5 seats - Result: Each member gets 100 hours (500 hours total)</p> <pre><code>{\n  \"consumption_strategy\": \"PER_SEAT\",\n  \"seats_count\": 5\n}\n</code></pre> <p>Consumables: - Each seat gets individual consumables - When seat is removed, their consumables are freed - Tracked by <code>subscription_seat</code> foreign key</p>"},{"location":"LLM-DOCS/SEATS_AND_TEAMS/#2-per_team","title":"2. PER_TEAM","text":"<p>Entire team shares from a single resource pool.</p> <p>Example: - Plan: 500 hours total - Team: 5 seats - Result: All 5 members share 500 hours</p> <pre><code>{\n  \"consumption_strategy\": \"PER_TEAM\",\n  \"seats_count\": 5\n}\n</code></pre> <p>Consumables: - One shared consumable for the team - Resources deplete from common pool - Tracked by <code>subscription_billing_team</code> only</p>"},{"location":"LLM-DOCS/SEATS_AND_TEAMS/#creating-a-billing-team","title":"Creating a Billing Team","text":"<p>Billing teams are typically created automatically during checkout when the plan supports seats.</p>"},{"location":"LLM-DOCS/SEATS_AND_TEAMS/#automatic-creation-during-checkout","title":"Automatic Creation (During Checkout)","text":"<p>Endpoint: <code>POST /v1/payments/consumable/checkout</code></p> <p>Request:</p> <pre><code>{\n  \"plan\": 1,\n  \"additional_seats\": 9,\n  \"currency\": \"USD\"\n}\n</code></pre> <p>What Happens:</p> <ol> <li>Creates subscription</li> <li>Creates billing team with 10 seats (9 additional + 1 owner)</li> <li>Assigns owner as first seat</li> <li>Creates seat-specific consumables</li> <li>Returns checkout success</li> </ol> <p>Response:</p> <pre><code>{\n  \"status\": \"fulfilled\",\n  \"subscription\": {\n    \"id\": 123,\n    \"has_billing_team\": true,\n    \"status\": \"ACTIVE\"\n  },\n  \"billing_team\": {\n    \"id\": 789,\n    \"seats_limit\": 10,\n    \"seats_count\": 1\n  }\n}\n</code></pre>"},{"location":"LLM-DOCS/SEATS_AND_TEAMS/#example-purchase-team-plan","title":"Example: Purchase Team Plan","text":"<pre><code>const purchaseTeamPlan = async (planId, seatCount) =&gt; {\n  const token = localStorage.getItem('authToken');\n\n  const response = await fetch(\n    'https://breathecode.herokuapp.com/v1/payments/consumable/checkout',\n    {\n      method: 'POST',\n      headers: {\n        'Authorization': `Token ${token}`,\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        plan: planId,\n        additional_seats: seatCount - 1,  // -1 because owner gets first seat\n        currency: 'USD'\n      })\n    }\n  );\n\n  if (!response.ok) {\n    const error = await response.json();\n    throw new Error(error.detail || 'Checkout failed');\n  }\n\n  return await response.json();\n};\n\n// Purchase plan with 10 total seats\nconst result = await purchaseTeamPlan(1, 10);\nconsole.log(`Team created with ${result.billing_team.seats_limit} seats`);\n</code></pre>"},{"location":"LLM-DOCS/SEATS_AND_TEAMS/#managing-team-seats","title":"Managing Team Seats","text":""},{"location":"LLM-DOCS/SEATS_AND_TEAMS/#view-billing-team","title":"View Billing Team","text":"<p>Endpoint: <code>GET /v1/payments/subscription/{subscription_id}/billing-team</code></p> <p>Purpose: Get team details, seat count, and spending info.</p> <p>Response:</p> <pre><code>{\n  \"id\": 789,\n  \"subscription\": 123,\n  \"name\": \"Team 123\",\n  \"seats_limit\": 10,\n  \"additional_seats\": 9,\n  \"seats_count\": 7,\n  \"seats_log\": [],\n  \"auto_recharge_enabled\": true,\n  \"recharge_threshold_amount\": \"10.00\",\n  \"recharge_amount\": \"100.00\",\n  \"max_period_spend\": \"1000.00\",\n  \"current_period_spend\": 250.50,\n  \"period_start\": \"2024-02-01T00:00:00\",\n  \"period_end\": \"2024-02-29T23:59:59\",\n  \"currency\": \"USD\"\n}\n</code></pre> <p>Example:</p> <pre><code>const getBillingTeam = async (subscriptionId) =&gt; {\n  const token = localStorage.getItem('authToken');\n\n  const response = await fetch(\n    `https://breathecode.herokuapp.com/v1/payments/subscription/${subscriptionId}/billing-team`,\n    {\n      headers: {\n        'Authorization': `Token ${token}`\n      }\n    }\n  );\n\n  return await response.json();\n};\n</code></pre>"},{"location":"LLM-DOCS/SEATS_AND_TEAMS/#list-all-seats","title":"List All Seats","text":"<p>Endpoint: <code>GET /v1/payments/subscription/{subscription_id}/seat</code></p> <p>Purpose: Get all seats in the team.</p> <p>Response:</p> <pre><code>[\n  {\n    \"id\": 101,\n    \"email\": \"owner@company.com\",\n    \"user\": 456,\n    \"is_active\": true,\n    \"seat_log\": []\n  },\n  {\n    \"id\": 102,\n    \"email\": \"member1@company.com\",\n    \"user\": 457,\n    \"is_active\": true,\n    \"seat_log\": []\n  },\n  {\n    \"id\": 103,\n    \"email\": \"pending@company.com\",\n    \"user\": null,\n    \"is_active\": true,\n    \"seat_log\": []\n  }\n]\n</code></pre> <p>Example:</p> <pre><code>const listSeats = async (subscriptionId) =&gt; {\n  const token = localStorage.getItem('authToken');\n\n  const response = await fetch(\n    `https://breathecode.herokuapp.com/v1/payments/subscription/${subscriptionId}/seat`,\n    {\n      headers: {\n        'Authorization': `Token ${token}`\n      }\n    }\n  );\n\n  return await response.json();\n};\n</code></pre>"},{"location":"LLM-DOCS/SEATS_AND_TEAMS/#get-single-seat","title":"Get Single Seat","text":"<p>Endpoint: <code>GET /v1/payments/subscription/{subscription_id}/seat/{seat_id}</code></p> <p>Purpose: Get details for one specific seat.</p>"},{"location":"LLM-DOCS/SEATS_AND_TEAMS/#managing-team-seats_1","title":"Managing Team Seats","text":""},{"location":"LLM-DOCS/SEATS_AND_TEAMS/#add-new-seats","title":"Add New Seats","text":"<p>Endpoint: <code>PUT /v1/payments/subscription/{subscription_id}/seat</code></p> <p>Purpose: Add one or more seats to the team.</p> <p>Request Body:</p> <pre><code>{\n  \"add_seats\": [\n    {\n      \"email\": \"newmember@company.com\",\n      \"user\": null\n    },\n    {\n      \"email\": \"anothermember@company.com\",\n      \"user\": 789\n    }\n  ]\n}\n</code></pre> <p>Field Descriptions:</p> Field Type Required Description <code>email</code> string \u2705 Yes Email address (will be normalized to lowercase) <code>user</code> integer \u274c No User ID if already registered, null for invite <p>Response (207 Multi-Status):</p> <pre><code>{\n  \"data\": [\n    {\n      \"id\": 104,\n      \"email\": \"newmember@company.com\",\n      \"user\": null,\n      \"is_active\": true,\n      \"seat_log\": []\n    },\n    {\n      \"id\": 105,\n      \"email\": \"anothermember@company.com\",\n      \"user\": 789,\n      \"is_active\": true,\n      \"seat_log\": []\n    }\n  ],\n  \"errors\": []\n}\n</code></pre> <p>Example:</p> <pre><code>const addSeats = async (subscriptionId, seats) =&gt; {\n  const token = localStorage.getItem('authToken');\n\n  const response = await fetch(\n    `https://breathecode.herokuapp.com/v1/payments/subscription/${subscriptionId}/seat`,\n    {\n      method: 'PUT',\n      headers: {\n        'Authorization': `Token ${token}`,\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        add_seats: seats\n      })\n    }\n  );\n\n  return await response.json();\n};\n\n// Add two new members\nconst result = await addSeats(123, [\n  { email: 'alice@company.com', user: null },\n  { email: 'bob@company.com', user: 456 }\n]);\n\nconsole.log(`Added ${result.data.length} seats`);\nif (result.errors.length &gt; 0) {\n  console.error('Some seats failed:', result.errors);\n}\n</code></pre>"},{"location":"LLM-DOCS/SEATS_AND_TEAMS/#replace-seats","title":"Replace Seats","text":"<p>Endpoint: <code>PUT /v1/payments/subscription/{subscription_id}/seat</code></p> <p>Purpose: Replace one seat with another (useful when someone leaves the team).</p> <p>Request Body:</p> <pre><code>{\n  \"replace_seats\": [\n    {\n      \"from_email\": \"old@company.com\",\n      \"to_email\": \"new@company.com\",\n      \"to_user\": null\n    }\n  ]\n}\n</code></pre> <p>Field Descriptions:</p> Field Type Required Description <code>from_email</code> string \u2705 Yes Current seat email to replace <code>to_email</code> string \u2705 Yes New seat email <code>to_user</code> integer \u274c No New user ID if registered <p>What Happens: 1. Finds existing seat by <code>from_email</code> 2. Updates seat to <code>to_email</code> and <code>to_user</code> 3. Sends invitation if <code>to_user</code> is null 4. Transfers any existing consumables</p> <p>Example:</p> <pre><code>const replaceSeat = async (subscriptionId, fromEmail, toEmail, toUser = null) =&gt; {\n  const token = localStorage.getItem('authToken');\n\n  const response = await fetch(\n    `https://breathecode.herokuapp.com/v1/payments/subscription/${subscriptionId}/seat`,\n    {\n      method: 'PUT',\n      headers: {\n        'Authorization': `Token ${token}`,\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        replace_seats: [\n          {\n            from_email: fromEmail,\n            to_email: toEmail,\n            to_user: toUser\n          }\n        ]\n      })\n    }\n  );\n\n  return await response.json();\n};\n\n// Replace departed employee with new hire\nawait replaceSeat(123, 'john@company.com', 'jane@company.com');\n</code></pre>"},{"location":"LLM-DOCS/SEATS_AND_TEAMS/#remove-seat","title":"Remove Seat","text":"<p>Endpoint: <code>DELETE /v1/payments/subscription/{subscription_id}/seat/{seat_id}</code></p> <p>Purpose: Deactivate a seat and free resources.</p> <p>What Happens: 1. Marks seat as <code>is_active=false</code> 2. Removes user association 3. Clears user from associated consumables 4. Seat slot becomes available for reuse</p> <p>Example:</p> <pre><code>const removeSeat = async (subscriptionId, seatId) =&gt; {\n  const token = localStorage.getItem('authToken');\n\n  const response = await fetch(\n    `https://breathecode.herokuapp.com/v1/payments/subscription/${subscriptionId}/seat/${seatId}`,\n    {\n      method: 'DELETE',\n      headers: {\n        'Authorization': `Token ${token}`\n      }\n    }\n  );\n\n  if (response.status === 204) {\n    console.log('Seat removed successfully');\n  }\n};\n\n// Remove a team member\nawait removeSeat(123, 105);\n</code></pre> <p>Important Notes: - Only the subscription owner can manage seats - Removing a seat doesn't delete it, it deactivates it - The freed slot can be reassigned to someone else - Owner's seat (first seat) cannot be removed</p>"},{"location":"LLM-DOCS/SEATS_AND_TEAMS/#plan-financing-seats","title":"Plan Financing Seats","text":"<p>Plan financings now support their own team and seat management flow, separated from subscriptions.</p> <ul> <li>Team Endpoint: <code>GET /v2/payments/plan-financing/{plan_financing_id}/team</code></li> <li>Seat Endpoint: <code>GET|PUT|DELETE /v2/payments/plan-financing/{plan_financing_id}/team/seat</code></li> <li>Only the financing owner can view or modify seats.</li> <li>Seat limits mirror the purchased seats in the financing (owner seat + additional seats).</li> <li>Seat operations reuse the same payload shape as subscription seats (<code>add_seats</code>, <code>replace_seats</code>).</li> <li>Auto-recharge, when enabled on the financing, follows the same thresholds and spend limits as subscriptions.</li> <li>When consumption strategy is <code>PER_SEAT</code>, consumables are tied to each financing seat.</li> <li>When consumption strategy is <code>PER_TEAM</code>, consumables are shared across the financing team.</li> </ul> <p>Note: Invitations for unregistered users are not yet available for plan financings; seats created without a user stay pending until manually reassigned.</p>"},{"location":"LLM-DOCS/SEATS_AND_TEAMS/#team-settings-auto-recharge","title":"Team Settings &amp; Auto-Recharge","text":"<p>Billing teams can be configured to automatically recharge when running low on credits.</p>"},{"location":"LLM-DOCS/SEATS_AND_TEAMS/#update-team-settings","title":"Update Team Settings","text":"<p>Endpoint: <code>PUT /v1/payments/subscription/{subscription_id}/billing-team</code></p> <p>Purpose: Configure auto-recharge and spending limits.</p> <p>Request Body:</p> <pre><code>{\n  \"auto_recharge_enabled\": true,\n  \"recharge_threshold_amount\": \"10.00\",\n  \"recharge_amount\": \"100.00\",\n  \"max_period_spend\": \"1000.00\"\n}\n</code></pre> <p>Field Descriptions:</p> Field Type Required Description <code>auto_recharge_enabled</code> boolean \u274c No Enable automatic recharging <code>recharge_threshold_amount</code> string \u274c No Balance threshold to trigger recharge <code>recharge_amount</code> string \u274c No Amount to recharge when triggered <code>max_period_spend</code> string \u274c No Maximum spending per billing period <p>How Auto-Recharge Works:</p> <ol> <li>Team consumes resources (credits decrease)</li> <li>When balance drops below <code>recharge_threshold_amount</code></li> <li>System automatically purchases <code>recharge_amount</code> more credits</li> <li>Continues until <code>max_period_spend</code> limit reached</li> </ol> <p>Example:</p> <pre><code>const updateTeamSettings = async (subscriptionId, settings) =&gt; {\n  const token = localStorage.getItem('authToken');\n\n  const response = await fetch(\n    `https://breathecode.herokuapp.com/v1/payments/subscription/${subscriptionId}/billing-team`,\n    {\n      method: 'PUT',\n      headers: {\n        'Authorization': `Token ${token}`,\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify(settings)\n    }\n  );\n\n  return await response.json();\n};\n\n// Configure auto-recharge\nawait updateTeamSettings(123, {\n  auto_recharge_enabled: true,\n  recharge_threshold_amount: '20.00',  // Recharge when balance &lt; $20\n  recharge_amount: '100.00',            // Add $100 each time\n  max_period_spend: '500.00'            // Don't exceed $500/month\n});\n</code></pre>"},{"location":"LLM-DOCS/SEATS_AND_TEAMS/#spending-monitoring","title":"Spending Monitoring","text":"<p>The billing team tracks spending per period:</p> <pre><code>{\n  \"current_period_spend\": 250.50,\n  \"max_period_spend\": \"500.00\",\n  \"period_start\": \"2024-02-01T00:00:00\",\n  \"period_end\": \"2024-02-29T23:59:59\"\n}\n</code></pre> <p>Use this to: - Display budget remaining - Alert when approaching limit - Generate spending reports</p>"},{"location":"LLM-DOCS/SEATS_AND_TEAMS/#consumption-strategies_1","title":"Consumption Strategies","text":"<p>Plans can support different consumption models.</p>"},{"location":"LLM-DOCS/SEATS_AND_TEAMS/#plan-consumption-strategy","title":"Plan Consumption Strategy","text":"<p>When creating a plan, specify the strategy:</p> <pre><code>{\n  \"slug\": \"team-plan\",\n  \"title\": \"Team Plan\",\n  \"consumption_strategy\": \"PER_SEAT\",\n  \"seat_service_price\": 50.00\n}\n</code></pre> <p>Options:</p> Strategy Description Use Case <code>PER_SEAT</code> Each seat gets individual resources Training programs with per-student allocation <code>PER_TEAM</code> Team shares pooled resources Development teams sharing computing credits <code>BOTH</code> Owner chooses at checkout Flexible plans"},{"location":"LLM-DOCS/SEATS_AND_TEAMS/#consumable-allocation","title":"Consumable Allocation","text":""},{"location":"LLM-DOCS/SEATS_AND_TEAMS/#per_seat-strategy","title":"PER_SEAT Strategy","text":"<pre><code>// When seat is added, create individual consumables\n{\n  \"subscription\": 123,\n  \"subscription_billing_team\": 789,\n  \"subscription_seat\": 101,\n  \"user\": 456,\n  \"how_many\": 100  // This seat's allocation\n}\n</code></pre> <p>Consumption: - User 456 consumes from their 100 units - Other seats have their own allocations - Independent tracking per user</p>"},{"location":"LLM-DOCS/SEATS_AND_TEAMS/#per_team-strategy","title":"PER_TEAM Strategy","text":"<pre><code>// All seats share one consumable\n{\n  \"subscription\": 123,\n  \"subscription_billing_team\": 789,\n  \"subscription_seat\": null,\n  \"user\": null,\n  \"how_many\": 500  // Shared pool\n}\n</code></pre> <p>Consumption: - Any team member consumes from 500 units - No per-user tracking - Team-wide limit</p>"},{"location":"LLM-DOCS/SEATS_AND_TEAMS/#consumables-and-seats","title":"Consumables and Seats","text":""},{"location":"LLM-DOCS/SEATS_AND_TEAMS/#view-team-consumables","title":"View Team Consumables","text":"<p>Consumables represent the actual resources (credits, hours, etc.) available to the team.</p> <p>Query by Subscription:</p> <pre><code>const getTeamConsumables = async (subscriptionId) =&gt; {\n  const token = localStorage.getItem('authToken');\n\n  const response = await fetch(\n    `https://breathecode.herokuapp.com/v1/payments/consumable?subscription=${subscriptionId}`,\n    {\n      headers: {\n        'Authorization': `Token ${token}`\n      }\n    }\n  );\n\n  return await response.json();\n};\n</code></pre> <p>Response:</p> <pre><code>[\n  {\n    \"id\": 201,\n    \"service_item\": {\n      \"service\": \"mentorship\",\n      \"how_many\": 10\n    },\n    \"subscription\": 123,\n    \"subscription_billing_team\": 789,\n    \"subscription_seat\": 101,\n    \"user\": 456,\n    \"how_many\": 10,\n    \"balance\": 7,\n    \"valid_until\": \"2024-12-31T23:59:59Z\"\n  },\n  {\n    \"id\": 202,\n    \"service_item\": {\n      \"service\": \"mentorship\",\n      \"how_many\": 10\n    },\n    \"subscription\": 123,\n    \"subscription_billing_team\": 789,\n    \"subscription_seat\": 102,\n    \"user\": 457,\n    \"how_many\": 10,\n    \"balance\": 9\n  }\n]\n</code></pre>"},{"location":"LLM-DOCS/SEATS_AND_TEAMS/#view-seat-specific-consumables","title":"View Seat-Specific Consumables","text":"<pre><code>const getSeatConsumables = async (subscriptionId, seatId) =&gt; {\n  const token = localStorage.getItem('authToken');\n\n  const response = await fetch(\n    `https://breathecode.herokuapp.com/v1/payments/consumable?subscription=${subscriptionId}&amp;seat=${seatId}`,\n    {\n      headers: {\n        'Authorization': `Token ${token}`\n      }\n    }\n  );\n\n  return await response.json();\n};\n</code></pre>"},{"location":"LLM-DOCS/SEATS_AND_TEAMS/#inviting-team-members","title":"Inviting Team Members","text":"<p>When you add a seat without a <code>user</code> ID, an invitation is automatically sent.</p>"},{"location":"LLM-DOCS/SEATS_AND_TEAMS/#invitation-flow","title":"Invitation Flow","text":"<pre><code>1. Owner adds seat with email only\n   \u2193\n2. System creates SubscriptionSeat (user=null)\n   \u2193\n3. System creates UserInvite\n   \u2193\n4. Invitation email sent to member\n   \u2193\n5. Member clicks link and registers\n   \u2193\n6. SubscriptionSeat updated with user ID\n   \u2193\n7. Member gains access to team resources\n</code></pre>"},{"location":"LLM-DOCS/SEATS_AND_TEAMS/#add-seat-with-invitation","title":"Add Seat with Invitation","text":"<pre><code>const inviteTeamMember = async (subscriptionId, email) =&gt; {\n  const token = localStorage.getItem('authToken');\n\n  const response = await fetch(\n    `https://breathecode.herokuapp.com/v1/payments/subscription/${subscriptionId}/seat`,\n    {\n      method: 'PUT',\n      headers: {\n        'Authorization': `Token ${token}`,\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        add_seats: [\n          {\n            email: email,\n            user: null  // null triggers invitation\n          }\n        ]\n      })\n    }\n  );\n\n  return await response.json();\n};\n\n// Invite a new member\nconst result = await inviteTeamMember(123, 'newbie@company.com');\nconsole.log('Invitation sent!');\n</code></pre>"},{"location":"LLM-DOCS/SEATS_AND_TEAMS/#check-pending-invitations","title":"Check Pending Invitations","text":"<pre><code>// List seats to see which don't have users yet\nconst seats = await listSeats(123);\nconst pending = seats.filter(seat =&gt; seat.user === null &amp;&amp; seat.is_active);\n\nconsole.log(`${pending.length} pending invitations:`);\npending.forEach(seat =&gt; {\n  console.log(`- ${seat.email} (Seat ID: ${seat.id})`);\n});\n</code></pre>"},{"location":"LLM-DOCS/SEATS_AND_TEAMS/#removing-team-members","title":"Removing Team Members","text":""},{"location":"LLM-DOCS/SEATS_AND_TEAMS/#deactivate-seat","title":"Deactivate Seat","text":"<p>To remove someone from the team:</p> <pre><code>const removeTeamMember = async (subscriptionId, seatId) =&gt; {\n  const token = localStorage.getItem('authToken');\n\n  await fetch(\n    `https://breathecode.herokuapp.com/v1/payments/subscription/${subscriptionId}/seat/${seatId}`,\n    {\n      method: 'DELETE',\n      headers: {\n        'Authorization': `Token ${token}`\n      }\n    }\n  );\n};\n</code></pre> <p>What Happens: - Seat marked <code>is_active=false</code> - User loses access immediately - Consumables remain but <code>user</code> field cleared - Seat count decreases by 1 - Slot available for new member</p>"},{"location":"LLM-DOCS/SEATS_AND_TEAMS/#reactivate-slot","title":"Reactivate Slot","text":"<p>The deactivated seat can be reassigned:</p> <pre><code>// Add new member (will reuse available slots)\nawait addSeats(123, [\n  { email: 'replacement@company.com', user: null }\n]);\n</code></pre>"},{"location":"LLM-DOCS/SEATS_AND_TEAMS/#seat-limits-and-scaling","title":"Seat Limits and Scaling","text":""},{"location":"LLM-DOCS/SEATS_AND_TEAMS/#check-available-seats","title":"Check Available Seats","text":"<pre><code>const getAvailableSeats = async (subscriptionId) =&gt; {\n  const team = await getBillingTeam(subscriptionId);\n  const available = team.seats_limit - team.seats_count;\n\n  console.log(`Available seats: ${available} of ${team.seats_limit}`);\n  return available;\n};\n</code></pre>"},{"location":"LLM-DOCS/SEATS_AND_TEAMS/#scale-up-buy-more-seats","title":"Scale Up (Buy More Seats)","text":"<p>To increase seat limit, purchase additional seats through checkout:</p> <pre><code>const addMoreSeats = async (subscriptionId, additionalSeats) =&gt; {\n  const token = localStorage.getItem('authToken');\n\n  // This would typically be handled through the checkout flow\n  // Contact support or use upgrade endpoint\n\n  console.log(`Request ${additionalSeats} more seats for subscription ${subscriptionId}`);\n};\n</code></pre> <p>Note: Currently, seat limit changes may require contacting support or going through a separate checkout flow.</p>"},{"location":"LLM-DOCS/SEATS_AND_TEAMS/#seat-limit-validation","title":"Seat Limit Validation","text":"<p>When adding seats, the system validates against the limit:</p> <pre><code>try {\n  await addSeats(123, [\n    { email: 'user1@company.com' },\n    { email: 'user2@company.com' },\n    { email: 'user3@company.com' }\n  ]);\n} catch (error) {\n  if (error.message.includes('seat limit')) {\n    console.error('Cannot add seats: limit reached');\n    // Prompt to purchase more seats\n  }\n}\n</code></pre>"},{"location":"LLM-DOCS/SEATS_AND_TEAMS/#billing-and-charges","title":"Billing and Charges","text":""},{"location":"LLM-DOCS/SEATS_AND_TEAMS/#how-team-billing-works","title":"How Team Billing Works","text":"<ol> <li>Initial Purchase:</li> <li>Owner pays for subscription</li> <li> <p>Includes base fee + (seat price \u00d7 additional seats)</p> </li> <li> <p>Seat Charges:</p> </li> <li>Each additional seat beyond owner costs extra</li> <li> <p>Charged monthly based on plan's <code>seat_service_price</code></p> </li> <li> <p>Consumption Charges:</p> </li> <li>Team members consume resources (credits, hours)</li> <li>Charges based on consumption strategy</li> <li>PER_SEAT: Each seat billed individually</li> <li> <p>PER_TEAM: Team billed for total usage</p> </li> <li> <p>Auto-Recharge:</p> </li> <li>When enabled, automatically purchases more credits</li> <li>Charged to subscription owner's payment method</li> <li>Subject to <code>max_period_spend</code> limit</li> </ol>"},{"location":"LLM-DOCS/SEATS_AND_TEAMS/#view-current-period-spending","title":"View Current Period Spending","text":"<pre><code>const getTeamSpending = async (subscriptionId) =&gt; {\n  const team = await getBillingTeam(subscriptionId);\n\n  console.log('Current Period:', {\n    start: team.period_start,\n    end: team.period_end,\n    spent: team.current_period_spend,\n    limit: team.max_period_spend,\n    remaining: parseFloat(team.max_period_spend) - team.current_period_spend\n  });\n\n  return team;\n};\n</code></pre>"},{"location":"LLM-DOCS/SEATS_AND_TEAMS/#api-reference","title":"API Reference","text":""},{"location":"LLM-DOCS/SEATS_AND_TEAMS/#complete-endpoint-list","title":"Complete Endpoint List","text":"Endpoint Method Purpose Auth <code>/v1/payments/consumable/checkout</code> POST Purchase team plan \u2705 Required <code>/v1/payments/subscription/{id}/billing-team</code> GET Get billing team info \u2705 Owner only <code>/v1/payments/subscription/{id}/billing-team</code> PUT Update team settings \u2705 Owner only <code>/v1/payments/subscription/{id}/seat</code> GET List all seats \u2705 Owner only <code>/v1/payments/subscription/{id}/seat/{seat_id}</code> GET Get single seat \u2705 Owner only <code>/v1/payments/subscription/{id}/seat</code> PUT Add/replace seats \u2705 Owner only <code>/v1/payments/subscription/{id}/seat/{seat_id}</code> DELETE Remove seat \u2705 Owner only <code>/v1/payments/consumable</code> GET List consumables \u2705 Required"},{"location":"LLM-DOCS/SEATS_AND_TEAMS/#query-parameters","title":"Query Parameters","text":"<p>List Consumables:</p> Parameter Example Description <code>subscription</code> <code>?subscription=123</code> Filter by subscription <code>user</code> <code>?user=456</code> Filter by user <code>service</code> <code>?service=mentorship</code> Filter by service"},{"location":"LLM-DOCS/SEATS_AND_TEAMS/#complete-workflows","title":"Complete Workflows","text":""},{"location":"LLM-DOCS/SEATS_AND_TEAMS/#workflow-1-create-team-and-invite-members","title":"Workflow 1: Create Team and Invite Members","text":"<pre><code>// Step 1: Purchase team plan with 5 seats\nconst checkout = await fetch(\n  'https://breathecode.herokuapp.com/v1/payments/consumable/checkout',\n  {\n    method: 'POST',\n    headers: {\n      'Authorization': `Token ${token}`,\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify({\n      plan: 1,\n      additional_seats: 4,  // 4 + 1 owner = 5 total\n      currency: 'USD'\n    })\n  }\n).then(r =&gt; r.json());\n\nconst subscriptionId = checkout.subscription.id;\nconsole.log(`Created subscription ${subscriptionId} with 5 seats`);\n\n// Step 2: Invite team members\nconst inviteResult = await fetch(\n  `https://breathecode.herokuapp.com/v1/payments/subscription/${subscriptionId}/seat`,\n  {\n    method: 'PUT',\n    headers: {\n      'Authorization': `Token ${token}`,\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify({\n      add_seats: [\n        { email: 'alice@company.com', user: null },\n        { email: 'bob@company.com', user: null },\n        { email: 'carol@company.com', user: null },\n        { email: 'dave@company.com', user: null }\n      ]\n    })\n  }\n).then(r =&gt; r.json());\n\nconsole.log(`Invited ${inviteResult.data.length} members`);\n\n// Step 3: Configure auto-recharge\nawait fetch(\n  `https://breathecode.herokuapp.com/v1/payments/subscription/${subscriptionId}/billing-team`,\n  {\n    method: 'PUT',\n    headers: {\n      'Authorization': `Token ${token}`,\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify({\n      auto_recharge_enabled: true,\n      recharge_threshold_amount: '50.00',\n      recharge_amount: '200.00',\n      max_period_spend: '1000.00'\n    })\n  }\n);\n\nconsole.log('\u2705 Team created and configured!');\n</code></pre>"},{"location":"LLM-DOCS/SEATS_AND_TEAMS/#workflow-2-monitor-team-usage","title":"Workflow 2: Monitor Team Usage","text":"<pre><code>// Get team overview\nconst team = await fetch(\n  `https://breathecode.herokuapp.com/v1/payments/subscription/${subscriptionId}/billing-team`,\n  { headers: { 'Authorization': `Token ${token}` } }\n).then(r =&gt; r.json());\n\nconsole.log('Team Overview:');\nconsole.log(`- Seats: ${team.seats_count}/${team.seats_limit}`);\nconsole.log(`- Period spend: $${team.current_period_spend}/$${team.max_period_spend}`);\nconsole.log(`- Auto-recharge: ${team.auto_recharge_enabled ? 'ON' : 'OFF'}`);\n\n// Get all seats\nconst seats = await fetch(\n  `https://breathecode.herokuapp.com/v1/payments/subscription/${subscriptionId}/seat`,\n  { headers: { 'Authorization': `Token ${token}` } }\n).then(r =&gt; r.json());\n\nconsole.log('\\nSeats:');\nseats.forEach(seat =&gt; {\n  const status = seat.user ? 'Active' : 'Pending';\n  console.log(`- ${seat.email}: ${status}`);\n});\n\n// Get consumables\nconst consumables = await fetch(\n  `https://breathecode.herokuapp.com/v1/payments/consumable?subscription=${subscriptionId}`,\n  { headers: { 'Authorization': `Token ${token}` } }\n).then(r =&gt; r.json());\n\nconsole.log('\\nConsumables:');\nconsumables.forEach(c =&gt; {\n  const percent = ((c.balance / c.how_many) * 100).toFixed(0);\n  console.log(`- ${c.service_item.service}: ${c.balance}/${c.how_many} (${percent}%)`);\n});\n</code></pre>"},{"location":"LLM-DOCS/SEATS_AND_TEAMS/#workflow-3-replace-departing-member","title":"Workflow 3: Replace Departing Member","text":"<pre><code>// Step 1: Find the seat to replace\nconst seats = await fetch(\n  `https://breathecode.herokuapp.com/v1/payments/subscription/${subscriptionId}/seat`,\n  { headers: { 'Authorization': `Token ${token}` } }\n).then(r =&gt; r.json());\n\nconst departingSeat = seats.find(s =&gt; s.email === 'leaving@company.com');\n\nif (departingSeat) {\n  // Step 2: Replace with new member\n  await fetch(\n    `https://breathecode.herokuapp.com/v1/payments/subscription/${subscriptionId}/seat`,\n    {\n      method: 'PUT',\n      headers: {\n        'Authorization': `Token ${token}`,\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        replace_seats: [\n          {\n            from_email: 'leaving@company.com',\n            to_email: 'newmember@company.com',\n            to_user: null  // Will send invitation\n          }\n        ]\n      })\n    }\n  );\n\n  console.log('\u2705 Member replaced successfully');\n}\n</code></pre>"},{"location":"LLM-DOCS/SEATS_AND_TEAMS/#best-practices","title":"Best Practices","text":""},{"location":"LLM-DOCS/SEATS_AND_TEAMS/#1-always-check-seat-availability","title":"1. Always Check Seat Availability","text":"<pre><code>const canAddSeats = async (subscriptionId, count) =&gt; {\n  const team = await getBillingTeam(subscriptionId);\n  const available = team.seats_limit - team.seats_count;\n\n  if (available &lt; count) {\n    throw new Error(`Only ${available} seats available, need ${count}`);\n  }\n\n  return true;\n};\n\n// Before adding\nawait canAddSeats(123, 3);\nawait addSeats(123, [...]);\n</code></pre>"},{"location":"LLM-DOCS/SEATS_AND_TEAMS/#2-handle-partial-failures","title":"2. Handle Partial Failures","text":"<p>The seat endpoint returns 207 Multi-Status:</p> <pre><code>const result = await addSeats(123, seats);\n\nif (result.errors.length &gt; 0) {\n  console.warn('Some seats failed:');\n  result.errors.forEach(err =&gt; {\n    console.warn(`- ${err.message}`);\n  });\n}\n\nif (result.data.length &gt; 0) {\n  console.log(`Successfully added ${result.data.length} seats`);\n}\n</code></pre>"},{"location":"LLM-DOCS/SEATS_AND_TEAMS/#3-monitor-spending-limits","title":"3. Monitor Spending Limits","text":"<pre><code>const checkSpendingLimit = async (subscriptionId) =&gt; {\n  const team = await getBillingTeam(subscriptionId);\n  const remaining = parseFloat(team.max_period_spend) - team.current_period_spend;\n  const percentUsed = (team.current_period_spend / parseFloat(team.max_period_spend)) * 100;\n\n  if (percentUsed &gt; 80) {\n    console.warn(`\u26a0\ufe0f ${percentUsed.toFixed(0)}% of budget used`);\n  }\n\n  return remaining;\n};\n</code></pre>"},{"location":"LLM-DOCS/SEATS_AND_TEAMS/#4-use-replace-instead-of-removeadd","title":"4. Use Replace Instead of Remove+Add","text":"<p>When swapping members, use replace to maintain continuity:</p> <pre><code>// \u274c Bad: Remove then add (loses history)\nawait removeSeat(123, oldSeatId);\nawait addSeats(123, [{ email: 'new@company.com' }]);\n\n// \u2705 Good: Replace (maintains seat slot)\nawait replaceSeat(123, 'old@company.com', 'new@company.com');\n</code></pre>"},{"location":"LLM-DOCS/SEATS_AND_TEAMS/#troubleshooting","title":"Troubleshooting","text":""},{"location":"LLM-DOCS/SEATS_AND_TEAMS/#common-issues","title":"Common Issues","text":""},{"location":"LLM-DOCS/SEATS_AND_TEAMS/#issue-only-the-owner-can-manage-team-members","title":"Issue: \"Only the owner can manage team members\"","text":"<p>Cause: Non-owner trying to manage seats.</p> <p>Solution: Only the subscription owner can add/remove team members.</p>"},{"location":"LLM-DOCS/SEATS_AND_TEAMS/#issue-seat-limit-exceeded","title":"Issue: \"Seat limit exceeded\"","text":"<p>Cause: Trying to add more seats than available.</p> <p>Solution: Check available seats or purchase more:</p> <pre><code>const team = await getBillingTeam(subscriptionId);\nconsole.log(`Available: ${team.seats_limit - team.seats_count}`);\n</code></pre>"},{"location":"LLM-DOCS/SEATS_AND_TEAMS/#issue-seat-not-found","title":"Issue: \"Seat not found\"","text":"<p>Cause: Seat ID doesn't exist or is inactive.</p> <p>Solution: List all seats to verify:</p> <pre><code>const seats = await listSeats(subscriptionId);\nconst activeSeat = seats.find(s =&gt; s.id === seatId &amp;&amp; s.is_active);\n</code></pre>"},{"location":"LLM-DOCS/SEATS_AND_TEAMS/#issue-team-not-found","title":"Issue: \"Team not found\"","text":"<p>Cause: Subscription doesn't have a billing team.</p> <p>Solution: Billing team is created during checkout. Verify:</p> <pre><code>const subscription = await getSubscription(subscriptionId);\nif (!subscription.has_billing_team) {\n  console.error('This subscription does not support teams');\n}\n</code></pre>"},{"location":"LLM-DOCS/SEATS_AND_TEAMS/#related-documentation","title":"Related Documentation","text":"<ul> <li>ACADEMY_PLANS.md - Plan creation and pricing</li> <li>BC_CHECKOUT_CONSUMABLE.md - Checkout process</li> <li>AUTHENTICATION.md - API authentication</li> </ul>"},{"location":"LLM-DOCS/SEATS_AND_TEAMS/#support","title":"Support","text":"<p>For questions or issues with seats and teams: - Verify you are the subscription owner - Check seat limits before adding members - Monitor spending to avoid exceeding limits - Contact support for seat limit increases</p> <p>Last Updated: October 2024</p>"},{"location":"LLM-DOCS/STUDENT_REPORT/","title":"Student Report API - Complete Guide","text":"<p>This document provides a comprehensive guide for academies to retrieve complete information about their students using the BreatheCode API.</p>"},{"location":"LLM-DOCS/STUDENT_REPORT/#table-of-contents","title":"Table of Contents","text":"<ol> <li>Overview</li> <li>Authentication &amp; Permissions</li> <li>Core Student Endpoints</li> <li>Student Data by Category</li> <li>Complete Student Report Workflow</li> <li>Query Parameters Reference</li> <li>Response Examples</li> </ol>"},{"location":"LLM-DOCS/STUDENT_REPORT/#overview","title":"Overview","text":"<p>The BreatheCode API provides multiple endpoints to gather comprehensive information about students. This includes:</p> <ul> <li>Basic Profile: User information, contact details, GitHub profile</li> <li>Enrollment Status: Cohort assignments, educational status, financial status</li> <li>Academic Progress: Tasks, assignments, projects, code reviews</li> <li>Mentorship: Sessions, feedback, mentor interactions</li> <li>Activity: Learning activity, attendance, engagement metrics</li> <li>History: Cohort changes, status updates, timeline</li> </ul>"},{"location":"LLM-DOCS/STUDENT_REPORT/#authentication-permissions","title":"Authentication &amp; Permissions","text":""},{"location":"LLM-DOCS/STUDENT_REPORT/#required-headers","title":"Required Headers","text":"<p>All academy-scoped endpoints require:</p> <pre><code>Authorization: Token {your-access-token}\nAcademy: {academy_id}\n</code></pre>"},{"location":"LLM-DOCS/STUDENT_REPORT/#required-permissions","title":"Required Permissions","text":"<p>Different endpoints require different capabilities:</p> <ul> <li><code>read_student</code> - View basic student information</li> <li><code>read_all_cohort</code> - View cohort and enrollment data</li> <li><code>task_delivery_details</code> - View student assignments and tasks</li> <li><code>read_mentorship_session</code> - View mentorship sessions</li> <li><code>read_activity</code> - View student activity logs</li> </ul> <p>Note: Academy staff with appropriate roles automatically have these permissions. See create_academy_roles.py for full capability list.</p>"},{"location":"LLM-DOCS/STUDENT_REPORT/#core-student-endpoints","title":"Core Student Endpoints","text":""},{"location":"LLM-DOCS/STUDENT_REPORT/#1-get-basic-student-profile","title":"1. Get Basic Student Profile","text":"<p>Endpoint: <code>GET /v1/auth/academy/student/{user_id_or_email}</code></p> <p>Purpose: Get basic student information including profile, status, and academy role.</p> <p>Parameters: - <code>user_id_or_email</code> - Can be numeric user ID or email address</p> <p>Headers: <pre><code>Authorization: Token {token}\nAcademy: {academy_id}\n</code></pre></p> <p>Response includes: - User details: <code>id</code>, <code>first_name</code>, <code>last_name</code>, <code>email</code> - Profile: <code>avatar_url</code>, <code>phone</code>, <code>bio</code> - GitHub: <code>username</code>, <code>avatar_url</code>, <code>name</code> - Role: Academy role and permissions - Status: <code>ACTIVE</code>, <code>INVITED</code>, etc.</p> <p>Example: <pre><code>GET https://breathecode.herokuapp.com/v1/auth/academy/student/123\nAuthorization: Token abc123...\nAcademy: 4\n</code></pre></p> <p>Response: <pre><code>{\n  \"id\": 123,\n  \"user\": {\n    \"id\": 123,\n    \"email\": \"student@example.com\",\n    \"first_name\": \"John\",\n    \"last_name\": \"Doe\",\n    \"github\": {\n      \"username\": \"johndoe\",\n      \"avatar_url\": \"https://avatars.githubusercontent.com/u/123?v=4\"\n    }\n  },\n  \"role\": {\n    \"slug\": \"student\",\n    \"name\": \"Student\"\n  },\n  \"status\": \"ACTIVE\",\n  \"phone\": \"+1234567890\",\n  \"created_at\": \"2024-01-15T10:30:00Z\"\n}\n</code></pre></p>"},{"location":"LLM-DOCS/STUDENT_REPORT/#2-list-all-academy-students","title":"2. List All Academy Students","text":"<p>Endpoint: <code>GET /v1/auth/academy/student</code></p> <p>Purpose: Get list of all students in the academy with filtering options.</p> <p>Query Parameters: - <code>like={text}</code> - Search by name or email - <code>status=ACTIVE|INVITED</code> - Filter by profile status - <code>cohort={slug1,slug2}</code> - Filter by cohort slugs - <code>limit={number}</code> - Pagination limit - <code>offset={number}</code> - Pagination offset</p> <p>Example: <pre><code>GET https://breathecode.herokuapp.com/v1/auth/academy/student?cohort=web-dev-pt-01&amp;status=ACTIVE\nAuthorization: Token abc123...\nAcademy: 4\n</code></pre></p>"},{"location":"LLM-DOCS/STUDENT_REPORT/#student-data-by-category","title":"Student Data by Category","text":""},{"location":"LLM-DOCS/STUDENT_REPORT/#a-enrollment-cohort-information","title":"A. Enrollment &amp; Cohort Information","text":""},{"location":"LLM-DOCS/STUDENT_REPORT/#get-students-cohort-enrollments","title":"Get Student's Cohort Enrollments","text":"<p>Endpoint: <code>GET /v1/admissions/academy/cohort/user</code></p> <p>Purpose: Get detailed cohort enrollment information including educational and financial status.</p> <p>Query Parameters: - <code>users={user_id1,user_id2}</code> - Filter by specific user IDs - <code>roles=STUDENT</code> - Filter by role (use STUDENT for students) - <code>educational_status={status}</code> - Filter by educational status   - Options: <code>ACTIVE</code>, <code>POSTPONED</code>, <code>SUSPENDED</code>, <code>GRADUATED</code>, <code>DROPPED</code>, <code>NOT_COMPLETING</code> - <code>finantial_status={status}</code> - Filter by financial status   - Options: <code>FULLY_PAID</code>, <code>UP_TO_DATE</code>, <code>LATE</code> - <code>cohorts={slug1,slug2}</code> - Filter by cohort slugs - <code>syllabus={slug}</code> - Filter by syllabus slug - <code>like={name}</code> - Search by student name - <code>distinct=true</code> - Get unique users only (if student in multiple cohorts) - <code>sort={field}</code> - Sort results (default: <code>-created_at</code>)</p> <p>Example: <pre><code>GET https://breathecode.herokuapp.com/v1/admissions/academy/cohort/user?users=123&amp;roles=STUDENT\nAuthorization: Token abc123...\nAcademy: 4\n</code></pre></p> <p>Response: <pre><code>[\n  {\n    \"id\": 456,\n    \"user\": {\n      \"id\": 123,\n      \"email\": \"student@example.com\",\n      \"first_name\": \"John\",\n      \"last_name\": \"Doe\"\n    },\n    \"cohort\": {\n      \"id\": 10,\n      \"slug\": \"web-dev-pt-01\",\n      \"name\": \"Web Development Part-Time Cohort 01\",\n      \"stage\": \"STARTED\",\n      \"current_day\": 45,\n      \"syllabus_version\": {\n        \"name\": \"Full-Stack Software Development\",\n        \"slug\": \"full-stack\"\n      }\n    },\n    \"role\": \"STUDENT\",\n    \"educational_status\": \"ACTIVE\",\n    \"finantial_status\": \"UP_TO_DATE\",\n    \"created_at\": \"2024-01-15T10:00:00Z\",\n    \"watching\": true\n  }\n]\n</code></pre></p>"},{"location":"LLM-DOCS/STUDENT_REPORT/#get-student-in-specific-cohort","title":"Get Student in Specific Cohort","text":"<p>Endpoint: <code>GET /v1/admissions/academy/cohort/{cohort_id}/user/{user_id}</code></p> <p>Purpose: Get detailed information about a student in a specific cohort, including optional task data.</p> <p>Query Parameters: - <code>tasks=True</code> - Include task/assignment statistics</p> <p>Example: <pre><code>GET https://breathecode.herokuapp.com/v1/admissions/academy/cohort/10/user/123?tasks=True\nAuthorization: Token abc123...\nAcademy: 4\n</code></pre></p> <p>Response with tasks=True: <pre><code>{\n  \"id\": 456,\n  \"user\": {\n    \"id\": 123,\n    \"email\": \"student@example.com\",\n    \"first_name\": \"John\",\n    \"last_name\": \"Doe\"\n  },\n  \"cohort\": {\n    \"id\": 10,\n    \"slug\": \"web-dev-pt-01\",\n    \"name\": \"Web Development Part-Time Cohort 01\"\n  },\n  \"role\": \"STUDENT\",\n  \"educational_status\": \"ACTIVE\",\n  \"finantial_status\": \"UP_TO_DATE\",\n  \"tasks\": {\n    \"total\": 50,\n    \"completed\": 35,\n    \"pending\": 10,\n    \"approved\": 30,\n    \"rejected\": 3\n  }\n}\n</code></pre></p>"},{"location":"LLM-DOCS/STUDENT_REPORT/#get-cohort-details","title":"Get Cohort Details","text":"<p>Endpoint: <code>GET /v1/admissions/academy/cohort/{cohort_id}</code></p> <p>Purpose: Get complete cohort information including syllabus, schedule, and settings.</p> <p>Example: <pre><code>GET https://breathecode.herokuapp.com/v1/admissions/academy/cohort/10\nAuthorization: Token abc123...\nAcademy: 4\n</code></pre></p>"},{"location":"LLM-DOCS/STUDENT_REPORT/#b-tasks-assignments","title":"B. Tasks &amp; Assignments","text":""},{"location":"LLM-DOCS/STUDENT_REPORT/#get-students-tasks","title":"Get Student's Tasks","text":"<p>Endpoint: <code>GET /v1/assignments/user/{user_id}/task</code></p> <p>Purpose: Get all tasks/assignments for a specific student.</p> <p>Query Parameters: - <code>cohort={cohort_id}</code> - Filter by cohort - <code>task_status={status}</code> - Filter by status   - Options: <code>PENDING</code>, <code>DONE</code>, <code>APPROVED</code>, <code>REJECTED</code> - <code>task_type={type}</code> - Filter by type   - Options: <code>EXERCISE</code>, <code>PROJECT</code>, <code>QUIZ</code>, <code>LESSON</code> - <code>revision_status={status}</code> - Filter by review status - <code>limit={number}</code> - Pagination limit - <code>offset={number}</code> - Pagination offset</p> <p>Example: <pre><code>GET https://breathecode.herokuapp.com/v1/assignments/user/123/task?task_type=PROJECT\nAuthorization: Token abc123...\nAcademy: 4\n</code></pre></p> <p>Response: <pre><code>[\n  {\n    \"id\": 789,\n    \"title\": \"Build a Todo App\",\n    \"task_type\": \"PROJECT\",\n    \"task_status\": \"DONE\",\n    \"revision_status\": \"APPROVED\",\n    \"github_url\": \"https://github.com/johndoe/todo-app\",\n    \"live_url\": \"https://todo-app.vercel.app\",\n    \"description\": \"A full-stack todo application\",\n    \"opened_at\": \"2024-02-01T10:00:00Z\",\n    \"delivered_at\": \"2024-02-10T15:30:00Z\",\n    \"approved_at\": \"2024-02-11T09:00:00Z\",\n    \"cohort\": {\n      \"id\": 10,\n      \"slug\": \"web-dev-pt-01\"\n    },\n    \"associated_slug\": \"build-todo-app-react\"\n  }\n]\n</code></pre></p>"},{"location":"LLM-DOCS/STUDENT_REPORT/#get-specific-task-details","title":"Get Specific Task Details","text":"<p>Endpoint: <code>GET /v1/assignments/user/{user_id}/task/{task_id}</code></p> <p>Purpose: Get detailed information about a specific task.</p> <p>Example: <pre><code>GET https://breathecode.herokuapp.com/v1/assignments/user/123/task/789\nAuthorization: Token abc123...\nAcademy: 4\n</code></pre></p>"},{"location":"LLM-DOCS/STUDENT_REPORT/#get-task-code-reviews","title":"Get Task Code Reviews","text":"<p>Endpoint: <code>GET /v1/assignments/academy/coderevision</code></p> <p>Purpose: Get code reviews for student tasks.</p> <p>Query Parameters: - <code>author={user_id}</code> - Filter by student (task author) - <code>reviewer={user_id}</code> - Filter by reviewer - <code>task={task_id}</code> - Filter by specific task - <code>status={status}</code> - Filter by review status   - Options: <code>PENDING</code>, <code>APPROVED</code>, <code>REJECTED</code>, <code>IGNORED</code></p> <p>Example: <pre><code>GET https://breathecode.herokuapp.com/v1/assignments/academy/coderevision?author=123\nAuthorization: Token abc123...\nAcademy: 4\n</code></pre></p> <p>Response: <pre><code>[\n  {\n    \"id\": 101,\n    \"task\": {\n      \"id\": 789,\n      \"title\": \"Build a Todo App\"\n    },\n    \"author\": {\n      \"id\": 123,\n      \"first_name\": \"John\",\n      \"last_name\": \"Doe\"\n    },\n    \"reviewer\": {\n      \"id\": 456,\n      \"first_name\": \"Jane\",\n      \"last_name\": \"Smith\"\n    },\n    \"status\": \"APPROVED\",\n    \"comments\": \"Great job! Clean code and good practices.\",\n    \"created_at\": \"2024-02-11T08:30:00Z\"\n  }\n]\n</code></pre></p>"},{"location":"LLM-DOCS/STUDENT_REPORT/#get-task-commit-files","title":"Get Task Commit Files","text":"<p>Endpoint: <code>GET /v1/assignments/academy/task/{task_id}/commitfile</code></p> <p>Purpose: Get commit history and files for a task.</p> <p>Example: <pre><code>GET https://breathecode.herokuapp.com/v1/assignments/academy/task/789/commitfile\nAuthorization: Token abc123...\nAcademy: 4\n</code></pre></p>"},{"location":"LLM-DOCS/STUDENT_REPORT/#get-cohort-tasks-overview","title":"Get Cohort Tasks Overview","text":"<p>Endpoint: <code>GET /v1/assignments/academy/cohort/{cohort_id}/task</code></p> <p>Purpose: Get all tasks for a cohort (useful for comparing student progress).</p> <p>Query Parameters: - <code>task_type={type}</code> - Filter by type - <code>user={user_id}</code> - Filter by specific user</p> <p>Example: <pre><code>GET https://breathecode.herokuapp.com/v1/assignments/academy/cohort/10/task?user=123\nAuthorization: Token abc123...\nAcademy: 4\n</code></pre></p>"},{"location":"LLM-DOCS/STUDENT_REPORT/#get-students-final-projects","title":"Get Student's Final Projects","text":"<p>Endpoint: <code>GET /v1/assignments/academy/cohort/{cohort_id}/final_project</code></p> <p>Purpose: Get final project submissions for cohort students.</p> <p>Query Parameters: - <code>user={user_id}</code> - Filter by specific student</p> <p>Example: <pre><code>GET https://breathecode.herokuapp.com/v1/assignments/academy/cohort/10/final_project?user=123\nAuthorization: Token abc123...\nAcademy: 4\n</code></pre></p>"},{"location":"LLM-DOCS/STUDENT_REPORT/#c-mentorship-sessions","title":"C. Mentorship Sessions","text":""},{"location":"LLM-DOCS/STUDENT_REPORT/#get-students-mentorship-sessions","title":"Get Student's Mentorship Sessions","text":"<p>Endpoint: <code>GET /v1/mentorship/academy/session</code></p> <p>Purpose: Get all mentorship sessions for a student.</p> <p>Query Parameters: - <code>student={name}</code> - Filter by student name (fuzzy search) - <code>mentor={name}</code> - Filter by mentor name - <code>status={status}</code> - Filter by session status   - Options: <code>PENDING</code>, <code>STARTED</code>, <code>COMPLETED</code>, <code>FAILED</code>, <code>IGNORED</code> - <code>with_feedback={true|false}</code> - Filter by feedback presence - <code>mentee={user_id}</code> - Filter by student user ID - <code>started_after={date}</code> - Filter sessions after date (ISO format) - <code>ended_before={date}</code> - Filter sessions before date (ISO format) - <code>limit={number}</code> - Pagination limit - <code>offset={number}</code> - Pagination offset</p> <p>Example: <pre><code>GET https://breathecode.herokuapp.com/v1/mentorship/academy/session?student=John Doe&amp;with_feedback=true\nAuthorization: Token abc123...\nAcademy: 4\n</code></pre></p> <p>Response: <pre><code>[\n  {\n    \"id\": 234,\n    \"mentor\": {\n      \"id\": 456,\n      \"user\": {\n        \"first_name\": \"Jane\",\n        \"last_name\": \"Smith\"\n      }\n    },\n    \"mentee\": {\n      \"id\": 123,\n      \"first_name\": \"John\",\n      \"last_name\": \"Doe\",\n      \"email\": \"student@example.com\"\n    },\n    \"service\": {\n      \"name\": \"Code Review Session\",\n      \"slug\": \"code-review\"\n    },\n    \"status\": \"COMPLETED\",\n    \"started_at\": \"2024-02-15T14:00:00Z\",\n    \"ended_at\": \"2024-02-15T15:00:00Z\",\n    \"summary\": \"Reviewed React component structure\",\n    \"answer\": {\n      \"score\": 9,\n      \"comment\": \"Very helpful session, learned a lot about hooks\",\n      \"lowest\": \"Time management\",\n      \"highest\": \"Technical knowledge\"\n    }\n  }\n]\n</code></pre></p>"},{"location":"LLM-DOCS/STUDENT_REPORT/#d-activity-engagement","title":"D. Activity &amp; Engagement","text":""},{"location":"LLM-DOCS/STUDENT_REPORT/#get-student-activity","title":"Get Student Activity","text":"<p>Endpoint: <code>GET /v1/activity/academy/student/{student_id}</code></p> <p>Purpose: Get activity log for a specific student.</p> <p>Query Parameters: - <code>cohort={cohort_id}</code> - Filter by cohort - <code>start={date}</code> - Filter from date (ISO format) - <code>end={date}</code> - Filter to date (ISO format)</p> <p>Example: <pre><code>GET https://breathecode.herokuapp.com/v1/activity/academy/student/123\nAuthorization: Token abc123...\nAcademy: 4\n</code></pre></p> <p>Response: <pre><code>[\n  {\n    \"id\": 567,\n    \"slug\": \"lesson_opened\",\n    \"user\": {\n      \"id\": 123,\n      \"first_name\": \"John\",\n      \"last_name\": \"Doe\"\n    },\n    \"cohort\": {\n      \"id\": 10,\n      \"slug\": \"web-dev-pt-01\"\n    },\n    \"day\": 45,\n    \"created_at\": \"2024-02-20T10:30:00Z\",\n    \"data\": {\n      \"slug\": \"learn-react-hooks\",\n      \"title\": \"Learn React Hooks\"\n    }\n  },\n  {\n    \"id\": 568,\n    \"slug\": \"exercise_started\",\n    \"user\": {\n      \"id\": 123,\n      \"first_name\": \"John\",\n      \"last_name\": \"Doe\"\n    },\n    \"cohort\": {\n      \"id\": 10,\n      \"slug\": \"web-dev-pt-01\"\n    },\n    \"day\": 45,\n    \"created_at\": \"2024-02-20T11:00:00Z\",\n    \"data\": {\n      \"slug\": \"react-hooks-practice\"\n    }\n  }\n]\n</code></pre></p>"},{"location":"LLM-DOCS/STUDENT_REPORT/#get-cohort-activity-report","title":"Get Cohort Activity Report","text":"<p>Endpoint: <code>GET /v1/activity/academy/cohort/{cohort_id}</code></p> <p>Purpose: Get activity metrics for entire cohort (useful for comparing student engagement).</p> <p>Query Parameters: - <code>user={user_id}</code> - Filter by specific student</p> <p>Example: <pre><code>GET https://breathecode.herokuapp.com/v1/activity/academy/cohort/10?user=123\nAuthorization: Token abc123...\nAcademy: 4\n</code></pre></p>"},{"location":"LLM-DOCS/STUDENT_REPORT/#e-student-history-timeline","title":"E. Student History &amp; Timeline","text":""},{"location":"LLM-DOCS/STUDENT_REPORT/#get-students-cohort-history","title":"Get Student's Cohort History","text":"<p>Endpoint: <code>GET /v1/admissions/academy/cohort/{cohort_id}/log</code></p> <p>Purpose: Get timeline of changes for a student in a cohort (status changes, drops, etc.).</p> <p>Example: <pre><code>GET https://breathecode.herokuapp.com/v1/admissions/academy/cohort/10/log\nAuthorization: Token abc123...\nAcademy: 4\n</code></pre></p> <p>Response: <pre><code>[\n  {\n    \"id\": 890,\n    \"cohort\": {\n      \"id\": 10,\n      \"slug\": \"web-dev-pt-01\"\n    },\n    \"user\": {\n      \"id\": 123,\n      \"first_name\": \"John\",\n      \"last_name\": \"Doe\"\n    },\n    \"changes\": {\n      \"educational_status\": {\n        \"old\": \"ACTIVE\",\n        \"new\": \"GRADUATED\"\n      }\n    },\n    \"created_at\": \"2024-03-01T10:00:00Z\",\n    \"created_by\": {\n      \"id\": 10,\n      \"first_name\": \"Admin\",\n      \"last_name\": \"User\"\n    }\n  }\n]\n</code></pre></p>"},{"location":"LLM-DOCS/STUDENT_REPORT/#complete-student-report-workflow","title":"Complete Student Report Workflow","text":""},{"location":"LLM-DOCS/STUDENT_REPORT/#recommended-approach-for-full-student-report","title":"Recommended Approach for Full Student Report","text":"<p>To get a complete picture of a student, follow this workflow:</p> <pre><code># Step 1: Get basic profile and contact information\nGET /v1/auth/academy/student/{user_id}\n\n# Step 2: Get cohort enrollments and status\nGET /v1/admissions/academy/cohort/user?users={user_id}&amp;roles=STUDENT\n\n# Step 3: For each cohort, get detailed enrollment with tasks\nGET /v1/admissions/academy/cohort/{cohort_id}/user/{user_id}?tasks=True\n\n# Step 4: Get all tasks and assignments\nGET /v1/assignments/user/{user_id}/task\n\n# Step 5: Get code reviews and feedback\nGET /v1/assignments/academy/coderevision?author={user_id}\n\n# Step 6: Get mentorship sessions\nGET /v1/mentorship/academy/session?mentee={user_id}\n\n# Step 7: Get activity log\nGET /v1/activity/academy/student/{user_id}\n\n# Step 8: Get change history\nGET /v1/admissions/academy/cohort/{cohort_id}/log\n</code></pre>"},{"location":"LLM-DOCS/STUDENT_REPORT/#example-python-script-to-generate-complete-report","title":"Example: Python Script to Generate Complete Report","text":"<pre><code>import requests\n\nBASE_URL = \"https://breathecode.herokuapp.com\"\nTOKEN = \"your-token-here\"\nACADEMY_ID = 4\nUSER_ID = 123\n\nheaders = {\n    \"Authorization\": f\"Token {TOKEN}\",\n    \"Academy\": str(ACADEMY_ID)\n}\n\ndef get_student_report(user_id):\n    report = {}\n\n    # 1. Basic Profile\n    response = requests.get(\n        f\"{BASE_URL}/v1/auth/academy/student/{user_id}\",\n        headers=headers\n    )\n    report['profile'] = response.json()\n\n    # 2. Cohort Enrollments\n    response = requests.get(\n        f\"{BASE_URL}/v1/admissions/academy/cohort/user\",\n        params={\"users\": user_id, \"roles\": \"STUDENT\"},\n        headers=headers\n    )\n    report['enrollments'] = response.json()\n\n    # 3. Tasks\n    response = requests.get(\n        f\"{BASE_URL}/v1/assignments/user/{user_id}/task\",\n        headers=headers\n    )\n    report['tasks'] = response.json()\n\n    # 4. Code Reviews\n    response = requests.get(\n        f\"{BASE_URL}/v1/assignments/academy/coderevision\",\n        params={\"author\": user_id},\n        headers=headers\n    )\n    report['code_reviews'] = response.json()\n\n    # 5. Mentorship Sessions\n    response = requests.get(\n        f\"{BASE_URL}/v1/mentorship/academy/session\",\n        params={\"mentee\": user_id},\n        headers=headers\n    )\n    report['mentorship'] = response.json()\n\n    # 6. Activity\n    response = requests.get(\n        f\"{BASE_URL}/v1/activity/academy/student/{user_id}\",\n        headers=headers\n    )\n    report['activity'] = response.json()\n\n    return report\n\n# Generate report\nstudent_report = get_student_report(USER_ID)\nprint(f\"Student: {student_report['profile']['user']['first_name']}\")\nprint(f\"Total Tasks: {len(student_report['tasks'])}\")\nprint(f\"Total Sessions: {len(student_report['mentorship'])}\")\n</code></pre>"},{"location":"LLM-DOCS/STUDENT_REPORT/#query-parameters-reference","title":"Query Parameters Reference","text":""},{"location":"LLM-DOCS/STUDENT_REPORT/#educational-status-options","title":"Educational Status Options","text":"<ul> <li><code>ACTIVE</code> - Currently enrolled and active</li> <li><code>POSTPONED</code> - Temporarily postponed</li> <li><code>SUSPENDED</code> - Suspended from cohort</li> <li><code>GRADUATED</code> - Successfully completed</li> <li><code>DROPPED</code> - Dropped out</li> <li><code>NOT_COMPLETING</code> - Not planning to complete</li> </ul>"},{"location":"LLM-DOCS/STUDENT_REPORT/#financial-status-options","title":"Financial Status Options","text":"<ul> <li><code>FULLY_PAID</code> - Fully paid tuition</li> <li><code>UP_TO_DATE</code> - Payment up to date</li> <li><code>LATE</code> - Payment overdue</li> </ul>"},{"location":"LLM-DOCS/STUDENT_REPORT/#task-status-options","title":"Task Status Options","text":"<ul> <li><code>PENDING</code> - Not started</li> <li><code>DONE</code> - Submitted/delivered</li> <li><code>APPROVED</code> - Approved by teacher</li> <li><code>REJECTED</code> - Needs revision</li> </ul>"},{"location":"LLM-DOCS/STUDENT_REPORT/#task-type-options","title":"Task Type Options","text":"<ul> <li><code>EXERCISE</code> - Practice exercise</li> <li><code>PROJECT</code> - Project assignment</li> <li><code>QUIZ</code> - Quiz/assessment</li> <li><code>LESSON</code> - Lesson reading</li> </ul>"},{"location":"LLM-DOCS/STUDENT_REPORT/#session-status-options","title":"Session Status Options","text":"<ul> <li><code>PENDING</code> - Scheduled but not started</li> <li><code>STARTED</code> - Currently in progress</li> <li><code>COMPLETED</code> - Successfully completed</li> <li><code>FAILED</code> - Did not complete</li> <li><code>IGNORED</code> - Cancelled/ignored</li> </ul>"},{"location":"LLM-DOCS/STUDENT_REPORT/#cohort-stage-options","title":"Cohort Stage Options","text":"<ul> <li><code>INACTIVE</code> - Not yet started</li> <li><code>PREWORK</code> - Prework phase</li> <li><code>STARTED</code> - Active cohort</li> <li><code>FINAL_PROJECT</code> - Final project phase</li> <li><code>ENDED</code> - Cohort completed</li> </ul>"},{"location":"LLM-DOCS/STUDENT_REPORT/#response-examples","title":"Response Examples","text":""},{"location":"LLM-DOCS/STUDENT_REPORT/#complete-student-profile-response","title":"Complete Student Profile Response","text":"<pre><code>{\n  \"basic_profile\": {\n    \"id\": 123,\n    \"email\": \"student@example.com\",\n    \"first_name\": \"John\",\n    \"last_name\": \"Doe\",\n    \"phone\": \"+1234567890\",\n    \"github\": {\n      \"username\": \"johndoe\",\n      \"avatar_url\": \"https://avatars.githubusercontent.com/u/123?v=4\"\n    },\n    \"status\": \"ACTIVE\"\n  },\n  \"enrollments\": [\n    {\n      \"cohort\": {\n        \"id\": 10,\n        \"slug\": \"web-dev-pt-01\",\n        \"name\": \"Web Development Part-Time 01\",\n        \"stage\": \"STARTED\",\n        \"current_day\": 45,\n        \"syllabus\": \"Full-Stack Software Development\"\n      },\n      \"educational_status\": \"ACTIVE\",\n      \"finantial_status\": \"UP_TO_DATE\",\n      \"joined_at\": \"2024-01-15T10:00:00Z\"\n    }\n  ],\n  \"task_summary\": {\n    \"total\": 50,\n    \"pending\": 10,\n    \"done\": 25,\n    \"approved\": 30,\n    \"rejected\": 3,\n    \"completion_rate\": 70.0\n  },\n  \"mentorship_summary\": {\n    \"total_sessions\": 8,\n    \"completed\": 7,\n    \"pending\": 1,\n    \"average_rating\": 9.2\n  },\n  \"activity_summary\": {\n    \"last_activity\": \"2024-02-20T15:30:00Z\",\n    \"total_activities\": 450,\n    \"lessons_opened\": 120,\n    \"exercises_completed\": 85\n  }\n}\n</code></pre>"},{"location":"LLM-DOCS/STUDENT_REPORT/#best-practices","title":"Best Practices","text":""},{"location":"LLM-DOCS/STUDENT_REPORT/#1-caching","title":"1. Caching","text":"<p>Many endpoints support caching. For frequently accessed data, implement client-side caching to reduce API calls.</p>"},{"location":"LLM-DOCS/STUDENT_REPORT/#2-pagination","title":"2. Pagination","text":"<p>Always use pagination for large datasets: <pre><code>GET /v1/assignments/user/123/task?limit=50&amp;offset=0\n</code></pre></p>"},{"location":"LLM-DOCS/STUDENT_REPORT/#3-filtering","title":"3. Filtering","text":"<p>Use specific filters to reduce response size: <pre><code># Get only active student's pending tasks\nGET /v1/assignments/user/123/task?task_status=PENDING\n</code></pre></p>"},{"location":"LLM-DOCS/STUDENT_REPORT/#4-batch-requests","title":"4. Batch Requests","text":"<p>When getting data for multiple students, consider batching: <pre><code>GET /v1/admissions/academy/cohort/user?users=123,124,125&amp;roles=STUDENT\n</code></pre></p>"},{"location":"LLM-DOCS/STUDENT_REPORT/#5-error-handling","title":"5. Error Handling","text":"<p>Always handle common errors: - <code>404</code> - Student/resource not found - <code>403</code> - Insufficient permissions - <code>401</code> - Invalid/expired token - <code>400</code> - Invalid parameters</p>"},{"location":"LLM-DOCS/STUDENT_REPORT/#related-documentation","title":"Related Documentation","text":"<ul> <li>ADD_STUDENT.md - How to add students to academy</li> <li>COHORTS.md - Cohort management</li> <li>ACADEMY_PLANS.md - Student plans and subscriptions</li> <li>BC_AUTH_FIRST_PARTY_APPS.md - Authentication details</li> </ul>"},{"location":"LLM-DOCS/STUDENT_REPORT/#support","title":"Support","text":"<p>For additional help or questions about the Student Report API: - Check the main API documentation - Review permission requirements in <code>create_academy_roles.py</code> - Contact the development team</p> <p>Last Updated: October 2024</p>"},{"location":"LLM-DOCS/STUDENT_VIEW/","title":"Student View API Documentation","text":"<p>Complete guide to the <code>/v1/auth/academy/student</code> endpoint, including single and bulk student creation, updates, queries, and payment method integration.</p>"},{"location":"LLM-DOCS/STUDENT_VIEW/#overview","title":"Overview","text":"<p>The <code>StudentView</code> API endpoint provides comprehensive student management capabilities for academies, supporting: - \u2705 Single and bulk student creation - \u2705 Student profile queries with filtering - \u2705 Student profile updates - \u2705 Payment plans and payment methods assignment - \u2705 Multiple cohort assignments - \u2705 Automatic invitation emails - \u2705 Automatic invoice creation with payment methods</p> <p>Base Endpoint: <code>/v1/auth/academy/student</code></p>"},{"location":"LLM-DOCS/STUDENT_VIEW/#authentication-headers","title":"Authentication &amp; Headers","text":"<p>All requests require:</p> <pre><code>Authorization: Token {your-token}\nAcademy: {academy_id}\n</code></pre>"},{"location":"LLM-DOCS/STUDENT_VIEW/#get-list-and-query-students","title":"GET - List and Query Students","text":""},{"location":"LLM-DOCS/STUDENT_VIEW/#list-all-students","title":"List All Students","text":"<p>Endpoint: <code>GET /v1/auth/academy/student</code></p> <p>Query Parameters: - <code>like={text}</code> - Search by full name or email (case-insensitive) - <code>status={ACTIVE|INVITED}</code> - Filter by profile status - <code>cohort={slug1,slug2}</code> - Filter by cohort slugs (comma-separated) - <code>limit={number}</code> - Pagination limit (default: 10) - <code>offset={number}</code> - Pagination offset</p> <p>Example: <pre><code>GET /v1/auth/academy/student?cohort=web-dev-pt-01&amp;status=ACTIVE&amp;like=john\n</code></pre></p> <p>Response: <pre><code>[\n  {\n    \"id\": 123,\n    \"user\": {\n      \"id\": 123,\n      \"email\": \"student@example.com\",\n      \"first_name\": \"John\",\n      \"last_name\": \"Doe\"\n    },\n    \"role\": {\n      \"slug\": \"student\",\n      \"name\": \"Student\"\n    },\n    \"status\": \"ACTIVE\",\n    \"created_at\": \"2024-01-15T10:30:00Z\"\n  }\n]\n</code></pre></p>"},{"location":"LLM-DOCS/STUDENT_VIEW/#get-single-student","title":"Get Single Student","text":"<p>Endpoint: <code>GET /v1/auth/academy/student/{user_id_or_email}</code></p> <p>Parameters: - <code>user_id_or_email</code> - Can be numeric user ID or email address</p> <p>Example: <pre><code>GET /v1/auth/academy/student/123\n# or\nGET /v1/auth/academy/student/student@example.com\n</code></pre></p> <p>Response: <pre><code>{\n  \"id\": 123,\n  \"user\": {\n    \"id\": 123,\n    \"email\": \"student@example.com\",\n    \"first_name\": \"John\",\n    \"last_name\": \"Doe\"\n  },\n  \"role\": {\n    \"slug\": \"student\",\n    \"name\": \"Student\"\n  },\n  \"status\": \"ACTIVE\",\n  \"phone\": \"+1234567890\",\n  \"address\": \"123 Main St\",\n  \"created_at\": \"2024-01-15T10:30:00Z\"\n}\n</code></pre></p>"},{"location":"LLM-DOCS/STUDENT_VIEW/#post-create-students","title":"POST - Create Students","text":""},{"location":"LLM-DOCS/STUDENT_VIEW/#single-student-creation","title":"Single Student Creation","text":"<p>Endpoint: <code>POST /v1/auth/academy/student</code></p> <p>Request Body: <pre><code>{\n  \"email\": \"student@example.com\",\n  \"first_name\": \"John\",\n  \"last_name\": \"Doe\",\n  \"phone\": \"1234567890\",\n  \"address\": \"123 Main St\",\n  \"cohort\": [1429, 1430],\n  \"plans\": [5, 12],\n  \"payment_method\": 123,\n  \"invite\": true\n}\n</code></pre></p> <p>Field Descriptions:</p> Field Type Required Description <code>email</code> String \u2705 Yes Student email (will be lowercased) <code>first_name</code> String \u2705 Yes* First name (required for new users) <code>last_name</code> String \u2705 Yes* Last name (required for new users) <code>phone</code> String \u26a0\ufe0f Optional Phone number <code>address</code> String \u26a0\ufe0f Optional Student address <code>cohort</code> Array[Int] \u26a0\ufe0f Optional Array of cohort IDs. Use <code>[]</code> for none, never <code>[null]</code> <code>plans</code> Array[Int] \u26a0\ufe0f Optional Array of plan IDs. Only for new users (when <code>invite: true</code>) <code>payment_method</code> Integer \u26a0\ufe0f Optional Payment method ID. Must belong to the academy <code>invite</code> Boolean \u26a0\ufe0f Optional Send invitation email (default: <code>false</code>) <code>user</code> Integer \u26a0\ufe0f Optional Existing user ID (alternative to email) <p>Response: <pre><code>{\n  \"id\": 18396,\n  \"email\": \"student@example.com\",\n  \"first_name\": \"John\",\n  \"last_name\": \"Doe\",\n  \"status\": \"INVITED\",\n  \"created_at\": \"2024-01-15T10:30:00Z\"\n}\n</code></pre></p>"},{"location":"LLM-DOCS/STUDENT_VIEW/#bulk-student-creation","title":"Bulk Student Creation","text":"<p>The endpoint automatically detects bulk requests when the request body is an array. Each student in the array is processed independently.</p> <p>Endpoint: <code>POST /v1/auth/academy/student</code></p> <p>Request Body (Array): <pre><code>[\n  {\n    \"email\": \"student1@example.com\",\n    \"first_name\": \"John\",\n    \"last_name\": \"Doe\",\n    \"cohort\": [1429],\n    \"plans\": [5],\n    \"payment_method\": 123,\n    \"invite\": true\n  },\n  {\n    \"email\": \"student2@example.com\",\n    \"first_name\": \"Jane\",\n    \"last_name\": \"Smith\",\n    \"cohort\": [1429, 1430],\n    \"plans\": [5, 12],\n    \"payment_method\": 123,\n    \"invite\": true\n  },\n  {\n    \"email\": \"student3@example.com\",\n    \"first_name\": \"Bob\",\n    \"last_name\": \"Johnson\",\n    \"cohort\": [],\n    \"invite\": true\n  }\n]\n</code></pre></p> <p>Response (Array): <pre><code>[\n  {\n    \"id\": 18396,\n    \"email\": \"student1@example.com\",\n    \"first_name\": \"John\",\n    \"last_name\": \"Doe\",\n    \"status\": \"INVITED\"\n  },\n  {\n    \"id\": 18397,\n    \"email\": \"student2@example.com\",\n    \"first_name\": \"Jane\",\n    \"last_name\": \"Smith\",\n    \"status\": \"INVITED\"\n  },\n  {\n    \"id\": 18398,\n    \"email\": \"student3@example.com\",\n    \"first_name\": \"Bob\",\n    \"last_name\": \"Johnson\",\n    \"status\": \"INVITED\"\n  }\n]\n</code></pre></p> <p>Bulk Creation Notes: - \u2705 Each student is validated and created independently - \u2705 If one student fails, others may still succeed - \u2705 Uses <code>StudentPOSTListSerializer</code> internally - \u2705 All students are created with <code>INVITED</code> status - \u2705 Each student can have different cohorts, plans, and payment methods</p>"},{"location":"LLM-DOCS/STUDENT_VIEW/#payment-methods","title":"Payment Methods","text":""},{"location":"LLM-DOCS/STUDENT_VIEW/#overview_1","title":"Overview","text":"<p>The <code>payment_method</code> field allows you to specify which payment method should be used when creating invoices for students with payment plans.</p> <p>How It Works: 1. When a student is created with <code>plans</code> and <code>payment_method</code> 2. The <code>payment_method</code> is saved to the <code>UserInvite</code> record 3. When the student accepts the invitation:    - A <code>Bag</code> is created (type <code>INVITED</code>, status <code>PAID</code>)    - An <code>Invoice</code> is created with the specified <code>payment_method</code>    - The invoice is marked as <code>externally_managed=True</code> automatically    - A <code>ProofOfPayment</code> is automatically created (if payment method is not crypto)    - The proof is created by the invite <code>author</code> (staff member who created the invite)</p>"},{"location":"LLM-DOCS/STUDENT_VIEW/#requirements","title":"Requirements","text":"<ul> <li>\u2705 <code>payment_method</code> must belong to the academy</li> <li>\u2705 Only works with new users (when <code>invite: true</code> and user doesn't exist)</li> <li>\u2705 When <code>payment_method</code> is set, the invoice is automatically marked as <code>externally_managed=True</code></li> <li>\u2705 If <code>payment_method</code> is not crypto, a <code>ProofOfPayment</code> is automatically created</li> <li>\u2705 The invite must have an <code>author</code> (staff member) when <code>payment_method</code> is set</li> </ul>"},{"location":"LLM-DOCS/STUDENT_VIEW/#example-with-payment-method","title":"Example with Payment Method","text":"<pre><code>{\n  \"email\": \"student@example.com\",\n  \"first_name\": \"John\",\n  \"last_name\": \"Doe\",\n  \"cohort\": [1429],\n  \"plans\": [5],\n  \"payment_method\": 123,\n  \"invite\": true\n}\n</code></pre> <p>What Happens: 1. User account is created (if doesn't exist) 2. <code>UserInvite</code> is created with <code>payment_method=123</code> and <code>author=request.user</code> 3. Plans are linked to the invite 4. When student accepts:    - Invoice is created with <code>payment_method=123</code> and <code>externally_managed=True</code>    - <code>ProofOfPayment</code> is created (if not crypto) with <code>created_by=invite.author</code>    - Subscription/financing is created automatically</p>"},{"location":"LLM-DOCS/STUDENT_VIEW/#payment-method-validation","title":"Payment Method Validation","text":"<p>Error: Payment Method Not Found <pre><code>{\n  \"detail\": \"Payment method not found or does not belong to this academy\",\n  \"status_code\": 404,\n  \"slug\": \"payment-method-not-found\"\n}\n</code></pre></p> <p>Error: Invite Author Required <pre><code>{\n  \"detail\": \"Invite author is required when payment method is set. The author is the staff member who created the invitation.\",\n  \"status_code\": 400,\n  \"slug\": \"invite-author-required-for-payment-method\"\n}\n</code></pre></p> <p>This error occurs when trying to accept an invite with a payment method but the invite doesn't have an <code>author</code>. The <code>author</code> is automatically set when creating students through the API (it's the authenticated user making the request).</p>"},{"location":"LLM-DOCS/STUDENT_VIEW/#payment-plans","title":"Payment Plans","text":""},{"location":"LLM-DOCS/STUDENT_VIEW/#overview_2","title":"Overview","text":"<p>Payment plans can be assigned to students during creation, but only for new users.</p>"},{"location":"LLM-DOCS/STUDENT_VIEW/#restrictions","title":"Restrictions","text":"<ul> <li>\u274c Cannot add plans to existing users</li> <li>\u2705 Can add plans when <code>invite: true</code> and user doesn't exist</li> <li>\u2705 Plans are linked to the <code>UserInvite</code> record</li> <li>\u2705 Multiple plans can be assigned per student</li> </ul>"},{"location":"LLM-DOCS/STUDENT_VIEW/#example-with-plans","title":"Example with Plans","text":"<pre><code>{\n  \"email\": \"new.student@example.com\",\n  \"first_name\": \"John\",\n  \"last_name\": \"Doe\",\n  \"cohort\": [1429],\n  \"plans\": [5, 12],\n  \"payment_method\": 123,\n  \"invite\": true\n}\n</code></pre> <p>What Happens: 1. Plans are validated to exist 2. Plans are linked to the <code>UserInvite</code> 3. When student accepts:    - Free <code>Bag</code> is created (type <code>INVITED</code>, status <code>PAID</code>)    - <code>$0</code> invoice is generated (status <code>FULFILLED</code>)    - <code>ProofOfPayment</code> is created (if payment method is not crypto)    - <code>build_plan_financing</code> task creates the subscription    - Student capabilities are automatically granted</p>"},{"location":"LLM-DOCS/STUDENT_VIEW/#error-cannot-add-plans-to-existing-user","title":"Error: Cannot Add Plans to Existing User","text":"<p>Error: <code>cannot-add-plans-to-existing-user</code></p> <p>Cause: Trying to add plans when user already exists</p> <p>Solution: - Only add plans when <code>invite: true</code> and user doesn't exist - For existing users, they must purchase through checkout</p>"},{"location":"LLM-DOCS/STUDENT_VIEW/#multiple-cohorts","title":"Multiple Cohorts","text":"<p>Students can be assigned to multiple cohorts simultaneously.</p> <p>Example: <pre><code>{\n  \"email\": \"student@example.com\",\n  \"first_name\": \"John\",\n  \"last_name\": \"Doe\",\n  \"cohort\": [1429, 1430, 1431],\n  \"invite\": true\n}\n</code></pre></p> <p>What Happens: - Student is added to all three cohorts - Multiple <code>CohortUser</code> records are created - One <code>UserInvite</code> is created per cohort (if <code>invite: true</code>)</p> <p>Note: If no cohorts are specified, use <code>\"cohort\": []</code> or omit the field entirely. Never use <code>[null]</code>.</p>"},{"location":"LLM-DOCS/STUDENT_VIEW/#put-update-student","title":"PUT - Update Student","text":"<p>Endpoint: <code>PUT /v1/auth/academy/student/{user_id}</code></p> <p>Note: <code>user_id_or_email</code> must be numeric for PUT requests.</p> <p>Request Body: <pre><code>{\n  \"first_name\": \"John\",\n  \"last_name\": \"Doe Updated\",\n  \"phone\": \"9876543210\",\n  \"address\": \"456 New St\"\n}\n</code></pre></p> <p>Restrictions: - \u274c Cannot update <code>role</code> (use <code>/member</code> endpoint instead) - \u274c Cannot update <code>email</code> or <code>user</code> - \u2705 Can update: <code>first_name</code>, <code>last_name</code>, <code>phone</code>, <code>address</code></p> <p>Response: <pre><code>{\n  \"id\": 123,\n  \"user\": 123,\n  \"first_name\": \"John\",\n  \"last_name\": \"Doe Updated\",\n  \"phone\": \"9876543210\",\n  \"address\": \"456 New St\",\n  \"role\": \"student\",\n  \"academy\": 4\n}\n</code></pre></p>"},{"location":"LLM-DOCS/STUDENT_VIEW/#delete-remove-student","title":"DELETE - Remove Student","text":"<p>Endpoint: <code>DELETE /v1/auth/academy/student/{user_id}</code></p> <p>Status: \u26a0\ufe0f Currently disabled - Returns 403 error</p> <p>Error Response: <pre><code>{\n  \"detail\": \"This functionality is under maintenance and it's not working\"\n}\n</code></pre></p>"},{"location":"LLM-DOCS/STUDENT_VIEW/#common-scenarios","title":"Common Scenarios","text":""},{"location":"LLM-DOCS/STUDENT_VIEW/#scenario-1-import-new-students-without-cohorts","title":"Scenario 1: Import New Students Without Cohorts","text":"<pre><code>{\n  \"email\": \"student@example.com\",\n  \"first_name\": \"John\",\n  \"last_name\": \"Doe\",\n  \"phone\": \"1234567890\",\n  \"invite\": true\n}\n</code></pre>"},{"location":"LLM-DOCS/STUDENT_VIEW/#scenario-2-import-students-to-multiple-cohorts","title":"Scenario 2: Import Students to Multiple Cohorts","text":"<pre><code>{\n  \"email\": \"student@example.com\",\n  \"first_name\": \"John\",\n  \"last_name\": \"Doe\",\n  \"cohort\": [1429, 1430, 1431],\n  \"invite\": true\n}\n</code></pre>"},{"location":"LLM-DOCS/STUDENT_VIEW/#scenario-3-import-students-with-payment-plans-and-payment-method","title":"Scenario 3: Import Students with Payment Plans and Payment Method","text":"<pre><code>{\n  \"email\": \"student@example.com\",\n  \"first_name\": \"John\",\n  \"last_name\": \"Doe\",\n  \"cohort\": [1429],\n  \"plans\": [5, 12],\n  \"payment_method\": 123,\n  \"invite\": true\n}\n</code></pre> <p>What Happens: 1. Student is created with plans and payment method 2. When student accepts invite:    - Invoice is created with payment method    - Proof of payment is created (if not crypto)    - Subscription is created automatically</p>"},{"location":"LLM-DOCS/STUDENT_VIEW/#scenario-4-add-existing-user-to-academy","title":"Scenario 4: Add Existing User to Academy","text":"<pre><code>{\n  \"user\": 123,\n  \"cohort\": [1429],\n  \"invite\": true\n}\n</code></pre> <p>Note: Cannot add plans to existing users.</p>"},{"location":"LLM-DOCS/STUDENT_VIEW/#scenario-5-bulk-import-with-mixed-configurations","title":"Scenario 5: Bulk Import with Mixed Configurations","text":"<pre><code>[\n  {\n    \"email\": \"premium@example.com\",\n    \"first_name\": \"John\",\n    \"last_name\": \"Doe\",\n    \"cohort\": [1429],\n    \"plans\": [5],\n    \"payment_method\": 123,\n    \"invite\": true\n  },\n  {\n    \"email\": \"free@example.com\",\n    \"first_name\": \"Jane\",\n    \"last_name\": \"Smith\",\n    \"cohort\": [1429, 1430],\n    \"invite\": true\n  },\n  {\n    \"user\": 456,\n    \"cohort\": [1429],\n    \"invite\": true\n  }\n]\n</code></pre>"},{"location":"LLM-DOCS/STUDENT_VIEW/#validation-rules","title":"Validation Rules","text":""},{"location":"LLM-DOCS/STUDENT_VIEW/#email-validation","title":"Email Validation","text":"<ul> <li>Email is automatically lowercased</li> <li>Must be unique per academy (no duplicate invites)</li> <li>If user exists, <code>user</code> field is automatically populated</li> </ul>"},{"location":"LLM-DOCS/STUDENT_VIEW/#user-vs-email","title":"User vs Email","text":"<ul> <li>Use <code>email</code> for new users</li> <li>Use <code>user</code> (ID) for existing users</li> <li>Cannot use both in the same request</li> </ul>"},{"location":"LLM-DOCS/STUDENT_VIEW/#plans-validation","title":"Plans Validation","text":"<ul> <li>Plans must exist in the system</li> <li>Can only be added to new users (<code>invite: true</code> + user doesn't exist)</li> <li>Plans are validated before creation</li> </ul>"},{"location":"LLM-DOCS/STUDENT_VIEW/#payment-method-validation_1","title":"Payment Method Validation","text":"<ul> <li>Payment method must exist</li> <li>Must belong to the academy</li> <li>Validated before creation</li> <li>Requires invite <code>author</code> when used (automatically set by API)</li> </ul>"},{"location":"LLM-DOCS/STUDENT_VIEW/#cohort-validation","title":"Cohort Validation","text":"<ul> <li>Cohorts must exist</li> <li>Can assign to multiple cohorts</li> <li>Use <code>[]</code> for no cohorts, never <code>[null]</code></li> </ul>"},{"location":"LLM-DOCS/STUDENT_VIEW/#error-responses","title":"Error Responses","text":""},{"location":"LLM-DOCS/STUDENT_VIEW/#common-errors","title":"Common Errors","text":"<p>1. User Not Found <pre><code>{\n  \"detail\": \"User does not exists, do you want to invite it?\",\n  \"status_code\": 400,\n  \"slug\": \"user-not-found\"\n}\n</code></pre></p> <p>2. Already Exists <pre><code>{\n  \"detail\": \"There is a student already in this academy, or with invitation pending\",\n  \"status_code\": 400,\n  \"slug\": \"already-exists-with-this-email\"\n}\n</code></pre></p> <p>3. Cohort Not Found <pre><code>{\n  \"detail\": \"Cohort not found\",\n  \"status_code\": 400,\n  \"slug\": \"cohort-not-found\"\n}\n</code></pre></p> <p>4. Plan Not Found <pre><code>{\n  \"detail\": \"Plan not found\",\n  \"status_code\": 400,\n  \"slug\": \"plan-not-found\"\n}\n</code></pre></p> <p>5. Payment Method Not Found <pre><code>{\n  \"detail\": \"Payment method not found or does not belong to this academy\",\n  \"status_code\": 404,\n  \"slug\": \"payment-method-not-found\"\n}\n</code></pre></p> <p>6. Cannot Add Plans to Existing User <pre><code>{\n  \"detail\": \"Cannot add payment plans when user already exists. User 123 (user@example.com) should be enrolled through their existing account or payment system.\",\n  \"status_code\": 400,\n  \"slug\": \"cannot-add-plans-to-existing-user\"\n}\n</code></pre></p> <p>7. Already Invited <pre><code>{\n  \"detail\": \"You already invited this user\",\n  \"status_code\": 400,\n  \"slug\": \"already-invited\"\n}\n</code></pre></p> <p>8. Invite Author Required <pre><code>{\n  \"detail\": \"Invite author is required when payment method is set. The author is the staff member who created the invitation.\",\n  \"status_code\": 400,\n  \"slug\": \"invite-author-required-for-payment-method\"\n}\n</code></pre></p>"},{"location":"LLM-DOCS/STUDENT_VIEW/#internal-flow","title":"Internal Flow","text":""},{"location":"LLM-DOCS/STUDENT_VIEW/#new-user-creation-flow","title":"New User Creation Flow","text":"<ol> <li>Validation Phase:</li> <li>Email is lowercased</li> <li>User existence is checked</li> <li>Cohorts, plans, and payment_method are validated</li> <li> <p>Duplicate checks are performed</p> </li> <li> <p>User Creation:</p> </li> <li>User account is created (if doesn't exist)</li> <li> <p><code>UserInvite</code> is created with:</p> <ul> <li>User reference</li> <li>Academy reference</li> <li>Cohort(s) reference</li> <li>Payment method (if provided)</li> <li>Author (automatically set to <code>request.user</code>)</li> <li>Plans linked via many-to-many</li> </ul> </li> <li> <p>Profile Creation:</p> </li> <li><code>ProfileAcademy</code> is created with <code>INVITED</code> status</li> <li> <p><code>CohortUser</code> records are created for each cohort</p> </li> <li> <p>Email Notification:</p> </li> <li>Invitation email is sent (if <code>invite: true</code>)</li> <li> <p>Email contains invitation link with token</p> </li> <li> <p>On Invite Acceptance:</p> </li> <li>User status changes to <code>ACCEPTED</code></li> <li>If plans exist:<ul> <li><code>Bag</code> is created (type <code>INVITED</code>, status <code>PAID</code>)</li> <li><code>Invoice</code> is created with:</li> <li><code>payment_method</code> from invite</li> <li><code>externally_managed=True</code> (if payment_method exists)</li> <li>Status <code>FULFILLED</code></li> <li><code>ProofOfPayment</code> is created (if payment_method exists and is not crypto):</li> <li><code>created_by</code> = invite author (staff member)</li> <li><code>status</code> = DONE</li> <li><code>reference</code> = INVITE-{invite.id}</li> <li><code>provided_payment_details</code> = description of payment method</li> <li><code>build_plan_financing</code> task is triggered</li> <li>Subscription/financing is created automatically</li> </ul> </li> </ol>"},{"location":"LLM-DOCS/STUDENT_VIEW/#existing-user-flow","title":"Existing User Flow","text":"<ol> <li>Validation:</li> <li>User ID is validated</li> <li>Plans cannot be added (error if attempted)</li> <li> <p>Duplicate checks are performed</p> </li> <li> <p>Profile Creation:</p> </li> <li><code>ProfileAcademy</code> is created</li> <li> <p><code>CohortUser</code> records are created</p> </li> <li> <p>Email Notification:</p> </li> <li>Invitation email is sent (if <code>invite: true</code>)</li> </ol>"},{"location":"LLM-DOCS/STUDENT_VIEW/#best-practices","title":"Best Practices","text":""},{"location":"LLM-DOCS/STUDENT_VIEW/#bulk-import-tips","title":"Bulk Import Tips","text":"<ol> <li>Batch Size: Process in batches of 50-100 students for optimal performance</li> <li>Error Handling: Check response for partial failures</li> <li>Validation: Pre-validate emails, cohorts, and plans before bulk import</li> <li>Testing: Test with small batches (2-3 students) before large imports</li> </ol>"},{"location":"LLM-DOCS/STUDENT_VIEW/#payment-methods_1","title":"Payment Methods","text":"<ol> <li>Verify Payment Methods: Use <code>GET /v1/payments/academy/paymentmethod</code> to list available methods</li> <li>Academy Ownership: Ensure payment method belongs to the academy</li> <li>Currency Compatibility: Verify payment method currency matches academy currency</li> <li>Author Requirement: The invite author is automatically set when creating through the API</li> </ol>"},{"location":"LLM-DOCS/STUDENT_VIEW/#plans-management","title":"Plans Management","text":"<ol> <li>Verify Plans: Use <code>GET /v1/payments/academy/plan?cohort={cohort_id}</code> to list available plans</li> <li>Compatibility: Ensure plans are compatible with assigned cohorts</li> <li>New Users Only: Remember plans can only be added to new users</li> </ol>"},{"location":"LLM-DOCS/STUDENT_VIEW/#data-quality","title":"Data Quality","text":"<ol> <li>Email Format: Ensure emails are valid and properly formatted</li> <li>Required Fields: Always include <code>first_name</code> and <code>last_name</code> for new users</li> <li>Cohort Arrays: Use <code>[]</code> for empty arrays, never <code>[null]</code></li> </ol>"},{"location":"LLM-DOCS/STUDENT_VIEW/#technical-details","title":"Technical Details","text":""},{"location":"LLM-DOCS/STUDENT_VIEW/#serializers","title":"Serializers","text":"<ul> <li>StudentPOSTSerializer: Handles single student creation</li> <li>StudentPOSTListSerializer: Handles bulk student creation (extends ListSerializer)</li> <li>GetProfileAcademySerializer: Used for GET responses</li> <li>GetProfileAcademySmallSerializer: Used for list responses</li> </ul>"},{"location":"LLM-DOCS/STUDENT_VIEW/#permissions","title":"Permissions","text":"<ul> <li>GET: Requires <code>read_student</code> capability</li> <li>POST: Requires <code>crud_student</code> capability</li> <li>PUT: Requires <code>crud_student</code> capability</li> <li>DELETE: Currently disabled</li> </ul>"},{"location":"LLM-DOCS/STUDENT_VIEW/#database-models","title":"Database Models","text":"<ul> <li>User: Django User model</li> <li>ProfileAcademy: Student profile in academy</li> <li>UserInvite: Invitation record with plans and payment_method</li> <li>CohortUser: Many-to-many relationship between users and cohorts</li> <li>Plan: Payment plan model</li> <li>PaymentMethod: Payment method model</li> <li>Invoice: Created when invite is accepted with plans</li> <li>ProofOfPayment: Created automatically when invoice has payment_method (non-crypto)</li> </ul>"},{"location":"LLM-DOCS/STUDENT_VIEW/#related-endpoints","title":"Related Endpoints","text":"<ul> <li>List Payment Methods: <code>GET /v1/payments/academy/paymentmethod</code></li> <li>List Plans: <code>GET /v1/payments/academy/plan</code></li> <li>List Cohorts: <code>GET /v1/admissions/academy/cohort</code></li> <li>Update Member: <code>PUT /v1/auth/academy/member/{user_id}</code></li> </ul>"},{"location":"LLM-DOCS/STUDENT_VIEW/#changelog","title":"Changelog","text":""},{"location":"LLM-DOCS/STUDENT_VIEW/#2024-payment-method-support","title":"2024 - Payment Method Support","text":"<ul> <li>\u2705 Added <code>payment_method</code> field to student creation</li> <li>\u2705 Payment method is saved to <code>UserInvite</code></li> <li>\u2705 Invoice automatically uses payment method when invite is accepted</li> <li>\u2705 Invoice is marked as <code>externally_managed=True</code> when payment_method is set</li> <li>\u2705 <code>ProofOfPayment</code> is automatically created when payment_method is set (non-crypto)</li> <li>\u2705 Proof is created by invite <code>author</code> (staff member)</li> </ul>"},{"location":"LLM-DOCS/STUDENT_VIEW/#2024-bulk-creation-support","title":"2024 - Bulk Creation Support","text":"<ul> <li>\u2705 Added automatic bulk detection (array vs object)</li> <li>\u2705 Uses <code>StudentPOSTListSerializer</code> for efficient bulk processing</li> <li>\u2705 Each student is processed independently</li> </ul>"},{"location":"LLM-DOCS/STUDENT_VIEW/#examples","title":"Examples","text":""},{"location":"LLM-DOCS/STUDENT_VIEW/#complete-example-bulk-import-with-plans-and-payment-methods","title":"Complete Example: Bulk Import with Plans and Payment Methods","text":"<pre><code>POST /v1/auth/academy/student\nHeaders:\n  Authorization: Token abc123...\n  Academy: 4\n\nBody:\n[\n  {\n    \"email\": \"premium.student@example.com\",\n    \"first_name\": \"John\",\n    \"last_name\": \"Doe\",\n    \"cohort\": [1429],\n    \"plans\": [5],\n    \"payment_method\": 123,\n    \"invite\": true\n  },\n  {\n    \"email\": \"free.student@example.com\",\n    \"first_name\": \"Jane\",\n    \"last_name\": \"Smith\",\n    \"cohort\": [1429, 1430],\n    \"invite\": true\n  }\n]\n</code></pre> <p>This will: 1. Create two new users 2. Assign first student to cohort 1429 with plan 5 and payment method 123 3. Assign second student to cohorts 1429 and 1430 (no plans) 4. Send invitation emails to both 5. When they accept:    - First student will get invoice with payment method 123 and proof of payment    - Second student will just be added to cohorts</p>"},{"location":"LLM-DOCS/SURVEYS_POSTMAN_CHECKLIST/","title":"Surveys \u2014 Postman checklist (staff + student)","text":"<p>Use this doc to copy/paste requests into Postman.</p>"},{"location":"LLM-DOCS/SURVEYS_POSTMAN_CHECKLIST/#variables-used-in-this-doc","title":"Variables used in this doc","text":"<ul> <li><code>{{base_url}}</code>: Example: <code>https://breathecode-test.herokuapp.com</code></li> <li><code>{{academy_id}}</code>: The academy id you want to operate on</li> <li><code>{{token_admin_or_staff}}</code>: Auth token for a user with the right capabilities on that academy</li> <li><code>{{token_student}}</code>: Auth token for a student</li> <li><code>{{configuration_id}}</code>: <code>SurveyConfiguration.id</code></li> <li><code>{{template_id}}</code>: <code>SurveyQuestionTemplate.id</code></li> <li><code>{{study_id}}</code>: <code>SurveyStudy.id</code></li> <li><code>{{response_id}}</code>: <code>SurveyResponse.id</code></li> <li><code>{{response_token}}</code>: <code>SurveyResponse.token</code> (UUID)</li> <li><code>{{user_id}}</code>: Django user id</li> <li><code>{{cohort_id}}</code>: cohort id</li> </ul>"},{"location":"LLM-DOCS/SURVEYS_POSTMAN_CHECKLIST/#common-headers","title":"Common headers","text":""},{"location":"LLM-DOCS/SURVEYS_POSTMAN_CHECKLIST/#staff-endpoints-academy-scoped","title":"Staff endpoints (academy-scoped)","text":"<ul> <li>Authorization: <code>Token {{token_admin_or_staff}}</code></li> <li>Academy: <code>{{academy_id}}</code></li> <li>Content-Type: <code>application/json</code></li> </ul>"},{"location":"LLM-DOCS/SURVEYS_POSTMAN_CHECKLIST/#student-endpoints-non-academy-scoped","title":"Student endpoints (non-academy scoped)","text":"<ul> <li>Authorization: <code>Token {{token_student}}</code></li> <li>Content-Type: <code>application/json</code></li> </ul>"},{"location":"LLM-DOCS/SURVEYS_POSTMAN_CHECKLIST/#1-surveyquestiontemplate-staff","title":"1) SurveyQuestionTemplate (staff)","text":""},{"location":"LLM-DOCS/SURVEYS_POSTMAN_CHECKLIST/#11-list-templates","title":"1.1 List templates","text":"<ul> <li>Method: GET</li> <li>URL: <code>{{base_url}}/v1/feedback/academy/survey/question_template</code></li> <li>Headers: staff headers</li> </ul>"},{"location":"LLM-DOCS/SURVEYS_POSTMAN_CHECKLIST/#12-retrieve-template","title":"1.2 Retrieve template","text":"<ul> <li>Method: GET</li> <li>URL: <code>{{base_url}}/v1/feedback/academy/survey/question_template/{{template_id}}</code></li> <li>Headers: staff headers</li> </ul>"},{"location":"LLM-DOCS/SURVEYS_POSTMAN_CHECKLIST/#13-create-template","title":"1.3 Create template","text":"<ul> <li>Method: POST</li> <li>URL: <code>{{base_url}}/v1/feedback/academy/survey/question_template</code></li> <li>Headers: staff headers</li> <li>Body:</li> </ul> <pre><code>{\n  \"slug\": \"course-completion-v1\",\n  \"title\": \"Course completion (v1)\",\n  \"description\": \"Baseline course completion survey\",\n  \"questions\": {\n    \"questions\": [\n      {\n        \"id\": \"q1\",\n        \"type\": \"likert_scale\",\n        \"required\": true,\n        \"title\": { \"en\": \"How was the course?\", \"es\": \"\u00bfQu\u00e9 tal fue el curso?\" },\n        \"config\": { \"scale\": 5 }\n      }\n    ]\n  }\n}\n</code></pre>"},{"location":"LLM-DOCS/SURVEYS_POSTMAN_CHECKLIST/#14-update-template-partial","title":"1.4 Update template (partial)","text":"<ul> <li>Method: PUT</li> <li>URL: <code>{{base_url}}/v1/feedback/academy/survey/question_template/{{template_id}}</code></li> <li>Headers: staff headers</li> <li>Body: send only fields you want to change</li> </ul>"},{"location":"LLM-DOCS/SURVEYS_POSTMAN_CHECKLIST/#2-surveystudy-staff","title":"2) SurveyStudy (staff)","text":""},{"location":"LLM-DOCS/SURVEYS_POSTMAN_CHECKLIST/#21-list-studies","title":"2.1 List studies","text":"<ul> <li>Method: GET</li> <li>URL: <code>{{base_url}}/v1/feedback/academy/survey/study</code></li> <li>Headers: staff headers</li> </ul>"},{"location":"LLM-DOCS/SURVEYS_POSTMAN_CHECKLIST/#22-retrieve-study","title":"2.2 Retrieve study","text":"<ul> <li>Method: GET</li> <li>URL: <code>{{base_url}}/v1/feedback/academy/survey/study/{{study_id}}</code></li> <li>Headers: staff headers</li> </ul>"},{"location":"LLM-DOCS/SURVEYS_POSTMAN_CHECKLIST/#23-create-study","title":"2.3 Create study","text":"<ul> <li>Method: POST</li> <li>URL: <code>{{base_url}}/v1/feedback/academy/survey/study</code></li> <li>Headers: staff headers</li> <li>Body:</li> </ul> <pre><code>{\n  \"slug\": \"course-completion-study-dec-2025\",\n  \"title\": \"Course completion \u2014 Dec 2025\",\n  \"description\": \"Study window for course completion surveys\",\n  \"starts_at\": \"2025-12-01T00:00:00Z\",\n  \"ends_at\": \"2026-01-01T00:00:00Z\",\n  \"max_responses\": null,\n  \"survey_configurations\": [{{configuration_id}}]\n}\n</code></pre>"},{"location":"LLM-DOCS/SURVEYS_POSTMAN_CHECKLIST/#24-update-study-partial","title":"2.4 Update study (partial)","text":"<ul> <li>Method: PUT</li> <li>URL: <code>{{base_url}}/v1/feedback/academy/survey/study/{{study_id}}</code></li> <li>Headers: staff headers</li> </ul>"},{"location":"LLM-DOCS/SURVEYS_POSTMAN_CHECKLIST/#25-send-study-survey-by-email-to-a-list-of-users-round-robin-across-configs","title":"2.5 Send study survey by email to a list of users (round-robin across configs)","text":"<ul> <li>Method: POST</li> <li>URL: <code>{{base_url}}/v1/feedback/academy/survey/study/{{study_id}}/send_emails</code></li> <li>Headers: staff headers</li> <li>Body:</li> </ul> <pre><code>{\n  \"user_ids\": [1, 2, 3],\n  \"callback\": \"https://your-frontend.com/after-survey\",\n  \"dry_run\": false\n}\n</code></pre> <p>Notes: - The endpoint creates one SurveyResponse per (study, user) if missing. - If the study has multiple configurations, users are assigned round-robin across them (equitable split). - Emails include the <code>SurveyResponse.token</code> in the LINK (and append <code>?callback=...</code> if provided). - You can also target a cohort (all ACTIVE/GRADUATED students) instead of passing explicit user ids:</p> <pre><code>{\n  \"cohort_id\": {{cohort_id}},\n  \"callback\": \"https://your-frontend.com/after-survey\",\n  \"dry_run\": false\n}\n</code></pre>"},{"location":"LLM-DOCS/SURVEYS_POSTMAN_CHECKLIST/#3-surveyconfiguration-staff","title":"3) SurveyConfiguration (staff)","text":""},{"location":"LLM-DOCS/SURVEYS_POSTMAN_CHECKLIST/#31-list-configurations","title":"3.1 List configurations","text":"<ul> <li>Method: GET</li> <li>URL: <code>{{base_url}}/v1/feedback/academy/survey/configuration</code></li> <li>Headers: staff headers</li> </ul>"},{"location":"LLM-DOCS/SURVEYS_POSTMAN_CHECKLIST/#32-retrieve-configuration","title":"3.2 Retrieve configuration","text":"<ul> <li>Method: GET</li> <li>URL: <code>{{base_url}}/v1/feedback/academy/survey/configuration/{{configuration_id}}</code></li> <li>Headers: staff headers</li> </ul>"},{"location":"LLM-DOCS/SURVEYS_POSTMAN_CHECKLIST/#33-create-configuration-using-a-template","title":"3.3 Create configuration using a template","text":"<ul> <li>Method: POST</li> <li>URL: <code>{{base_url}}/v1/feedback/academy/survey/configuration</code></li> <li>Headers: staff headers</li> <li>Body:</li> </ul> <pre><code>{\n  \"trigger_type\": \"course_completed\",\n  \"template\": {{template_id}},\n  \"is_active\": true,\n  \"cohorts\": [{{cohort_id}}],\n  \"asset_slugs\": []\n}\n</code></pre>"},{"location":"LLM-DOCS/SURVEYS_POSTMAN_CHECKLIST/#34-create-configuration-using-inline-questions-no-template","title":"3.4 Create configuration using inline questions (no template)","text":"<ul> <li>Method: POST</li> <li>URL: <code>{{base_url}}/v1/feedback/academy/survey/configuration</code></li> <li>Headers: staff headers</li> <li>Body:</li> </ul> <pre><code>{\n  \"trigger_type\": \"course_completed\",\n  \"is_active\": true,\n  \"cohorts\": [{{cohort_id}}],\n  \"asset_slugs\": [],\n  \"questions\": {\n    \"questions\": [\n      {\n        \"id\": \"q1\",\n        \"type\": \"likert_scale\",\n        \"required\": true,\n        \"title\": { \"en\": \"Changed\", \"es\": \"Cambiado\" },\n        \"config\": { \"scale\": 5 }\n      }\n    ]\n  }\n}\n</code></pre>"},{"location":"LLM-DOCS/SURVEYS_POSTMAN_CHECKLIST/#35-update-configuration-questions-only-when-template-is-null","title":"3.5 Update configuration questions (only when <code>template</code> is null)","text":"<ul> <li>Method: PUT</li> <li>URL: <code>{{base_url}}/v1/feedback/academy/survey/configuration/{{configuration_id}}</code></li> <li>Headers: staff headers</li> <li>Body:</li> </ul> <pre><code>{\n  \"questions\": {\n    \"questions\": [\n      {\n        \"id\": \"q1\",\n        \"type\": \"likert_scale\",\n        \"required\": true,\n        \"title\": { \"en\": \"Changed\", \"es\": \"Cambiado\" },\n        \"config\": { \"scale\": 5 }\n      }\n    ]\n  }\n}\n</code></pre> <p>Important: - If the configuration has <code>template != null</code>, the API should reject any attempt to send <code>\"questions\"</code> in the request.</p>"},{"location":"LLM-DOCS/SURVEYS_POSTMAN_CHECKLIST/#4-surveyresponse-staff","title":"4) SurveyResponse (staff)","text":"<p>All endpoints below are staff + academy scoped.</p>"},{"location":"LLM-DOCS/SURVEYS_POSTMAN_CHECKLIST/#41-list-responses-filter-by-configuration","title":"4.1 List responses (filter by configuration)","text":"<ul> <li>Method: GET</li> <li>URL: <code>{{base_url}}/v1/feedback/academy/survey/response?survey_config={{configuration_id}}</code></li> <li>Headers: staff headers</li> </ul>"},{"location":"LLM-DOCS/SURVEYS_POSTMAN_CHECKLIST/#42-list-responses-filter-by-user","title":"4.2 List responses (filter by user)","text":"<ul> <li>Method: GET</li> <li>URL: <code>{{base_url}}/v1/feedback/academy/survey/response?user={{user_id}}</code></li> <li>Headers: staff headers</li> </ul>"},{"location":"LLM-DOCS/SURVEYS_POSTMAN_CHECKLIST/#43-list-responses-filter-by-cohort_id-inside-trigger_context","title":"4.3 List responses (filter by cohort_id inside <code>trigger_context</code>)","text":"<ul> <li>Method: GET</li> <li>URL: <code>{{base_url}}/v1/feedback/academy/survey/response?cohort_id={{cohort_id}}</code></li> <li>Headers: staff headers</li> </ul>"},{"location":"LLM-DOCS/SURVEYS_POSTMAN_CHECKLIST/#44-retrieve-response-by-id","title":"4.4 Retrieve response (by id)","text":"<ul> <li>Method: GET</li> <li>URL: <code>{{base_url}}/v1/feedback/academy/survey/response/{{response_id}}</code></li> <li>Headers: staff headers</li> </ul>"},{"location":"LLM-DOCS/SURVEYS_POSTMAN_CHECKLIST/#5-surveyresponse-student-flow","title":"5) SurveyResponse (student flow)","text":""},{"location":"LLM-DOCS/SURVEYS_POSTMAN_CHECKLIST/#51-retrieve-response-by-token-direct-link","title":"5.1 Retrieve response by token (direct link)","text":"<ul> <li>Method: GET</li> <li>URL: <code>{{base_url}}/v1/feedback/survey/response/by_token/{{response_token}}</code></li> <li>Headers: student headers</li> </ul>"},{"location":"LLM-DOCS/SURVEYS_POSTMAN_CHECKLIST/#52-mark-opened-idempotent","title":"5.2 Mark opened (idempotent)","text":"<ul> <li>Method: POST</li> <li>URL: <code>{{base_url}}/v1/feedback/survey/response/{{response_id}}/opened</code></li> <li>Headers: student headers</li> <li>Body: empty</li> </ul>"},{"location":"LLM-DOCS/SURVEYS_POSTMAN_CHECKLIST/#53-mark-partial-idempotent-ish","title":"5.3 Mark partial (idempotent-ish)","text":"<ul> <li>Method: POST</li> <li>URL: <code>{{base_url}}/v1/feedback/survey/response/{{response_id}}/partial</code></li> <li>Headers: student headers</li> <li>Body:</li> </ul> <pre><code>{ \"answers\": { \"q1\": 4 } }\n</code></pre>"},{"location":"LLM-DOCS/SURVEYS_POSTMAN_CHECKLIST/#54-submit-final-answers","title":"5.4 Submit final answers","text":"<ul> <li>Method: POST</li> <li>URL: <code>{{base_url}}/v1/feedback/user/me/survey/response/{{response_id}}/answer</code></li> <li>Headers: student headers</li> <li>Body:</li> </ul> <pre><code>{\n  \"answers\": {\n    \"q1\": 5,\n    \"q2\": \"Great experience\"\n  }\n}\n</code></pre>"},{"location":"LLM-DOCS/SURVEYS_POSTMAN_CHECKLIST/#6-trackers-no-auth","title":"6) Trackers (no auth)","text":""},{"location":"LLM-DOCS/SURVEYS_POSTMAN_CHECKLIST/#61-classic-answer-tracker-legacy","title":"6.1 Classic Answer tracker (legacy)","text":"<ul> <li>Method: GET</li> <li>URL: <code>{{base_url}}/v1/feedback/answer/{{answer_id}}/tracker.png</code></li> </ul>"},{"location":"LLM-DOCS/SURVEYS_POSTMAN_CHECKLIST/#62-surveyresponse-email-open-tracker","title":"6.2 SurveyResponse email open tracker","text":"<ul> <li>Method: GET</li> <li>URL: <code>{{base_url}}/v1/feedback/survey/response/{{response_token}}/tracker.png</code></li> </ul>"},{"location":"LLM-DOCS/SURVEYS_POSTMAN_CHECKLIST/#troubleshooting","title":"Troubleshooting","text":""},{"location":"LLM-DOCS/SURVEYS_POSTMAN_CHECKLIST/#a-405-method-not-allowed","title":"A) 405 Method Not Allowed","text":"<p>This means you are hitting the right path, but with a method the server does not implement for that URL.</p> <ul> <li>SurveyConfiguration update supports PUT on: <code>.../academy/survey/configuration/{{configuration_id}}</code></li> <li>SurveyStudy retrieve supports GET on: <code>.../academy/survey/study/{{study_id}}</code></li> <li>Trackers are GET.</li> </ul> <p>If you are using the correct method and still getting 405, your Heroku app is likely running an older release (not deployed with the latest view methods/routes).</p>"},{"location":"LLM-DOCS/SURVEYS_POSTMAN_CHECKLIST/#b-drf-json-parseerror-expecting-value-at-line-1-column-1","title":"B) DRF JSON ParseError (Expecting value at line 1 column 1)","text":"<p>You are sending an empty body, or the body is not valid JSON.</p> <p>In Postman: - Body \u2192 raw \u2192 JSON - The body must start with <code>{</code> and contain only JSON (no URL text before it).</p>"},{"location":"LLM-DOCS/SURVEYS_SYSTEM/","title":"How to Study an Entire Syllabus","text":"<p>This guide explains how to set up a survey study that automatically triggers when students complete an entire syllabus.</p>"},{"location":"LLM-DOCS/SURVEYS_SYSTEM/#overview","title":"Overview","text":"<p>When you want to survey students after they complete a full syllabus, you need to:</p> <ol> <li>Create a Survey Question Template (optional but recommended)</li> <li>Create a Survey Configuration with <code>trigger_type: \"syllabus_completed\"</code></li> <li>Create a Survey Study to group your configuration</li> <li>The system will automatically trigger surveys when students complete the syllabus</li> </ol>"},{"location":"LLM-DOCS/SURVEYS_SYSTEM/#available-trigger-types","title":"Available Trigger Types","text":"<p>The <code>trigger_type</code> field in <code>SurveyConfiguration</code> determines when surveys are automatically triggered. Here are all available options:</p>"},{"location":"LLM-DOCS/SURVEYS_SYSTEM/#1-syllabus_completed-syllabus-completion","title":"1. <code>\"syllabus_completed\"</code> - Syllabus Completion","text":"<ul> <li>Triggers when: A user completes ALL modules in a syllabus</li> <li>Filtering: Use <code>syllabus.syllabus</code> and optionally <code>syllabus.version</code> in the syllabus filter</li> <li>Important: Do NOT include <code>syllabus.module</code> (only for module completion)</li> <li>Use case: Survey students after they finish an entire course/syllabus</li> </ul> <p>Example Configuration: <pre><code>{\n  \"trigger_type\": \"syllabus_completed\",\n  \"template\": {{template_id}},\n  \"is_active\": true,\n  \"syllabus\": {\n    \"syllabus\": \"full-stack\",\n    \"version\": 2\n  },\n  \"cohorts\": [],\n  \"asset_slugs\": []\n}\n</code></pre></p>"},{"location":"LLM-DOCS/SURVEYS_SYSTEM/#2-module_completed-module-completion","title":"2. <code>\"module_completed\"</code> - Module Completion","text":"<ul> <li>Triggers when: A user completes all activities (QUIZ, LESSON, EXERCISE, PROJECT) in a specific module</li> <li>Filtering: Use <code>syllabus.module</code> (0-based index) to target a specific module</li> <li>Special feature: Supports <code>priority</code> field for conditional hazard-based sampling across multiple modules</li> <li>Use case: Survey students at different points during a course (e.g., after module 1, 3, and 5)</li> </ul> <p>Example Configuration: <pre><code>{\n  \"trigger_type\": \"module_completed\",\n  \"template\": {{template_id}},\n  \"is_active\": true,\n  \"syllabus\": {\n    \"syllabus\": \"full-stack\",\n    \"version\": 2,\n    \"module\": 3\n  },\n  \"cohorts\": [],\n  \"asset_slugs\": [],\n  \"priority\": 75.0\n}\n</code></pre></p> <p>Note: The <code>priority</code> field (0-100) represents the cumulative target percentage of users who should have received a survey by this module. Only used for <code>module_completed</code> triggers.</p>"},{"location":"LLM-DOCS/SURVEYS_SYSTEM/#3-learnpack_completed-learnpack-completion","title":"3. <code>\"learnpack_completed\"</code> - Learnpack Completion","text":"<ul> <li>Triggers when: A user completes a learnpack (completion_rate &gt;= 99.999)</li> <li>Filtering: Use <code>asset_slugs</code> array to filter by specific learnpacks</li> <li>If <code>asset_slugs</code> is empty: Applies to all learnpacks</li> <li>Use case: Survey students after completing specific learning materials</li> </ul> <p>Example Configuration (Specific Learnpacks): <pre><code>{\n  \"trigger_type\": \"learnpack_completed\",\n  \"template\": {{template_id}},\n  \"is_active\": true,\n  \"asset_slugs\": [\"learnpack-javascript-basics\", \"learnpack-react-intro\"],\n  \"cohorts\": [],\n  \"syllabus\": {}\n}\n</code></pre></p> <p>Example Configuration (All Learnpacks): <pre><code>{\n  \"trigger_type\": \"learnpack_completed\",\n  \"template\": {{template_id}},\n  \"is_active\": true,\n  \"asset_slugs\": [],\n  \"cohorts\": [],\n  \"syllabus\": {}\n}\n</code></pre></p>"},{"location":"LLM-DOCS/SURVEYS_SYSTEM/#4-course_completed-course-completion","title":"4. <code>\"course_completed\"</code> - Course Completion","text":"<ul> <li>Triggers when: A user completes all mandatory tasks in a SaaS cohort</li> <li>Filtering: Use <code>cohorts</code> ManyToMany field to filter by specific cohorts</li> <li>If <code>cohorts</code> is empty: Applies to all cohorts</li> <li>Use case: Survey students after graduating from a cohort</li> </ul> <p>Example Configuration (Specific Cohorts): <pre><code>{\n  \"trigger_type\": \"course_completed\",\n  \"template\": {{template_id}},\n  \"is_active\": true,\n  \"cohorts\": [123, 456, 789],\n  \"asset_slugs\": [],\n  \"syllabus\": {}\n}\n</code></pre></p> <p>Example Configuration (All Cohorts): <pre><code>{\n  \"trigger_type\": \"course_completed\",\n  \"template\": {{template_id}},\n  \"is_active\": true,\n  \"cohorts\": [],\n  \"asset_slugs\": [],\n  \"syllabus\": {}\n}\n</code></pre></p>"},{"location":"LLM-DOCS/SURVEYS_SYSTEM/#5-null-no-trigger-emaillist-based-studies","title":"5. <code>null</code> - No Trigger (Email/List-based Studies)","text":"<ul> <li>Use case: For email/list-based studies where surveys are sent manually via the <code>send_emails</code> endpoint</li> <li>Not for: Real-time automatic triggering</li> <li>When to use: When you want to manually send surveys to a list of users or cohorts</li> </ul> <p>Example Configuration: <pre><code>{\n  \"trigger_type\": null,\n  \"template\": {{template_id}},\n  \"is_active\": true,\n  \"cohorts\": [],\n  \"asset_slugs\": [],\n  \"syllabus\": {}\n}\n</code></pre></p> <p>Note: For <code>null</code> trigger types, surveys are not automatically triggered. You must manually send them using the <code>POST /v1/feedback/academy/survey/study/{{study_id}}/send_emails</code> endpoint.</p>"},{"location":"LLM-DOCS/SURVEYS_SYSTEM/#important-rules","title":"Important Rules","text":"<ul> <li>All configurations in a study must have the same <code>trigger_type</code>: If you need different trigger types, create separate studies</li> <li>The <code>priority</code> field is only used for <code>module_completed</code> triggers: For other trigger types, <code>priority</code> is ignored</li> <li>Trigger types are case-sensitive: Use the exact string values shown above</li> <li>Filtering fields:</li> <li><code>syllabus</code>: Used for <code>module_completed</code> and <code>syllabus_completed</code> triggers</li> <li><code>asset_slugs</code>: Used for <code>learnpack_completed</code> triggers</li> <li><code>cohorts</code>: Used for <code>course_completed</code>, <code>module_completed</code>, and <code>syllabus_completed</code> triggers</li> </ul>"},{"location":"LLM-DOCS/SURVEYS_SYSTEM/#step-1-create-a-survey-question-template-optional-but-recommended","title":"Step 1: Create a Survey Question Template (Optional but Recommended)","text":"<p>Create a reusable template for your questions. This makes it easier to reuse the same questions across multiple configurations.</p> <p>Endpoint: <code>POST /v1/feedback/academy/survey/question_template</code></p> <p>Headers: - <code>Authorization: Token {{token}}</code> - <code>Academy: {{academy_id}}</code> - <code>Content-Type: application/json</code></p> <p>Request Body: <pre><code>{\n  \"slug\": \"syllabus-completion-v1\",\n  \"title\": \"Syllabus Completion Survey\",\n  \"description\": \"Survey when students complete the entire syllabus\",\n  \"questions\": {\n    \"questions\": [\n      {\n        \"id\": \"q1\",\n        \"type\": \"likert_scale\",\n        \"required\": true,\n        \"title\": {\n          \"en\": \"How satisfied are you with the overall course?\",\n          \"es\": \"\u00bfQu\u00e9 tan satisfecho est\u00e1s con el curso en general?\"\n        },\n        \"config\": {\n          \"scale\": 5,\n          \"labels\": {\n            \"1\": \"Very unsatisfied\",\n            \"5\": \"Very satisfied\"\n          }\n        }\n      },\n      {\n        \"id\": \"q2\",\n        \"type\": \"open_question\",\n        \"required\": false,\n        \"title\": {\n          \"en\": \"What did you like most about the course?\",\n          \"es\": \"\u00bfQu\u00e9 te gust\u00f3 m\u00e1s del curso?\"\n        },\n        \"config\": {\n          \"max_length\": 500\n        }\n      }\n    ]\n  }\n}\n</code></pre></p> <p>Response: Save the <code>id</code> from the response as <code>{{template_id}}</code> for use in Step 2.</p>"},{"location":"LLM-DOCS/SURVEYS_SYSTEM/#step-2-create-a-survey-configuration","title":"Step 2: Create a Survey Configuration","text":"<p>Create a configuration that triggers when the syllabus is completed.</p> <p>Endpoint: <code>POST /v1/feedback/academy/survey/configuration</code></p> <p>Headers: - <code>Authorization: Token {{token}}</code> - <code>Academy: {{academy_id}}</code> - <code>Content-Type: application/json</code></p>"},{"location":"LLM-DOCS/SURVEYS_SYSTEM/#option-a-using-a-template-recommended","title":"Option A: Using a Template (Recommended)","text":"<p>Request Body: <pre><code>{\n  \"trigger_type\": \"syllabus_completed\",\n  \"template\": {{template_id}},\n  \"is_active\": true,\n  \"syllabus\": {\n    \"syllabus\": \"full-stack\",\n    \"version\": 2\n  },\n  \"cohorts\": [],\n  \"asset_slugs\": []\n}\n</code></pre></p>"},{"location":"LLM-DOCS/SURVEYS_SYSTEM/#option-b-using-inline-questions","title":"Option B: Using Inline Questions","text":"<p>Request Body: <pre><code>{\n  \"trigger_type\": \"syllabus_completed\",\n  \"is_active\": true,\n  \"syllabus\": {\n    \"syllabus\": \"full-stack\",\n    \"version\": 2\n  },\n  \"cohorts\": [],\n  \"asset_slugs\": [],\n  \"questions\": {\n    \"questions\": [\n      {\n        \"id\": \"q1\",\n        \"type\": \"likert_scale\",\n        \"required\": true,\n        \"title\": \"How satisfied are you?\",\n        \"config\": {\n          \"scale\": 5,\n          \"labels\": {\n            \"1\": \"Very unsatisfied\",\n            \"5\": \"Very satisfied\"\n          }\n        }\n      },\n      {\n        \"id\": \"q2\",\n        \"type\": \"open_question\",\n        \"required\": false,\n        \"title\": \"What would you improve?\",\n        \"config\": {\n          \"max_length\": 500\n        }\n      }\n    ]\n  }\n}\n</code></pre></p>"},{"location":"LLM-DOCS/SURVEYS_SYSTEM/#important-configuration-fields","title":"Important Configuration Fields:","text":"<ul> <li><code>trigger_type</code>: Must be <code>\"syllabus_completed\"</code> for syllabus completion surveys</li> <li><code>syllabus</code>: Filter object that specifies which syllabus to target:</li> <li><code>\"syllabus\"</code>: The syllabus slug (e.g., <code>\"full-stack\"</code>)</li> <li><code>\"version\"</code>: Optional, specific version number (integer)</li> <li>Do NOT include <code>\"module\"</code> - that's only for module completion surveys</li> <li><code>cohorts</code>: </li> <li>Empty array <code>[]</code> = applies to all cohorts</li> <li>Array of cohort IDs = only applies to those specific cohorts</li> <li><code>asset_slugs</code>: Not used for syllabus completion (leave as empty array <code>[]</code>)</li> <li><code>is_active</code>: Must be <code>true</code> for the survey to trigger</li> </ul> <p>Response: Save the <code>id</code> from the response as <code>{{configuration_id}}</code> for use in Step 3.</p>"},{"location":"LLM-DOCS/SURVEYS_SYSTEM/#step-3-create-a-survey-study","title":"Step 3: Create a Survey Study","text":"<p>Create a study to group your configuration. Studies provide study-level constraints and statistics tracking.</p> <p>Endpoint: <code>POST /v1/feedback/academy/survey/study</code></p> <p>Headers: - <code>Authorization: Token {{token}}</code> - <code>Academy: {{academy_id}}</code> - <code>Content-Type: application/json</code></p> <p>Request Body: <pre><code>{\n  \"slug\": \"syllabus-completion-study-2025\",\n  \"title\": \"Syllabus Completion Study - 2025\",\n  \"description\": \"Study for tracking syllabus completion feedback\",\n  \"starts_at\": \"2025-01-01T00:00:00Z\",\n  \"ends_at\": null,\n  \"max_responses\": null,\n  \"survey_configurations\": [{{configuration_id}}]\n}\n</code></pre></p>"},{"location":"LLM-DOCS/SURVEYS_SYSTEM/#study-fields-explained","title":"Study Fields Explained:","text":"<ul> <li><code>slug</code>: Unique identifier for the study (URL-friendly)</li> <li><code>title</code>: Human-readable title</li> <li><code>description</code>: Optional description</li> <li><code>starts_at</code>: Optional start date/time (ISO 8601 format). If <code>null</code>, study starts immediately</li> <li><code>ends_at</code>: Optional end date/time. If <code>null</code>, study has no end date</li> <li><code>max_responses</code>: Optional maximum number of ANSWERED responses allowed. If <code>null</code>, unlimited</li> <li><code>survey_configurations</code>: Array containing your configuration ID(s)</li> </ul> <p>Response: Save the <code>id</code> from the response as <code>{{study_id}}</code> for monitoring.</p>"},{"location":"LLM-DOCS/SURVEYS_SYSTEM/#step-4-verify-the-setup","title":"Step 4: Verify the Setup","text":"<p>Check that your study is properly configured:</p> <p>Endpoint: <code>GET /v1/feedback/academy/survey/study/{{study_id}}</code></p> <p>Headers: - <code>Authorization: Token {{token}}</code> - <code>Academy: {{academy_id}}</code></p> <p>The response should show your study with the configuration included.</p>"},{"location":"LLM-DOCS/SURVEYS_SYSTEM/#how-it-works","title":"How It Works","text":""},{"location":"LLM-DOCS/SURVEYS_SYSTEM/#automatic-triggering","title":"Automatic Triggering","text":"<p>When a user completes all modules in a syllabus, the system automatically:</p> <ol> <li>Detects completion: The system checks if ALL modules in the syllabus are complete using <code>_is_syllabus_complete()</code></li> <li>Finds active studies: Looks for active <code>SurveyStudy</code> instances with <code>syllabus_completed</code> trigger type</li> <li>Matches filters: Checks if the user's syllabus slug and version match your configuration</li> <li>Creates response: Creates a <code>SurveyResponse</code> and sends a Pusher event to show the survey in real-time</li> </ol>"},{"location":"LLM-DOCS/SURVEYS_SYSTEM/#syllabus-filtering","title":"Syllabus Filtering","text":"<p>Your configuration will match when:</p> <ul> <li>Syllabus slug matches: If you specified <code>\"syllabus\": \"full-stack\"</code>, it only matches that syllabus</li> <li>Syllabus version matches: If you specified <code>\"version\": 2</code>, it only matches version 2</li> <li>Cohort matches: If you specified <code>cohorts: [123, 456]</code>, it only matches those cohorts. If <code>cohorts: []</code>, it matches all cohorts</li> </ul>"},{"location":"LLM-DOCS/SURVEYS_SYSTEM/#one-survey-per-user-per-study","title":"One Survey Per User Per Study","text":"<p>Important: Each user can receive only one survey per study, even if they complete multiple syllabi. This prevents duplicate surveys.</p>"},{"location":"LLM-DOCS/SURVEYS_SYSTEM/#example-multiple-syllabi","title":"Example: Multiple Syllabi","text":"<p>If you want to study multiple syllabi, create separate configurations and add them to the same study:</p> <p>Step 2 (repeated for each syllabus): <pre><code>{\n  \"trigger_type\": \"syllabus_completed\",\n  \"template\": {{template_id}},\n  \"is_active\": true,\n  \"syllabus\": {\n    \"syllabus\": \"full-stack\",\n    \"version\": 2\n  },\n  \"cohorts\": [],\n  \"asset_slugs\": []\n}\n</code></pre></p> <pre><code>{\n  \"trigger_type\": \"syllabus_completed\",\n  \"template\": {{template_id}},\n  \"is_active\": true,\n  \"syllabus\": {\n    \"syllabus\": \"data-science\",\n    \"version\": 1\n  },\n  \"cohorts\": [],\n  \"asset_slugs\": []\n}\n</code></pre> <p>Step 3 (create study with both configurations): <pre><code>{\n  \"slug\": \"multi-syllabus-study\",\n  \"title\": \"Multi-Syllabus Completion Study\",\n  \"description\": \"Study for multiple syllabi\",\n  \"survey_configurations\": [\n    {{config_id_syllabus_1}},\n    {{config_id_syllabus_2}}\n  ]\n}\n</code></pre></p> <p>Users will be distributed across configurations using round-robin distribution to ensure equitable split.</p>"},{"location":"LLM-DOCS/SURVEYS_SYSTEM/#monitoring-your-study","title":"Monitoring Your Study","text":""},{"location":"LLM-DOCS/SURVEYS_SYSTEM/#view-study-statistics","title":"View Study Statistics","text":"<p>Endpoint: <code>GET /v1/feedback/academy/survey/study/{{study_id}}</code></p> <p>The response includes a <code>stats</code> field with aggregated statistics:</p> <pre><code>{\n  \"id\": 1,\n  \"slug\": \"syllabus-completion-study-2025\",\n  \"stats\": {\n    \"sent\": 150,\n    \"opened\": 120,\n    \"partial_responses\": 10,\n    \"responses\": 100,\n    \"email_opened\": 80,\n    \"updated_at\": \"2025-01-15T10:30:00Z\"\n  }\n}\n</code></pre> <p>Statistics Explained: - <code>sent</code>: Total number of <code>SurveyResponse</code> objects created - <code>opened</code>: Number of responses that were opened by users - <code>partial_responses</code>: Number of partially completed responses - <code>responses</code>: Number of fully answered responses - <code>email_opened</code>: Number of survey emails that were opened (if using email campaigns)</p>"},{"location":"LLM-DOCS/SURVEYS_SYSTEM/#view-individual-responses","title":"View Individual Responses","text":"<p>Endpoint: <code>GET /v1/feedback/academy/survey/response?survey_config={{configuration_id}}</code></p> <p>Query Parameters: - <code>survey_config</code>: Filter by configuration ID - <code>cohort_id</code>: Filter by cohort ID - <code>status</code>: Filter by status (<code>PENDING</code>, <code>OPENED</code>, <code>PARTIAL</code>, <code>ANSWERED</code>, <code>EXPIRED</code>) - <code>user</code>: Filter by user ID</p>"},{"location":"LLM-DOCS/SURVEYS_SYSTEM/#important-reminders","title":"Important Reminders","text":"<ol> <li> <p>All configurations in a study must have the same <code>trigger_type</code>: Since you're using <code>syllabus_completed</code>, all configurations in your study must use <code>syllabus_completed</code>. If you need different trigger types, create separate studies.</p> </li> <li> <p>Do NOT include <code>\"module\"</code> in the syllabus filter: The <code>module</code> field is only for module completion surveys. For syllabus completion, omit it entirely.</p> </li> <li> <p>Set <code>is_active: true</code>: Your configuration must be active for surveys to trigger.</p> </li> <li> <p>Automatic triggering: The system automatically triggers surveys when users complete the syllabus. You don't need to manually send surveys.</p> </li> <li> <p>Time windows: Use <code>starts_at</code> and <code>ends_at</code> to control when the study is active. Surveys will only trigger during the active period.</p> </li> <li> <p>Response limits: Use <code>max_responses</code> to limit the total number of answered responses. Once the limit is reached, no new surveys will be created.</p> </li> </ol>"},{"location":"LLM-DOCS/SURVEYS_SYSTEM/#troubleshooting","title":"Troubleshooting","text":""},{"location":"LLM-DOCS/SURVEYS_SYSTEM/#surveys-not-triggering","title":"Surveys Not Triggering","text":"<ol> <li>Check configuration is active: Verify <code>is_active: true</code> in your configuration</li> <li>Check study time window: Verify <code>starts_at</code> and <code>ends_at</code> allow the study to be active</li> <li>Check syllabus filter: Verify the syllabus slug and version match what students are actually using</li> <li>Check cohort filter: If you specified cohorts, verify students are in those cohorts</li> <li>Check syllabus completion: Verify students have actually completed ALL modules in the syllabus</li> </ol>"},{"location":"LLM-DOCS/SURVEYS_SYSTEM/#viewing-survey-responses","title":"Viewing Survey Responses","text":"<p>Use the staff endpoint to view responses: <pre><code>GET /v1/feedback/academy/survey/response?survey_config={{configuration_id}}\n</code></pre></p>"},{"location":"LLM-DOCS/SURVEYS_SYSTEM/#testing","title":"Testing","text":"<p>To test your setup, you can: 1. Complete a syllabus as a test user 2. Check if a <code>SurveyResponse</code> was created 3. Verify the response appears in the study statistics</p>"},{"location":"LLM-DOCS/SURVEYS_SYSTEM/#related-documentation","title":"Related Documentation","text":"<ul> <li>API Endpoints: See <code>docs/LLM-DOCS/SURVEYS_POSTMAN_CHECKLIST.md</code> for complete API reference</li> <li>Question Types: See question type documentation for available question formats</li> <li>Module Completion: For module-level surveys, use <code>trigger_type: \"module_completed\"</code> instead</li> </ul>"},{"location":"LLM-DOCS/SYLLABUS/","title":"Syllabus Creation - Complete Guide","text":"<p>This guide covers the entire flow to create a syllabus, including all dependencies, validation, and versioning.</p>"},{"location":"LLM-DOCS/SYLLABUS/#table-of-contents","title":"\ud83d\udccb Table of Contents","text":"<ol> <li>Prerequisites</li> <li>Step-by-Step Flow</li> <li>Syllabus JSON Structure</li> <li>API Endpoints Reference</li> <li>Complete Examples</li> <li>Validation and Testing</li> <li>Troubleshooting</li> </ol>"},{"location":"LLM-DOCS/SYLLABUS/#prerequisites","title":"\ud83c\udfaf Prerequisites","text":"<p>Before creating a syllabus, you need to have the following dependencies in place:</p>"},{"location":"LLM-DOCS/SYLLABUS/#1-academy-optional-but-recommended","title":"1. Academy (Optional but Recommended)","text":"<ul> <li>An academy can own private syllabi</li> <li>Academy provides context for syllabus ownership</li> <li>Public syllabi can be used by any academy</li> </ul>"},{"location":"LLM-DOCS/SYLLABUS/#2-assets-required-for-content","title":"2. Assets (Required for Content)","text":"<ul> <li>Lessons: Educational content assets</li> <li>Quizzes: Assessment assets</li> <li>Replits: Interactive coding exercises</li> <li>Assignments: Project-based learning assets</li> </ul>"},{"location":"LLM-DOCS/SYLLABUS/#step-by-step-flow","title":"\ud83d\ude80 Step-by-Step Flow","text":""},{"location":"LLM-DOCS/SYLLABUS/#step-1-create-or-verify-academy-optional","title":"Step 1: Create or Verify Academy (Optional)","text":"<p>Endpoint: <code>POST /v1/admissions/academy</code></p> <p>Required Fields: - <code>slug</code> - Unique academy identifier - <code>name</code> - Academy display name - <code>logo_url</code> - Academy logo URL - <code>street_address</code> - Physical address - <code>city</code> - City ID (from catalog) - <code>country</code> - Country code</p> <p>Example: <pre><code>curl -X POST \"https://your-api.com/v1/admissions/academy\" \\\n  -H \"Authorization: Token your_token_here\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"slug\": \"miami-academy\",\n    \"name\": \"Miami Academy\",\n    \"logo_url\": \"https://example.com/logo.png\",\n    \"street_address\": \"123 Main St\",\n    \"city\": 1,\n    \"country\": \"us\",\n    \"timezone\": \"America/New_York\"\n  }'\n</code></pre></p> <p>Response: <pre><code>{\n  \"id\": 1,\n  \"slug\": \"miami-academy\",\n  \"name\": \"Miami Academy\",\n  \"owner\": {\n    \"id\": 123,\n    \"email\": \"admin@miami-academy.com\"\n  },\n  \"timezone\": \"America/New_York\",\n  \"status\": \"ACTIVE\"\n}\n</code></pre></p>"},{"location":"LLM-DOCS/SYLLABUS/#step-2-create-syllabus","title":"Step 2: Create Syllabus","text":"<p>Endpoint: <code>POST /v1/admissions/syllabus</code></p> <p>Required Fields: - <code>slug</code> - Unique syllabus identifier - <code>name</code> - Syllabus display name</p> <p>Example: <pre><code>curl -X POST \"https://your-api.com/v1/admissions/syllabus\" \\\n  -H \"Authorization: Token your_token_here\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"slug\": \"full-stack-web-development\",\n    \"name\": \"Full Stack Web Development\",\n    \"main_technologies\": \"HTML, CSS, JavaScript, React, Node.js\",\n    \"duration_in_hours\": 400,\n    \"duration_in_days\": 16,\n    \"week_hours\": 25,\n    \"logo\": \"https://example.com/syllabus-logo.png\",\n    \"github_url\": \"https://github.com/4geeksacademy/full-stack-syllabus\",\n    \"academy_owner\": 1,\n    \"private\": false,\n    \"is_documentation\": false\n  }'\n</code></pre></p> <p>Response: <pre><code>{\n  \"id\": 1,\n  \"slug\": \"full-stack-web-development\",\n  \"name\": \"Full Stack Web Development\",\n  \"main_technologies\": \"HTML, CSS, JavaScript, React, Node.js\",\n  \"duration_in_hours\": 400,\n  \"duration_in_days\": 16,\n  \"week_hours\": 25,\n  \"logo\": \"https://example.com/syllabus-logo.png\",\n  \"github_url\": \"https://github.com/4geeksacademy/full-stack-syllabus\",\n  \"academy_owner\": 1,\n  \"private\": false,\n  \"is_documentation\": false,\n  \"created_at\": \"2024-01-15T10:00:00Z\",\n  \"updated_at\": \"2024-01-15T10:00:00Z\"\n}\n</code></pre></p> <p>Note: A signal automatically creates version 1 when a syllabus is created.</p>"},{"location":"LLM-DOCS/SYLLABUS/#step-3-create-syllabus-version","title":"Step 3: Create Syllabus Version","text":"<p>Endpoint: <code>POST /v1/admissions/syllabus/{syllabus_id}/version</code></p> <p>Required Fields: - <code>json</code> - Syllabus content in JSON format - <code>status</code> - Must be \"PUBLISHED\" for cohorts</p> <p>Example: <pre><code>curl -X POST \"https://your-api.com/v1/admissions/syllabus/1/version\" \\\n  -H \"Authorization: Token your_token_here\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"json\": {\n      \"days\": [\n        {\n          \"id\": 1,\n          \"label\": \"HTML/CSS Fundamentals\",\n          \"lessons\": [\n            {\n              \"slug\": \"intro-to-html\",\n              \"title\": \"Introduction to HTML\"\n            },\n            {\n              \"slug\": \"css-basics\",\n              \"title\": \"CSS Fundamentals\"\n            }\n          ],\n          \"quizzes\": [\n            {\n              \"slug\": \"html-quiz\",\n              \"title\": \"HTML Knowledge Check\",\n              \"mandatory\": true\n            }\n          ],\n          \"replits\": [\n            {\n              \"slug\": \"html-exercises\",\n              \"title\": \"HTML Practice Exercises\"\n            }\n          ],\n          \"assignments\": [\n            {\n              \"slug\": \"build-a-website\",\n              \"title\": \"Build Your First Website\"\n            }\n          ],\n          \"project\": {\n            \"title\": \"Personal Portfolio Website\",\n            \"instructions\": \"Create a personal portfolio using HTML and CSS\"\n          },\n          \"teacher_instructions\": \"Focus on semantic HTML and responsive CSS design principles.\"\n        }\n      ]\n    },\n    \"status\": \"PUBLISHED\",\n    \"change_log_details\": \"Initial version with HTML/CSS fundamentals\"\n  }'\n</code></pre></p> <p>Response: <pre><code>{\n  \"id\": 1,\n  \"version\": 2,\n  \"syllabus\": 1,\n  \"status\": \"PUBLISHED\",\n  \"change_log_details\": \"Initial version with HTML/CSS fundamentals\",\n  \"integrity_status\": \"PENDING\",\n  \"created_at\": \"2024-01-15T10:30:00Z\",\n  \"updated_at\": \"2024-01-15T10:30:00Z\"\n}\n</code></pre></p>"},{"location":"LLM-DOCS/SYLLABUS/#syllabus-json-structure","title":"\ud83d\udcda Syllabus JSON Structure","text":""},{"location":"LLM-DOCS/SYLLABUS/#root-structure","title":"Root Structure","text":"<pre><code>{\n  \"days\": [\n    {\n      \"id\": 1,\n      \"label\": \"Module Name\",\n      \"lessons\": [...],\n      \"quizzes\": [...],\n      \"replits\": [...],\n      \"assignments\": [...],\n      \"project\": {...},\n      \"teacher_instructions\": \"Instructions for teachers\"\n    }\n  ]\n}\n</code></pre>"},{"location":"LLM-DOCS/SYLLABUS/#daymodule-structure","title":"Day/Module Structure","text":"Field Type Required Description <code>id</code> integer \u2705 Unique day/module identifier <code>label</code> string \u2705 Module name/title <code>lessons</code> array \u274c List of lesson assets <code>quizzes</code> array \u274c List of quiz assets <code>replits</code> array \u274c List of replit assets <code>assignments</code> array \u274c List of assignment assets <code>project</code> object \u274c Project information <code>teacher_instructions</code> string \u274c Instructions for teachers"},{"location":"LLM-DOCS/SYLLABUS/#asset-structure","title":"Asset Structure","text":""},{"location":"LLM-DOCS/SYLLABUS/#lessons","title":"Lessons","text":"<pre><code>{\n  \"slug\": \"lesson-slug\",\n  \"title\": \"Lesson Title\"\n}\n</code></pre>"},{"location":"LLM-DOCS/SYLLABUS/#quizzes","title":"Quizzes","text":"<pre><code>{\n  \"slug\": \"quiz-slug\",\n  \"title\": \"Quiz Title\",\n  \"url\": \"https://quiz-url.com\",\n  \"target\": \"self\",\n  \"mandatory\": true\n}\n</code></pre>"},{"location":"LLM-DOCS/SYLLABUS/#replits","title":"Replits","text":"<pre><code>{\n  \"slug\": \"replit-slug\",\n  \"title\": \"Replit Title\"\n}\n</code></pre>"},{"location":"LLM-DOCS/SYLLABUS/#assignments","title":"Assignments","text":"<pre><code>{\n  \"slug\": \"assignment-slug\",\n  \"title\": \"Assignment Title\"\n}\n</code></pre>"},{"location":"LLM-DOCS/SYLLABUS/#project","title":"Project","text":"<pre><code>{\n  \"title\": \"Project Title\",\n  \"instructions\": \"Project instructions or URL\"\n}\n</code></pre>"},{"location":"LLM-DOCS/SYLLABUS/#complete-example","title":"Complete Example","text":"<pre><code>{\n  \"days\": [\n    {\n      \"id\": 1,\n      \"label\": \"HTML/CSS Fundamentals\",\n      \"lessons\": [\n        {\n          \"slug\": \"intro-to-html\",\n          \"title\": \"Introduction to HTML\"\n        },\n        {\n          \"slug\": \"css-basics\",\n          \"title\": \"CSS Fundamentals\"\n        }\n      ],\n      \"quizzes\": [\n        {\n          \"slug\": \"html-quiz\",\n          \"title\": \"HTML Knowledge Check\",\n          \"mandatory\": true\n        }\n      ],\n      \"replits\": [\n        {\n          \"slug\": \"html-exercises\",\n          \"title\": \"HTML Practice Exercises\"\n        }\n      ],\n      \"assignments\": [\n        {\n          \"slug\": \"build-a-website\",\n          \"title\": \"Build Your First Website\"\n        }\n      ],\n      \"project\": {\n        \"title\": \"Personal Portfolio Website\",\n        \"instructions\": \"Create a personal portfolio using HTML and CSS\"\n      },\n      \"teacher_instructions\": \"Focus on semantic HTML and responsive CSS design principles.\"\n    },\n    {\n      \"id\": 2,\n      \"label\": \"JavaScript Basics\",\n      \"lessons\": [\n        {\n          \"slug\": \"intro-to-javascript\",\n          \"title\": \"Introduction to JavaScript\"\n        }\n      ],\n      \"quizzes\": [\n        {\n          \"slug\": \"javascript-quiz\",\n          \"title\": \"JavaScript Fundamentals Quiz\",\n          \"mandatory\": true\n        }\n      ],\n      \"replits\": [\n        {\n          \"slug\": \"javascript-exercises\",\n          \"title\": \"JavaScript Practice\"\n        }\n      ],\n      \"assignments\": [],\n      \"project\": {\n        \"title\": \"Interactive Calculator\",\n        \"instructions\": \"Build a calculator using JavaScript\"\n      },\n      \"teacher_instructions\": \"Emphasize DOM manipulation and event handling.\"\n    }\n  ]\n}\n</code></pre>"},{"location":"LLM-DOCS/SYLLABUS/#api-endpoints-reference","title":"\ud83d\udcda API Endpoints Reference","text":""},{"location":"LLM-DOCS/SYLLABUS/#syllabus-management","title":"Syllabus Management","text":"Method Endpoint Description Required Headers <code>GET</code> <code>/v1/admissions/syllabus</code> List all syllabi None <code>POST</code> <code>/v1/admissions/syllabus</code> Create syllabus <code>Authorization</code> <code>GET</code> <code>/v1/admissions/syllabus/{id}</code> Get syllabus details None <code>PUT</code> <code>/v1/admissions/syllabus/{id}</code> Update syllabus <code>Authorization</code> <code>GET</code> <code>/v1/admissions/syllabus/{slug}</code> Get syllabus by slug None"},{"location":"LLM-DOCS/SYLLABUS/#academy-scoped-syllabus-management","title":"Academy-Scoped Syllabus Management","text":"Method Endpoint Description Required Headers <code>GET</code> <code>/v1/admissions/academy/{id}/syllabus</code> List academy syllabi None <code>POST</code> <code>/v1/admissions/academy/{id}/syllabus</code> Create academy syllabus <code>Authorization</code> <code>GET</code> <code>/v1/admissions/academy/{id}/syllabus/{id}</code> Get academy syllabus None <code>PUT</code> <code>/v1/admissions/academy/{id}/syllabus/{id}</code> Update academy syllabus <code>Authorization</code>"},{"location":"LLM-DOCS/SYLLABUS/#syllabus-version-management","title":"Syllabus Version Management","text":"Method Endpoint Description Required Headers <code>GET</code> <code>/v1/admissions/syllabus/{id}/version</code> List syllabus versions None <code>POST</code> <code>/v1/admissions/syllabus/{id}/version</code> Create syllabus version <code>Authorization</code> <code>GET</code> <code>/v1/admissions/syllabus/{id}/version/{version}</code> Get specific version None <code>PUT</code> <code>/v1/admissions/syllabus/{id}/version/{version}</code> Update version <code>Authorization</code>"},{"location":"LLM-DOCS/SYLLABUS/#syllabus-testing","title":"Syllabus Testing","text":"Method Endpoint Description Required Headers <code>POST</code> <code>/v1/admissions/syllabus/test</code> Test syllabus JSON <code>Authorization</code>"},{"location":"LLM-DOCS/SYLLABUS/#complete-examples","title":"\ud83c\udfaf Complete Examples","text":""},{"location":"LLM-DOCS/SYLLABUS/#example-1-minimal-syllabus-creation","title":"Example 1: Minimal Syllabus Creation","text":"<pre><code># 1. Create Syllabus\ncurl -X POST \"https://api.breatheco.de/v1/admissions/syllabus\" \\\n  -H \"Authorization: Token your_token\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"slug\": \"web-dev-basics\",\n    \"name\": \"Web Development Basics\"\n  }'\n\n# 2. Create Syllabus Version\ncurl -X POST \"https://api.breatheco.de/v1/admissions/syllabus/1/version\" \\\n  -H \"Authorization: Token your_token\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"json\": {\n      \"days\": [\n        {\n          \"id\": 1,\n          \"label\": \"Introduction\",\n          \"lessons\": [\n            {\n              \"slug\": \"intro-to-web\",\n              \"title\": \"Introduction to Web Development\"\n            }\n          ],\n          \"teacher_instructions\": \"Welcome students to web development\"\n        }\n      ]\n    },\n    \"status\": \"PUBLISHED\"\n  }'\n</code></pre>"},{"location":"LLM-DOCS/SYLLABUS/#example-2-complete-syllabus-with-all-content-types","title":"Example 2: Complete Syllabus with All Content Types","text":"<pre><code># 1. Create Syllabus\ncurl -X POST \"https://api.breatheco.de/v1/admissions/syllabus\" \\\n  -H \"Authorization: Token your_token\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"slug\": \"full-stack-bootcamp\",\n    \"name\": \"Full Stack Development Bootcamp\",\n    \"main_technologies\": \"HTML, CSS, JavaScript, React, Node.js, MongoDB\",\n    \"duration_in_hours\": 400,\n    \"duration_in_days\": 16,\n    \"week_hours\": 25,\n    \"logo\": \"https://example.com/logo.png\",\n    \"github_url\": \"https://github.com/academy/full-stack-syllabus\",\n    \"academy_owner\": 1,\n    \"private\": false\n  }'\n\n# 2. Create Comprehensive Syllabus Version\ncurl -X POST \"https://api.breatheco.de/v1/admissions/syllabus/1/version\" \\\n  -H \"Authorization: Token your_token\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"json\": {\n      \"days\": [\n        {\n          \"id\": 1,\n          \"label\": \"HTML/CSS Fundamentals\",\n          \"lessons\": [\n            {\n              \"slug\": \"intro-to-html\",\n              \"title\": \"Introduction to HTML\"\n            },\n            {\n              \"slug\": \"css-basics\",\n              \"title\": \"CSS Fundamentals\"\n            },\n            {\n              \"slug\": \"responsive-design\",\n              \"title\": \"Responsive Web Design\"\n            }\n          ],\n          \"quizzes\": [\n            {\n              \"slug\": \"html-css-quiz\",\n              \"title\": \"HTML/CSS Knowledge Check\",\n              \"mandatory\": true\n            }\n          ],\n          \"replits\": [\n            {\n              \"slug\": \"html-exercises\",\n              \"title\": \"HTML Practice Exercises\"\n            },\n            {\n              \"slug\": \"css-exercises\",\n              \"title\": \"CSS Practice Exercises\"\n            }\n          ],\n          \"assignments\": [\n            {\n              \"slug\": \"build-portfolio\",\n              \"title\": \"Build a Personal Portfolio\"\n            }\n          ],\n          \"project\": {\n            \"title\": \"Personal Portfolio Website\",\n            \"instructions\": \"Create a responsive personal portfolio using HTML and CSS\"\n          },\n          \"teacher_instructions\": \"Focus on semantic HTML, CSS Grid, Flexbox, and responsive design principles. Ensure students understand the box model and CSS specificity.\"\n        },\n        {\n          \"id\": 2,\n          \"label\": \"JavaScript Fundamentals\",\n          \"lessons\": [\n            {\n              \"slug\": \"intro-to-javascript\",\n              \"title\": \"Introduction to JavaScript\"\n            },\n            {\n              \"slug\": \"dom-manipulation\",\n              \"title\": \"DOM Manipulation\"\n            },\n            {\n              \"slug\": \"async-javascript\",\n              \"title\": \"Asynchronous JavaScript\"\n            }\n          ],\n          \"quizzes\": [\n            {\n              \"slug\": \"javascript-quiz\",\n              \"title\": \"JavaScript Fundamentals Quiz\",\n              \"mandatory\": true\n            }\n          ],\n          \"replits\": [\n            {\n              \"slug\": \"javascript-exercises\",\n              \"title\": \"JavaScript Practice\"\n            }\n          ],\n          \"assignments\": [\n            {\n              \"slug\": \"interactive-calculator\",\n              \"title\": \"Build an Interactive Calculator\"\n            }\n          ],\n          \"project\": {\n            \"title\": \"Interactive Web Application\",\n            \"instructions\": \"Build an interactive web application using vanilla JavaScript\"\n          },\n          \"teacher_instructions\": \"Emphasize DOM manipulation, event handling, and asynchronous programming. Cover ES6+ features and modern JavaScript practices.\"\n        }\n      ]\n    },\n    \"status\": \"PUBLISHED\",\n    \"change_log_details\": \"Initial comprehensive version with HTML/CSS and JavaScript modules\"\n  }'\n</code></pre>"},{"location":"LLM-DOCS/SYLLABUS/#example-3-academy-scoped-syllabus","title":"Example 3: Academy-Scoped Syllabus","text":"<pre><code># 1. Create Academy-Scoped Syllabus\ncurl -X POST \"https://api.breatheco.de/v1/admissions/academy/1/syllabus\" \\\n  -H \"Authorization: Token your_token\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"slug\": \"miami-web-dev\",\n    \"name\": \"Miami Web Development Program\",\n    \"main_technologies\": \"HTML, CSS, JavaScript, React\",\n    \"duration_in_hours\": 300,\n    \"academy_owner\": 1,\n    \"private\": true\n  }'\n\n# 2. Create Version for Academy Syllabus\ncurl -X POST \"https://api.breatheco.de/v1/admissions/syllabus/2/version\" \\\n  -H \"Authorization: Token your_token\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"json\": {\n      \"days\": [\n        {\n          \"id\": 1,\n          \"label\": \"Miami-Specific Web Development\",\n          \"lessons\": [\n            {\n              \"slug\": \"miami-tech-scene\",\n              \"title\": \"Miami Tech Scene Overview\"\n            }\n          ],\n          \"teacher_instructions\": \"Focus on local Miami tech opportunities and networking\"\n        }\n      ]\n    },\n    \"status\": \"PUBLISHED\"\n  }'\n</code></pre>"},{"location":"LLM-DOCS/SYLLABUS/#field-reference","title":"\ud83d\udd27 Field Reference","text":""},{"location":"LLM-DOCS/SYLLABUS/#syllabus-fields","title":"Syllabus Fields","text":"Field Type Required Description <code>slug</code> string \u2705 Unique identifier <code>name</code> string \u2705 Display name <code>main_technologies</code> string \u274c Comma-separated technologies <code>duration_in_hours</code> integer \u274c Total hours <code>duration_in_days</code> integer \u274c Total days <code>week_hours</code> integer \u274c Hours per week <code>logo</code> string \u274c Logo URL <code>github_url</code> string \u274c GitHub repository URL <code>academy_owner</code> integer \u274c Academy ID (for private syllabi) <code>private</code> boolean \u274c Private to academy owner <code>is_documentation</code> boolean \u274c Documentation-only syllabus"},{"location":"LLM-DOCS/SYLLABUS/#syllabus-version-fields","title":"Syllabus Version Fields","text":"Field Type Required Description <code>json</code> object \u2705 Syllabus content <code>status</code> string \u2705 \"PUBLISHED\" or \"DRAFT\" <code>change_log_details</code> string \u274c Change description"},{"location":"LLM-DOCS/SYLLABUS/#version-status-options","title":"Version Status Options","text":"Status Description <code>PUBLISHED</code> Available for cohorts <code>DRAFT</code> Work in progress"},{"location":"LLM-DOCS/SYLLABUS/#validation-and-testing","title":"\ud83e\uddea Validation and Testing","text":""},{"location":"LLM-DOCS/SYLLABUS/#syllabus-validation","title":"Syllabus Validation","text":"<p>The system automatically validates syllabus JSON when creating versions:</p> <ol> <li>Structure Validation: Ensures <code>days</code> array exists</li> <li>Asset Validation: Checks that referenced assets exist</li> <li>Content Validation: Validates lesson, quiz, replit, and assignment slugs</li> <li>Teacher Instructions: Warns if missing or empty</li> </ol>"},{"location":"LLM-DOCS/SYLLABUS/#test-syllabus-endpoint","title":"Test Syllabus Endpoint","text":"<p>Endpoint: <code>POST /v1/admissions/syllabus/test</code></p> <p>Example: <pre><code>curl -X POST \"https://api.breatheco.de/v1/admissions/syllabus/test\" \\\n  -H \"Authorization: Token your_token\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"json\": {\n      \"days\": [\n        {\n          \"id\": 1,\n          \"label\": \"Test Module\",\n          \"lessons\": [\n            {\n              \"slug\": \"test-lesson\",\n              \"title\": \"Test Lesson\"\n            }\n          ],\n          \"teacher_instructions\": \"Test instructions\"\n        }\n      ]\n    }\n  }'\n</code></pre></p> <p>Response: <pre><code>{\n  \"status\": \"OK\",\n  \"errors\": [],\n  \"warnings\": []\n}\n</code></pre></p>"},{"location":"LLM-DOCS/SYLLABUS/#validation-rules","title":"Validation Rules","text":"<ol> <li>Required Fields: Each day must have <code>id</code> and <code>label</code></li> <li>Asset Slugs: All asset slugs must be strings</li> <li>Asset Existence: Referenced assets must exist in the system</li> <li>Teacher Instructions: Should not be empty (warning only)</li> <li>Unique IDs: Day IDs should be unique within the syllabus</li> </ol>"},{"location":"LLM-DOCS/SYLLABUS/#important-notes","title":"\u26a0\ufe0f Important Notes","text":""},{"location":"LLM-DOCS/SYLLABUS/#version-management","title":"Version Management","text":"<ul> <li>Version 1: Automatically created when syllabus is created (marketing only)</li> <li>Version 2+: Can be assigned to cohorts</li> <li>Status: Must be \"PUBLISHED\" for cohorts</li> <li>Auto-increment: Versions are automatically incremented</li> </ul>"},{"location":"LLM-DOCS/SYLLABUS/#academy-ownership","title":"Academy Ownership","text":"<ul> <li>Public Syllabi: Can be used by any academy (<code>private=false</code>)</li> <li>Private Syllabi: Only accessible by academy owner (<code>private=true</code>)</li> <li>Academy Owner: Set via <code>academy_owner</code> field</li> </ul>"},{"location":"LLM-DOCS/SYLLABUS/#asset-dependencies","title":"Asset Dependencies","text":"<ul> <li>Lessons: Must exist in the asset registry</li> <li>Quizzes: Must exist in the asset registry</li> <li>Replits: Must exist in the asset registry</li> <li>Assignments: Must exist in the asset registry</li> </ul>"},{"location":"LLM-DOCS/SYLLABUS/#change-tracking","title":"Change Tracking","text":"<ul> <li>Change Log: Automatically generated for version creation</li> <li>User Tracking: Records who created each version</li> <li>Timestamp: Includes creation timestamp</li> </ul>"},{"location":"LLM-DOCS/SYLLABUS/#troubleshooting","title":"\ud83d\udea8 Troubleshooting","text":""},{"location":"LLM-DOCS/SYLLABUS/#common-errors","title":"Common Errors","text":""},{"location":"LLM-DOCS/SYLLABUS/#1-syllabus-must-have-a-days-property","title":"1. \"Syllabus must have a 'days' property\"","text":"<p>Error: <code>Syllabus must have a 'days' or 'modules' property</code> Solution: Ensure JSON has a <code>days</code> array at the root level</p>"},{"location":"LLM-DOCS/SYLLABUS/#2-missing-slug-on-lessons-property","title":"2. \"Missing slug on lessons property\"","text":"<p>Error: <code>Missing slug on lessons property on module {index}</code> Solution: Ensure all assets have a <code>slug</code> field</p>"},{"location":"LLM-DOCS/SYLLABUS/#3-missing-lesson-with-slug-slug","title":"3. \"Missing lesson with slug {slug}\"","text":"<p>Error: <code>Missing lesson with slug {slug} on module {index}</code> Solution: Ensure the referenced asset exists in the system</p>"},{"location":"LLM-DOCS/SYLLABUS/#4-empty-teacher-instructions","title":"4. \"Empty teacher instructions\"","text":"<p>Warning: <code>Empty teacher instructions on module {index}</code> Solution: Add meaningful teacher instructions for each module</p>"},{"location":"LLM-DOCS/SYLLABUS/#5-syllabus-with-errors","title":"5. \"Syllabus with errors\"","text":"<p>Error: <code>There are {count} errors in your syllabus</code> Solution: Fix all validation errors before submitting</p>"},{"location":"LLM-DOCS/SYLLABUS/#validation-tips","title":"Validation Tips","text":"<ol> <li>Test First: Use the test endpoint before creating versions</li> <li>Check Assets: Ensure all referenced assets exist</li> <li>Validate Structure: Follow the JSON structure exactly</li> <li>Review Instructions: Add meaningful teacher instructions</li> <li>Check Slugs: Ensure all slugs are valid strings</li> </ol>"},{"location":"LLM-DOCS/SYLLABUS/#debug-steps","title":"Debug Steps","text":"<ol> <li>Test Syllabus: <code>POST /v1/admissions/syllabus/test</code></li> <li>List Assets: Check available assets in the registry</li> <li>Validate JSON: Use JSON validators for structure</li> <li>Check Permissions: Ensure you have <code>crud_syllabus</code> capability</li> <li>Review Logs: Check server logs for detailed error messages</li> </ol>"},{"location":"LLM-DOCS/SYLLABUS/#support","title":"\ud83d\udcde Support","text":"<p>For additional help: - Check API documentation: <code>/docs/</code> - Review error messages for specific guidance - Ensure all required fields are provided - Verify permissions and academy context - Test syllabus JSON before creating versions</p>"},{"location":"LLM-DOCS/SYLLABUS/#version-lifecycle","title":"\ud83d\udd04 Version Lifecycle","text":""},{"location":"LLM-DOCS/SYLLABUS/#version-1-marketing","title":"Version 1 (Marketing)","text":"<ul> <li>Automatically created when syllabus is created</li> <li>Used for marketing purposes only</li> <li>Cannot be assigned to cohorts</li> <li>Always has status \"PUBLISHED\"</li> </ul>"},{"location":"LLM-DOCS/SYLLABUS/#version-2-functional","title":"Version 2+ (Functional)","text":"<ul> <li>Created manually via API</li> <li>Can be assigned to cohorts</li> <li>Must have status \"PUBLISHED\" for cohorts</li> <li>Supports \"DRAFT\" status for work in progress</li> </ul>"},{"location":"LLM-DOCS/SYLLABUS/#version-management_1","title":"Version Management","text":"<ul> <li>Versions are auto-incremented</li> <li>Previous versions are preserved</li> <li>Change logs track modifications</li> <li>Integrity checks validate content</li> </ul> <p>This guide covers the complete flow for creating syllabi with all dependencies. Follow the steps in order for successful syllabus creation and versioning.</p>"},{"location":"LLM-DOCS/Student_Activity/","title":"Student Activity API Documentation","text":"<p>Complete guide to the Student Activity API endpoints, including activity tracking, querying, and reporting capabilities.</p>"},{"location":"LLM-DOCS/Student_Activity/#overview","title":"Overview","text":"<p>The Student Activity API provides comprehensive activity tracking and monitoring capabilities for students, supporting: - \u2705 Activity creation and logging - \u2705 Activity querying with advanced filtering - \u2705 Cohort-based activity tracking - \u2705 Classroom activity management - \u2705 Activity reporting and analytics - \u2705 BigQuery-based activity storage (V2)</p> <p>Base Endpoints: - V1: <code>/v1/activity/</code> - V2: <code>/v2/activity/</code> - V3: <code>/v3/activity/</code></p>"},{"location":"LLM-DOCS/Student_Activity/#authentication-headers","title":"Authentication &amp; Headers","text":"<p>All requests require:</p> <pre><code>Authorization: Token {your-token}\n</code></pre> <p>For academy-scoped endpoints, also include:</p> <pre><code>Academy: {academy_id}\n</code></pre>"},{"location":"LLM-DOCS/Student_Activity/#activity-types","title":"Activity Types","text":"<p>The system supports the following activity types (slugs):</p> Slug Description <code>breathecode_login</code> Every time a user logs in <code>online_platform_registration</code> First day using breathecode <code>public_event_attendance</code> Attendance on an eventbrite event <code>classroom_attendance</code> When the student attends class <code>classroom_unattendance</code> When the student misses class <code>lesson_opened</code> When a lesson is opened on the platform <code>office_attendance</code> When the office raspberry pi detects the student <code>nps_survey_answered</code> When an NPS survey is answered by the student <code>exercise_success</code> When student successfully tests exercise <code>registration</code> When student successfully joins breathecode <code>educational_status_change</code> Student cohort changes like: starts, drop, postpone, etc <code>educational_note</code> Notes that can be added by teachers, TA's or anyone involved in the student education <code>career_note</code> Notes related to the student career <p>Public Activities (not tied to a specific academy): - <code>breathecode_login</code> - <code>online_platform_registration</code></p>"},{"location":"LLM-DOCS/Student_Activity/#v1-endpoints","title":"V1 Endpoints","text":""},{"location":"LLM-DOCS/Student_Activity/#get-list-activity-types","title":"GET - List Activity Types","text":"<p>Endpoint: <code>GET /v1/activity/type/</code></p> <p>Permissions: <code>read_activity</code></p> <p>Description: Get all available activity types</p> <p>Response: <pre><code>[\n  {\n    \"slug\": \"breathecode_login\",\n    \"description\": \"Every time it logs in\"\n  },\n  {\n    \"slug\": \"online_platform_registration\",\n    \"description\": \"First day using breathecode\"\n  }\n]\n</code></pre></p>"},{"location":"LLM-DOCS/Student_Activity/#get-get-single-activity-type","title":"GET - Get Single Activity Type","text":"<p>Endpoint: <code>GET /v1/activity/type/{activity_slug}</code></p> <p>Parameters: - <code>activity_slug</code> - The slug of the activity type</p> <p>Permissions: <code>read_activity</code></p> <p>Example: <pre><code>GET /v1/activity/type/breathecode_login\n</code></pre></p> <p>Response: <pre><code>{\n  \"slug\": \"breathecode_login\",\n  \"description\": \"Every time it logs in\"\n}\n</code></pre></p>"},{"location":"LLM-DOCS/Student_Activity/#get-get-my-activities","title":"GET - Get My Activities","text":"<p>Endpoint: <code>GET /v1/activity/me</code></p> <p>Permissions: <code>read_activity</code></p> <p>Query Parameters: - <code>slug={activity_slug}</code> - Filter by activity type slug - <code>cohort={cohort_slug}</code> - Filter by cohort slug - <code>user_id={user_id}</code> - Filter by user ID (integer) - <code>email={email}</code> - Filter by user email</p> <p>Description: Get activities for the authenticated user. Returns activities from both academy-specific and public (academy_id=0) sources.</p> <p>Example: <pre><code>GET /v1/activity/me?slug=classroom_attendance&amp;cohort=web-dev-pt-01\n</code></pre></p> <p>Response: <pre><code>[\n  {\n    \"slug\": \"classroom_attendance\",\n    \"user_id\": 123,\n    \"email\": \"student@example.com\",\n    \"cohort\": \"web-dev-pt-01\",\n    \"data\": {\n      \"attendance_type\": \"present\"\n    },\n    \"created_at\": \"2024-01-15T10:30:00Z\",\n    \"academy_id\": 1\n  }\n]\n</code></pre></p>"},{"location":"LLM-DOCS/Student_Activity/#post-create-activity","title":"POST - Create Activity","text":"<p>Endpoint: <code>POST /v1/activity/me</code></p> <p>Permissions: <code>crud_activity</code></p> <p>Description: Create a new activity for the authenticated user</p> <p>Request Body: <pre><code>{\n  \"slug\": \"classroom_attendance\",\n  \"user_agent\": \"Mozilla/5.0...\",\n  \"cohort\": \"web-dev-pt-01\",\n  \"data\": \"{\\\"attendance_type\\\": \\\"present\\\"}\"\n}\n</code></pre></p> <p>Required Fields: - <code>slug</code> - Activity type slug - <code>user_agent</code> - User agent string</p> <p>Optional Fields: - <code>cohort</code> - Cohort slug (required for most activity types except public ones) - <code>data</code> - JSON string with additional activity data (required for most activity types) - <code>day</code> - Day number</p> <p>Response: <pre><code>{\n  \"slug\": \"classroom_attendance\",\n  \"user_id\": 123,\n  \"email\": \"student@example.com\",\n  \"cohort\": \"web-dev-pt-01\",\n  \"data\": {\n    \"attendance_type\": \"present\"\n  },\n  \"created_at\": \"2024-01-15T10:30:00Z\",\n  \"academy_id\": 1\n}\n</code></pre></p>"},{"location":"LLM-DOCS/Student_Activity/#get-get-cohort-activities","title":"GET - Get Cohort Activities","text":"<p>Endpoint: <code>GET /v1/activity/cohort/{cohort_id}</code></p> <p>Parameters: - <code>cohort_id</code> - Cohort ID or slug</p> <p>Permissions: <code>read_activity</code></p> <p>Query Parameters: - <code>slug={activity_slug}</code> - Filter by activity type slug (comma-separated for multiple) - <code>limit={number}</code> - Limit results - <code>offset={number}</code> - Offset for pagination</p> <p>Description: Get all activities for a specific cohort</p> <p>Example: <pre><code>GET /v1/activity/cohort/web-dev-pt-01?slug=classroom_attendance,classroom_unattendance&amp;limit=50\n</code></pre></p> <p>Response: Array of activity objects (paginated if limit/offset provided)</p>"},{"location":"LLM-DOCS/Student_Activity/#get-get-classroom-activities","title":"GET - Get Classroom Activities","text":"<p>Endpoint: <code>GET /v1/activity/academy/cohort/{cohort_id}</code></p> <p>Parameters: - <code>cohort_id</code> - Cohort ID or slug</p> <p>Permissions: <code>classroom_activity</code></p> <p>Query Parameters: - <code>slug={activity_slug}</code> - Filter by activity type slug - <code>user_id={user_id}</code> - Filter by user ID - <code>email={email}</code> - Filter by user email - <code>limit={number}</code> - Limit results - <code>offset={number}</code> - Offset for pagination</p> <p>Description: Get activities for a specific cohort (for teachers/assistants)</p> <p>Example: <pre><code>GET /v1/activity/academy/cohort/web-dev-pt-01?slug=classroom_attendance\n</code></pre></p> <p>Response: Array of activity objects (paginated)</p>"},{"location":"LLM-DOCS/Student_Activity/#post-create-classroom-activities-bulk","title":"POST - Create Classroom Activities (Bulk)","text":"<p>Endpoint: <code>POST /v1/activity/academy/cohort/{cohort_id}</code></p> <p>Parameters: - <code>cohort_id</code> - Cohort ID or slug</p> <p>Permissions: <code>classroom_activity</code></p> <p>Description: Create activities for multiple students in a cohort. Only teachers or assistants from the cohort can use this endpoint.</p> <p>Request Body (Single Activity): <pre><code>{\n  \"user_id\": 123,\n  \"slug\": \"classroom_attendance\",\n  \"user_agent\": \"Mozilla/5.0...\",\n  \"data\": \"{\\\"attendance_type\\\": \\\"present\\\"}\"\n}\n</code></pre></p> <p>Request Body (Multiple Activities): <pre><code>[\n  {\n    \"user_id\": 123,\n    \"slug\": \"classroom_attendance\",\n    \"user_agent\": \"Mozilla/5.0...\",\n    \"data\": \"{\\\"attendance_type\\\": \\\"present\\\"}\"\n  },\n  {\n    \"user_id\": 456,\n    \"slug\": \"classroom_unattendance\",\n    \"user_agent\": \"Mozilla/5.0...\",\n    \"data\": \"{\\\"reason\\\": \\\"sick\\\"}\"\n  }\n]\n</code></pre></p> <p>Response: Array of created activity objects</p>"},{"location":"LLM-DOCS/Student_Activity/#get-get-student-activities","title":"GET - Get Student Activities","text":"<p>Endpoint: <code>GET /v1/activity/academy/student/{student_id}</code></p> <p>Parameters: - <code>student_id</code> - Student user ID</p> <p>Permissions: <code>read_activity</code></p> <p>Query Parameters: - <code>slug={activity_slug}</code> - Filter by activity type slug - <code>email={email}</code> - Filter by user email (alternative to student_id) - <code>limit={number}</code> - Limit results - <code>offset={number}</code> - Offset for pagination</p> <p>Description: Get all activities for a specific student within the academy</p> <p>Example: <pre><code>GET /v1/activity/academy/student/123?slug=lesson_opened&amp;limit=100\n</code></pre></p> <p>Response: Array of activity objects (paginated)</p>"},{"location":"LLM-DOCS/Student_Activity/#post-create-student-activities-bulk","title":"POST - Create Student Activities (Bulk)","text":"<p>Endpoint: <code>POST /v1/activity/academy/student/{student_id}</code></p> <p>Parameters: - <code>student_id</code> - Student user ID (can be omitted if provided in body)</p> <p>Permissions: <code>crud_activity</code></p> <p>Description: Create activities for one or more students. Each activity must include a cohort slug.</p> <p>Request Body (Single Activity): <pre><code>{\n  \"user_id\": 123,\n  \"slug\": \"lesson_opened\",\n  \"user_agent\": \"Mozilla/5.0...\",\n  \"cohort\": \"web-dev-pt-01\",\n  \"data\": \"{\\\"lesson_slug\\\": \\\"javascript-basics\\\"}\"\n}\n</code></pre></p> <p>Request Body (Multiple Activities): <pre><code>[\n  {\n    \"user_id\": 123,\n    \"slug\": \"lesson_opened\",\n    \"user_agent\": \"Mozilla/5.0...\",\n    \"cohort\": \"web-dev-pt-01\",\n    \"data\": \"{\\\"lesson_slug\\\": \\\"javascript-basics\\\"}\"\n  },\n  {\n    \"user_id\": 456,\n    \"slug\": \"exercise_success\",\n    \"user_agent\": \"Mozilla/5.0...\",\n    \"cohort\": \"web-dev-pt-01\",\n    \"data\": \"{\\\"exercise_slug\\\": \\\"hello-world\\\"}\"\n  }\n]\n</code></pre></p> <p>Important Notes: - Each activity must include a <code>cohort</code> field (slug, not numeric ID) - The <code>user_id</code> in the body must match a student in the specified cohort - The cohort slug must exist in the academy</p> <p>Response: Array of created activity objects</p>"},{"location":"LLM-DOCS/Student_Activity/#v2-endpoints-bigquery-based","title":"V2 Endpoints (BigQuery-based)","text":"<p>V2 endpoints use BigQuery for storage and provide more advanced querying capabilities.</p>"},{"location":"LLM-DOCS/Student_Activity/#get-get-my-activities-v2","title":"GET - Get My Activities (V2)","text":"<p>Endpoint: <code>GET /v2/activity/me/activity</code></p> <p>Permissions: None (uses authenticated user)</p> <p>Query Parameters: - <code>kind={activity_kind}</code> - Filter by activity kind - <code>cohort={cohort_slug_or_id}</code> - Filter by cohort (slug or ID) - <code>limit={number}</code> - Limit results (default: 100) - <code>page={number}</code> - Page number (default: 1)</p> <p>Description: Get activities for the authenticated user from BigQuery</p> <p>Example: <pre><code>GET /v2/activity/me/activity?kind=login&amp;cohort=web-dev-pt-01&amp;limit=50&amp;page=1\n</code></pre></p> <p>Response: <pre><code>[\n  {\n    \"id\": \"activity-123\",\n    \"user_id\": 123,\n    \"kind\": \"login\",\n    \"related\": {\n      \"type\": \"auth.User\",\n      \"id\": 123,\n      \"slug\": null\n    },\n    \"meta\": {\n      \"email\": \"student@example.com\",\n      \"username\": \"student\",\n      \"cohort\": \"web-dev-pt-01\"\n    },\n    \"timestamp\": \"2024-01-15T10:30:00Z\"\n  }\n]\n</code></pre></p>"},{"location":"LLM-DOCS/Student_Activity/#get-get-single-activity-v2","title":"GET - Get Single Activity (V2)","text":"<p>Endpoint: <code>GET /v2/activity/me/activity/{activity_id}</code></p> <p>Parameters: - <code>activity_id</code> - Activity ID</p> <p>Permissions: None (uses authenticated user)</p> <p>Description: Get a specific activity by ID for the authenticated user</p> <p>Example: <pre><code>GET /v2/activity/me/activity/activity-123\n</code></pre></p> <p>Response: <pre><code>{\n  \"id\": \"activity-123\",\n  \"user_id\": 123,\n  \"kind\": \"login\",\n  \"related\": {\n    \"type\": \"auth.User\",\n    \"id\": 123,\n    \"slug\": null\n  },\n  \"meta\": {\n    \"email\": \"student@example.com\",\n    \"username\": \"student\"\n  },\n  \"timestamp\": \"2024-01-15T10:30:00Z\"\n}\n</code></pre></p>"},{"location":"LLM-DOCS/Student_Activity/#get-get-academy-activities-v2","title":"GET - Get Academy Activities (V2)","text":"<p>Endpoint: <code>GET /v2/activity/academy/activity</code></p> <p>Permissions: <code>read_activity</code></p> <p>Query Parameters: - <code>user_id={user_id}</code> - Filter by user ID (defaults to authenticated user if not provided) - <code>kind={activity_kind}</code> - Filter by activity kind - <code>cohort_id={cohort_id_or_slug}</code> - Filter by cohort (ID or slug) - <code>date_start={timestamp}</code> - Filter by start date (ISO timestamp) - <code>date_end={timestamp}</code> - Filter by end date (ISO timestamp) - <code>limit={number}</code> - Limit results (default: 100) - <code>page={number}</code> - Page number (default: 1)</p> <p>Description: Get activities for a specific user within an academy from BigQuery</p> <p>Example: <pre><code>GET /v2/activity/academy/activity?user_id=123&amp;kind=login&amp;date_start=2024-01-01T00:00:00Z&amp;date_end=2024-01-31T23:59:59Z\n</code></pre></p> <p>Response: Array of activity objects</p>"},{"location":"LLM-DOCS/Student_Activity/#get-get-single-academy-activity-v2","title":"GET - Get Single Academy Activity (V2)","text":"<p>Endpoint: <code>GET /v2/activity/academy/activity/{activity_id}</code></p> <p>Parameters: - <code>activity_id</code> - Activity ID</p> <p>Permissions: <code>read_activity</code></p> <p>Query Parameters: - <code>user_id={user_id}</code> - Filter by user ID (defaults to authenticated user)</p> <p>Description: Get a specific activity by ID within an academy</p> <p>Example: <pre><code>GET /v2/activity/academy/activity/activity-123?user_id=123\n</code></pre></p> <p>Response: Single activity object</p>"},{"location":"LLM-DOCS/Student_Activity/#get-activity-report-v2","title":"GET - Activity Report (V2)","text":"<p>Endpoint: <code>GET /v2/activity/report</code></p> <p>Permissions: <code>read_activity</code></p> <p>Description: Advanced reporting endpoint with aggregation capabilities</p> <p>Query Parameters: - <code>query={json_string}</code> - JSON query object with filters and grouping functions - <code>fields={comma_separated}</code> - Fields to select - <code>by={comma_separated}</code> - Fields to group by - <code>order={comma_separated}</code> - Fields to order by - <code>limit={number}</code> - Limit results</p> <p>Query Object Structure: <pre><code>{\n  \"filter\": {\n    \"user_id\": 123,\n    \"kind\": \"login\",\n    \"meta.academy\": 1\n  },\n  \"grouping_function\": {\n    \"count\": [\"kind\"],\n    \"sum\": [\"some_numeric_field\"],\n    \"avg\": [\"some_numeric_field\"]\n  }\n}\n</code></pre></p> <p>Example - Count activities by kind: <pre><code>GET /v2/activity/report?by=kind&amp;fields=kind&amp;query={\"filter\":{\"meta.academy\":1}}\n</code></pre></p> <p>Example - Aggregated report: <pre><code>GET /v2/activity/report?query={\"filter\":{\"meta.academy\":1},\"grouping_function\":{\"count\":[\"kind\"],\"sum\":[\"points\"]}}\n</code></pre></p> <p>Response: Array of report results (structure depends on query)</p>"},{"location":"LLM-DOCS/Student_Activity/#how-the-v2activityreport-endpoint-works","title":"How the <code>/v2/activity/report</code> Endpoint Works","text":"<p>The report endpoint is a powerful BigQuery-based analytics tool that allows you to build complex SQL queries through a simple API interface. Here's a detailed breakdown:</p>"},{"location":"LLM-DOCS/Student_Activity/#endpoint-processing-flow","title":"Endpoint Processing Flow","text":"<ol> <li>Query Parameter Parsing: The <code>query</code> parameter is URL-encoded JSON that gets parsed</li> <li>BigQuery Builder: Creates a BigQuery query builder instance for the <code>activity</code> table</li> <li>Field Selection: Uses <code>fields</code> parameter to select specific columns</li> <li>Grouping: Uses <code>by</code> parameter to group results</li> <li>Filtering: Applies filters from the <code>query.filter</code> object</li> <li>Aggregation: Applies aggregation functions (count, sum, avg) from <code>query.grouping_function</code></li> <li>SQL Generation: Builds and executes a BigQuery SQL query</li> <li>Result Formatting: Returns results as an array of dictionaries</li> </ol>"},{"location":"LLM-DOCS/Student_Activity/#example-breakdown","title":"Example Breakdown","text":"<p>Let's analyze your example URL:</p> <pre><code>/v2/activity/report?query={\"filter\":{\"user_id\":19487,\"meta.cohort\":1521},\"grouping_function\":{\"count\":[\"kind\"],\"avg\":[\"meta.score\"]}}&amp;by=kind&amp;fields=kind\n</code></pre> <p>URL Decoded Query Parameter: <pre><code>{\n  \"filter\": {\n    \"user_id\": 19487,\n    \"meta.cohort\": 1521\n  },\n  \"grouping_function\": {\n    \"count\": [\"kind\"],\n    \"avg\": [\"meta.score\"]\n  }\n}\n</code></pre></p> <p>Additional Parameters: - <code>by=kind</code> - Group results by the <code>kind</code> field - <code>fields=kind</code> - Select only the <code>kind</code> field (plus aggregated fields)</p>"},{"location":"LLM-DOCS/Student_Activity/#generated-sql-query","title":"Generated SQL Query","text":"<p>The endpoint generates this BigQuery SQL:</p> <pre><code>SELECT \n  kind,\n  COUNT(kind) AS count__kind,\n  AVG(meta.score) AS avg__meta__score\nFROM `{project_id}.{dataset}.activity`\nWHERE \n  user_id = @x__user_id AND \n  meta.cohort = @x__meta__cohort\nGROUP BY kind\nORDER BY kind DESC\n</code></pre> <p>Query Parameters: - <code>@x__user_id</code> = 19487 (INT64) - <code>@x__meta__cohort</code> = 1521 (INT64)</p>"},{"location":"LLM-DOCS/Student_Activity/#response-structure","title":"Response Structure","text":"<p>The response will be an array of objects, one per <code>kind</code> value:</p> <pre><code>[\n  {\n    \"kind\": \"login\",\n    \"count__kind\": 45,\n    \"avg__meta__score\": 85.5\n  },\n  {\n    \"kind\": \"lesson_opened\",\n    \"count__kind\": 120,\n    \"avg__meta__score\": 92.3\n  },\n  {\n    \"kind\": \"exercise_success\",\n    \"count__kind\": 78,\n    \"avg__meta__score\": 88.7\n  }\n]\n</code></pre>"},{"location":"LLM-DOCS/Student_Activity/#parameter-reference","title":"Parameter Reference","text":""},{"location":"LLM-DOCS/Student_Activity/#query-object-query-parameter","title":"Query Object (<code>query</code> parameter)","text":"<p>Filter Object: <pre><code>{\n  \"filter\": {\n    \"user_id\": 19487,              // Exact match\n    \"meta.cohort\": 1521,           // Nested field access with dot notation\n    \"kind\": \"login\",               // String match\n    \"timestamp.gte\": \"2024-01-01\" // Greater than or equal (use .gte, .gt, .lte, .lt)\n  }\n}\n</code></pre></p> <p>Filter Operators: - <code>.gte</code> - Greater than or equal (<code>&gt;=</code>) - <code>.gt</code> - Greater than (<code>&gt;</code>) - <code>.lte</code> - Less than or equal (<code>&lt;=</code>) - <code>.lt</code> - Less than (<code>&lt;</code>) - <code>.like</code> - LIKE pattern matching - No suffix - Exact match (<code>=</code>)</p> <p>Grouping Functions: <pre><code>{\n  \"grouping_function\": {\n    \"count\": [\"kind\", \"user_id\"],      // Count occurrences\n    \"sum\": [\"meta.points\", \"meta.score\"], // Sum numeric values\n    \"avg\": [\"meta.score\", \"meta.time\"]    // Average numeric values\n  }\n}\n</code></pre></p>"},{"location":"LLM-DOCS/Student_Activity/#url-query-parameters","title":"URL Query Parameters","text":"<ul> <li><code>fields</code>: Comma-separated list of fields to select</li> <li>Example: <code>fields=kind,user_id</code></li> <li> <p>If not provided, all fields are selected (plus aggregated fields)</p> </li> <li> <p><code>by</code>: Comma-separated list of fields to group by</p> </li> <li>Example: <code>by=kind,user_id</code></li> <li> <p>Required when using aggregation functions</p> </li> <li> <p><code>order</code>: Comma-separated list of fields to order by</p> </li> <li>Example: <code>order=kind,timestamp</code></li> <li> <p>Default: DESC order</p> </li> <li> <p><code>limit</code>: Maximum number of results</p> </li> <li>Example: <code>limit=100</code></li> </ul>"},{"location":"LLM-DOCS/Student_Activity/#common-use-cases","title":"Common Use Cases","text":""},{"location":"LLM-DOCS/Student_Activity/#1-count-activities-by-kind","title":"1. Count Activities by Kind","text":"<p>Query: <pre><code>GET /v2/activity/report?by=kind&amp;fields=kind&amp;query={\"filter\":{\"meta.academy\":1},\"grouping_function\":{\"count\":[\"kind\"]}}\n</code></pre></p> <p>SQL Generated: <pre><code>SELECT kind, COUNT(kind) AS count__kind\nFROM `activity`\nWHERE meta.academy = @x__meta__academy\nGROUP BY kind\n</code></pre></p>"},{"location":"LLM-DOCS/Student_Activity/#2-average-score-by-user","title":"2. Average Score by User","text":"<p>Query: <pre><code>GET /v2/activity/report?by=user_id&amp;fields=user_id&amp;query={\"filter\":{\"kind\":\"exercise_success\"},\"grouping_function\":{\"avg\":[\"meta.score\"]}}\n</code></pre></p> <p>SQL Generated: <pre><code>SELECT user_id, AVG(meta.score) AS avg__meta__score\nFROM `activity`\nWHERE kind = @x__kind\nGROUP BY user_id\n</code></pre></p>"},{"location":"LLM-DOCS/Student_Activity/#3-multiple-aggregations","title":"3. Multiple Aggregations","text":"<p>Query: <pre><code>GET /v2/activity/report?by=kind&amp;fields=kind&amp;query={\"filter\":{\"meta.academy\":1},\"grouping_function\":{\"count\":[\"kind\"],\"sum\":[\"meta.points\"],\"avg\":[\"meta.score\"]}}\n</code></pre></p> <p>SQL Generated: <pre><code>SELECT \n  kind,\n  COUNT(kind) AS count__kind,\n  SUM(meta.points) AS sum__meta__points,\n  AVG(meta.score) AS avg__meta__score\nFROM `activity`\nWHERE meta.academy = @x__meta__academy\nGROUP BY kind\n</code></pre></p>"},{"location":"LLM-DOCS/Student_Activity/#4-date-range-filtering","title":"4. Date Range Filtering","text":"<p>Query: <pre><code>GET /v2/activity/report?query={\"filter\":{\"timestamp.gte\":\"2024-01-01\",\"timestamp.lte\":\"2024-01-31\",\"meta.academy\":1},\"grouping_function\":{\"count\":[\"kind\"]}}&amp;by=kind\n</code></pre></p> <p>SQL Generated: <pre><code>SELECT kind, COUNT(kind) AS count__kind\nFROM `activity`\nWHERE \n  timestamp &gt;= @x__timestamp AND\n  timestamp &lt;= @x__timestamp_2 AND\n  meta.academy = @x__meta__academy\nGROUP BY kind\n</code></pre></p>"},{"location":"LLM-DOCS/Student_Activity/#important-notes","title":"Important Notes","text":"<ol> <li>Field Naming: Aggregated fields use the format <code>{operation}__{field}</code> where dots are replaced with double underscores</li> <li><code>COUNT(kind)</code> \u2192 <code>count__kind</code></li> <li> <p><code>AVG(meta.score)</code> \u2192 <code>avg__meta__score</code></p> </li> <li> <p>Nested Fields: Use dot notation for nested fields in <code>meta</code> object</p> </li> <li><code>meta.cohort</code> - Access cohort field</li> <li> <p><code>meta.score</code> - Access score field</p> </li> <li> <p>Grouping Requirement: When using aggregation functions, you must include the grouped fields in the <code>by</code> parameter</p> </li> <li> <p>Field Selection: If you specify <code>fields</code>, only those fields plus aggregated fields are returned. If omitted, all fields plus aggregated fields are returned.</p> </li> <li> <p>Type Safety: BigQuery automatically infers parameter types (INT64, STRING, FLOAT64, etc.) from the filter values</p> </li> <li> <p>Performance: This endpoint queries BigQuery directly, so it's optimized for large datasets and analytics workloads</p> </li> </ol>"},{"location":"LLM-DOCS/Student_Activity/#activity-payload-structure","title":"Activity Payload Structure","text":""},{"location":"LLM-DOCS/Student_Activity/#v1-activity-payload","title":"V1 Activity Payload","text":"<p>Required Fields: <pre><code>{\n  \"slug\": \"classroom_attendance\",\n  \"user_agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36\"\n}\n</code></pre></p> <p>Optional Fields: <pre><code>{\n  \"slug\": \"lesson_opened\",\n  \"user_agent\": \"Mozilla/5.0...\",\n  \"cohort\": \"web-dev-pt-01\",           // Required for most activity types\n  \"data\": \"{\\\"lesson_slug\\\": \\\"js-101\\\"}\",  // JSON string, required for most activity types\n  \"day\": 5                              // Day number\n}\n</code></pre></p> <p>Note: The <code>data</code> field must be a valid JSON string, not a JSON object.</p>"},{"location":"LLM-DOCS/Student_Activity/#v2-activity-response-structure","title":"V2 Activity Response Structure","text":"<pre><code>{\n  \"id\": \"activity-123\",\n  \"user_id\": 123,\n  \"kind\": \"login\",\n  \"related\": {\n    \"type\": \"auth.User\",\n    \"id\": 123,\n    \"slug\": null\n  },\n  \"meta\": {\n    \"email\": \"student@example.com\",\n    \"username\": \"student\",\n    \"cohort\": \"web-dev-pt-01\",\n    \"academy\": 1\n  },\n  \"timestamp\": \"2024-01-15T10:30:00Z\"\n}\n</code></pre>"},{"location":"LLM-DOCS/Student_Activity/#important-flows-and-use-cases","title":"Important Flows and Use Cases","text":""},{"location":"LLM-DOCS/Student_Activity/#1-student-login-tracking","title":"1. Student Login Tracking","text":"<p>Use Case: Track when a student logs into the platform</p> <p>Endpoint: <code>POST /v1/activity/me</code></p> <p>Payload: <pre><code>{\n  \"slug\": \"breathecode_login\",\n  \"user_agent\": \"Mozilla/5.0...\"\n}\n</code></pre></p> <p>Note: This is a public activity (no cohort required, academy_id=0)</p>"},{"location":"LLM-DOCS/Student_Activity/#2-classroom-attendance-tracking","title":"2. Classroom Attendance Tracking","text":"<p>Use Case: Teacher marks attendance for multiple students</p> <p>Endpoint: <code>POST /v1/activity/academy/cohort/{cohort_id}</code></p> <p>Payload: <pre><code>[\n  {\n    \"user_id\": 123,\n    \"slug\": \"classroom_attendance\",\n    \"user_agent\": \"Mozilla/5.0...\",\n    \"data\": \"{\\\"attendance_type\\\": \\\"present\\\", \\\"session_id\\\": \\\"session-123\\\"}\"\n  },\n  {\n    \"user_id\": 456,\n    \"slug\": \"classroom_unattendance\",\n    \"user_agent\": \"Mozilla/5.0...\",\n    \"data\": \"{\\\"reason\\\": \\\"sick\\\", \\\"session_id\\\": \\\"session-123\\\"}\"\n  }\n]\n</code></pre></p> <p>Requirements: - User must be a TEACHER or ASSISTANT in the cohort - Each student must exist in the cohort</p>"},{"location":"LLM-DOCS/Student_Activity/#3-lesson-progress-tracking","title":"3. Lesson Progress Tracking","text":"<p>Use Case: Track when a student opens a lesson</p> <p>Endpoint: <code>POST /v1/activity/me</code></p> <p>Payload: <pre><code>{\n  \"slug\": \"lesson_opened\",\n  \"user_agent\": \"Mozilla/5.0...\",\n  \"cohort\": \"web-dev-pt-01\",\n  \"data\": \"{\\\"lesson_slug\\\": \\\"javascript-basics\\\", \\\"module_slug\\\": \\\"js-101\\\"}\"\n}\n</code></pre></p>"},{"location":"LLM-DOCS/Student_Activity/#4-exercise-completion-tracking","title":"4. Exercise Completion Tracking","text":"<p>Use Case: Track when a student successfully completes an exercise</p> <p>Endpoint: <code>POST /v1/activity/me</code></p> <p>Payload: <pre><code>{\n  \"slug\": \"exercise_success\",\n  \"user_agent\": \"Mozilla/5.0...\",\n  \"cohort\": \"web-dev-pt-01\",\n  \"data\": \"{\\\"exercise_slug\\\": \\\"hello-world\\\", \\\"attempts\\\": 3, \\\"time_spent\\\": 1200}\"\n}\n</code></pre></p>"},{"location":"LLM-DOCS/Student_Activity/#5-educational-notes","title":"5. Educational Notes","text":"<p>Use Case: Add educational notes about a student</p> <p>Endpoint: <code>POST /v1/activity/academy/student/{student_id}</code></p> <p>Payload: <pre><code>{\n  \"user_id\": 123,\n  \"slug\": \"educational_note\",\n  \"user_agent\": \"Mozilla/5.0...\",\n  \"cohort\": \"web-dev-pt-01\",\n  \"data\": \"{\\\"note\\\": \\\"Student showing great progress\\\", \\\"author_id\\\": 456, \\\"visibility\\\": \\\"private\\\"}\"\n}\n</code></pre></p>"},{"location":"LLM-DOCS/Student_Activity/#6-query-student-activities","title":"6. Query Student Activities","text":"<p>Use Case: Get all activities for a student in a specific cohort</p> <p>Endpoint: <code>GET /v1/activity/academy/student/{student_id}</code></p> <p>Query: <pre><code>GET /v1/activity/academy/student/123?slug=lesson_opened,exercise_success&amp;limit=100\n</code></pre></p>"},{"location":"LLM-DOCS/Student_Activity/#7-cohort-activity-analysis","title":"7. Cohort Activity Analysis","text":"<p>Use Case: Get all attendance activities for a cohort</p> <p>Endpoint: <code>GET /v1/activity/academy/cohort/{cohort_id}</code></p> <p>Query: <pre><code>GET /v1/activity/academy/cohort/web-dev-pt-01?slug=classroom_attendance,classroom_unattendance\n</code></pre></p>"},{"location":"LLM-DOCS/Student_Activity/#8-advanced-reporting-v2","title":"8. Advanced Reporting (V2)","text":"<p>Use Case: Generate activity statistics by kind</p> <p>Endpoint: <code>GET /v2/activity/report</code></p> <p>Query: <pre><code>GET /v2/activity/report?by=kind&amp;fields=kind&amp;query={\"filter\":{\"meta.academy\":1},\"grouping_function\":{\"count\":[\"kind\"]}}\n</code></pre></p> <p>Response: <pre><code>[\n  {\n    \"kind\": \"login\",\n    \"kind__count\": 150\n  },\n  {\n    \"kind\": \"lesson_opened\",\n    \"kind__count\": 320\n  }\n]\n</code></pre></p>"},{"location":"LLM-DOCS/Student_Activity/#9-date-range-activity-query-v2","title":"9. Date Range Activity Query (V2)","text":"<p>Use Case: Get activities for a user within a date range</p> <p>Endpoint: <code>GET /v2/activity/academy/activity</code></p> <p>Query: <pre><code>GET /v2/activity/academy/activity?user_id=123&amp;date_start=2024-01-01T00:00:00Z&amp;date_end=2024-01-31T23:59:59Z&amp;kind=lesson_opened\n</code></pre></p>"},{"location":"LLM-DOCS/Student_Activity/#field-validation-rules","title":"Field Validation Rules","text":""},{"location":"LLM-DOCS/Student_Activity/#activity-type-requirements","title":"Activity Type Requirements","text":"<p>Activities that DON'T require <code>cohort</code>: - <code>breathecode_login</code> - <code>online_platform_registration</code></p> <p>Activities that DON'T require <code>data</code>: - <code>breathecode_login</code> - <code>online_platform_registration</code></p> <p>All other activities require both <code>cohort</code> and <code>data</code> fields.</p>"},{"location":"LLM-DOCS/Student_Activity/#data-field-validation","title":"Data Field Validation","text":"<ul> <li>The <code>data</code> field must be a valid JSON string</li> <li>If <code>data</code> is provided, it must be parseable JSON</li> <li>Empty or null <code>data</code> is allowed only for public activities</li> </ul>"},{"location":"LLM-DOCS/Student_Activity/#cohort-validation","title":"Cohort Validation","text":"<ul> <li>Cohort can be provided as a slug or numeric ID</li> <li>For POST requests in student endpoints, cohort must be a slug (not numeric ID)</li> <li>Cohort must exist in the specified academy</li> </ul>"},{"location":"LLM-DOCS/Student_Activity/#error-responses","title":"Error Responses","text":""},{"location":"LLM-DOCS/Student_Activity/#common-error-codes","title":"Common Error Codes","text":"Error Slug Description Status Code <code>activity-not-found</code> Activity type not found 400 <code>cohort-not-found</code> Cohort not found 400 <code>cohort-not-exists</code> Cohort doesn't exist in academy 400 <code>user-not-exists</code> User not found 400 <code>bad-user-id</code> user_id is not an integer 400 <code>missing-cohort</code> Activity requires a cohort 400 <code>missing-data</code> Activity requires a data field 400 <code>data-is-not-a-json</code> Data field is not valid JSON 400 <code>not-found-in-cohort</code> Student not found in cohort 400 <code>student-no-cohort</code> Student doesn't belong to any cohort in academy 400"},{"location":"LLM-DOCS/Student_Activity/#example-error-response","title":"Example Error Response","text":"<pre><code>{\n  \"detail\": \"Cohort not found\",\n  \"status_code\": 400,\n  \"slug\": \"cohort-not-found\"\n}\n</code></pre>"},{"location":"LLM-DOCS/Student_Activity/#best-practices","title":"Best Practices","text":"<ol> <li>Always include user_agent: Required for all activity creation</li> <li>Validate data JSON: Ensure <code>data</code> field is valid JSON string before sending</li> <li>Use appropriate activity types: Choose the correct slug for the activity</li> <li>Bulk operations: Use bulk endpoints when creating multiple activities</li> <li>Pagination: Always use limit/offset for large result sets</li> <li>V2 for analytics: Use V2 endpoints for advanced reporting and analytics</li> <li>Cohort validation: Verify cohort exists before creating cohort-specific activities</li> <li>Error handling: Check for specific error slugs to handle validation errors appropriately</li> </ol>"},{"location":"LLM-DOCS/Student_Activity/#v3-endpoints-bigquery-based-with-enhanced-filtering","title":"V3 Endpoints (BigQuery-based with Enhanced Filtering)","text":"<p>V3 endpoints use BigQuery for storage and provide enhanced filtering capabilities, including support for multiple activity kinds in a single query.</p>"},{"location":"LLM-DOCS/Student_Activity/#get-list-activity-kinds","title":"GET - List Activity Kinds","text":"<p>Endpoint: <code>GET /v3/activity/kinds</code></p> <p>Permissions: <code>read_activity</code></p> <p>Description: Returns all available activity kinds from ALLOWED_TYPES, grouped by related_type. This endpoint is useful for frontend filter configuration.</p> <p>Response:</p> <pre><code>[\n  {\n    \"related_type\": \"auth.User\",\n    \"kinds\": [\"login\"]\n  },\n  {\n    \"related_type\": \"assignments.Task\",\n    \"kinds\": [\n      \"open_syllabus_module\",\n      \"read_assignment\",\n      \"assignment_review_status_updated\",\n      \"assignment_status_updated\"\n    ]\n  },\n  {\n    \"related_type\": \"events.EventCheckin\",\n    \"kinds\": [\n      \"event_checkin_created\",\n      \"event_checkin_assisted\"\n    ]\n  },\n  {\n    \"related_type\": \"feedback.Answer\",\n    \"kinds\": [\"nps_answered\"]\n  },\n  {\n    \"related_type\": \"admissions.CohortUser\",\n    \"kinds\": [\"joined_cohort\"]\n  },\n  {\n    \"related_type\": \"payments.Bag\",\n    \"kinds\": [\"bag_created\"]\n  },\n  {\n    \"related_type\": \"payments.Subscription\",\n    \"kinds\": [\"checkout_completed\"]\n  },\n  {\n    \"related_type\": \"payments.PlanFinancing\",\n    \"kinds\": [\"checkout_completed\"]\n  },\n  {\n    \"related_type\": \"mentorship.MentorshipSession\",\n    \"kinds\": [\n      \"mentoring_session_scheduled\",\n      \"mentorship_session_checkin\",\n      \"mentorship_session_checkout\"\n    ]\n  },\n  {\n    \"related_type\": \"payments.Invoice\",\n    \"kinds\": [\"checkout_completed\"]\n  }\n]\n</code></pre> <p>Use Case: Use this endpoint to populate filter dropdowns or UI components that allow users to select which activity kinds to query.</p> <p>Example: <pre><code>GET /v3/activity/kinds\n</code></pre></p>"},{"location":"LLM-DOCS/Student_Activity/#get-get-academy-activities-v3","title":"GET - Get Academy Activities (V3)","text":"<p>Endpoint: <code>GET /v3/activity/academy/activity</code></p> <p>Permissions: <code>read_activity</code></p> <p>Query Parameters: - <code>user_id={user_id}</code> - Filter by user ID (defaults to authenticated user if not provided) - <code>kind={activity_kind1,activity_kind2,...}</code> - Filter by one or more activity kinds (comma-separated) \u2b50 NEW - <code>cohort_id={cohort_id_or_slug}</code> - Filter by cohort (ID or slug) - <code>date_start={timestamp}</code> - Filter by start date (ISO timestamp) - <code>date_end={timestamp}</code> - Filter by end date (ISO timestamp) - <code>limit={number}</code> - Limit results (default: 100) - <code>page={number}</code> - Page number (default: 1)</p> <p>Description: Get activities for a specific user within an academy from BigQuery. V3 supports filtering by multiple activity kinds in a single query, making it ideal for frontend applications with multi-select filters.</p> <p>Key Differences from V2: - \u2705 Supports multiple <code>kind</code> values: <code>?kind=login,open_syllabus_module,read_assignment</code> - \u2705 Always uses BigQuery array parameters for consistent querying - \u2705 Optimized for frontend filter UIs</p> <p>Example - Single Kind (backward compatible): <pre><code>GET /v3/activity/academy/activity?user_id=123&amp;kind=login&amp;date_start=2024-01-01T00:00:00Z\n</code></pre></p> <p>Example - Multiple Kinds: <pre><code>GET /v3/activity/academy/activity?user_id=123&amp;kind=login,open_syllabus_module,read_assignment&amp;date_start=2024-01-01T00:00:00Z\n</code></pre></p> <p>Example - Multiple Kinds with Cohort: <pre><code>GET /v3/activity/academy/activity?kind=login,assignment_status_updated&amp;cohort_id=web-dev-pt-01&amp;limit=50\n</code></pre></p> <p>Example - All Assignment-Related Activities: <pre><code>GET /v3/activity/academy/activity?user_id=123&amp;kind=open_syllabus_module,read_assignment,assignment_review_status_updated,assignment_status_updated&amp;date_start=2024-01-01T00:00:00Z&amp;date_end=2024-01-31T23:59:59Z\n</code></pre></p> <p>Response:</p> <pre><code>[\n  {\n    \"id\": \"activity-123\",\n    \"user_id\": 123,\n    \"kind\": \"login\",\n    \"related\": {\n      \"type\": \"auth.User\",\n      \"id\": 123,\n      \"slug\": null\n    },\n    \"meta\": {\n      \"email\": \"student@example.com\",\n      \"username\": \"student\",\n      \"cohort\": \"web-dev-pt-01\",\n      \"academy\": 1\n    },\n    \"timestamp\": \"2024-01-15T10:30:00Z\"\n  },\n  {\n    \"id\": \"activity-124\",\n    \"user_id\": 123,\n    \"kind\": \"open_syllabus_module\",\n    \"related\": {\n      \"type\": \"assignments.Task\",\n      \"id\": 456,\n      \"slug\": \"javascript-basics\"\n    },\n    \"meta\": {\n      \"email\": \"student@example.com\",\n      \"username\": \"student\",\n      \"cohort\": \"web-dev-pt-01\",\n      \"academy\": 1\n    },\n    \"timestamp\": \"2024-01-15T11:00:00Z\"\n  }\n]\n</code></pre> <p>Response: Array of activity objects matching any of the specified kinds, ordered by timestamp (descending).</p>"},{"location":"LLM-DOCS/Student_Activity/#get-get-single-academy-activity-v3","title":"GET - Get Single Academy Activity (V3)","text":"<p>Endpoint: <code>GET /v3/activity/academy/activity/{activity_id}</code></p> <p>Parameters: - <code>activity_id</code> - Activity ID</p> <p>Permissions: <code>read_activity</code></p> <p>Query Parameters: - <code>user_id={user_id}</code> - Filter by user ID (defaults to authenticated user)</p> <p>Description: Get a specific activity by ID within an academy. Works identically to V2.</p> <p>Example: <pre><code>GET /v3/activity/academy/activity/activity-123?user_id=123\n</code></pre></p> <p>Response:</p> <pre><code>{\n  \"id\": \"activity-123\",\n  \"user_id\": 123,\n  \"kind\": \"login\",\n  \"related\": {\n    \"type\": \"auth.User\",\n    \"id\": 123,\n    \"slug\": null\n  },\n  \"meta\": {\n    \"email\": \"student@example.com\",\n    \"username\": \"student\",\n    \"cohort\": \"web-dev-pt-01\",\n    \"academy\": 1\n  },\n  \"timestamp\": \"2024-01-15T10:30:00Z\"\n}\n</code></pre>"},{"location":"LLM-DOCS/Student_Activity/#v3-use-cases-and-examples","title":"V3 Use Cases and Examples","text":""},{"location":"LLM-DOCS/Student_Activity/#1-frontend-filter-ui-get-available-activity-types","title":"1. Frontend Filter UI - Get Available Activity Types","text":"<p>Use Case: Load all available activity kinds for filter dropdown/checkboxes</p> <p>Step 1 - Get Activity Kinds: <pre><code>GET /v3/activity/kinds\n</code></pre></p> <p>Step 2 - Build Filter UI: Use the response to populate multi-select filters grouped by <code>related_type</code>: - Group: \"User Activities\" \u2192 Options: <code>login</code> - Group: \"Task Activities\" \u2192 Options: <code>open_syllabus_module</code>, <code>read_assignment</code>, <code>assignment_review_status_updated</code>, <code>assignment_status_updated</code> - Group: \"Event Activities\" \u2192 Options: <code>event_checkin_created</code>, <code>event_checkin_assisted</code> - etc.</p>"},{"location":"LLM-DOCS/Student_Activity/#2-filter-by-multiple-activity-kinds","title":"2. Filter by Multiple Activity Kinds","text":"<p>Use Case: Get all login and lesson activities for a user</p> <p>Endpoint: <pre><code>GET /v3/activity/academy/activity?user_id=123&amp;kind=login,open_syllabus_module,read_assignment&amp;limit=100\n</code></pre></p> <p>What it does: - Returns activities where <code>kind</code> is <code>login</code> OR <code>open_syllabus_module</code> OR <code>read_assignment</code> - Results are ordered by timestamp (most recent first)</p>"},{"location":"LLM-DOCS/Student_Activity/#3-combined-filters-multiple-kinds-cohort-date-range","title":"3. Combined Filters - Multiple Kinds + Cohort + Date Range","text":"<p>Use Case: Get all assignment-related activities for a cohort in a specific month</p> <p>Endpoint: <pre><code>GET /v3/activity/academy/activity?kind=open_syllabus_module,read_assignment,assignment_status_updated,assignment_review_status_updated&amp;cohort_id=web-dev-pt-01&amp;date_start=2024-01-01T00:00:00Z&amp;date_end=2024-01-31T23:59:59Z&amp;limit=200\n</code></pre></p> <p>What it does: - Filters by 4 different assignment-related kinds - Only includes activities from the specified cohort - Only includes activities within the date range - Returns up to 200 results</p>"},{"location":"LLM-DOCS/Student_Activity/#4-user-activity-dashboard","title":"4. User Activity Dashboard","text":"<p>Use Case: Show a comprehensive activity feed for a user</p> <p>Endpoint: <pre><code>GET /v3/activity/academy/activity?user_id=123&amp;kind=login,open_syllabus_module,read_assignment,assignment_status_updated,event_checkin_created,event_checkin_assisted&amp;limit=50&amp;page=1\n</code></pre></p> <p>What it does: - Shows multiple types of activities in a single query - Perfect for dashboard/activity feed UI - Supports pagination for large result sets</p>"},{"location":"LLM-DOCS/Student_Activity/#5-analytics-all-payment-related-activities","title":"5. Analytics - All Payment-Related Activities","text":"<p>Use Case: Track all payment-related activities for analysis</p> <p>Endpoint: <pre><code>GET /v3/activity/academy/activity?kind=bag_created,checkout_completed&amp;date_start=2024-01-01T00:00:00Z&amp;date_end=2024-12-31T23:59:59Z&amp;limit=1000\n</code></pre></p> <p>Note: <code>checkout_completed</code> appears in multiple related types (Subscription, PlanFinancing, Invoice), but the query will match all of them.</p>"},{"location":"LLM-DOCS/Student_Activity/#v3-vs-v2-differences","title":"V3 vs V2 Differences","text":"Feature V2 V3 Multiple kind filtering \u274c Single kind only \u2705 Comma-separated multiple kinds Kind parameter <code>kind=login</code> <code>kind=login,open_syllabus_module</code> Query pattern <code>kind = @kind</code> <code>kind IN UNNEST(@kinds)</code> Activity kinds endpoint \u274c Not available \u2705 <code>/v3/activity/kinds</code> Backward compatible N/A \u2705 Single kind still works"},{"location":"LLM-DOCS/Student_Activity/#when-to-use-v3","title":"When to Use V3","text":"<p>\u2705 Use V3 when: - You need to filter by multiple activity kinds in a single query - You're building a frontend UI with multi-select filters - You want to get all available activity kinds programmatically - You're implementing activity dashboards or analytics views</p> <p>\u2705 Use V2 when: - You only need single kind filtering - You're working with existing V2 integrations - You need the report endpoint (V3 doesn't include it)</p>"},{"location":"LLM-DOCS/Student_Activity/#migration-notes","title":"Migration Notes","text":"<ul> <li>V1 endpoints use Google Cloud Datastore (NDB)</li> <li>V2 endpoints use Google Cloud BigQuery</li> <li>V3 endpoints use Google Cloud BigQuery with enhanced filtering capabilities</li> <li>V2 provides better querying capabilities and analytics</li> <li>V3 adds support for multiple kind filtering and activity kinds listing</li> <li>Some V1 endpoints are deprecated (see deprecation_list in v2 URLs)</li> <li>V3 endpoints are recommended for new frontend implementations requiring multi-kind filtering</li> </ul>"},{"location":"LLM-DOCS/TALENT_CAREER_MAP/","title":"Talent Career Map API","text":"<p>This document describes every endpoint implemented in <code>breathecode/talent_development/views.py</code>.  All routes live under the <code>/v1/talent_development/</code> namespace and are protected with Capy Core capabilities.</p>"},{"location":"LLM-DOCS/TALENT_CAREER_MAP/#shared-behavior","title":"Shared Behavior","text":"<ul> <li>Academy scope: Every endpoint is prefixed with <code>/academy/</code>.  When an   <code>academy_id</code> path parameter is present, <code>academy=None</code> records are always   included unless the query string contains <code>academy=self</code>, in which case only   rows belonging to the requesting academy are returned.</li> <li>Capabilities:</li> <li><code>read_career_path</code> for all <code>GET</code> handlers.</li> <li><code>crud_career_path</code> for <code>POST</code>, <code>PUT</code>, <code>DELETE</code>.  Only users with this Django     permission can change or delete global (<code>academy=None</code>) entities.</li> <li>Pagination / sorting: Each collection view uses <code>APIViewExtensions</code> with   pagination and optional <code>sort</code> query parameter (default sort indicated below).</li> <li>Language handling: Error messages rely on <code>get_user_language</code> and are   translated via <code>capyc.core.translation</code>.</li> </ul>"},{"location":"LLM-DOCS/TALENT_CAREER_MAP/#endpoint-reference","title":"Endpoint Reference","text":""},{"location":"LLM-DOCS/TALENT_CAREER_MAP/#job-families","title":"Job Families","text":"Method Path Capability Description <code>GET</code> <code>/academy/job_family</code> <code>read_career_path</code> Paginated list of job families (<code>sort=name</code>). Supports <code>academy=self</code>. <code>POST</code> <code>/academy/job_family</code> <code>crud_career_path</code> Creates a job family. If <code>academy</code> is omitted the path <code>academy_id</code> is used. Body fields: <code>name</code>, <code>description</code>, <code>academy</code> (optional), <code>is_active</code>. Slug auto-generates if missing. <code>GET</code> <code>/academy/job_family/&lt;int:id&gt;</code> <code>read_career_path</code> Retrieve a job family by numeric id (honors academy filter). <code>PUT</code> <code>/academy/job_family/&lt;int:id&gt;</code> <code>crud_career_path</code> Partial update by id. Cannot modify global (<code>academy=None</code>) rows without <code>crud_career_path</code>. <code>DELETE</code> <code>/academy/job_family/&lt;int:id&gt;</code> <code>crud_career_path</code> Deletes by id after ensuring there are no related job roles. <code>GET</code> <code>/academy/job_family/&lt;slug&gt;</code> <code>read_career_path</code> Retrieve by slug (same filtering rules). <code>PUT</code> <code>/academy/job_family/&lt;slug&gt;</code> <code>crud_career_path</code> Partial update by slug. Same permission &amp; academy checks as id route. <code>DELETE</code> <code>/academy/job_family/&lt;slug&gt;</code> <code>crud_career_path</code> Deletes by slug, blocked if job roles exist."},{"location":"LLM-DOCS/TALENT_CAREER_MAP/#job-roles","title":"Job Roles","text":"Method Path Capability Description <code>GET</code> <code>/academy/job_role</code> <code>read_career_path</code> Paginated job roles (<code>sort=name</code>). Optional query <code>job_family_id</code> plus the shared academy filter. <code>POST</code> <code>/academy/job_role</code> <code>crud_career_path</code> Creates a job role. Body fields: <code>name</code>, <code>job_family</code>, <code>description</code>, <code>academy</code>, <code>is_active</code>, <code>is_model</code>. Slug auto-generates. <code>GET</code> <code>/academy/job_role/&lt;int:id&gt;</code> <code>read_career_path</code> Retrieve job role by id (academy filter applied). <code>PUT</code> <code>/academy/job_role/&lt;int:id&gt;</code> <code>crud_career_path</code> Partial update by id with same global-entity protections. <code>DELETE</code> <code>/academy/job_role/&lt;int:id&gt;</code> <code>crud_career_path</code> Deletes by id after verifying no linked career paths. <code>GET</code> <code>/academy/job_role/&lt;slug&gt;</code> <code>read_career_path</code> Retrieve job role by slug. <code>PUT</code> <code>/academy/job_role/&lt;slug&gt;</code> <code>crud_career_path</code> Partial update by slug. <code>DELETE</code> <code>/academy/job_role/&lt;slug&gt;</code> <code>crud_career_path</code> Delete by slug, blocked if career paths exist. <code>GET</code> <code>/academy/job_family/&lt;int:job_family_id&gt;/job_role</code> <code>read_career_path</code> Lists roles belonging to a specific job family (<code>sort=name</code>). Response embeds <code>career_paths</code> (<code>id</code>, <code>name</code>). Requires <code>job_family_id</code> path arg."},{"location":"LLM-DOCS/TALENT_CAREER_MAP/#skills","title":"Skills","text":"Method Path Capability Description <code>GET</code> <code>/academy/skill</code> <code>read_career_path</code> Paginated skills (<code>sort=name</code>). Filters: <code>skill_domains=&lt;slug,...&gt;</code>, <code>technologies=&lt;csv&gt;</code>, <code>competencies=&lt;slug,...&gt;</code>, <code>job_roles=&lt;slug,...&gt;</code>. <code>POST</code> \u2014 \u2014 Not implemented (all skill mutations are elsewhere). <code>GET</code> <code>/academy/skill/&lt;int:id&gt;</code> <code>read_career_path</code> Detailed skill by id using <code>SkillDetailSerializer</code> (includes domain, competencies, indicators, knowledge, attitudes, etc.). <code>GET</code> <code>/academy/skill/&lt;slug&gt;</code> <code>read_career_path</code> Same as above but slug-based."},{"location":"LLM-DOCS/TALENT_CAREER_MAP/#competencies","title":"Competencies","text":"Method Path Capability Description <code>GET</code> <code>/academy/competency</code> <code>read_career_path</code> Paginated list (<code>sort=name</code>). Filters: <code>technologies=&lt;csv&gt;</code>, <code>job_roles=&lt;slug,...&gt;</code>. Serializer adds embedded skills (<code>slug</code>, <code>name</code>). <code>GET</code> <code>/academy/competency/&lt;int:id&gt;</code> <code>read_career_path</code> Detailed competency by id (<code>CompetencyDetailSerializer</code>). <code>GET</code> <code>/academy/competency/&lt;slug&gt;</code> <code>read_career_path</code> Detailed competency by slug."},{"location":"LLM-DOCS/TALENT_CAREER_MAP/#career-paths-stages","title":"Career Paths &amp; Stages","text":"Method Path Capability Description <code>GET</code> <code>/academy/career_path</code> <code>read_career_path</code> Paginated career paths (<code>sort=name</code>) with nested stages collection per item."},{"location":"LLM-DOCS/TALENT_CAREER_MAP/#skill-domains","title":"Skill Domains","text":"Method Path Capability Description <code>GET</code> <code>/academy/skill_domain</code> <code>read_career_path</code> Paginated list (<code>sort=name</code>) of all skill domains."},{"location":"LLM-DOCS/TALENT_CAREER_MAP/#skill-knowledge-items","title":"Skill Knowledge Items","text":"Method Path Capability Description <code>GET</code> <code>/academy/skill_knowledge_item</code> <code>read_career_path</code> Paginated list (<code>sort=id</code>). Optional query <code>skill=&lt;slug,...&gt;</code> filters by related skill slug(s)."},{"location":"LLM-DOCS/TALENT_CAREER_MAP/#skill-attitude-tags","title":"Skill Attitude Tags","text":"Method Path Capability Description <code>GET</code> <code>/academy/skill_attitude_tag</code> <code>read_career_path</code> Paginated list (<code>sort=tag</code>). Optional query <code>skill=&lt;slug,...&gt;</code> filters by skill slug(s)."},{"location":"LLM-DOCS/TALENT_CAREER_MAP/#request-response-patterns","title":"Request &amp; Response Patterns","text":"<ul> <li>Creation / updates: Serializers (<code>JobFamilySerializer</code>, <code>JobRoleSerializer</code>)   auto-generate slugs when absent and raise <code>ValidationException</code> if a slug   already exists. They also accept numeric ids for related fields and convert   them to ORM instances.</li> <li>Error handling: All validation issues raise <code>ValidationException</code> with   translated messages and HTTP-appropriate status codes (400, 403, 404).</li> <li>Deletion guards: Job families cannot be deleted while job roles exist, and   job roles cannot be deleted while any career path references them.</li> </ul> <p>Use this reference whenever you need to discover the capabilities, filters, or side-effects tied to the talent development (\u201ccareer map\u201d) endpoints.</p>"},{"location":"LLM-DOCS/assignment_telemetry/","title":"Assignment Telemetry API - Complete Guide","text":"<p>This document provides comprehensive guidance on creating and updating assignment telemetry records for individual users and assets in the BreatheCode platform.</p>"},{"location":"LLM-DOCS/assignment_telemetry/#table-of-contents","title":"Table of Contents","text":"<ol> <li>Overview</li> <li>Authentication &amp; Permissions</li> <li>Creating or Updating Telemetry (POST)</li> <li>Updating Existing Telemetry (PUT)</li> <li>Field Reference</li> <li>Error Handling</li> <li>Examples</li> </ol>"},{"location":"LLM-DOCS/assignment_telemetry/#overview","title":"Overview","text":"<p>Assignment telemetry tracks detailed learning analytics for students working on specific assets (exercises, projects, etc.). This includes:</p> <ul> <li>Raw Telemetry Data: JSON data from LearnPack with detailed interaction information</li> <li>Engagement Metrics: Calculated engagement scores (0-100)</li> <li>Frustration Metrics: Calculated frustration scores (0-100)</li> <li>Completion Data: Completion rates, total time spent, and other metrics</li> <li>Algorithm Versioning: Track which version of the calculation algorithm was used</li> </ul>"},{"location":"LLM-DOCS/assignment_telemetry/#key-concepts","title":"Key Concepts","text":"<ul> <li>Asset Slug: Unique identifier for the learning asset (e.g., \"intro-to-python\", \"todo-list-project\")</li> <li>User ID: The numeric ID of the student/user</li> <li>Upsert Behavior: POST endpoint creates new telemetry if it doesn't exist, or updates existing telemetry</li> <li>Update Only: PUT endpoint only updates existing telemetry (returns 404 if not found)</li> </ul>"},{"location":"LLM-DOCS/assignment_telemetry/#base-url","title":"Base URL","text":"<pre><code>Production: https://breathecode.herokuapp.com\nDevelopment: http://localhost:8000\n</code></pre>"},{"location":"LLM-DOCS/assignment_telemetry/#authentication-permissions","title":"Authentication &amp; Permissions","text":""},{"location":"LLM-DOCS/assignment_telemetry/#required-headers","title":"Required Headers","text":"<p>All endpoints require:</p> <pre><code>Authorization: Token {your-access-token}\nAcademy: {academy_id}\nContent-Type: application/json\n</code></pre>"},{"location":"LLM-DOCS/assignment_telemetry/#required-capability","title":"Required Capability","text":"<p><code>crud_telemetry</code> - Create, update or delete assignment telemetry</p> <p>Note: This capability must be assigned to your role in the academy. Academy staff with appropriate roles automatically have this permission. See create_academy_roles.py for full capability list.</p>"},{"location":"LLM-DOCS/assignment_telemetry/#creating-or-updating-telemetry-post","title":"Creating or Updating Telemetry (POST)","text":"<p>The POST endpoint provides upsert functionality - it will create a new telemetry record if one doesn't exist, or update an existing one if it does.</p>"},{"location":"LLM-DOCS/assignment_telemetry/#endpoint","title":"Endpoint","text":"<p><code>POST /v1/assignment/academy/asset/{asset_slug}/user/{user_id}/telemetry</code></p>"},{"location":"LLM-DOCS/assignment_telemetry/#url-parameters","title":"URL Parameters","text":"Parameter Type Required Description <code>asset_slug</code> string Yes The slug identifier of the asset (e.g., \"intro-to-python\") <code>user_id</code> integer Yes The numeric ID of the user/student"},{"location":"LLM-DOCS/assignment_telemetry/#headers","title":"Headers","text":"<pre><code>Authorization: Token {your-token}\nAcademy: {academy_id}\nContent-Type: application/json\n</code></pre>"},{"location":"LLM-DOCS/assignment_telemetry/#request-body","title":"Request Body","text":"<p>All fields are optional. Include only the fields you want to set or update:</p> <pre><code>{\n  \"telemetry\": {\n    \"events\": [...],\n    \"interactions\": [...],\n    \"timestamps\": [...]\n  },\n  \"engagement_score\": 85.5,\n  \"frustration_score\": 12.3,\n  \"metrics_algo_version\": 1.2,\n  \"metrics\": {\n    \"total_time_on_platform\": 3600,\n    \"completion_rate\": 95.5,\n    \"interactions_count\": 150\n  },\n  \"total_time\": \"01:00:00\",\n  \"completion_rate\": 95.5\n}\n</code></pre>"},{"location":"LLM-DOCS/assignment_telemetry/#response-codes","title":"Response Codes","text":"<ul> <li>201 Created: New telemetry record was created</li> <li>200 OK: Existing telemetry record was updated</li> <li>400 Bad Request: Validation error (invalid data format)</li> <li>404 Not Found: User with the specified ID doesn't exist</li> <li>403 Forbidden: Missing <code>crud_telemetry</code> capability or invalid academy</li> </ul>"},{"location":"LLM-DOCS/assignment_telemetry/#response-body-success","title":"Response Body (Success)","text":"<p>Returns the created or updated telemetry object:</p> <pre><code>{\n  \"id\": 123,\n  \"user\": 456,\n  \"asset_slug\": \"intro-to-python\",\n  \"telemetry\": {\n    \"events\": [...],\n    \"interactions\": [...]\n  },\n  \"engagement_score\": 85.5,\n  \"frustration_score\": 12.3,\n  \"metrics_algo_version\": 1.2,\n  \"metrics\": {\n    \"total_time_on_platform\": 3600,\n    \"completion_rate\": 95.5\n  },\n  \"total_time\": \"01:00:00\",\n  \"completion_rate\": 95.5,\n  \"created_at\": \"2024-01-15T10:30:00Z\",\n  \"updated_at\": \"2024-01-15T11:45:00Z\"\n}\n</code></pre>"},{"location":"LLM-DOCS/assignment_telemetry/#example-create-new-telemetry","title":"Example: Create New Telemetry","text":"<pre><code>curl -X POST \\\n  \"https://breathecode.herokuapp.com/v1/assignment/academy/asset/intro-to-python/user/123/telemetry\" \\\n  -H \"Authorization: Token your-token-here\" \\\n  -H \"Academy: 1\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"telemetry\": {\n      \"events\": [\"start\", \"code_edit\", \"test_run\", \"complete\"],\n      \"total_interactions\": 45\n    },\n    \"engagement_score\": 88.5,\n    \"completion_rate\": 100.0\n  }'\n</code></pre>"},{"location":"LLM-DOCS/assignment_telemetry/#example-update-existing-telemetry","title":"Example: Update Existing Telemetry","text":"<pre><code># Same endpoint - automatically updates if telemetry exists\ncurl -X POST \\\n  \"https://breathecode.herokuapp.com/v1/assignment/academy/asset/intro-to-python/user/123/telemetry\" \\\n  -H \"Authorization: Token your-token-here\" \\\n  -H \"Academy: 1\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"engagement_score\": 92.0,\n    \"completion_rate\": 100.0\n  }'\n</code></pre>"},{"location":"LLM-DOCS/assignment_telemetry/#updating-existing-telemetry-put","title":"Updating Existing Telemetry (PUT)","text":"<p>The PUT endpoint only updates existing telemetry records. It will return a 404 error if the telemetry doesn't exist.</p>"},{"location":"LLM-DOCS/assignment_telemetry/#endpoint_1","title":"Endpoint","text":"<p><code>PUT /v1/assignment/academy/asset/{asset_slug}/user/{user_id}/telemetry</code></p>"},{"location":"LLM-DOCS/assignment_telemetry/#url-parameters_1","title":"URL Parameters","text":"Parameter Type Required Description <code>asset_slug</code> string Yes The slug identifier of the asset <code>user_id</code> integer Yes The numeric ID of the user/student"},{"location":"LLM-DOCS/assignment_telemetry/#headers_1","title":"Headers","text":"<pre><code>Authorization: Token {your-token}\nAcademy: {academy_id}\nContent-Type: application/json\n</code></pre>"},{"location":"LLM-DOCS/assignment_telemetry/#request-body_1","title":"Request Body","text":"<p>All fields are optional. Include only the fields you want to update:</p> <pre><code>{\n  \"engagement_score\": 90.0,\n  \"frustration_score\": 8.5,\n  \"completion_rate\": 98.5,\n  \"total_time\": \"01:30:00\"\n}\n</code></pre>"},{"location":"LLM-DOCS/assignment_telemetry/#response-codes_1","title":"Response Codes","text":"<ul> <li>200 OK: Telemetry was successfully updated</li> <li>400 Bad Request: Validation error (invalid data format)</li> <li>404 Not Found: Telemetry record doesn't exist for this asset and user</li> <li>403 Forbidden: Missing <code>crud_telemetry</code> capability or invalid academy</li> </ul>"},{"location":"LLM-DOCS/assignment_telemetry/#response-body-success_1","title":"Response Body (Success)","text":"<p>Returns the updated telemetry object (same format as POST).</p>"},{"location":"LLM-DOCS/assignment_telemetry/#example-update-telemetry","title":"Example: Update Telemetry","text":"<pre><code>curl -X PUT \\\n  \"https://breathecode.herokuapp.com/v1/assignment/academy/asset/intro-to-python/user/123/telemetry\" \\\n  -H \"Authorization: Token your-token-here\" \\\n  -H \"Academy: 1\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"engagement_score\": 95.0,\n    \"completion_rate\": 100.0\n  }'\n</code></pre>"},{"location":"LLM-DOCS/assignment_telemetry/#field-reference","title":"Field Reference","text":""},{"location":"LLM-DOCS/assignment_telemetry/#request-fields","title":"Request Fields","text":"<p>All fields are optional and can be included in both POST and PUT requests:</p> Field Type Description Example <code>telemetry</code> JSON Raw telemetry data from LearnPack with detailed interaction info <code>{\"events\": [...], \"interactions\": [...]}</code> <code>engagement_score</code> float Calculated engagement score (0-100) <code>85.5</code> <code>frustration_score</code> float Calculated frustration score (0-100) <code>12.3</code> <code>metrics_algo_version</code> float Version of the algorithm used to calculate metrics <code>1.2</code> <code>metrics</code> JSON Calculated metrics based on telemetry <code>{\"total_time_on_platform\": 3600, \"completion_rate\": 95.5}</code> <code>total_time</code> duration Total time spent on the exercise (ISO 8601 duration format) <code>\"01:00:00\"</code> or <code>\"PT1H\"</code> <code>completion_rate</code> float Completion rate from 0 to 100 (percentage) <code>95.5</code>"},{"location":"LLM-DOCS/assignment_telemetry/#response-fields","title":"Response Fields","text":"<p>In addition to the request fields, responses include:</p> Field Type Description <code>id</code> integer Unique telemetry record ID <code>user</code> integer User ID (read-only) <code>asset_slug</code> string Asset slug (read-only) <code>created_at</code> datetime When the record was created (ISO 8601) <code>updated_at</code> datetime When the record was last updated (ISO 8601)"},{"location":"LLM-DOCS/assignment_telemetry/#field-constraints","title":"Field Constraints","text":"<ul> <li>engagement_score: Float value between 0 and 100</li> <li>frustration_score: Float value between 0 and 100</li> <li>completion_rate: Float value between 0 and 100 (percentage)</li> <li>total_time: Duration in ISO 8601 format (e.g., \"PT1H30M\" for 1 hour 30 minutes, or \"01:30:00\")</li> <li>telemetry: Valid JSON object (can be nested)</li> <li>metrics: Valid JSON object (can be nested)</li> </ul>"},{"location":"LLM-DOCS/assignment_telemetry/#error-handling","title":"Error Handling","text":""},{"location":"LLM-DOCS/assignment_telemetry/#common-error-responses","title":"Common Error Responses","text":""},{"location":"LLM-DOCS/assignment_telemetry/#400-bad-request-validation-error","title":"400 Bad Request - Validation Error","text":"<pre><code>{\n  \"engagement_score\": [\"Ensure this value is less than or equal to 100.\"],\n  \"total_time\": [\"Duration has wrong format. Use one of these formats instead: [HH:MM:SS, PT...].\"]\n}\n</code></pre>"},{"location":"LLM-DOCS/assignment_telemetry/#404-not-found-user-not-found-post","title":"404 Not Found - User Not Found (POST)","text":"<pre><code>{\n  \"detail\": \"User with id 999 not found\",\n  \"status_code\": 404,\n  \"slug\": \"user-not-found\"\n}\n</code></pre>"},{"location":"LLM-DOCS/assignment_telemetry/#404-not-found-telemetry-not-found-put","title":"404 Not Found - Telemetry Not Found (PUT)","text":"<pre><code>{\n  \"detail\": \"Assignment telemetry not found for asset intro-to-python and user 123\",\n  \"status_code\": 404,\n  \"slug\": \"telemetry-not-found\"\n}\n</code></pre>"},{"location":"LLM-DOCS/assignment_telemetry/#403-forbidden-missing-capability","title":"403 Forbidden - Missing Capability","text":"<pre><code>{\n  \"detail\": \"You (user: 456) don't have this capability: crud_telemetry for academy 1\",\n  \"status_code\": 403\n}\n</code></pre>"},{"location":"LLM-DOCS/assignment_telemetry/#403-forbidden-missing-academy-header","title":"403 Forbidden - Missing Academy Header","text":"<pre><code>{\n  \"detail\": \"Missing academy_id parameter expected for the endpoint url or 'Academy' header\",\n  \"status_code\": 403\n}\n</code></pre>"},{"location":"LLM-DOCS/assignment_telemetry/#examples","title":"Examples","text":""},{"location":"LLM-DOCS/assignment_telemetry/#complete-workflow-example","title":"Complete Workflow Example","text":""},{"location":"LLM-DOCS/assignment_telemetry/#1-create-initial-telemetry-post","title":"1. Create Initial Telemetry (POST)","text":"<p>When a student starts an assignment:</p> <pre><code>curl -X POST \\\n  \"https://breathecode.herokuapp.com/v1/assignment/academy/asset/todo-list-project/user/123/telemetry\" \\\n  -H \"Authorization: Token your-token-here\" \\\n  -H \"Academy: 1\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"telemetry\": {\n      \"started_at\": \"2024-01-15T10:00:00Z\",\n      \"events\": [\"start\"]\n    },\n    \"engagement_score\": 0,\n    \"completion_rate\": 0\n  }'\n</code></pre>"},{"location":"LLM-DOCS/assignment_telemetry/#2-update-telemetry-as-student-progresses-put","title":"2. Update Telemetry as Student Progresses (PUT)","text":"<pre><code>curl -X PUT \\\n  \"https://breathecode.herokuapp.com/v1/assignment/academy/asset/todo-list-project/user/123/telemetry\" \\\n  -H \"Authorization: Token your-token-here\" \\\n  -H \"Academy: 1\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"telemetry\": {\n      \"started_at\": \"2024-01-15T10:00:00Z\",\n      \"events\": [\"start\", \"code_edit\", \"test_run\"],\n      \"interactions\": 25\n    },\n    \"engagement_score\": 65.5,\n    \"completion_rate\": 45.0,\n    \"total_time\": \"00:30:00\"\n  }'\n</code></pre>"},{"location":"LLM-DOCS/assignment_telemetry/#3-final-update-when-student-completes-put","title":"3. Final Update When Student Completes (PUT)","text":"<pre><code>curl -X PUT \\\n  \"https://breathecode.herokuapp.com/v1/assignment/academy/asset/todo-list-project/user/123/telemetry\" \\\n  -H \"Authorization: Token your-token-here\" \\\n  -H \"Academy: 1\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"telemetry\": {\n      \"started_at\": \"2024-01-15T10:00:00Z\",\n      \"completed_at\": \"2024-01-15T11:30:00Z\",\n      \"events\": [\"start\", \"code_edit\", \"test_run\", \"complete\"],\n      \"interactions\": 150\n    },\n    \"engagement_score\": 92.5,\n    \"frustration_score\": 8.0,\n    \"completion_rate\": 100.0,\n    \"total_time\": \"01:30:00\",\n    \"metrics\": {\n      \"total_time_on_platform\": 5400,\n      \"completion_rate\": 100.0,\n      \"interactions_count\": 150,\n      \"test_passes\": 12,\n      \"test_failures\": 0\n    },\n    \"metrics_algo_version\": 1.2\n  }'\n</code></pre>"},{"location":"LLM-DOCS/assignment_telemetry/#additional-curl-examples","title":"Additional cURL Examples","text":""},{"location":"LLM-DOCS/assignment_telemetry/#create-or-update-telemetry-with-full-data-post","title":"Create or Update Telemetry with Full Data (POST)","text":"<pre><code>curl -X POST \\\n  \"https://breathecode.herokuapp.com/v1/assignment/academy/asset/intro-to-python/user/123/telemetry\" \\\n  -H \"Authorization: Token your-token-here\" \\\n  -H \"Academy: 1\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"telemetry\": {\n      \"events\": [\"start\", \"code_edit\", \"test_run\"],\n      \"interactions\": 45\n    },\n    \"engagement_score\": 85.5,\n    \"completion_rate\": 95.0,\n    \"total_time\": \"01:00:00\"\n  }'\n</code></pre>"},{"location":"LLM-DOCS/assignment_telemetry/#partial-update-put","title":"Partial Update (PUT)","text":"<pre><code>curl -X PUT \\\n  \"https://breathecode.herokuapp.com/v1/assignment/academy/asset/intro-to-python/user/123/telemetry\" \\\n  -H \"Authorization: Token your-token-here\" \\\n  -H \"Academy: 1\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"engagement_score\": 90.0,\n    \"completion_rate\": 100.0\n  }'\n</code></pre>"},{"location":"LLM-DOCS/assignment_telemetry/#best-practices","title":"Best Practices","text":"<ol> <li> <p>Use POST for Upsert: If you're unsure whether telemetry exists, use POST which will create or update automatically.</p> </li> <li> <p>Use PUT for Updates Only: Use PUT when you're certain the telemetry exists and want to ensure it fails if it doesn't.</p> </li> <li> <p>Partial Updates: Both endpoints support partial updates - only include the fields you want to change.</p> </li> <li> <p>Duration Format: Use ISO 8601 duration format (e.g., \"PT1H30M\") or time format (e.g., \"01:30:00\") for <code>total_time</code>.</p> </li> <li> <p>Score Validation: Ensure engagement_score, frustration_score, and completion_rate are between 0 and 100.</p> </li> <li> <p>Error Handling: Always check for 404 errors (user not found, telemetry not found) and handle them appropriately.</p> </li> <li> <p>Academy Header: Always include the <code>Academy</code> header with the academy ID, even though it's also in the URL path.</p> </li> </ol>"},{"location":"LLM-DOCS/assignment_telemetry/#related-documentation","title":"Related Documentation","text":"<ul> <li>Managing Single Asset - Learn about assets and asset slugs</li> <li>Student Report - View student information and progress</li> <li>Authentication - Learn about authentication and tokens</li> </ul>"},{"location":"LLM-DOCS/assignment_telemetry/#support","title":"Support","text":"<p>For issues or questions: - Check error messages for specific validation errors - Verify you have the <code>crud_telemetry</code> capability in your academy role - Ensure the user ID and asset slug are correct - Verify the Academy header matches the academy ID in the URL</p>"},{"location":"LLM-DOCS/reports/","title":"Monitoring Reports - Complete Guide","text":"<p>Complete guide to the Monitoring Reports system for generating analytics and insights about platform usage, user behavior, and business metrics.</p>"},{"location":"LLM-DOCS/reports/#overview","title":"Overview","text":"<p>The Monitoring Reports system provides a modular framework for generating daily analytics reports. Reports are designed to:</p> <ul> <li>Reduce BigQuery costs by pre-computing aggregations once per day</li> <li>Enable fast dashboard queries by storing results in PostgreSQL</li> <li>Support churn prediction and risk assessment</li> <li>Enable historical trend analysis with daily snapshots</li> <li>Scale independently via management commands on dedicated Heroku dynos</li> </ul> <p>Location: <code>breathecode/monitoring/reports/</code></p>"},{"location":"LLM-DOCS/reports/#table-of-contents","title":"Table of Contents","text":"<ol> <li>Architecture</li> <li>Available Reports</li> <li>Running Reports</li> <li>Churn Risk Report</li> <li>Report Structure</li> <li>Adding New Reports</li> <li>Best Practices</li> </ol>"},{"location":"LLM-DOCS/reports/#architecture","title":"Architecture","text":""},{"location":"LLM-DOCS/reports/#modular-design","title":"Modular Design","text":"<p>Each report type lives in its own submodule:</p> <pre><code>breathecode/monitoring/reports/\n\u251c\u2500\u2500 __init__.py           # Package initialization\n\u251c\u2500\u2500 base.py               # BaseReport abstract class\n\u251c\u2500\u2500 churn/                # Churn risk report\n\u2502   \u251c\u2500\u2500 __init__.py\n\u2502   \u251c\u2500\u2500 models.py         # ChurnRiskReport, ChurnAlert models\n\u2502   \u2514\u2500\u2500 actions.py        # ChurnReport class, calculation logic\n\u2514\u2500\u2500 engagement/           # Future: Engagement report\n    \u251c\u2500\u2500 __init__.py\n    \u251c\u2500\u2500 models.py\n    \u2514\u2500\u2500 actions.py\n</code></pre>"},{"location":"LLM-DOCS/reports/#base-report-pattern","title":"Base Report Pattern","text":"<p>All reports extend <code>BaseReport</code> which provides:</p> <ul> <li><code>fetch_data()</code> - Get raw data from BigQuery/database</li> <li><code>process_data()</code> - Transform raw data into model instances</li> <li><code>save_reports()</code> - Bulk save to database</li> <li><code>generate()</code> - Orchestrate the full workflow</li> </ul>"},{"location":"LLM-DOCS/reports/#execution-model","title":"Execution Model","text":"<p>Reports are executed via Django management commands (not Celery tasks) to enable:</p> <ul> <li>Flexible scheduling via cronjobs</li> <li>Dedicated resources (Performance dynos on Heroku)</li> <li>Long-running queries without timeout constraints</li> <li>Better error visibility in command output</li> </ul>"},{"location":"LLM-DOCS/reports/#available-reports","title":"Available Reports","text":""},{"location":"LLM-DOCS/reports/#churn-risk-report","title":"Churn Risk Report","text":"<p>Purpose: Predict user churn likelihood based on activity patterns</p> <p>Command: <code>python manage.py generate_report churn</code></p> <p>Models: - <code>ChurnRiskReport</code> - Daily per-user risk assessment - <code>ChurnAlert</code> - Triggered alerts for high-risk users</p> <p>Details: See Churn Risk Report section below</p>"},{"location":"LLM-DOCS/reports/#running-reports","title":"Running Reports","text":""},{"location":"LLM-DOCS/reports/#management-command","title":"Management Command","text":"<p>The <code>generate_report</code> command supports multiple report types:</p> <pre><code>python manage.py generate_report {report_type} [options]\n</code></pre>"},{"location":"LLM-DOCS/reports/#command-options","title":"Command Options","text":"Option Description Example <code>report_type</code> Type of report (required) <code>churn</code>, <code>engagement</code> <code>--date</code> Specific date (YYYY-MM-DD) <code>--date 2024-12-15</code> <code>--academy</code> Filter by academy ID <code>--academy 1</code> <code>--days-back</code> Backfill last N days <code>--days-back 30</code> <code>--dry-run</code> Test without saving <code>--dry-run</code> <code>--verbosity</code> Logging verbosity <code>--verbosity 2</code>"},{"location":"LLM-DOCS/reports/#usage-examples","title":"Usage Examples","text":"<pre><code># Generate yesterday's churn report (default)\npython manage.py generate_report churn\n\n# Generate for specific date\npython manage.py generate_report churn --date 2024-12-15\n\n# Generate for specific academy\npython manage.py generate_report churn --academy 1\n\n# Backfill last 30 days\npython manage.py generate_report churn --days-back 30\n\n# Test without saving (dry run)\npython manage.py generate_report churn --dry-run\n\n# Verbose output for debugging\npython manage.py generate_report churn --verbosity 2\n</code></pre>"},{"location":"LLM-DOCS/reports/#heroku-scheduler-setup","title":"Heroku Scheduler Setup","text":"<p>For daily automated runs:</p> <pre><code># Daily at 2 AM UTC (after midnight data is complete)\nheroku run python manage.py generate_report churn --app your-app\n</code></pre> <p>Or configure via Heroku Scheduler addon: - Command: <code>python manage.py generate_report churn</code> - Schedule: Daily at 02:00 UTC - Dyno Type: Performance-L (or Standard-2X for large datasets)</p>"},{"location":"LLM-DOCS/reports/#churn-risk-report_1","title":"Churn Risk Report","text":""},{"location":"LLM-DOCS/reports/#overview_1","title":"Overview","text":"<p>The Churn Risk Report analyzes user activity patterns to predict likelihood of subscription cancellation. It generates:</p> <ol> <li>Daily risk scores (0-100) for each active subscriber</li> <li>Risk level classifications (LOW, MEDIUM, HIGH, CRITICAL)</li> <li>Automated alerts for users crossing risk thresholds</li> <li>Historical tracking for trend analysis</li> </ol>"},{"location":"LLM-DOCS/reports/#risk-calculation","title":"Risk Calculation","text":"<p>The churn risk score is calculated using weighted signals:</p> Signal Weight Description Inactivity 25% Days since last activity (max risk at 14+ days) Engagement Decay 20% Drop in engagement score vs baseline Frustration 15% High frustration scores from telemetry Login Decay 15% Decline in login frequency Assignment Stall 15% Drop in assignment completion rate Payment Issues 10% Subscription in PAYMENT_ISSUE status"},{"location":"LLM-DOCS/reports/#risk-levels","title":"Risk Levels","text":"Score Range Level Description 0-24 LOW Healthy engagement, low churn risk 25-49 MEDIUM Some concerning signals, monitor 50-74 HIGH Significant risk, intervention recommended 75-100 CRITICAL Very high risk, immediate action needed"},{"location":"LLM-DOCS/reports/#data-sources","title":"Data Sources","text":"<p>The report combines data from:</p> <ol> <li>BigQuery Activity Table - Login frequency, assignment completions, trends</li> <li>PostgreSQL Subscriptions - Payment status, renewal dates</li> <li>Assignment Telemetry - Engagement and frustration scores (future)</li> </ol>"},{"location":"LLM-DOCS/reports/#query-strategy","title":"Query Strategy","text":"<p>The report uses a single batch BigQuery query to fetch metrics for all users simultaneously, minimizing costs:</p> <ul> <li>Queries last 14 days of activity</li> <li>Calculates trends comparing last 7 days vs previous 7 days</li> <li>Groups by user for efficient processing</li> <li>Filters to active subscribers only</li> </ul>"},{"location":"LLM-DOCS/reports/#models","title":"Models","text":""},{"location":"LLM-DOCS/reports/#churnriskreport","title":"ChurnRiskReport","text":"<p>Stores daily risk assessment per user.</p> <p>Key Fields: - <code>user</code> - ForeignKey to User - <code>academy</code> - ForeignKey to Academy (nullable) - <code>report_date</code> - Date of the report - <code>churn_risk_score</code> - Calculated score (0-100) - <code>risk_level</code> - Classification (LOW/MEDIUM/HIGH/CRITICAL) - <code>days_since_last_activity</code> - Days since last platform activity - <code>login_count_7d</code> - Login count in last 7 days - <code>login_trend</code> - Percentage change vs previous 7 days - <code>assignments_completed_7d</code> - Assignments completed in last 7 days - <code>assignment_trend</code> - Percentage change vs previous 7 days - <code>avg_frustration_score</code> - Average frustration from telemetry (if available) - <code>avg_engagement_score</code> - Average engagement from telemetry (if available) - <code>subscription_status</code> - Current subscription status - <code>days_until_renewal</code> - Days until next payment - <code>has_payment_issues</code> - Boolean flag for payment problems - <code>details</code> - JSONField with full metrics breakdown</p> <p>Indexes: - <code>(academy, report_date, risk_level)</code> - Filter high-risk users by academy - <code>(risk_level, report_date)</code> - Find all high-risk users - <code>(-churn_risk_score)</code> - Sort by risk - <code>(report_date, -churn_risk_score)</code> - Daily leaderboards</p> <p>Unique Constraint: <code>(user, report_date)</code> - One report per user per day</p>"},{"location":"LLM-DOCS/reports/#churnalert","title":"ChurnAlert","text":"<p>Stores triggered alerts when users cross risk thresholds.</p> <p>Key Fields: - <code>user</code> - ForeignKey to User - <code>academy</code> - ForeignKey to Academy (nullable) - <code>alert_type</code> - Type of alert (INACTIVITY, ENGAGEMENT_DROP, etc.) - <code>severity</code> - Alert severity (LOW/MEDIUM/HIGH/CRITICAL) - <code>triggered_at</code> - When alert was created - <code>resolved_at</code> - When alert was resolved (nullable) - <code>action_taken</code> - Text description of intervention (nullable) - <code>metrics_snapshot</code> - JSONField with metrics at alert time</p> <p>Alert Types: - <code>INACTIVITY</code> - User inactive for 7+ days - <code>ENGAGEMENT_DROP</code> - Login frequency dropped 50%+ - <code>HIGH_FRUSTRATION</code> - Frustration score &gt;= 70 - <code>PAYMENT_RISK</code> - Subscription in PAYMENT_ISSUE status - <code>TRIAL_EXPIRING</code> - Free trial expiring in 3 days without conversion</p> <p>Indexes: - <code>(academy, severity, -triggered_at)</code> - Find recent critical alerts - <code>(user, -triggered_at)</code> - User alert history - <code>(alert_type, -triggered_at)</code> - Alert type trends</p>"},{"location":"LLM-DOCS/reports/#usage-examples_1","title":"Usage Examples","text":""},{"location":"LLM-DOCS/reports/#generate-report","title":"Generate Report","text":"<pre><code># Generate yesterday's report\npython manage.py generate_report churn\n\n# Generate for specific academy\npython manage.py generate_report churn --academy 1\n\n# Backfill historical data\npython manage.py generate_report churn --days-back 90\n</code></pre>"},{"location":"LLM-DOCS/reports/#query-high-risk-users","title":"Query High-Risk Users","text":"<pre><code>from breathecode.monitoring.reports.churn.models import ChurnRiskReport\n\n# Get all critical risk users from today\ncritical_users = ChurnRiskReport.objects.filter(\n    report_date=date.today(),\n    risk_level=ChurnRiskReport.RiskLevel.CRITICAL\n).select_related('user', 'academy')\n\n# Get users with increasing risk trend\nfrom django.db.models import F\n\nincreasing_risk = ChurnRiskReport.objects.filter(\n    academy_id=1,\n    report_date__gte=date.today() - timedelta(days=7)\n).order_by('user_id', '-report_date').annotate(\n    risk_change=F('churn_risk_score') - F('previous_score')\n).filter(risk_change__gt=20)\n</code></pre>"},{"location":"LLM-DOCS/reports/#query-alerts","title":"Query Alerts","text":"<pre><code>from breathecode.monitoring.reports.churn.models import ChurnAlert\n\n# Get unresolved critical alerts\ncritical_alerts = ChurnAlert.objects.filter(\n    academy_id=1,\n    severity=ChurnAlert.Severity.CRITICAL,\n    resolved_at__isnull=True\n).select_related('user').order_by('-triggered_at')\n</code></pre>"},{"location":"LLM-DOCS/reports/#report-structure","title":"Report Structure","text":""},{"location":"LLM-DOCS/reports/#base-report-interface","title":"Base Report Interface","text":"<p>All reports must implement the <code>BaseReport</code> abstract class:</p> <pre><code>from breathecode.monitoring.reports.base import BaseReport\n\nclass MyReport(BaseReport):\n    report_type = \"my_report\"\n\n    def fetch_data(self) -&gt; dict[str, Any]:\n        \"\"\"Fetch raw data from BigQuery/database\"\"\"\n        pass\n\n    def process_data(self, raw_data: dict[str, Any]) -&gt; list[Any]:\n        \"\"\"Transform raw data into model instances\"\"\"\n        pass\n\n    def save_reports(self, reports: list[Any]) -&gt; int:\n        \"\"\"Bulk save to database. Returns count saved.\"\"\"\n        pass\n</code></pre>"},{"location":"LLM-DOCS/reports/#report-lifecycle","title":"Report Lifecycle","text":"<ol> <li>Initialization - Report instance created with <code>report_date</code> and optional <code>academy_id</code></li> <li>fetch_data() - Queries BigQuery/PostgreSQL for raw data</li> <li>process_data() - Transforms raw data into Django model instances</li> <li>save_reports() - Bulk creates/updates reports in database</li> <li>generate() - Orchestrates steps 2-4 and handles logging</li> </ol>"},{"location":"LLM-DOCS/reports/#logging","title":"Logging","text":"<p>Reports use Django management command's stdout for logging:</p> <pre><code>self.log(\"Processing started\", \"SUCCESS\")\nself.log(\"Warning message\", \"WARNING\")\nself.log(\"Error occurred\", \"ERROR\")\n</code></pre>"},{"location":"LLM-DOCS/reports/#adding-new-reports","title":"Adding New Reports","text":""},{"location":"LLM-DOCS/reports/#step-by-step-guide","title":"Step-by-Step Guide","text":""},{"location":"LLM-DOCS/reports/#1-create-report-module","title":"1. Create Report Module","text":"<p>Create directory structure:</p> <pre><code>mkdir -p breathecode/monitoring/reports/my_report\ntouch breathecode/monitoring/reports/my_report/__init__.py\ntouch breathecode/monitoring/reports/my_report/models.py\ntouch breathecode/monitoring/reports/my_report/actions.py\n</code></pre>"},{"location":"LLM-DOCS/reports/#2-define-models","title":"2. Define Models","text":"<p>Create models in <code>models.py</code>:</p> <pre><code>from django.db import models\nfrom django.contrib.auth.models import User\nfrom breathecode.admissions.models import Academy\n\nclass MyReport(models.Model):\n    user = models.ForeignKey(User, on_delete=models.CASCADE)\n    academy = models.ForeignKey(Academy, on_delete=models.CASCADE, null=True)\n    report_date = models.DateField(db_index=True)\n    metric1 = models.IntegerField()\n    metric2 = models.FloatField()\n    details = models.JSONField(default=dict)\n    created_at = models.DateTimeField(auto_now_add=True)\n\n    class Meta:\n        unique_together = [[\"user\", \"report_date\"]]\n        indexes = [\n            models.Index(fields=[\"academy\", \"report_date\"]),\n        ]\n</code></pre>"},{"location":"LLM-DOCS/reports/#3-implement-report-logic","title":"3. Implement Report Logic","text":"<p>Create report class in <code>actions.py</code>:</p> <pre><code>from typing import Any\nfrom breathecode.monitoring.reports.base import BaseReport\nfrom .models import MyReport\n\nclass MyReportGenerator(BaseReport):\n    report_type = \"my_report\"\n\n    def fetch_data(self) -&gt; dict[str, Any]:\n        # Query BigQuery or database\n        # Return dict with raw data\n        return {\"user_ids\": [...], \"metrics\": {...}}\n\n    def process_data(self, raw_data: dict[str, Any]) -&gt; list[MyReport]:\n        reports = []\n        for user_id, metrics in raw_data[\"metrics\"].items():\n            reports.append(MyReport(\n                user_id=user_id,\n                report_date=self.report_date,\n                metric1=metrics[\"metric1\"],\n                metric2=metrics[\"metric2\"],\n                details=metrics,\n            ))\n        return reports\n\n    def save_reports(self, reports: list[MyReport]) -&gt; int:\n        MyReport.objects.bulk_create(\n            reports,\n            update_conflicts=True,\n            unique_fields=[\"user\", \"report_date\"],\n            update_fields=[\"metric1\", \"metric2\", \"details\"]\n        )\n        return len(reports)\n</code></pre>"},{"location":"LLM-DOCS/reports/#4-register-report","title":"4. Register Report","text":"<p>Add to <code>generate_report.py</code>:</p> <pre><code>from breathecode.monitoring.reports.my_report.actions import MyReportGenerator\n\nREPORT_REGISTRY = {\n    \"churn\": ChurnReport,\n    \"my_report\": MyReportGenerator,  # Add here\n}\n</code></pre>"},{"location":"LLM-DOCS/reports/#5-register-models","title":"5. Register Models","text":"<p>Add imports to <code>breathecode/monitoring/models.py</code>:</p> <pre><code>from breathecode.monitoring.reports.my_report.models import MyReport\n\n__all__ = [\n    # ... existing models\n    \"MyReport\",\n]\n</code></pre>"},{"location":"LLM-DOCS/reports/#6-create-migration","title":"6. Create Migration","text":"<pre><code>python manage.py makemigrations monitoring --name add_my_report\npython manage.py migrate monitoring\n</code></pre>"},{"location":"LLM-DOCS/reports/#best-practices","title":"Best Practices","text":"<ol> <li>Use batch queries - Fetch all users in one BigQuery query</li> <li>Use bulk operations - <code>bulk_create</code> with <code>update_conflicts</code> for upserts</li> <li>Store computed metrics - Pre-calculate aggregations, not raw counts</li> <li>Index strategically - Add indexes for common query patterns</li> <li>Include details JSON - Store full breakdown for debugging/analysis</li> <li>Handle nulls gracefully - Use <code>COALESCE</code> in SQL, defaults in Python</li> <li>Log progress - Use <code>self.log()</code> for visibility during execution</li> </ol>"},{"location":"LLM-DOCS/reports/#best-practices_1","title":"Best Practices","text":""},{"location":"LLM-DOCS/reports/#cost-optimization","title":"Cost Optimization","text":"<ol> <li>Single Batch Query - Fetch all users in one BigQuery query, not per-user queries</li> <li>Partition by Date - Use BigQuery date partitioning to reduce scan costs</li> <li>Cluster by User - Cluster tables by <code>user_id</code> for faster filtering</li> <li>Store Aggregates - Store computed metrics, not raw activity counts</li> <li>Archive Old Data - Move reports older than 1 year to cold storage</li> </ol>"},{"location":"LLM-DOCS/reports/#performance","title":"Performance","text":"<ol> <li>Use Indexes - Index on <code>(academy, report_date, risk_level)</code> for common queries</li> <li>Bulk Operations - Use <code>bulk_create</code> instead of individual <code>save()</code> calls</li> <li>Select Related - Use <code>select_related()</code> when querying related models</li> <li>Limit Date Ranges - Query reasonable date ranges (last 30-90 days typically)</li> </ol>"},{"location":"LLM-DOCS/reports/#data-quality","title":"Data Quality","text":"<ol> <li>Handle Missing Data - Use <code>COALESCE</code> and defaults for null values</li> <li>Validate Calculations - Include sanity checks for calculated metrics</li> <li>Store Raw Details - Keep full breakdown in <code>details</code> JSONField for debugging</li> <li>Version Schema - Include <code>schema_version</code> field if report structure evolves</li> </ol>"},{"location":"LLM-DOCS/reports/#monitoring","title":"Monitoring","text":"<ol> <li>Dry Run First - Always test with <code>--dry-run</code> before production</li> <li>Monitor Execution Time - Track how long reports take to complete</li> <li>Check Error Rates - Monitor failed report generations</li> <li>Alert on Failures - Set up alerts if reports fail to generate</li> </ol>"},{"location":"LLM-DOCS/reports/#troubleshooting","title":"Troubleshooting","text":""},{"location":"LLM-DOCS/reports/#report-generation-fails","title":"Report Generation Fails","text":"<p>Issue: Command exits with error</p> <p>Solutions: - Check BigQuery credentials and permissions - Verify date format is valid (YYYY-MM-DD) - Check database connection - Review logs with <code>--verbosity 2</code></p>"},{"location":"LLM-DOCS/reports/#missing-data-in-reports","title":"Missing Data in Reports","text":"<p>Issue: Users missing from report</p> <p>Solutions: - Verify users have active subscriptions - Check BigQuery activity data exists for date range - Verify academy filter isn't excluding users - Check for data gaps in BigQuery (null academies, etc.)</p>"},{"location":"LLM-DOCS/reports/#slow-report-generation","title":"Slow Report Generation","text":"<p>Issue: Report takes too long to complete</p> <p>Solutions: - Use Performance dyno (more memory/CPU) - Reduce date range for backfills - Check BigQuery query performance - Optimize database indexes - Consider breaking into smaller batches</p>"},{"location":"LLM-DOCS/reports/#high-bigquery-costs","title":"High BigQuery Costs","text":"<p>Issue: Report queries are expensive</p> <p>Solutions: - Ensure BigQuery table is partitioned by date - Add clustering by <code>user_id</code> - Review query to ensure it's scanning minimal data - Use <code>SELECT</code> only needed columns - Cache frequently accessed data</p>"},{"location":"LLM-DOCS/reports/#related-documentation","title":"Related Documentation","text":"<ul> <li>Student Activity API - Activity tracking system</li> <li>Supervisors Documentation - Automated monitoring system</li> <li>Student Report API - Student data reporting</li> </ul>"},{"location":"LLM-DOCS/reports/#future-reports","title":"Future Reports","text":"<p>Planned report types:</p> <ul> <li>Engagement Report - User engagement trends and patterns</li> <li>Revenue Report - Subscription revenue, churn rates, LTV</li> <li>Cohort Health Report - Cohort-level metrics and progress</li> <li>Mentorship Report - Mentorship session utilization and effectiveness</li> </ul>"},{"location":"advanced/csv-export-customization/","title":"CSV Export Customization","text":""},{"location":"advanced/csv-export-customization/#overview","title":"Overview","text":"<p>The CSV export system now supports customizable field selection with labels, dot notation for related fields, and calculated properties/methods.</p>"},{"location":"advanced/csv-export-customization/#how-it-works","title":"How It Works","text":""},{"location":"advanced/csv-export-customization/#1-define-csv-fields-in-your-model","title":"1. Define CSV Fields in Your Model","text":"<p>Add a static method <code>get_csv_fields()</code> to your model that returns a list of tuples:</p> <pre><code>class EventCheckin(models.Model):\n    # ... fields ...\n\n    @staticmethod\n    def get_csv_fields():\n        \"\"\"\n        Define custom fields for CSV export with user-friendly labels.\n        Returns a list of tuples: (header_name, field_path)\n        \"\"\"\n        return [\n            ('ID', 'id'),                              # Simple field\n            ('Email', 'email'),                        # Simple field\n            ('Event Title', 'event.title'),            # Related field (dot notation)\n            ('Academy', 'event.academy.name'),         # Deep relation (dot notation)\n            ('Attendee Name', 'attendee_name'),        # Calculated property\n        ]\n\n    @property\n    def attendee_name(self):\n        \"\"\"Calculated field example\"\"\"\n        if self.attendee:\n            return f\"{self.attendee.first_name} {self.attendee.last_name}\".strip()\n        return ''\n</code></pre>"},{"location":"advanced/csv-export-customization/#2-field-types-supported","title":"2. Field Types Supported","text":""},{"location":"advanced/csv-export-customization/#simple-fields","title":"Simple Fields","text":"<pre><code>('Email', 'email')  # Direct model field\n</code></pre>"},{"location":"advanced/csv-export-customization/#related-fields-with-dot-notation","title":"Related Fields with Dot Notation","text":"<pre><code>('Event Title', 'event.title')              # One level deep\n('Academy', 'event.academy.name')           # Multiple levels deep\n('Attendee First Name', 'attendee.first_name')\n</code></pre>"},{"location":"advanced/csv-export-customization/#calculated-properties","title":"Calculated Properties","text":"<pre><code>('Attendee Name', 'attendee_name')  # References @property attendee_name\n\n@property\ndef attendee_name(self):\n    if self.attendee:\n        return f\"{self.attendee.first_name} {self.attendee.last_name}\".strip()\n    return ''\n</code></pre>"},{"location":"advanced/csv-export-customization/#methods-without-property","title":"Methods (without @property)","text":"<pre><code>('Status Text', 'get_status_display')  # Django's built-in method\n\ndef custom_method(self):\n    return \"calculated value\"\n</code></pre>"},{"location":"advanced/csv-export-customization/#3-csv-output","title":"3. CSV Output","text":"<p>The exported CSV will have: - Custom column headers (first item in tuple) - Related data resolved via dot notation - Calculated values from properties/methods - Null-safe handling (returns empty string for None values)</p> <p>Example output: <pre><code>ID,Email,Attendee First Name,Attendee Last Name,Attendee Name,Event ID,Event Slug,Event Title,Academy,Status,Created At,Attended At,UTM Source,UTM Medium,UTM Campaign\n1,john@example.com,John,Doe,John Doe,42,python-workshop,Python Workshop,Miami Campus,DONE,2024-01-15 10:30:00,2024-01-15 11:00:00,google,cpc,workshop\n</code></pre></p>"},{"location":"advanced/csv-export-customization/#benefits","title":"Benefits","text":"<ul> <li>\u2705 Custom Labels: User-friendly column names</li> <li>\u2705 Related Data: Access foreign key fields without joins</li> <li>\u2705 Calculated Fields: Include computed values</li> <li>\u2705 Flexible: Mix simple, related, and calculated fields</li> <li>\u2705 Backward Compatible: Falls back to all model fields if not defined</li> <li>\u2705 Clean Code: Everything in the model, no separate serializers needed</li> </ul>"},{"location":"advanced/csv-export-customization/#implementation-details","title":"Implementation Details","text":""},{"location":"advanced/csv-export-customization/#file-updates","title":"File Updates","text":"<ol> <li><code>breathecode/monitoring/actions.py</code></li> <li>Enhanced <code>download_csv()</code> function</li> <li>Supports tuple format <code>(header, field_path)</code></li> <li>Handles dot notation for related fields</li> <li> <p>Calls properties/methods for calculated fields</p> </li> <li> <p><code>breathecode/events/models.py</code></p> </li> <li>Added <code>get_csv_fields()</code> to <code>EventCheckin</code> model</li> <li>Added <code>attendee_name</code> property as example calculated field</li> </ol>"},{"location":"advanced/csv-export-customization/#example-eventcheckin-csv-export","title":"Example: EventCheckin CSV Export","text":"<p>When you export EventCheckin records via: <pre><code>GET /v1/events/academy/{academy_id}/checkin.csv\n</code></pre></p> <p>The system will: 1. Check if <code>EventCheckin.get_csv_fields()</code> exists 2. Use custom field definitions with labels 3. Resolve related fields (event.slug, event.academy.name, etc.) 4. Calculate properties (attendee_name) 5. Export to CSV with clean headers</p>"},{"location":"advanced/csv-export-customization/#adding-to-other-models","title":"Adding to Other Models","text":"<p>To enable custom CSV export for any model:</p> <pre><code>class MyModel(models.Model):\n    # ... fields ...\n\n    @staticmethod\n    def get_csv_fields():\n        return [\n            ('Custom Header', 'field_name'),\n            ('Related Field', 'foreign_key.field'),\n            ('Calculated', 'my_property'),\n        ]\n\n    @property\n    def my_property(self):\n        # Your calculation logic\n        return calculated_value\n</code></pre> <p>That's it! The CSV export will automatically use your custom configuration.</p>"},{"location":"advanced/supervisor/","title":"Supervisor","text":""},{"location":"advanced/supervisor/#overview","title":"Overview","text":"<p>The <code>@supervisor</code> and <code>@issue</code> decorators are part of a monitoring system that helps identify and automatically fix issues in the application. They work together to create a self-healing mechanism where:</p> <ol> <li><code>@supervisor</code> functions detect potential issues in the system</li> <li><code>@issue</code> handlers attempt to fix those issues automatically</li> </ol>"},{"location":"advanced/supervisor/#supervisor-decorator","title":"@supervisor Decorator","text":""},{"location":"advanced/supervisor/#purpose","title":"Purpose","text":"<p>The <code>@supervisor</code> decorator is used to create monitoring functions that periodically check for potential issues or anomalies in the system. These functions yield messages when they detect problems, which are then recorded in the database.</p>"},{"location":"advanced/supervisor/#syntax","title":"Syntax","text":"<pre><code>@supervisor(delta=timedelta(hours=6))\ndef supervise_something():\n    # Check for issues\n    if issue_detected:\n        # Simple message\n        yield \"Something is wrong\"\n\n        # Or with code and parameters for issue handlers\n        yield \"Specific issue description\", \"issue-code\", {\"param1\": value1, \"param2\": value2}\n</code></pre>"},{"location":"advanced/supervisor/#parameters","title":"Parameters","text":"<ul> <li><code>delta</code>: A <code>timedelta</code> object that specifies how often the supervisor should run. For example, <code>delta=timedelta(hours=6)</code> means the supervisor will run every 6 hours.</li> <li><code>auto</code>: Boolean that determines if the supervisor should run automatically (default is <code>True</code>).</li> <li><code>raises</code>: Boolean that determines if the supervisor should raise exceptions (default is <code>False</code>).</li> </ul>"},{"location":"advanced/supervisor/#return-value","title":"Return Value","text":"<p>A supervisor function should be a generator that yields:</p> <ul> <li>A simple string message describing the issue, or</li> <li>A tuple containing: 1. A string message, 2. An issue code, 3. A dictionary of parameters for the issue handler</li> </ul>"},{"location":"advanced/supervisor/#example","title":"Example","text":"<pre><code>@supervisor(delta=timedelta(minutes=10))\ndef supervise_pending_bags_to_be_delivered():\n    \"\"\"\n    Supervisor to check for bags that are paid but not delivered.\n    This helps identify issues in the subscription/plan financing creation process.\n    \"\"\"\n    utc_now = timezone.now()\n\n    # Filter bags that are paid but not delivered, updated between 5 and 30 minutes ago\n    pending_bags = Bag.objects.filter(\n        status=\"PAID\",\n        was_delivered=False,\n        updated_at__lte=utc_now - timedelta(minutes=30),\n        updated_at__gte=utc_now - timedelta(minutes=5),\n    )\n\n    for bag in pending_bags:\n        invoice = bag.invoices.filter(status=\"FULFILLED\").order_by(\"-paid_at\").first()\n        if invoice:\n            yield (\n                f\"Bag {bag.id} for user {bag.user.email} in academy {bag.academy.name} has not been delivered\",\n                \"pending-bag-delivery\",\n                {\"bag_id\": bag.id},\n            )\n</code></pre>"},{"location":"advanced/supervisor/#issue-decorator","title":"@issue Decorator","text":""},{"location":"advanced/supervisor/#purpose_1","title":"Purpose","text":"<p>The <code>@issue</code> decorator creates handler functions that attempt to fix issues detected by supervisors. When a supervisor yields an issue with a specific code, the corresponding issue handler is triggered to fix the problem.</p>"},{"location":"advanced/supervisor/#syntax_1","title":"Syntax","text":"<pre><code>@issue(supervisor_function, delta=timedelta(minutes=30), attempts=3)\ndef fix_specific_issue(param1, param2):\n    # Attempt to fix the issue\n    if issue_fixed:\n        return True  # Issue is fixed\n    elif issue_cannot_be_fixed:\n        return False  # Issue cannot be fixed\n    else:\n        return None  # Issue is not yet fixed, will retry later\n</code></pre>"},{"location":"advanced/supervisor/#parameters_1","title":"Parameters","text":"<ul> <li><code>supervisor_function</code>: The supervisor function that this issue handler is associated with.</li> <li><code>delta</code>: A <code>timedelta</code> object that specifies how often the issue handler should retry if the issue is not fixed.</li> <li><code>attempts</code>: The maximum number of attempts to fix the issue before giving up.</li> </ul>"},{"location":"advanced/supervisor/#parameters-passed-to-the-handler","title":"Parameters Passed to the Handler","text":"<p>The parameters passed to the issue handler function come from the third element of the tuple yielded by the supervisor function. These parameters should match the parameter names in the issue handler function signature.</p>"},{"location":"advanced/supervisor/#return-value_1","title":"Return Value","text":"<p>An issue handler function should return:</p> <ul> <li><code>True</code>: The issue is fixed</li> <li><code>False</code>: The issue cannot be fixed (will not retry)</li> <li><code>None</code>: The issue is not yet fixed (will retry later, up to the specified number of attempts)</li> </ul>"},{"location":"advanced/supervisor/#example_1","title":"Example","text":"<pre><code>@issue(supervise_pending_bags_to_be_delivered, delta=timedelta(minutes=30), attempts=3)\ndef pending_bag_delivery(bag_id: int):\n    \"\"\"\n    Issue handler for pending bag delivery.\n    This function is called when a bag is detected as paid but not delivered.\n    It will attempt to retry the delivery process.\n    \"\"\"\n    # Check if the bag still needs to be processed\n    bag = Bag.objects.filter(id=bag_id, status=\"PAID\", was_delivered=False).first()\n    if not bag:\n        # Bag was already delivered or doesn't exist, mark as fixed\n        return True\n\n    # Call the function to retry the delivery\n    res = retry_pending_bag(bag)\n\n    # Return True if the issue is fixed\n    if res in [\"scheduled\", \"done\"]:\n        return True\n\n    # Return None to retry later\n    return None\n</code></pre>"},{"location":"advanced/supervisor/#how-they-work-together","title":"How They Work Together","text":"<ol> <li>The <code>@supervisor</code> function runs periodically (based on its <code>delta</code> parameter) and checks for issues.</li> <li>When an issue is detected, the supervisor yields a message, code, and parameters.</li> <li>The system records this issue in the database.</li> <li>The <code>@issue</code> handler associated with the supervisor (matching the yielded code) is triggered.</li> <li>The issue handler receives the parameters yielded by the supervisor and attempts to fix the issue.</li> <li>If the issue handler returns <code>None</code>, it will be retried later (based on the handler's <code>delta</code> parameter).</li> <li>If the issue handler returns <code>True</code>, the issue is marked as fixed.</li> <li>If the issue handler returns <code>False</code>, the issue is marked as unfixable.</li> </ol>"},{"location":"advanced/supervisor/#benefits","title":"Benefits","text":"<ol> <li>Separation of Concerns: Supervisors focus on detecting issues, while issue handlers focus on fixing them.</li> <li>Automatic Healing: The system can automatically detect and fix common issues without manual intervention.</li> <li>Monitoring: Issues are recorded in the database, providing visibility into system health.</li> <li>Retry Logic: Issue handlers can retry fixing issues multiple times with configurable delays.</li> <li>Scalability: New supervisors and issue handlers can be added without modifying existing code.</li> </ol>"},{"location":"advanced/supervisor/#best-practices","title":"Best Practices","text":"<ol> <li>Keep supervisors focused on detecting specific types of issues.</li> <li>Make issue handlers idempotent (can be run multiple times safely).</li> <li>Use meaningful codes that clearly identify the type of issue.</li> <li>Include all necessary parameters in the supervisor's yield statement.</li> <li>Return appropriate values from issue handlers to indicate the status of the fix.</li> <li>Set appropriate <code>delta</code> values based on the urgency and frequency of the issue.</li> <li>Document the purpose and behavior of each supervisor and issue handler.</li> </ol>"},{"location":"advanced/supervisor/#implementation-details","title":"Implementation Details","text":"<p>The supervisors and issues are stored in the database using the <code>Supervisor</code> and <code>SupervisorIssue</code> models from the <code>breathecode.monitoring</code> app. These models track:</p> <ul> <li>When supervisors last ran</li> <li>What issues were detected</li> <li>Whether issues have been fixed</li> <li>How many times an issue has occurred</li> </ul> <p>The system automatically schedules supervisors to run based on their <code>delta</code> parameter and triggers issue handlers when issues are detected.</p>"},{"location":"advanced/supervisor/#creating-new-supervisors-and-issue-handlers","title":"Creating New Supervisors and Issue Handlers","text":"<p>To create a new supervisor and issue handler:</p> <ol> <li>Define a supervisor function decorated with <code>@supervisor</code> that yields issues.</li> <li>Define an issue handler function decorated with <code>@issue</code> that fixes the issues.</li> <li>Make sure the code in the supervisor's yield statement matches the name of the issue handler function (with hyphens instead of underscores).</li> <li>Ensure the parameters in the supervisor's yield statement match the parameters expected by the issue handler.</li> </ol>"},{"location":"advanced/supervisor/#example-use-cases","title":"Example Use Cases","text":"<ul> <li>Detecting and fixing stalled processes</li> <li>Identifying and resolving data inconsistencies</li> <li>Monitoring system resources and taking action when thresholds are exceeded</li> <li>Checking for failed operations and retrying them</li> <li>Detecting security issues and taking remedial action</li> </ul> <p>This monitoring and self-healing system helps maintain the health of the application by automatically detecting and fixing common issues, reducing the need for manual intervention and improving overall system reliability.</p>"},{"location":"advanced/celery/application/","title":"Application","text":"<p>Celery needs an object called application, this object is bound with a set of configurations like the Message Broker or task queue, theoretically you should have many celery apps and bound your tasks to one or many of those apps, actually we had not got any use to this feature and we rather use the shared_task decorator instead which just support one application.</p>"},{"location":"advanced/celery/application/#setting-up-an-application","title":"Setting up an application","text":"<p>Read this.</p>"},{"location":"advanced/celery/application/#where-is-the-application","title":"Where is the application?","text":"<p>It where in <code>breathecode/celery.py</code>.</p>"},{"location":"advanced/celery/canvas/","title":"Canvas","text":"<p>Canvas is a Celery feature that provides an API to design a workflow, some of them like calling many tasks in a group, or execute them in pipe is supported for this API.</p>"},{"location":"advanced/celery/canvas/#using-canvas","title":"Using canvas","text":"<p>Read this.</p>"},{"location":"advanced/celery/periodic-tasks/","title":"Periodic tasks","text":"<p>Celery allows configure some tasks to be executed repeatedly separate by a period of time, it usually did not use in favor of Django commands.</p>"},{"location":"advanced/celery/periodic-tasks/#setting-up-periodic-tasks","title":"Setting up periodic tasks","text":"<p>Read this.</p>"},{"location":"advanced/celery/routing/","title":"Routing","text":"<p>Celery allows set custom routing to call its tasks, it is usually used when you use Celery as a Message Broker, actually use Celery for this purpose is complicated because Celery does not support other Programming languages, so, you would have to use the Message Broker that Celery is using instead.</p>"},{"location":"advanced/celery/routing/#setting-up-routes","title":"Setting up routes","text":"<p>Read this.</p>"},{"location":"advanced/celery/settings/","title":"Settings","text":"<p>Here is all references about Celery.</p>"},{"location":"apps/activities/","title":"Activities","text":""},{"location":"apps/activities/#activity-api","title":"Activity API","text":"<p>This API uses Google DataStore as storage, there is not local storage on Heroku or Postgres.</p> <p>We need Google DataStore because we plan to store huge amounts of activities that the user can do inside breathecode.</p> <p>Possible activities (so far): <pre><code>\"breathecode_login\" //every time it logs in\n\"online_platform_registration\" //first day using breathecode\n\"public_event_attendance\" //attendy on an eventbrite event\n\"classroom_attendance\" //when the student attent to class\n\"classroom_unattendance\" //when the student miss class\n\"lesson_opened\" //when a lessons is opened on the platform\n\"office_attendance\" //when the office raspberry pi detects the student\n\"nps_survey_answered\" //when a nps survey is answered by the student\n\"exercise_success\" //when student successfully tests exercise\n</code></pre></p> <p>Any activity has the following inputs:</p> <pre><code>    'cohort',\n    'data',\n    'day',\n    'slug',\n    'user_agent',\n</code></pre>"},{"location":"apps/activities/#endpoints-for-the-user","title":"Endpoints for the user","text":"<p>Get recent user activity <pre><code>GET: activity/user/{email_or_id}?slug=activity_slug\n</code></pre></p> <p>Add a new user activity (requires authentication) <pre><code>POST: activity/user/{email_or_id}\n{\n    'slug' =&gt; 'activity_slug',\n    'data' =&gt; 'any aditional data (string or json-encoded-string)'\n}\n\n\ud83d\udca1 Node: You can pass the cohort in the data json object and it will be possible to filter on the activity graph like this:\n\n{\n    'slug' =&gt; 'activity_slug',\n    'data' =&gt; \"{ \\\"cohort\\\": \\\"mdc-iii\\\" }\" (json encoded string with the cohort id)\n}\n</code></pre></p> <p>Endpoints for the Cohort</p> <p>Get recent user activity <pre><code>GET: activity/cohort/{slug_or_id}?slug=activity_slug\n</code></pre> Endpoints for the coding_error's <pre><code>Get recent user coding_errors\nGET: activity/coding_error/{email_or_id}?slug=activity_slug\n</code></pre> <pre><code>Add a new coding_error (requires authentication)\nPOST: activity/coding_error/\n\n{\n    \"user_id\" =&gt; \"my@email.com\",\n    \"slug\" =&gt; \"webpack_error\",\n    \"data\" =&gt; \"optional additional information about the error\",\n    \"message\" =&gt; \"file not found\",\n    \"name\" =&gt; \"module-not-found,\n    \"severity\" =&gt; \"900\",\n    \"details\" =&gt; \"stack trace for the error as string\"\n}\n</code></pre></p>"},{"location":"apps/admissions/","title":"4Geeks.Admissions","text":"<p>This module take care of the academic side of breathecode: Students, Cohorts, Course (aka: Certificate), Syllabus, etc. These are some of the things you can do with the breathecode.admissions API:</p> <ol> <li>Manage Academies (4Geeks let's you divide the academic operations into several academies normally based on territory, for example: 4Geeks Academy Miami vs 4Geeks Academy Madrid).</li> <li>Manage Academy Staff: There are multiple roles surroing an academy, here you can invite users to one or many academies and assign them roles based on their responsabilities.</li> <li>Manage Students (invite and delete students).</li> <li>Manage Cohorts: Every new batch of students that starts in a classroom with a start and end date is called a \"Cohort\".</li> </ol> <p>TODO: finish this documentation.</p>"},{"location":"apps/admissions/#commands","title":"Commands","text":""},{"location":"apps/admissions/#sync-academies","title":"Sync academies","text":"<pre><code>python manage.py sync_admissions academies\n</code></pre> <p>Override previous academies <pre><code>python manage.py sync_admissions academies --override\n</code></pre></p>"},{"location":"apps/admissions/#sync-courses","title":"Sync courses","text":"<pre><code>python manage.py sync_admissions certificates\n</code></pre>"},{"location":"apps/admissions/#sync-cohorts","title":"Sync cohorts","text":"<pre><code>python manage.py sync_admissions cohorts\n</code></pre>"},{"location":"apps/admissions/#sync-students","title":"Sync students","text":"<p><pre><code>python manage.py sync_admissions students --limit=3\n</code></pre> Limit: the number of students to sync</p>"},{"location":"apps/monitoring/introduction/","title":"Intro to monitoring","text":"<p>This app is ideal for running diagnostic and reminders on the breathecode platform.</p>"},{"location":"apps/monitoring/introduction/#installation","title":"Installation","text":"<ul> <li> <p>Setup the monitor app job for once a day, this is the command: <pre><code>$ python manage.py monitor apps\n</code></pre></p> </li> <li> <p>Setup the monitor script job for once a day, this is the command: <pre><code>$ python manage.py monitor script\n</code></pre></p> </li> </ul>"},{"location":"apps/monitoring/scripts/","title":"Monitoring Scripts","text":"<p>A monitoring script is something that you want to execute recurrently withing the breathecode API, for example:</p> <p><code>scripts/alert_pending_leads.py</code> is a small python script that checks if there is FormEntry Marketing module database that are pending processing.</p> <p>You can create a monitoring script to remind academy staff members about things, or to remind students about pending homework, etc.</p>"},{"location":"apps/monitoring/scripts/#stepts-to-create-a-new-script","title":"Stepts to create a new script:","text":"<ol> <li>create a new python file inside <code>./breathecode/monitoring/scripts</code></li> <li>make sure your script starts with this content always:</li> </ol> <pre><code>#!/usr/bin/env python\n\"\"\"\nAlert when there are Form Entries with status = PENDING\n\"\"\"\nfrom breathecode.utils import ScriptNotification\n# start your code here\n</code></pre> <ol> <li>You have access to the entire breathecode API from here, you can import models, services or any other class or variable from any file.</li> <li>You can raise a <code>ScriptNotification</code> to notify for <code>MINOR</code> or <code>CRITICAL</code> reasons, for example:</li> </ol> <p><pre><code># here we are raising a notification because there are 2 pending tasks\nraise ScriptNotification(\"There are 2 pending taks\", status='MINOR', slug=\"pending_tasks\")\n</code></pre> 5. If you don't raise any ScriptNotification and there are no other Exceptions in the script, it will be considered successfull and no notifications will trigger. 6. When a ScriptNotification has been raise the Application owner will receive a notification to the application.email and slack channel configured for notifications. 7. Check for other scripts as examples. 8. Test your script.</p>"},{"location":"apps/monitoring/scripts/#global-context","title":"Global Context","text":"<p>There are some global variables that you have available during your scripts:</p> Variable name Value academy Contains the academy model object, you can use it to retrieve the current academy id like this: <code>query.filter(academy__id=academy.id)</code>"},{"location":"apps/monitoring/scripts/#manually-running-your-script","title":"Manually running your script","text":"<p>You can test your scripts by running the following command:</p> <pre><code>$ python manage.py run_script &lt;file_name&gt;\n\n# For example you can test the alert_pending_leads script like this:\n$ python manage.py run_script alert_pending_leads.py\n</code></pre>"},{"location":"apps/monitoring/scripts/#example-script","title":"Example Script","text":"<p>The following script checks for pending leads to process:</p> <pre><code>#!/usr/bin/env python\n\"\"\"\nAlert when there are Form Entries with status = PENDING\n\"\"\"\nfrom breathecode.marketing.models import FormEntry\nfrom django.db.models import Q\nfrom breathecode.utils import ScriptNotification\n\n# check the database for pending leads\npending_leads = FormEntry.objects.filter(storage_status=\"PENDING\").filter(Q(academy__id=academy.id) | Q(location=academy.slug))\n\n# trigger notification because pending leads were found\nif len(pending_leads) &gt; 0:\n    raise ScriptNotification(f\"Warning there are {len(pending_leads)} pending form entries\", status='MINOR')\n\n# You can print this and it will show on the script results\nprint(\"No pending leads\")\n</code></pre>"},{"location":"apps/monitoring/scripts/#unit-testing-your-script","title":"Unit testing your script","text":"<p>from breathecode.monitoring.actions import run_script</p> <pre><code>script = run_script(model.monitor_script)\n\ndel script['slack_payload']\ndel script['title']\n\nexpected = {'details': script['details'],\n            'severity_level': 5,\n            'status': script['status'],\n            'text': script['text']\n            }\n\nself.assertEqual(script, expected)\n\nself.assertEqual(self.all_monitor_script_dict(), [{\n    **self.model_to_dict(model, 'monitor_script'),\n}])\n</code></pre>"},{"location":"deployment/configuring-the-github-secrets/","title":"Configuring the Github secrets","text":"<ol> <li>Get Dockerhub token    </li> <li>Add the repo to Coveralls https://coveralls.io/repos/new</li> <li>Add the repo to Codecov https://app.codecov.io/gh/+</li> <li>Set up the secrets    </li> </ol>"},{"location":"deployment/environment-variables/","title":"Environment variables","text":"name description ENV Represents the current environment, can be <code>DEVELOPMENT</code>, <code>TEST</code>, and <code>PRODUCTION</code> LOG_LEVEL Represents the log level for the logging module, can be <code>NOTSET</code>, <code>DEBUG</code>, <code>INFO</code>, <code>WARNING</code>, <code>ERROR</code> and <code>CRITICAL</code> DATABASE_URL Represents the connection string to the database, you can read more about schema url CACHE_MIDDLEWARE_MINUTES Represents how long an item will last in the cache API_URL Represents the url of api rest ADMIN_URL Represents the url of frontend of the admin APP_URL Represents the url of frontend of the webside REDIS_URL Represents the url of Redis CELERY_TASK_SERIALIZER Represents the default serialization method to use. Can be pickle <code>json</code>, <code>yaml</code>, <code>msgpack</code> or any custom serialization methods EMAIL_NOTIFICATIONS_ENABLED Represents if the server can send notifications through email SYSTEM_EMAIL Represents the email of <code>Breathecode</code> for support GITHUB_CLIENT_ID Represents the client id used for the OAuth2 with <code>Github</code> GITHUB_SECRET Represents the secret used for the OAuth2 with <code>Github</code> GITHUB_REDIRECT_URL Represents the redirect url used for the OAuth2 with <code>Github</code> SLACK_CLIENT_ID Represents the client id used for the OAuth2 with <code>Slack</code> SLACK_SECRET Represents the secret used for the OAuth2 with <code>Slack</code> SLACK_REDIRECT_URL Represents the redirect url used for the OAuth2 with <code>Slack</code> MAILGUN_API_KEY Represents the api key used for the OAuth2 with <code>Mailgun</code> MAILGUN_DOMAIN Represents the domain of Breathecode that provided <code>Mailgun</code> EVENTBRITE_KEY Represents the key used for the OAuth2 with <code>Eventbrite</code> FACEBOOK_VERIFY_TOKEN Represents the verify token used for the OAuth2 with <code>Facebook</code> FACEBOOK_CLIENT_ID Represents the client id used for the OAuth2 with <code>Facebook</code> FACEBOOK_SECRET Represents the secret used for the OAuth2 with <code>Facebook</code> FACEBOOK_REDIRECT_URL Represents the redirect url used for the OAuth2 with <code>Facebook</code> ACTIVE_CAMPAIGN_KEY Represents the key used for the OAuth2 with <code>Active Campaign</code> ACTIVE_CAMPAIGN_URL Represents the domain of Breathecode that provided <code>Active Campaign</code> GOOGLE_APPLICATION_CREDENTIALS Represents the file will be saved the service account of <code>Google Cloud</code> GOOGLE_SERVICE_KEY Represents the content of the service account used for the OAuth2 with <code>Google Cloud</code> GOOGLE_PROJECT_ID Project ID on google cloud used for the integration of the entire API GOOGLE_CLOUD_KEY Represents the key used for the OAuth2 with <code>Google Cloud</code> GOOGLE_CLIENT_ID Represents the client id used for the OAuth2 with <code>Google Cloud</code> GOOGLE_SECRET Represents the secret used for the OAuth2 with <code>Google Cloud</code> GOOGLE_REDIRECT_URL Represents the redirect url used for the OAuth2 with <code>Google Cloud</code> DAILY_API_KEY Represents the api key used for the OAuth2 with <code>Daily</code> DAILY_API_URL Represents the domain of Breathecode that provided <code>Daily</code> SAVE_LEADS Represents if Breathecode will persist the leads COMPANY_NAME Represents the company name COMPANY_CONTACT_URL Represents the company contact url COMPANY_LEGAL_NAME Represents the company legal name COMPANY_ADDRESS Represents the company address MEDIA_GALLERY_BUCKET Represents the bucket for the media gallery DOWNLOADS_BUCKET Represents the bucket for the CSV files PROFILE_BUCKET Represents the bucket for profile avatars"},{"location":"essential/academy-owner/","title":"Academy Owner Field","text":""},{"location":"essential/academy-owner/#overview","title":"Overview","text":"<p>The <code>owner</code> field has been added to the <code>Academy</code> model to explicitly track who owns/manages each academy.</p>"},{"location":"essential/academy-owner/#model-field","title":"Model Field","text":"<pre><code>class Academy(models.Model):\n    # ... other fields ...\n\n    owner = models.ForeignKey(\n        User,\n        on_delete=models.SET_NULL,\n        null=True,\n        blank=True,\n        default=None,\n        related_name=\"owned_academies\",\n        help_text=\"Primary owner of the academy, typically the first admin with role 'admin'\",\n        db_index=True,\n    )\n</code></pre>"},{"location":"essential/academy-owner/#how-it-works","title":"How It Works","text":""},{"location":"essential/academy-owner/#automatic-population","title":"Automatic Population","text":"<p>The owner is automatically set to the first active admin from <code>ProfileAcademy</code> for that academy:</p> <pre><code>from breathecode.authenticate.models import ProfileAcademy, Role\n\n# Find first admin for an academy\nfirst_admin = ProfileAcademy.objects.filter(\n    academy=academy,\n    role__slug='admin',\n    status='ACTIVE'\n).order_by('created_at').first()\n\nacademy.owner = first_admin.user\nacademy.save()\n</code></pre>"},{"location":"essential/academy-owner/#management-command","title":"Management Command","text":"<p>To populate or update academy owners:</p> <pre><code># Populate owners for all academies\npoetry run python manage.py populate_academy_owners\n\n# Force update even if owner is already set\npoetry run python manage.py populate_academy_owners --force\n</code></pre>"},{"location":"essential/academy-owner/#usage","title":"Usage","text":""},{"location":"essential/academy-owner/#get-academy-owner","title":"Get Academy Owner","text":"<pre><code>from breathecode.admissions.models import Academy\n\nacademy = Academy.objects.get(slug='downtown-miami')\nif academy.owner:\n    print(f\"Owner: {academy.owner.email}\")\n    print(f\"Name: {academy.owner.first_name} {academy.owner.last_name}\")\n</code></pre>"},{"location":"essential/academy-owner/#get-all-academies-owned-by-a-user","title":"Get All Academies Owned by a User","text":"<pre><code>from django.contrib.auth.models import User\n\nuser = User.objects.get(email='aalejo@gmail.com')\nowned_academies = user.owned_academies.all()\n\nfor academy in owned_academies:\n    print(f\"- {academy.name}\")\n</code></pre>"},{"location":"essential/academy-owner/#filter-academies-by-owner","title":"Filter Academies by Owner","text":"<pre><code># Get all academies owned by a specific user\nacademies = Academy.objects.filter(owner__email='aalejo@gmail.com')\n\n# Get academies without an owner\nunowned = Academy.objects.filter(owner__isnull=True)\n</code></pre>"},{"location":"essential/academy-owner/#migrations","title":"Migrations","text":"<p>Two migrations were created:</p> <ol> <li>0005_add_owner_to_academy.py - Adds the owner field to the Academy model</li> <li>0006_populate_academy_owner.py - Data migration to populate existing academies</li> </ol> <p>The data migration runs automatically and populates the owner field based on the first active admin from ProfileAcademy.</p>"},{"location":"essential/academy-owner/#fixture-loading","title":"Fixture Loading","text":"<p>When using the integrated fixture loading command, academy owners are automatically populated:</p> <pre><code>poetry run python manage.py load_dev_fixtures --flush\n</code></pre> <p>This command automatically: 1. Loads user fixtures 2. Loads academy fixtures 3. Creates ProfileAcademy relationships 4. Populates academy owners</p>"},{"location":"essential/academy-owner/#important-notes","title":"Important Notes","text":"<ol> <li> <p>Nullable Field: The owner field is nullable (<code>null=True, blank=True</code>) so academies without admins won't cause errors.</p> </li> <li> <p>SET_NULL on Delete: If the owner user is deleted, the owner field is set to NULL (<code>on_delete=models.SET_NULL</code>), preserving the academy.</p> </li> <li> <p>First Admin Logic: The owner is determined by the earliest created ProfileAcademy record with role='admin' and status='ACTIVE'.</p> </li> <li> <p>Manual Override: You can manually set any user as the owner through Django admin or code:    <pre><code>academy.owner = some_user\nacademy.save()\n</code></pre></p> </li> </ol>"},{"location":"essential/academy-owner/#api-access","title":"API Access","text":"<p>The owner can be included in API responses by adding it to serializers:</p> <pre><code>from breathecode.authenticate.serializers import UserSmallSerializer\n\nclass AcademySerializer(serpy.Serializer):\n    id = serpy.Field()\n    name = serpy.Field()\n    slug = serpy.Field()\n    owner = UserSmallSerializer(required=False)\n</code></pre>"},{"location":"essential/academy-owner/#related-models","title":"Related Models","text":"<ul> <li>ProfileAcademy: Links users to academies with specific roles</li> <li>Role: Defines capabilities (admin, staff, student, etc.)</li> <li>AcademyAuthSettings: Contains technical owners for GitHub/Google Cloud integrations</li> </ul>"},{"location":"essential/academy-owner/#see-also","title":"See Also","text":"<ul> <li>ProfileAcademy Documentation</li> <li>Roles and Capabilities</li> <li>Fixture Loading</li> </ul>"},{"location":"essential/aiohttp/","title":"AIOHTTP","text":"<p>AIOHTTP is an HTTP library that only supports asynchronous code, this library offers better performance today <code>01-23-24</code>.</p> <ul> <li>Follow this tutorial.</li> </ul>"},{"location":"essential/aiohttp/#when-use-it","title":"When use it","text":"<p>When you need to make a request within a Django Rest View, I do not have sufficient data to say if should be useful to use AIOHTTP within Celery <code>01-23-24</code>.</p>"},{"location":"essential/requests/","title":"Requests","text":"<p>Requests is an HTTP library that only supports synchronous code, this is the most popular choice due to its API and is the oldest library (among AIOHTTP, HTTPX and Requests).</p> <ul> <li>Follow this tutorial.</li> </ul>"},{"location":"essential/requests/#when-use-it","title":"When use it","text":"<p>Celery does not have good support for asyncronomous code, I do not know which option is better between Requests and AIOHTTP, I suggest you that you chose Requests until we have a study.</p>"},{"location":"essential/role-hierarchy/","title":"Role Hierarchy and Priorities","text":""},{"location":"essential/role-hierarchy/#overview","title":"Overview","text":"<p>The BreatheCode API uses a role-based access control system where roles can inherit capabilities from other roles. This creates a hierarchy that determines permission levels and role upgrade logic.</p>"},{"location":"essential/role-hierarchy/#role-priority-calculation","title":"Role Priority Calculation","text":"<p>Role priorities are automatically calculated from the role inheritance hierarchy defined in <code>breathecode/authenticate/role_definitions.py</code>. Higher priority means more permissions.</p>"},{"location":"essential/role-hierarchy/#how-priority-is-calculated","title":"How Priority is Calculated","text":"<p>Priority is calculated as the depth in the inheritance tree:</p> <ul> <li>Base roles (don't extend anything): Priority = 1</li> <li>Extended roles: Priority = 1 + max(parent priorities)</li> </ul>"},{"location":"essential/role-hierarchy/#example-hierarchy","title":"Example Hierarchy","text":"<pre><code>student (priority 1)\n  \u2514\u2500 (base role, no inheritance)\n\nstaff (priority 1)\n  \u2514\u2500 (base role, no inheritance)\n    \u2514\u2500 assistant (priority 2)\n       \u251c\u2500 homework_reviewer (priority 3)\n       \u2514\u2500 teacher (priority 3)\n          \u2514\u2500 academy_coordinator (priority 4)\n             \u2514\u2500 country_manager (priority 5)\n</code></pre>"},{"location":"essential/role-hierarchy/#profileacademy-role-management","title":"ProfileAcademy Role Management","text":"<p>When a user is added to a cohort or academy, the system ensures:</p> <ol> <li>One ProfileAcademy per user per academy (no duplicates)</li> <li>Automatic role upgrades based on priority</li> <li>No downgrades - higher roles are preserved</li> </ol>"},{"location":"essential/role-hierarchy/#upgrade-logic","title":"Upgrade Logic","text":"<pre><code>if new_priority &gt; current_priority:\n    # Upgrade to the higher role\n    profile.role = new_role\nelse:\n    # Keep the current higher role\n    pass\n</code></pre>"},{"location":"essential/role-hierarchy/#examples","title":"Examples","text":"Current Role New Role Action Reason student (1) teacher (3) \u2713 Upgrade Teacher has higher priority assistant (2) teacher (3) \u2713 Upgrade Teacher has higher priority teacher (3) student (1) \u2717 Keep teacher Teacher has higher priority homework_reviewer (3) teacher (3) \u2717 Keep current Same priority"},{"location":"essential/role-hierarchy/#implementation","title":"Implementation","text":""},{"location":"essential/role-hierarchy/#central-role-definitions","title":"Central Role Definitions","text":"<p>All roles and capabilities are defined in: <pre><code>breathecode/authenticate/role_definitions.py\n</code></pre></p> <p>This module provides: - <code>CAPABILITIES</code>: List of all system capabilities - <code>BASE_ROLES</code>: Foundation roles without inheritance - <code>get_extended_roles()</code>: Complete role list with inheritance - <code>get_role_priority(role_slug)</code>: Calculate priority for a role - <code>get_all_role_priorities()</code>: Get priorities for all roles</p>"},{"location":"essential/role-hierarchy/#usage-in-code","title":"Usage in Code","text":"<pre><code>from breathecode.authenticate.role_definitions import get_role_priority\n\n# Get priority of a role\npriority = get_role_priority(\"teacher\")  # Returns 3\n\n# Compare roles for upgrade decision\ncurrent_priority = get_role_priority(current_role.slug)\nnew_priority = get_role_priority(new_role_slug)\n\nif new_priority &gt; current_priority:\n    # Perform upgrade\n    profile.role = new_role\n</code></pre>"},{"location":"essential/role-hierarchy/#tasks-using-role-priority","title":"Tasks Using Role Priority","text":"<ol> <li><code>build_cohort_user</code> (<code>breathecode/admissions/tasks.py</code>)</li> <li>Called when a CohortUser is created</li> <li>Maps CohortUser role to ProfileAcademy role</li> <li> <p>Upgrades profile role if needed</p> </li> <li> <p><code>build_profile_academy</code> (<code>breathecode/admissions/tasks.py</code>)</p> </li> <li>Called to create or update ProfileAcademy</li> <li>Uses role priority to prevent downgrades</li> </ol>"},{"location":"essential/role-hierarchy/#role-mapping","title":"Role Mapping","text":""},{"location":"essential/role-hierarchy/#cohortuser-profileacademy","title":"CohortUser \u2192 ProfileAcademy","text":"<p>The mapping between CohortUser roles and ProfileAcademy role slugs is defined in the <code>CohortUser</code> model itself:</p> <pre><code># In breathecode/admissions/models.py\nclass CohortUser(models.Model):\n    ROLE_TO_PROFILE_ACADEMY_SLUG = {\n        TEACHER: \"teacher\",\n        ASSISTANT: \"assistant\",\n        REVIEWER: \"homework_reviewer\",\n        STUDENT: \"student\",\n    }\n\n    def get_profile_academy_role_slug(self) -&gt; str:\n        \"\"\"Get the ProfileAcademy role slug for this CohortUser's role.\"\"\"\n        return self.ROLE_TO_PROFILE_ACADEMY_SLUG.get(self.role, \"student\")\n\n    @classmethod\n    def map_role_to_profile_academy_slug(cls, cohort_user_role: str) -&gt; str:\n        \"\"\"Map a CohortUser role to its ProfileAcademy role slug.\"\"\"\n        return cls.ROLE_TO_PROFILE_ACADEMY_SLUG.get(cohort_user_role, \"student\")\n</code></pre> <p>When a user is added to a cohort:</p> CohortUser Role ProfileAcademy Role Priority STUDENT student 1 ASSISTANT assistant 2 REVIEWER homework_reviewer 3 TEACHER teacher 3"},{"location":"essential/role-hierarchy/#using-the-mapping","title":"Using the Mapping","text":"<pre><code># Instance method - when you have a CohortUser instance\ncohort_user = CohortUser.objects.get(id=123)\nrole_slug = cohort_user.get_profile_academy_role_slug()\n\n# Class method - when you have a role string\nrole_slug = CohortUser.map_role_to_profile_academy_slug(\"TEACHER\")  # Returns \"teacher\"\n</code></pre>"},{"location":"essential/role-hierarchy/#benefits","title":"Benefits","text":""},{"location":"essential/role-hierarchy/#single-source-of-truth","title":"Single Source of Truth","text":"<ul> <li>Role definitions in one place</li> <li>No hardcoded priority mappings</li> <li>Easy to add new roles</li> </ul>"},{"location":"essential/role-hierarchy/#automatic-priority","title":"Automatic Priority","text":"<ul> <li>Priority derived from inheritance</li> <li>No manual priority assignment</li> <li>Consistent across the system</li> </ul>"},{"location":"essential/role-hierarchy/#maintainability","title":"Maintainability","text":"<ul> <li>Adding a new role automatically calculates its priority</li> <li>Changes to inheritance automatically update priorities</li> <li>Clear relationship between roles</li> </ul>"},{"location":"essential/role-hierarchy/#adding-new-roles","title":"Adding New Roles","text":"<p>To add a new role:</p> <ol> <li>Edit <code>breathecode/authenticate/role_definitions.py</code></li> <li>Add to <code>get_extended_roles()</code> function:    <pre><code>roles.append({\n    \"slug\": \"new_role\",\n    \"name\": \"New Role\",\n    \"extends\": [\"parent_role\"],  # Optional\n    \"caps\": extend(roles, [\"parent_role\"]) + [\n        \"additional_capability\",\n    ],\n})\n</code></pre></li> <li>Run the management command:    <pre><code>python manage.py create_academy_roles\n</code></pre></li> <li>Priority is automatically calculated based on inheritance</li> </ol>"},{"location":"essential/role-hierarchy/#testing","title":"Testing","text":"<p>To verify role priorities are calculated correctly:</p> <pre><code>from breathecode.authenticate.role_definitions import get_all_role_priorities\n\npriorities = get_all_role_priorities()\nprint(priorities)\n# {'student': 1, 'staff': 1, 'assistant': 2, 'teacher': 3, ...}\n</code></pre>"},{"location":"essential/role-hierarchy/#security-considerations","title":"Security Considerations","text":"<ul> <li>Role upgrades are one-way (cannot downgrade automatically)</li> <li>System prevents creating duplicate ProfileAcademy records</li> <li>Role changes trigger signals for audit logging</li> <li>Priority calculation is deterministic and transparent</li> </ul>"},{"location":"essential/serpy/","title":"Serpy","text":"<p>Serpy in which it is:</p> <ul> <li>Faster serializer.</li> <li>Easy to use.</li> <li>It includes custom fields.</li> <li>It includes dynamic field resolution.</li> </ul> <p>It is weak in:</p> <ul> <li>Telling Django which fields include and which do not on the ORM.</li> </ul>"},{"location":"essential/serpy/#when-uses-serpy","title":"When uses Serpy?","text":"<p>When you need to serialize and GET request.</p>"},{"location":"essential/serpy/#when-does-not-use-serpy","title":"When does not use Serpy?","text":"<p>When you need the serialize to create or update a row in the database, it is in the POST and PUT methods, you must use DRF Serializer instead.</p>"},{"location":"essential/serpy/#fields","title":"fields","text":"<p>Read this.</p>"},{"location":"essential/serpy/#custom-fields","title":"Custom fields","text":"<p>Read this.</p>"},{"location":"essential/serpy/#related-articles","title":"Related articles","text":"<ul> <li>HTTP.</li> <li>REST.</li> </ul>"},{"location":"essential/webhook-auto-registration/","title":"Webhook Auto-Registration System","text":""},{"location":"essential/webhook-auto-registration/#overview","title":"Overview","text":"<p>The BreatheCode API includes an auto-registration system for webhook receivers that eliminates the need to write boilerplate code for standard webhook events. Instead of manually creating receiver functions, you can configure events in <code>settings.HOOK_EVENTS_METADATA</code> and they will be automatically registered.</p>"},{"location":"essential/webhook-auto-registration/#benefits","title":"Benefits","text":"<ol> <li>Single Source of Truth: All webhook configuration in one place</li> <li>Less Boilerplate: No need to write repetitive receiver functions</li> <li>Consistency: All auto-registered receivers follow the same pattern</li> <li>Maintainability: Add new webhooks by just adding metadata</li> <li>Documentation: Metadata serves as inline documentation</li> </ol>"},{"location":"essential/webhook-auto-registration/#how-it-works","title":"How It Works","text":""},{"location":"essential/webhook-auto-registration/#1-configuration-breathecodenotifyutilshook_eventspy","title":"1. Configuration (<code>breathecode/notify/utils/hook_events.py</code>)","text":"<p>Define webhook events in <code>HOOK_EVENTS_METADATA</code> (imported into settings.py):</p> <pre><code>HOOK_EVENTS_METADATA = {\n    \"assignment.assignment_created\": {\n        # Required by Django REST Hooks\n        \"action\": \"assignments.Task.assignment_created\",\n\n        # For API documentation and filtering\n        \"category\": \"assignments\",\n        \"description\": \"Triggered when a new assignment is created for a student\",\n        \"model\": \"assignments.Task\",\n\n        # For auto-registration (all three required)\n        \"signal\": \"breathecode.assignments.signals.assignment_created\",\n        \"sender\": \"breathecode.assignments.models.Task\",\n        \"serializer\": \"breathecode.assignments.serializers.TaskHookSerializer\",\n        \"event_action\": \"assignment_created\",\n    },\n}\n</code></pre>"},{"location":"essential/webhook-auto-registration/#2-auto-registration-breathecodenotifyutilsauto_register_hookspy","title":"2. Auto-Registration (<code>breathecode/notify/utils/auto_register_hooks.py</code>)","text":"<p>The system automatically: 1. Imports the signal and sender model 2. Creates a receiver function 3. Connects it to the signal 4. Handles serialization and payload delivery</p>"},{"location":"essential/webhook-auto-registration/#3-initialization-breathecodenotifyappspy","title":"3. Initialization (<code>breathecode/notify/apps.py</code>)","text":"<p>Receivers are registered when Django starts:</p> <pre><code>def ready(self):\n    from . import receivers  # Manual receivers\n    from .utils.auto_register_hooks import auto_register_webhook_receivers\n\n    auto_register_webhook_receivers()  # Auto-register from metadata\n</code></pre>"},{"location":"essential/webhook-auto-registration/#configuration-fields","title":"Configuration Fields","text":""},{"location":"essential/webhook-auto-registration/#required-fields-for-all-events","title":"Required Fields (for all events)","text":"Field Description Example <code>action</code> Django REST Hooks action string <code>\"assignments.Task.created+\"</code> <code>description</code> Human-readable description <code>\"Triggered when...\"</code> <code>app</code> App name (auto-derived from action) <code>\"assignments\"</code> <code>model</code> Source model (auto-derived from action) <code>\"assignments.Task\"</code>"},{"location":"essential/webhook-auto-registration/#optional-fields-for-auto-registration","title":"Optional Fields (for auto-registration)","text":"Field Description Required for Auto-Reg <code>signal</code> Import path to Django signal Auto-derived\u2020 <code>sender</code> Import path to sender model Auto-derived\u2020 <code>serializer</code> Import path to serializer class No* <code>event_action</code> Action name for HookManager Auto-derived\u2020 <code>auto_register</code> Set to <code>False</code> to skip No <p>* If no serializer is provided, raw instance data is sent</p> <p>\u2020 All auto-derived from the action string if not explicitly provided. The system converts: <pre><code>From action: \"app.Model.signal_name\"\n\nAuto-derived:\n- signal       \u2192 \"breathecode.app.signals.signal_name\"\n- sender       \u2192 \"breathecode.app.models.Model\"\n- event_action \u2192 \"signal_name\"\n</code></pre></p> <p>Only specify these explicitly when: - Signal name differs from action (e.g., <code>student_edu_status_updated</code> vs <code>edu_status_updated</code>) - You need custom behavior</p>"},{"location":"essential/webhook-auto-registration/#event-types","title":"Event Types","text":""},{"location":"essential/webhook-auto-registration/#type-1-auto-triggered-by-django-signals","title":"Type 1: Auto-Triggered by Django Signals","text":"<p>These use Django's built-in <code>post_save</code> or <code>post_delete</code> signals. No configuration needed beyond the basic fields:</p> <pre><code>\"cohort_user.added\": {\n    \"action\": \"admissions.CohortUser.created+\",\n    \"category\": \"admissions\",\n    \"description\": \"Triggered when a student is added to a cohort\",\n    \"model\": \"admissions.CohortUser\",\n    # No signal config - handled by post_save receiver\n}\n</code></pre>"},{"location":"essential/webhook-auto-registration/#type-2-auto-registered-custom-signals","title":"Type 2: Auto-Registered Custom Signals","text":"<p>These use custom signals and are auto-registered. Signal, sender, and event_action are all auto-derived from the action:</p> <pre><code>\"assignment.assignment_created\": {\n    \"action\": \"assignments.Task.assignment_created\",\n    \"category\": \"assignments\",\n    \"description\": \"Triggered when a new assignment is created\",\n    \"model\": \"assignments.Task\",\n    # Everything auto-derived from action! \u2728\n    # Derived: signal = \"breathecode.assignments.signals.assignment_created\"\n    # Derived: sender = \"breathecode.assignments.models.Task\"\n    # Derived: event_action = \"assignment_created\"\n    \"serializer\": \"breathecode.assignments.serializers.TaskHookSerializer\",\n}\n</code></pre> <p>Minimal Configuration: <pre><code>\"cohort.cohort_stage_updated\": {\n    \"action\": \"admissions.Cohort.cohort_stage_updated\",\n    \"category\": \"admissions\",\n    \"description\": \"Triggered when cohort stage changes\",\n    \"model\": \"admissions.Cohort\",\n    \"serializer\": \"breathecode.admissions.serializers.CohortHookSerializer\",\n    # That's it! Only 5 fields needed, everything else is auto-derived\n}\n</code></pre></p> <p>Only specify explicitly when signal name differs:</p> <pre><code>\"cohort_user.edu_status_updated\": {\n    \"action\": \"admissions.CohortUser.edu_status_updated\",\n    \"category\": \"admissions\",\n    \"description\": \"Triggered when educational status changes\",\n    \"model\": \"admissions.CohortUser\",\n    # Signal name differs from action - must be explicit\n    \"signal\": \"breathecode.admissions.signals.student_edu_status_updated\",\n    # Sender and event_action still auto-derived!\n    \"serializer\": \"breathecode.admissions.serializers.CohortUserHookSerializer\",\n}\n</code></pre>"},{"location":"essential/webhook-auto-registration/#type-3-manual-receivers-with-custom-logic","title":"Type 3: Manual Receivers with Custom Logic","text":"<p>For receivers that need custom logic beyond standard webhook delivery:</p> <pre><code>\"session.mentorship_session_status\": {\n    \"action\": \"mentorship.MentorshipSession.mentorship_session_status\",\n    \"category\": \"mentorship\",\n    \"description\": \"Triggered when session status changes\",\n    \"model\": \"mentorship.MentorshipSession\",\n    \"signal\": \"breathecode.mentorship.signals.mentorship_session_status\",\n    \"sender\": \"breathecode.mentorship.models.MentorshipSession\",\n    \"serializer\": \"breathecode.mentorship.serializers.SessionHookSerializer\",\n    \"event_action\": \"mentorship_session_status\",\n    # Prevent auto-registration\n    \"auto_register\": False,\n}\n</code></pre> <p>Then manually define in <code>breathecode/notify/receivers.py</code>:</p> <pre><code>@receiver(mentorship_session_status, sender=MentorshipSession)\ndef post_mentoring_session_status(sender, instance, **kwargs):\n    # Custom logic before webhook delivery\n    if instance.status == \"STARTED\":\n        send_mentorship_starting_notification.delay(instance.id)\n\n    # Standard webhook delivery\n    model_label = get_model_label(instance)\n    serializer = SessionHookSerializer(instance)\n    HookManager.process_model_event(\n        instance,\n        model_label,\n        \"mentorship_session_status\",\n        payload_override=serializer.data,\n        academy_override=instance.mentor.academy,\n    )\n</code></pre>"},{"location":"essential/webhook-auto-registration/#adding-a-new-auto-registered-webhook","title":"Adding a New Auto-Registered Webhook","text":""},{"location":"essential/webhook-auto-registration/#step-1-create-the-signal","title":"Step 1: Create the Signal","text":"<p>In your app's <code>signals.py</code>:</p> <pre><code>from task_manager.django.dispatch import Emisor\n\nemisor = Emisor(\"breathecode.myapp\")\nmy_custom_event = emisor.signal(\"my_custom_event\")\n</code></pre>"},{"location":"essential/webhook-auto-registration/#step-2-create-the-serializer-optional","title":"Step 2: Create the Serializer (Optional)","text":"<p>In your app's <code>serializers.py</code>:</p> <pre><code>from breathecode.utils import serpy\n\nclass MyModelHookSerializer(serpy.Serializer):\n    id = serpy.Field()\n    name = serpy.Field()\n    status = serpy.Field()\n    # ... other fields\n</code></pre>"},{"location":"essential/webhook-auto-registration/#step-3-add-to-hook_events_metadata","title":"Step 3: Add to HOOK_EVENTS_METADATA","text":"<p>In <code>breathecode/notify/utils/hook_events.py</code> (minimal configuration - everything auto-derived!):</p> <pre><code>HOOK_EVENTS_METADATA = {\n    # ... existing events ...\n\n    \"myapp.my_custom_event\": {\n        \"action\": \"myapp.MyModel.my_custom_event\",\n        \"category\": \"myapp\",\n        \"description\": \"Triggered when something happens to MyModel\",\n        \"model\": \"myapp.MyModel\",\n        \"serializer\": \"breathecode.myapp.serializers.MyModelHookSerializer\",\n        # That's it! Only 5 fields needed\n    },\n}\n</code></pre> <p>The system automatically derives everything else from the action: - <code>signal</code> = <code>breathecode.myapp.signals.my_custom_event</code> - <code>sender</code> = <code>breathecode.myapp.models.MyModel</code> - <code>event_action</code> = <code>my_custom_event</code></p>"},{"location":"essential/webhook-auto-registration/#step-4-emit-the-signal","title":"Step 4: Emit the Signal","text":"<p>In your model or view:</p> <pre><code>from . import signals\n\nclass MyModel(models.Model):\n    # ... fields ...\n\n    def some_method(self):\n        # Do something\n        # Then emit the signal\n        signals.my_custom_event.delay(instance=self, sender=self.__class__)\n</code></pre> <p>That's it! The webhook receiver is automatically registered and will: - Listen for the signal - Serialize the instance using your serializer - Deliver the webhook to subscribed endpoints</p>"},{"location":"essential/webhook-auto-registration/#debugging","title":"Debugging","text":""},{"location":"essential/webhook-auto-registration/#check-registered-receivers","title":"Check Registered Receivers","text":"<pre><code># In Django shell\nfrom breathecode.myapp.signals import my_custom_event\nprint(my_custom_event.receivers)\n</code></pre>"},{"location":"essential/webhook-auto-registration/#view-auto-registration-logs","title":"View Auto-Registration Logs","text":"<p>Auto-registration logs are visible at Django startup with <code>DEBUG=True</code>:</p> <pre><code>INFO - Auto-registered 15 webhook receivers, skipped 2\nDEBUG - Auto-registered receiver for assignment.assignment_created\nDEBUG - Skipping auto-registration for session.mentorship_session_status (auto_register=False)\n</code></pre>"},{"location":"essential/webhook-auto-registration/#test-signal-emission","title":"Test Signal Emission","text":"<pre><code># In Django shell or test\nfrom breathecode.myapp.models import MyModel\nfrom breathecode.myapp.signals import my_custom_event\n\ninstance = MyModel.objects.first()\nmy_custom_event.send(sender=MyModel, instance=instance)\n</code></pre>"},{"location":"essential/webhook-auto-registration/#migration-from-manual-to-auto-registration","title":"Migration from Manual to Auto-Registration","text":""},{"location":"essential/webhook-auto-registration/#before-manual-receiver","title":"Before (Manual Receiver)","text":"<pre><code># In breathecode/notify/receivers.py\nfrom breathecode.assignments.models import Task\nfrom breathecode.assignments.serializers import TaskHookSerializer\nfrom breathecode.assignments.signals import assignment_created\n\n@receiver(assignment_created, sender=Task)\ndef handle_assignment_created(sender, instance, **kwargs):\n    logger.debug(\"HOOK: Assignment created\")\n    model_label = get_model_label(instance)\n    serializer = TaskHookSerializer(instance)\n    HookManager.process_model_event(\n        instance, \n        model_label, \n        \"assignment_created\", \n        payload_override=serializer.data\n    )\n</code></pre>"},{"location":"essential/webhook-auto-registration/#after-auto-registered","title":"After (Auto-Registered)","text":"<pre><code># In breathecode/settings.py - just add metadata\nHOOK_EVENTS_METADATA = {\n    \"assignment.assignment_created\": {\n        \"action\": \"assignments.Task.assignment_created\",\n        \"category\": \"assignments\",\n        \"description\": \"Triggered when a new assignment is created\",\n        \"model\": \"assignments.Task\",\n        \"signal\": \"breathecode.assignments.signals.assignment_created\",\n        \"sender\": \"breathecode.assignments.models.Task\",\n        \"serializer\": \"breathecode.assignments.serializers.TaskHookSerializer\",\n        \"event_action\": \"assignment_created\",\n    },\n}\n\n# Remove manual receiver from receivers.py\n# That's it! \u2728\n</code></pre>"},{"location":"essential/webhook-auto-registration/#best-practices","title":"Best Practices","text":"<ol> <li>Use Auto-Registration for Standard Webhooks</li> <li>No custom logic needed</li> <li> <p>Just send data when signal fires</p> </li> <li> <p>Use Manual Receivers for Complex Logic</p> </li> <li>Need to check conditions before sending</li> <li>Need to trigger other tasks</li> <li>Need custom academy_override logic</li> <li> <p>Set <code>auto_register: False</code> in metadata</p> </li> <li> <p>Always Include Serializers</p> </li> <li>Provides consistent payload structure</li> <li>Documents what data is sent</li> <li> <p>Makes payload predictable for consumers</p> </li> <li> <p>Use Descriptive Event Names</p> </li> <li>Format: <code>category.action_description</code></li> <li> <p>Example: <code>assignment.status_updated</code> not <code>assignment.updated</code></p> </li> <li> <p>Document in Metadata</p> </li> <li>Clear descriptions help API consumers</li> <li>Include when/why event triggers</li> <li>List important fields in payload</li> </ol>"},{"location":"essential/webhook-auto-registration/#troubleshooting","title":"Troubleshooting","text":""},{"location":"essential/webhook-auto-registration/#receiver-not-triggering","title":"Receiver Not Triggering","text":"<ol> <li>Check signal is emitted: Add debug logging to signal emission</li> <li>Check auto-registration succeeded: Look for registration logs</li> <li>Check signal/sender imports: Verify paths are correct in metadata</li> <li>Check <code>auto_register</code> flag: Ensure it's not set to <code>False</code></li> </ol>"},{"location":"essential/webhook-auto-registration/#wrong-payload-structure","title":"Wrong Payload Structure","text":"<ol> <li>Check serializer path: Verify import path in metadata</li> <li>Test serializer directly: Serialize instance in shell</li> <li>Check serializer fields: Ensure all needed fields are included</li> </ol>"},{"location":"essential/webhook-auto-registration/#import-errors","title":"Import Errors","text":"<ol> <li>Check all import paths in metadata are valid</li> <li>Ensure signal is defined before auto-registration runs</li> <li>Check for circular import issues</li> </ol>"},{"location":"essential/webhook-auto-registration/#performance-considerations","title":"Performance Considerations","text":"<ul> <li>Auto-registration happens once at startup (minimal overhead)</li> <li>Dynamically created receivers have same performance as manual ones</li> <li>Serialization happens asynchronously via Celery</li> <li>No impact on signal emission performance</li> </ul>"},{"location":"essential/webhook-auto-registration/#summary","title":"Summary","text":"<p>The auto-registration system provides: - Less Code: Eliminate repetitive receiver functions - Single Source of Truth: All configuration in <code>HOOK_EVENTS_METADATA</code> - Better Documentation: Metadata documents all webhooks - Consistency: All receivers follow same pattern - Flexibility: Can still write manual receivers when needed</p> <p>For most webhook events, you only need to add metadata\u2014no receiver code required!</p>"},{"location":"essential/4geeks/actions/","title":"Actions","text":"<p>An action is a small code block like a function or a class which is reused within Django views and Celery tasks.</p>"},{"location":"essential/4geeks/actions/#where-is-the-task","title":"Where is the task?","text":"<p>It where in <code>breathecode/APP_NAME/actions.py</code>.</p>"},{"location":"essential/4geeks/services/introduction/","title":"Introduction","text":""},{"location":"essential/4geeks/services/introduction/#first-party-source","title":"First-party source.","text":"<p>It is all information that our company collects directly without the intervention of third-party companies.</p>"},{"location":"essential/4geeks/services/introduction/#third-party-source","title":"Third-party source.","text":"<p>All information that is collected by other companies and we are acceding thought of an Web API.</p>"},{"location":"essential/4geeks/services/introduction/#references","title":"References:","text":"<ul> <li>First-party source and Third-party source.</li> </ul>"},{"location":"essential/4geeks/services/first-party/token/","title":"<code>Token</code>","text":"<p>This object represents the JSON payload.</p> <ul> <li><code>sub</code>: user.id.</li> <li><code>iss</code>: the host of the service, example `\"http://localhost:8000\"``.</li> <li><code>app</code>: app that made the token, for example <code>\"4geeks\"</code>.</li> <li><code>aud</code>: app that will receive the request.</li> <li><code>exp</code>: token expiration time.</li> <li><code>iat</code>: time when the token was issued.</li> <li><code>typ</code>: token type (default <code>\"JWT\"</code>).</li> </ul>"},{"location":"essential/4geeks/services/first-party/using-services/","title":"Using services","text":"<p>We have a wrapper that manages the authentication to any first-party service.</p>"},{"location":"essential/4geeks/services/first-party/using-services/#arguments","title":"Arguments","text":"<p>Both, the class <code>Service</code> and the function <code>service</code> accepts the following arguments:</p> <ul> <li><code>app_pk</code>: <code>app.id</code> or <code>app.slug</code>.</li> <li><code>user_pk</code>: <code>user.id</code>.</li> <li><code>mode</code>: <code>\"signature\"</code> or <code>\"jwt\"</code>.</li> </ul>"},{"location":"essential/4geeks/services/first-party/using-services/#signature-mode-vs-jwt-mode","title":"Signature mode vs JWT mode","text":"<p>When JWT is used, it just signs a token with the data of the user, while the signature signs the token with all the content of the request to verify the source of the request. JWT is significantly faster than using signatures.</p>"},{"location":"essential/4geeks/services/first-party/using-services/#syncronomous-implementation","title":"Syncronomous implementation","text":"<p>Service is a Requests wrapper, you should use this library like it was Requests, and the host is resolved automatically.</p>"},{"location":"essential/4geeks/services/first-party/using-services/#making-a-request-signed-in-as-4geeks","title":"making a request signed in as 4geeks","text":"<pre><code>from breathecode.utils.service import Service\n\ntry:\n    s = Service('rigobot')\n    response = s.get('/my/path')\n    data = response.json()\n\nexcept Exception:\n    # not found exception\n</code></pre>"},{"location":"essential/4geeks/services/first-party/using-services/#making-a-request-signed-in-as-a-4geeks-user","title":"making a request signed in as a 4geeks user.","text":"<pre><code>from breathecode.utils.service import Service\n\ntry:\n    s = Service('rigobot', 1)\n    response = s.get('/my/path')\n    data = response.json()\n\nexcept Exception:\n    # not found exception\n</code></pre>"},{"location":"essential/4geeks/services/first-party/using-services/#asyncronomous-implementation","title":"Asyncronomous implementation","text":"<p>Service is a AIOHTTP wrapper, you should use this library like it was AIOHTTP, and the host is resolved automatically.</p>"},{"location":"essential/4geeks/services/first-party/using-services/#making-a-request-signed-in-as-4geeks_1","title":"making a request signed in as 4geeks","text":"<pre><code>from django.core.exceptions import SynchronousOnlyOperation\nfrom breathecode.utils.service import service\n\ntry:\n    s = await service('rigobot')\n\nexcept SynchronousOnlyOperation:\n    # exception about that the worker does not support asynchronous code\n\nexcept Exception:\n    # not found exception\n\n# If all went well\nasync with s:\n    async with s.get('/my/path') as response:\n        data = await response.json()\n</code></pre>"},{"location":"essential/4geeks/services/first-party/using-services/#making-a-request-signed-in-as-a-4geeks-user_1","title":"making a request signed in as a 4geeks user.","text":"<pre><code>from django.core.exceptions import SynchronousOnlyOperation\nfrom breathecode.utils.service import service\n\ntry:\n    s = await service('rigobot', 1)\n\nexcept SynchronousOnlyOperation:\n    # exception about that the worker does not support asynchronous code\n\nexcept Exception:\n    # not found exception\n\n# If all went well\nasync with s:\n    async with s.get('/my/path') as response:\n        data = await response.json()\n</code></pre>"},{"location":"essential/4geeks/services/first-party/using-services/#why-does-it-use-aget-instead-of-get","title":"Why does it use aget instead of get","text":"<p>Because initially this was made to contain both styles, synchronous and asynchronous, aget means asynchronous get, this difference should be removed by implementing the context API over the <code>Service</code> class.</p>"},{"location":"essential/4geeks/services/first-party/using-services/#why-the-implementation-differ","title":"Why the implementation differ","text":"<p>AIOHTTP requires the use of the context API and Requests does not, and Python does not support asyncronomous constructors, I could not implement a constructor that was compatible with syncronomous and asyncronomous code, I am thinking about update this implementation in the future to reduce the difference between them using the context API.</p>"},{"location":"essential/4geeks/services/first-party/writing-services/","title":"Writing services","text":"<p>We have a wrapper that implements a first-party endpoint to be used by some first-party services.</p>"},{"location":"essential/4geeks/services/first-party/writing-services/#arguments","title":"Arguments","text":"<p>Both, the decorator <code>scope</code> accepts the following arguments:</p> <ul> <li><code>scopes</code>: <code>[scope1.slug, scope2.slug, ...]</code></li> <li><code>mode</code>: <code>\"signature\"</code> or <code>\"jwt\"</code> (default)</li> </ul>"},{"location":"essential/4geeks/services/first-party/writing-services/#signature-mode-vs-jwt-mode","title":"Signature mode vs JWT mode","text":"<p>When JWT is used, it just signs a token with the data of the user, while the signature signs the token with all the content of the request to verify the source of the request. JWT is significantly faster than using signatures.</p>"},{"location":"essential/4geeks/services/first-party/writing-services/#syncronomous-implementation","title":"Syncronomous implementation","text":"<p>Service is a Requests wrapper, you should use this library like it was Requests, and the host is resolved automatically.</p>"},{"location":"essential/4geeks/services/first-party/writing-services/#making-a-request-signed-in-as-4geeks","title":"making a request signed in as 4geeks","text":"<pre><code>from rest_framework.views import APIView\nfrom breathecode.utils.decorators.scope import scope\n\nclass AppUserView(APIView):\n    permission_classes = [AllowAny]\n\n    @scope(['read:user'])\n    def get(self, request, app: dict, token: dict, user_id=None):\n        handler = self.extensions(request)\n        lang = get_user_language(request)\n\n        extra = {}\n        if app.require_an_agreement:\n            extra['appuseragreement__app__id'] = app.id\n\n        if token.sub:\n            extra['id'] = token.sub\n\n        if user_id:\n            if token.sub and token.sub != user_id:\n                raise ValidationException(translation(lang,\n                                                      en='This user does not have access to this resource',\n                                                      es='Este usuario no tiene acceso a este recurso'),\n                                          code=403,\n                                          slug='user-with-no-access',\n                                          silent=True)\n\n            if 'id' not in extra:\n                extra['id'] = user_id\n\n            user = User.objects.filter(**extra).first()\n            if not user:\n                raise ValidationException(translation(lang, en='User not found', es='Usuario no encontrado'),\n                                          code=404,\n                                          slug='user-not-found',\n                                          silent=True)\n\n            serializer = AppUserSerializer(user, many=False)\n            return Response(serializer.data)\n\n        # test this path\n        items = User.objects.filter(**extra)\n        items = handler.queryset(items)\n        serializer = AppUserSerializer(items, many=True)\n\n        return handler.response(serializer.data)\n</code></pre>"},{"location":"essential/4geeks/services/first-party/writing-services/#asyncronomous-implementation","title":"Asyncronomous implementation","text":"<p>Not implemented yet.</p>"},{"location":"essential/celery/calling/","title":"Calling","text":"<p>You can an existing task, Celery provides tree basic way to using its tasks:</p> <p>Asynchronous way:</p> <ul> <li>Using <code>my_task.delay(...)</code></li> <li>Using <code>my_task.apply_async(args=(...), kwargs={...})</code></li> </ul> <p>Synchronous way:</p> <ul> <li>Using <code>my_task(...)</code></li> </ul>"},{"location":"essential/celery/calling/#calling-your-task","title":"Calling your task","text":"<p>Read this.</p>"},{"location":"essential/celery/calling/#where-is-the-task","title":"Where is the task?","text":"<p>It where in <code>breathecode/APP_NAME/tasks.py</code>.</p>"},{"location":"essential/celery/introduction/","title":"Introduction","text":"<p>Celery is a asynchronous task queue which provided us a way to implement parallelism in 4geeks, usually it is used for execute operation which taken a long time, and it only support Python.</p>"},{"location":"essential/celery/introduction/#historical-use-on-4geeks","title":"Historical use on 4geeks","text":"<p>The support for asynchronous execution was added from Django 4, during a long time we used Django 3.12, and Celery helped us to deal with this purpose.</p>"},{"location":"essential/celery/introduction/#article-about-what-is-celery","title":"Article about what is Celery.","text":"<p>Read this.</p>"},{"location":"essential/celery/tasks/","title":"Tasks","text":"<p>A task is a code block that is executed in the Celery process, you usually go to use the tasks within a Django command, inside an action or inside a Django view. It is used to implement asynchronicity within the Django process.</p>"},{"location":"essential/celery/tasks/#writing-tasks","title":"Writing tasks","text":"<p>Read this</p>"},{"location":"essential/celery/tasks/#where-is-the-task","title":"Where is the task?","text":"<p>It where in <code>breathecode/APP_NAME/tasks.py</code>.</p>"},{"location":"essential/django/admin/","title":"Admin","text":"<p>Django provides an endpoint under <code>localhost:8000/admin</code>, which can see, update, remove, and execute an action over a Model or row.</p>"},{"location":"essential/django/admin/#writing-admin","title":"Writing admin","text":"<p>Read this.</p>"},{"location":"essential/django/admin/#documenting-your-admin","title":"Documenting your admin","text":"<p>Read this.</p>"},{"location":"essential/django/admin/#writing-admin-actions","title":"Writing admin actions","text":"<p>Read this.</p>"},{"location":"essential/django/admin/#where-is-the-admin","title":"Where is the admin?","text":"<p>It where in <code>breathecode/APP_NAME/admin.py</code>.</p>"},{"location":"essential/django/admin/#where-is-the-test-file","title":"Where is the test file?","text":"<p>It where in <code>breathecode/APP_NAME/tests/admin/tests_ADMIN_ACTION_NAME.py</code>.</p>"},{"location":"essential/django/commands/","title":"Django commands","text":"<p>Django allows you to create a custom command, it usually will be used with the Heroku Scheduler to schedule the execution of that command.</p>"},{"location":"essential/django/commands/#what-is-a-command","title":"What is a command?","text":"<p>Read this and this.</p>"},{"location":"essential/django/commands/#writing-commands","title":"Writing commands","text":"<p>Read this.</p>"},{"location":"essential/django/commands/#where-are-the-models","title":"Where are the models?","text":"<p>It where in <code>breathecode/APP_NAME/management/commands/COMMAND_EXEC_NAME.py</code>.</p>"},{"location":"essential/django/commands/#where-is-the-test-file","title":"Where is the test file?","text":"<p>It where in <code>breathecode/APP_NAME/tests/management/commands/tests_COMMAND_EXEC_NAME.py</code>.</p>"},{"location":"essential/django/introduction/","title":"Introduction","text":""},{"location":"essential/django/introduction/#what-is-django","title":"What is Django","text":"<p>Django is a web framework created on 21 July 2005, it was extremely popular because it had the better ORM, it was made in Python and its URL format was revolutionary. Django was created in the big frameworks era, It follows the model\u2013template\u2013views, it should do that it feels harder compared with the newest frameworks like Express, before Express, the frameworks were very oppressive, because they enforce that the team followed an unique standard, while Express does the opposite, so, all Express like frameworks does not have a high cognitive load caused by that. It requires that you understand that to learn Django you must understand its structures and concepts.</p>"},{"location":"essential/django/introduction/#other-introductions","title":"Other introductions","text":"<ul> <li>Django.</li> <li>Wikipedia.</li> </ul>"},{"location":"essential/django/introduction/#modeltemplateviews","title":"Model\u2013Template\u2013Views","text":"<p>Read this.</p>"},{"location":"essential/django/models/","title":"Models","text":"<p>A model is a concept that is part of Model-View-Controller, the models represent a structure that contains, manages, formats, and wraps the data, usually, it is related to the concept of an Object\u2013relational mapping , an Active record, and an Object Data Modelling (it is similar to an Object\u2013relational mapping but for NoSQL databases), in summary, way you will save and fetch the content using models.</p>"},{"location":"essential/django/models/#writing-models","title":"Writing models","text":"<p>Read this.</p>"},{"location":"essential/django/models/#field-types","title":"Field types","text":"<p>Read this.</p>"},{"location":"essential/django/models/#migrations","title":"Migrations","text":"<p>Read this.</p>"},{"location":"essential/django/models/#making-queries","title":"Making queries","text":"<p>Read this.</p>"},{"location":"essential/django/models/#where-are-the-models","title":"Where are the models?","text":"<p>It where in <code>breathecode/APP_NAME/models.py</code>.</p>"},{"location":"essential/django/signals/","title":"Signals and receivers","text":"<p>A signal is a way to decouple the logic inside the models, a signal is like an Airtag, when an Airtag becomes closer to another device it should trigger an action, your action is wrapped inside a receiver and the signal is the emitter, this signal should be trigger manually in the cases of a custom signal or automatically in case of the signals which was created by Django like <code>pre_save</code> which is execute before executing <code>model.save()</code>.</p>"},{"location":"essential/django/signals/#writing-signals","title":"Writing signals","text":"<p>Read this.</p>"},{"location":"essential/django/signals/#writing-receivers","title":"Writing receivers","text":"<p>Read this.</p>"},{"location":"essential/django/signals/#setting-up-the-app-to-enable-the-signals","title":"Setting up the app to enable the signals","text":"<p>Read this.</p>"},{"location":"essential/django/signals/#django-signals","title":"Django signals","text":"<p>read this.</p>"},{"location":"essential/django/signals/#where-are-the-signals","title":"Where are the signals","text":"<p>It where in <code>breathecode/APP_NAME/signals.py</code>.</p>"},{"location":"essential/django/signals/#where-are-the-receivers","title":"Where are the receivers","text":"<p>It where in <code>breathecode/APP_NAME/receivers.py</code>.</p>"},{"location":"essential/django/signals/#where-are-tested-the-signals","title":"Where are tested the signals?","text":"<p>It where in <code>breathecode/APP_NAME/tests/signals/tests_SIGNAL_NAME.py</code>.</p>"},{"location":"essential/django/signals/#where-are-tested-the-receivers","title":"Where are tested the receivers?","text":"<p>It where in <code>breathecode/APP_NAME/tests/receivers/tests_RECEIVER_NAME.py</code>.</p>"},{"location":"essential/django/templates/","title":"Templates","text":"<p>The template is a feature that allows you to build documents like an HTML or a TXT dynamically and fill this document with the necessary data, you usually will render them to send pages or emails.</p>"},{"location":"essential/django/templates/#writing-templates","title":"Writing templates","text":"<p>Read this.</p>"},{"location":"essential/django/templates/#using-custom-template-tags","title":"Using custom template tags","text":"<p>Read this.</p>"},{"location":"essential/django/templates/#where-are-the-templates","title":"Where are the templates?","text":"<p>It where in <code>breathecode/APP_NAME/templates/TEMPLATE_NAME.[html|txt]</code>.</p>"},{"location":"essential/django/urls/","title":"URLs","text":"<p>One of the most exciting features that made Django so popular was its URL handlers for its simplicity, right now, all frameworks implemented this format.</p>"},{"location":"essential/django/urls/#introduction","title":"Introduction","text":"<p>Read this.</p>"},{"location":"essential/django/urls/#writing-urls","title":"Writing URLs","text":"<p>Read this.</p>"},{"location":"essential/django/urls/#where-are-the-urls","title":"Where are the urls?","text":"<p>It where in <code>breathecode/APP_NAME/urls.py</code>.</p>"},{"location":"essential/django/views/","title":"Views","text":"<p>A view is a concept that is part of Model-View-Controller, the view manages the appearance of the application, you could guess that in Django a view would be the template, but actually, on Django what would be a handler in an Express like framework, because the view can build a HTML without using templates. On Django an Exception could return a 4xx or 5xx response.</p> <p>Related articles:</p> <ul> <li>HTTP.</li> <li>REST.</li> </ul>"},{"location":"essential/django/views/#writing-views","title":"Writing views","text":"<p>Read this.</p>"},{"location":"essential/django/views/#async-views","title":"Async views","text":"<p>Read this.</p>"},{"location":"essential/django/views/#functional-views","title":"Functional views","text":"<p>Read this.</p>"},{"location":"essential/django/views/#render-templates","title":"Render templates","text":"<p>Read this.</p>"},{"location":"essential/django/views/#redirections","title":"Redirections","text":"<p>Read this.</p>"},{"location":"essential/django/views/#where-are-the-views","title":"Where are the views?","text":"<p>It where in <code>breathecode/APP_NAME/views.py</code>.</p>"},{"location":"essential/django/views/#where-is-the-test-file","title":"Where is the test file?","text":"<p>It where in <code>breathecode/APP_NAME/tests/urls/tests_ROUTE_NAME.py</code>.</p>"},{"location":"essential/django-rest-framework/introduction/","title":"Introduction","text":""},{"location":"essential/django-rest-framework/introduction/#what-is-django-rest-framework","title":"What is Django Rest Framework","text":"<p>Some time ago Django was considered one of the top 5 web frameworks, At those times the API rest was not the standard, did not exists the SPA, in those times the content was rendered from the backend even usually, you could see form and validations exclusively in server side, Django was made to cover this purpose, Django Rest Framework is a middleware that adds support to Django for managing REST APIs.</p> <p>Related articles:</p> <ul> <li>HTTP.</li> <li>REST.</li> </ul>"},{"location":"essential/django-rest-framework/serializers/","title":"Serializers","text":"<p>A serializer is an element (a class in this case) that translates an object (Object-oriented programming) and generates an output that should be useful for something. In Django, a serializer is used to format the object before it is sent. We are using the Django Rest Framework Serializers for POST and PUT methods, and for the GET method we are using Serpy because it is faster than DRF Serializers.</p> <p>Related articles:</p> <ul> <li>HTTP</li> <li>REST</li> </ul>"},{"location":"essential/django-rest-framework/serializers/#writing-serializers","title":"Writing Serializers","text":"<p>Read this.</p>"},{"location":"essential/django-rest-framework/serializers/#where-are-the-serializers","title":"Where are the serializers?","text":"<p>They are located in <code>breathecode/APP_NAME/serializers.py</code>.</p>"},{"location":"essential/django-rest-framework/validators/","title":"Validators","text":"<p>Django Rest Framework provides a set of validators to be used with Django models.</p>"},{"location":"essential/django-rest-framework/validators/#using-validators","title":"Using validators","text":"<p>Read this.</p>"},{"location":"essential/django-rest-framework/views/","title":"Views","text":"<p>Django Rest Framework implements and extends the Django views but with support to REST frameworks (you can read about Django views here).</p> <p>Related articles:</p> <ul> <li>HTTP.</li> <li>REST.</li> </ul>"},{"location":"essential/django-rest-framework/views/#writing-views","title":"Writing views","text":"<p>Read this.</p>"},{"location":"essential/django-rest-framework/views/#exceptions","title":"Exceptions","text":"<p>Read this.</p>"},{"location":"essential/django-rest-framework/views/#status-code","title":"Status Code","text":"<p>Read this.</p>"},{"location":"essential/django-rest-framework/views/#writing-view-sets","title":"Writing view sets","text":"<p>Read this.</p>"},{"location":"essential/django-rest-framework/views/#parsers","title":"Parsers","text":"<p>Read this.</p>"},{"location":"essential/django-rest-framework/views/#renderers","title":"Renderers","text":"<p>Read this.</p>"},{"location":"essential/django-rest-framework/views/#permissions","title":"Permissions","text":"<p>Read this.</p>"},{"location":"essential/django-rest-framework/views/#authentication","title":"Authentication","text":"<p>Read this.</p>"},{"location":"essential/django-rest-framework/views/#throttling","title":"Throttling","text":"<p>Read this.</p>"},{"location":"essential/django-rest-framework/views/#where-are-the-views","title":"Where are the views?","text":"<p>It where in <code>breathecode/APP_NAME/views.py</code>.</p>"},{"location":"essential/django-rest-framework/views/#where-is-the-test-file","title":"Where is the test file?","text":"<p>It where in <code>breathecode/APP_NAME/tests/urls/tests_ROUTE_NAME.py</code>.</p>"},{"location":"getting-started/available-commands/","title":"Available Commands","text":"<p>The following custom commands are defined in <code>pyproject.toml</code> under <code>[tool.poetry.scripts]</code> and can be run from within your development environment (Codespace, Dev Container, or Manual Setup with activated virtual environment) using <code>poetry run &lt;command&gt;</code>:</p>"},{"location":"getting-started/available-commands/#development-server","title":"Development Server","text":"<ul> <li><code>poetry run dev</code>: (Legacy or specific development task - check <code>scripts/cmd.py</code> for details)</li> <li><code>poetry run start</code>: Starts the Django development server (usually on <code>http://localhost:8000</code>).</li> <li><code>poetry run createsuperuser</code>: Runs Django's interactive <code>createsuperuser</code> management command to create an admin user.</li> <li><code>poetry run startapp &lt;app_name&gt;</code>: Runs Django's <code>startapp</code> management command to create a new app structure.</li> </ul>"},{"location":"getting-started/available-commands/#testing","title":"Testing","text":"<ul> <li><code>poetry run test &lt;path&gt;</code>: Runs <code>pytest</code> for the specified path/module (e.g., <code>poetry run test ./breathecode/activity</code>).</li> <li><code>poetry run test:ci</code>: Runs tests with coverage specifically configured for CI environments.</li> <li><code>poetry run test:coverage &lt;module&gt;</code> / <code>poetry run test:c &lt;module&gt;</code>: Runs tests with coverage reporting for the specified Python module path (e.g., <code>poetry run cov breathecode.activity</code>).</li> <li><code>poetry run test:parallel &lt;path&gt;</code> / <code>poetry run test:p &lt;path&gt;</code>: Runs tests in parallel using <code>pytest-xdist</code> for the specified path/module (e.g., <code>poetry run ptest ./breathecode/activity</code>). Faster for large test suites.</li> </ul>"},{"location":"getting-started/available-commands/#database","title":"Database","text":"<ul> <li><code>poetry run migrate</code>: Runs Django's <code>migrate</code> management command to apply database migrations.</li> <li><code>poetry run makemigrations [app_name]</code>: Runs Django's <code>makemigrations</code> management command to create new migration files based on model changes. Optionally specify an app name.</li> </ul>"},{"location":"getting-started/available-commands/#code-quality-formatting","title":"Code Quality &amp; Formatting","text":"<ul> <li><code>poetry run format</code>: Formats the codebase using tools like <code>black</code> and <code>isort</code> according to project standards.</li> <li><code>poetry run lint</code>: Runs linters (like <code>flake8</code>) over the codebase to check for style issues and potential errors.</li> <li><code>poetry run precommit:install</code>: Installs pre-commit hooks defined in the configuration.</li> </ul>"},{"location":"getting-started/available-commands/#background-tasks","title":"Background Tasks","text":"<ul> <li><code>poetry run celery</code>: Starts a Celery worker process for handling background tasks.</li> </ul>"},{"location":"getting-started/available-commands/#documentation","title":"Documentation","text":"<ul> <li><code>poetry run docs</code>: Serves the documentation locally (usually on <code>http://localhost:8001</code>) using <code>mkdocs serve</code> for live preview.</li> <li><code>poetry run docs:build</code>: Builds the static documentation site into the <code>site/</code> directory using <code>mkdocs build</code>.</li> <li><code>poetry run docs:deploy</code>: Deploys the documentation (likely to GitHub Pages) using <code>mkdocs gh-deploy</code>.</li> </ul>"},{"location":"getting-started/available-commands/#utilities","title":"Utilities","text":"<ul> <li><code>poetry run update-sql-keywords</code>: Updates a JSON file containing SQL keywords (internal utility script).</li> <li><code>poetry run docker:build</code>: Builds the Docker image for the application using configuration in <code>scripts/docker_build.py</code>.</li> </ul>"},{"location":"getting-started/setup/works-locally/devcontainer/","title":"Devcontainer","text":"<p>Devcontainer provides you with a way to run this project on your local machine without setting any configuration.</p>"},{"location":"getting-started/setup/works-locally/devcontainer/#set-up-4geeks-dependencies","title":"Set up 4geeks dependencies","text":"<p>Read this.</p>"},{"location":"getting-started/setup/works-locally/devcontainer/#can-i-use-podman-to-run-devcontainer","title":"Can I use Podman to run Devcontainer?","text":"<p>Yes, but you should have compatibility issues.</p>"},{"location":"getting-started/setup/works-locally/devcontainer/#run-docker-on-non-root-users","title":"Run Docker on non-root users","text":"<p>Devcontainer requires be able to run Docker on non-root users, Follow this intructions.</p>"},{"location":"getting-started/setup/works-locally/devcontainer/#open-devcontainer","title":"Open Devcontainer","text":"<ol> <li>Click Visual Studio Button.</li> <li>Click reopen in Container.</li> <li>Wait until Devcontainer tab in finished its job.</li> </ol>"},{"location":"getting-started/setup/works-locally/devcontainer/#visual-studio-button","title":"Visual Studio Button","text":""},{"location":"getting-started/setup/works-locally/devcontainer/#local-dev-container","title":"Local Dev Container","text":"<p>If you prefer to work locally, have a reasonably powerful machine, and want the same consistent environment as Codespaces, you can use VS Code/Cursor Dev Containers.</p> <p>This method uses Docker to create an isolated environment with all necessary dependencies and configurations, based on the <code>.devcontainer</code> definition in the repository.</p>"},{"location":"getting-started/setup/works-locally/devcontainer/#prerequisites","title":"Prerequisites","text":"<ol> <li>Docker Desktop: Install Docker Desktop for your operating system.</li> <li>VS Code or Cursor: Install Visual Studio Code or Cursor.</li> <li>Install the Dev Containers Extension: You must install the official Dev Containers extension from the marketplace in VS Code/Cursor.</li> </ol>"},{"location":"getting-started/setup/works-locally/devcontainer/#windows-users-important-setup","title":"Windows Users (Important Setup)","text":"<ul> <li>You MUST use WSL 2 (Windows Subsystem for Linux). Dev Containers rely on a Linux environment.</li> <li>Install WSL: Follow the official Microsoft guide to install WSL. We recommend installing the Ubuntu distribution when prompted.</li> <li>Configure Docker Desktop: Ensure Docker Desktop is configured to use the WSL 2 backend. Go to Docker Desktop settings -&gt; Resources -&gt; WSL Integration and enable it for your chosen distribution (e.g., Ubuntu).</li> <li>Clone Project in WSL: Clone this repository inside your WSL environment (e.g., in <code>/home/&lt;your-username&gt;/dev/apiv2</code> within Ubuntu), not on your Windows C: drive. You can access the WSL terminal by typing <code>wsl</code> or <code>ubuntu</code> in your Windows Terminal or Command Prompt.</li> </ul>"},{"location":"getting-started/setup/works-locally/devcontainer/#launching-the-dev-container","title":"Launching the Dev Container","text":"<ol> <li>Clone this repository to your local machine (inside WSL if on Windows).</li> <li>Open the cloned repository folder in VS Code or Cursor (<code>code .</code> or <code>cursor .</code> from the terminal inside the project directory).</li> <li>Your editor should automatically detect the <code>.devcontainer</code> configuration and prompt you to \"Reopen in Container\". Click it.</li> <li>If it doesn't prompt, open the command palette (<code>Ctrl+Shift+P</code> or <code>Cmd+Shift+P</code>) and run <code>Dev Containers: Reopen in Container</code>.</li> </ol> <p>VS Code or Cursor will build the Docker image (if not already built) and start the container. Your editor window will then be connected to the containerized environment, complete with all dependencies.</p> <p>For more general information, refer to the official VS Code Dev Containers documentation.</p>"},{"location":"getting-started/setup/works-locally/introduction/","title":"Introduction","text":"<p>You should choose to work locally if your machine is faster than the machine of Gitpod and Codespaces, otherwise, I would recommend you work on the cloud.</p>"},{"location":"getting-started/setup/works-locally/introduction/#set-up-4geeks-dependencies","title":"Set up 4geeks dependencies","text":""},{"location":"getting-started/setup/works-locally/introduction/#option-one-install-docker-required-for-devcontainer","title":"Option one: install Docker (Required for Devcontainer)","text":"<p>Install Docker Engine and Docker Compose, if you use Linux you can know what your Linux distribution running <code>uname -n</code>.</p>"},{"location":"getting-started/setup/works-locally/introduction/#why-install-docker-and-docker-composer","title":"Why install Docker and Docker Composer","text":"<p>4geeks depends on Postgres and Redis to open the server, the easier way to set up these dependencies for the development team is using a configuration file, it is that Docker does.</p>"},{"location":"getting-started/setup/works-locally/introduction/#can-i-use-podman-and-podman-compose","title":"Can I use Podman and Podman Compose?","text":"<p>Podman supports Dockerfile and Docker Compose files, you should install Podman</p>"},{"location":"getting-started/setup/works-locally/introduction/#must-i-install-docker-enginepodman-or-docker-desktoppodman-desktop","title":"Must I install Docker Engine/Podman or Docker Desktop/Podman Desktop?","text":"<p>Windows users and Mac users usually install Docker Desktop, and Linux users install Docker Engine, my recommendation is if you use Windows, install Docker Desktop because it is complicated to install on Windows, in Mac and Linux choose Docker Desktop if you want to manage it with and graphical interface, else install Docker Engine.</p>"},{"location":"getting-started/setup/works-locally/introduction/#can-i-use-podman-to-run-devcontainer","title":"Can I use Podman to run Devcontainer?","text":"<p>Yes, but you should have compatibility issues.</p>"},{"location":"getting-started/setup/works-locally/introduction/#option-two-install-postgres-and-redis-manually","title":"Option two: install Postgres and Redis manually","text":"<p>Read, install, and configure Postgres and Redis.</p>"},{"location":"getting-started/setup/works-locally/introduction/#advantages-of-working-locally","title":"Advantages of working locally.","text":"<ul> <li>It offers less latency than using an editor on the cloud.</li> <li>May provide better performance than works in the cloud if your machine is older.</li> <li>It will work even without the internet.</li> </ul>"},{"location":"getting-started/setup/works-locally/introduction/#disadvantages-of-using-an-editor-on-the-cloud","title":"Disadvantages of using an Editor on the Cloud.","text":"<ul> <li>May provide better performance than works in the cloud if your machine is older.</li> <li>You will deal with the configurations.</li> </ul>"},{"location":"getting-started/setup/works-locally/on-host-os/","title":"Works on host Operative System","text":"<p>This is the faster option because it runs directly on your machine without any extra layer that adds some latency compared with this option, but should have a problem that you would have to fix manually.</p> <p>See what is an Operative System.</p>"},{"location":"getting-started/setup/works-locally/on-host-os/#set-up-4geeks-dependencies","title":"Set up 4geeks dependencies","text":"<p>Read this.</p>"},{"location":"getting-started/setup/works-locally/on-host-os/#set-up-python-dependencies","title":"Set up Python dependencies","text":"<p>We have a script with a lot of hooks to try to fix many issues that could happen during the installation</p> <pre><code>python -m scripts.install\n</code></pre>"},{"location":"getting-started/setup/works-locally/on-host-os/#start-the-server","title":"Start the server","text":""},{"location":"getting-started/setup/works-locally/on-host-os/#collect-statics","title":"Collect statics","text":"<p>Load the public files in Django, which it requires to open the Django Admin.</p> <pre><code>poetry run python manage.py collectstatic --noinput\n</code></pre>"},{"location":"getting-started/setup/works-locally/on-host-os/#run-migrations","title":"Run migrations","text":""},{"location":"getting-started/setup/works-locally/on-host-os/#what-is-a-migration","title":"What is a migration?","text":"<p>Read this.</p>"},{"location":"getting-started/setup/works-locally/on-host-os/#run-the-migrations","title":"Run the migrations","text":"<pre><code>poetry run python manage.py migrate\n</code></pre>"},{"location":"getting-started/setup/works-locally/on-host-os/#populate-the-database","title":"Populate the database","text":"<p>You should populate your database with initial data using:</p> <pre><code>poetry run python manage.py loaddata breathecode/*/fixtures/dev_*.json\n</code></pre>"},{"location":"getting-started/setup/works-locally/on-host-os/#create-a-super-user","title":"Create a super user","text":"<p>To get in Django Admin you need to create an account, this account will be saved in Postgres.</p> <pre><code>poetry run python manage.py createsuperuser\n</code></pre>"},{"location":"getting-started/setup/works-locally/on-host-os/#run-server","title":"Run server","text":"<p>To open the server run:</p> <pre><code>poetry run start\n</code></pre> <p>If something goes wrong execute this to get a diagnosis.</p> <pre><code>python -m scripts.doctor\n</code></pre>"},{"location":"getting-started/setup/works-on-the-cloud/codespaces/","title":"Works on Codespaces","text":""},{"location":"getting-started/setup/works-on-the-cloud/codespaces/#what-is-codespaces","title":"What is Codespaces?","text":"<p>Codespaces is the cloud version of Visual Studio Code.</p>"},{"location":"getting-started/setup/works-on-the-cloud/codespaces/#advantages-of-using-codespaces","title":"Advantages of using Codespaces","text":"<ul> <li>It support all Visual Studio extensions.</li> </ul>"},{"location":"getting-started/setup/works-on-the-cloud/codespaces/#disadvantages-of-using-codespaces","title":"Disadvantages of using Codespaces","text":"<ul> <li>The big companies hates compete, Microsoft injected a validation, and you cannot install or execute Pylance (and other extensions made by them) on any editor that was not released by them, even if that editor is based in Visual Studio Code, actually this is nasty and unfair, and this affect our as consumers.</li> </ul>"},{"location":"getting-started/setup/works-on-the-cloud/codespaces/#opening-your-project-on-codespaces","title":"Opening your project on Codespaces","text":"<p>Read this.</p>"},{"location":"getting-started/setup/works-on-the-cloud/codespaces/#github-codespaces","title":"GitHub Codespaces","text":"<p>GitHub Codespaces is the recommended way to get started, especially for beginners or if you have a less powerful machine. It provides a fully configured cloud-based development environment, accessible directly through your browser or via VS Code/Cursor.</p>"},{"location":"getting-started/setup/works-on-the-cloud/codespaces/#setting-up-a-codespace","title":"Setting up a Codespace","text":"<ol> <li>Navigate to the main page of the repository on GitHub.</li> <li>Click the <code>Code</code> button.</li> <li>Go to the <code>Codespaces</code> tab.</li> <li>Click <code>Create codespace on main</code> (or your desired branch).</li> </ol> <p>GitHub will set up the environment based on the <code>.devcontainer</code> configuration in the repository. Once ready, you'll have VS Code/Cursor running in your browser (or connected locally) with all dependencies and tools installed.</p>"},{"location":"getting-started/setup/works-on-the-cloud/codespaces/#important-note-for-codespaces","title":"Important Note for Codespaces","text":"<p>Due to potential timing issues with Codespaces setup (<code>postStartCommand</code>), the background services (like the database) might not start automatically. After your Codespace has loaded, open a terminal and run:</p> <pre><code>docker compose up -d redis postgres\n</code></pre> <p>(Or simply <code>docker compose up -d</code> to ensure all services defined in the compose file are running). This ensures the necessary services are available before running the API.</p>"},{"location":"getting-started/setup/works-on-the-cloud/codespaces/#changing-codespace-machine-type","title":"Changing Codespace Machine Type","text":"<p>If you find that the default Codespace machine type is too slow or you need more resources (CPU, RAM, Storage), you can change it:</p> <ul> <li>When creating a new Codespace: Before clicking \"Create codespace\", click on the three dots (...) next to the button or the \"Advanced options\" link (the UI may vary slightly). This will allow you to select a more powerful machine type.</li> <li>For an existing Codespace: You can change the machine type for an existing Codespace. Go to your list of Codespaces on GitHub (github.com/codespaces). Click the three dots (...) next to the Codespace you want to change, select \"Change machine type\", and choose a new one. The Codespace will then need to be reopened or rebuilt to apply the changes.</li> </ul> <p>Using a more powerful machine type may incur higher costs if you are outside of the free tier for GitHub Codespaces.</p> <p>For more general information, you can also refer to the official GitHub Codespaces documentation.</p>"},{"location":"getting-started/setup/works-on-the-cloud/gitpod/","title":"Works on Gitpod","text":""},{"location":"getting-started/setup/works-on-the-cloud/gitpod/#what-is-gitpod","title":"What is Gitpod?","text":"<p>Gitpod is a code editor on the cloud, It might be based on VSCodium, a free version of Visual Studio Code.</p>"},{"location":"getting-started/setup/works-on-the-cloud/gitpod/#disadvantages-of-using-gitpod","title":"Disadvantages of using Gitpod","text":"<ul> <li>Pylance is the better extension for python developers, actually the big companies hates compete, Microsoft injected a validation and you cannot install or execute Pylance (and other extensions made by them) on any editor that was not released by them, even if that editor is based in Visual Studio Code, so, you paid to use that extension with your soul, eventually should be a good idea change this extension with another one.</li> </ul>"},{"location":"getting-started/setup/works-on-the-cloud/gitpod/#opening-your-project-on-gitpod","title":"Opening your project on Gitpod","text":"<ol> <li>Install the browser extension.</li> <li>Read this.</li> </ol>"},{"location":"getting-started/setup/works-on-the-cloud/introduction/","title":"Introduction","text":""},{"location":"getting-started/setup/works-on-the-cloud/introduction/#what-is-the-cloud","title":"What is the cloud?","text":"<p>Read this.</p>"},{"location":"getting-started/setup/works-on-the-cloud/introduction/#advantages-of-using-an-editor-on-the-cloud","title":"Advantages of using an Editor on the Cloud.","text":"<ul> <li>Does not need to be configured.</li> <li>May provide better performance than your local machine if your machine is older.</li> <li>It will save your changes on the cloud, if you computer got break without saving the changes on Github, you will not lose your changes.</li> </ul>"},{"location":"getting-started/setup/works-on-the-cloud/introduction/#disadvantages-of-using-an-editor-on-the-cloud","title":"Disadvantages of using an Editor on the Cloud.","text":"<ul> <li>May provide worse performance than your local machine if your machine is newest.</li> <li>It will close if you do not use it during a time.</li> </ul>"},{"location":"infrastructure/environment-variables/","title":"Environment variables","text":"name description ENV Represents the current environment, can be <code>DEVELOPMENT</code>, <code>TEST</code>, and <code>PRODUCTION</code> LOG_LEVEL Represents the log level for the logging module, can be <code>NOTSET</code>, <code>DEBUG</code>, <code>INFO</code>, <code>WARNING</code>, <code>ERROR</code> and <code>CRITICAL</code> DATABASE_URL Represents the connection string to the database, you can read more about schema url CACHE_MIDDLEWARE_MINUTES Represents how long an item will last in the cache API_URL Represents the url of api rest ADMIN_URL Represents the url of frontend of the admin APP_URL Represents the url of frontend of the webside REDIS_URL Represents the url of Redis CELERY_TASK_SERIALIZER Represents the default serialization method to use. Can be pickle <code>json</code>, <code>yaml</code>, <code>msgpack</code> or any custom serialization methods EMAIL_NOTIFICATIONS_ENABLED Represents if the server can send notifications through email SYSTEM_EMAIL Represents the email of <code>Breathecode</code> for support SAVE_LEADS Represents if Breathecode will persist the leads COMPANY_NAME Represents the company name COMPANY_CONTACT_URL Represents the company contact url COMPANY_LEGAL_NAME Represents the company legal name COMPANY_ADDRESS Represents the company address MEDIA_GALLERY_BUCKET Represents the bucket for the media gallery DOWNLOADS_BUCKET Represents the bucket for the CSV files PROFILE_BUCKET Represents the bucket for profile avatars"},{"location":"infrastructure/infra-env/","title":"Environment variables","text":"<p>This article only includes the environment variables related to the infrastructure.</p>"},{"location":"infrastructure/infra-env/#web_worker_connection","title":"WEB_WORKER_CONNECTION","text":"<p>The maximum number of simultaneous clients.</p>"},{"location":"infrastructure/infra-env/#default","title":"Default","text":"<p>200</p>"},{"location":"infrastructure/infra-env/#references","title":"References","text":"<ul> <li>Gunicorn documentation.</li> </ul>"},{"location":"infrastructure/infra-env/#where-it-is-used","title":"Where it is used","text":"<ul> <li><code>scripts/dyno/web.sh</code></li> </ul>"},{"location":"infrastructure/infra-env/#note","title":"Note","text":"<ul> <li>Maybe this variable should be called <code>WEB_WORKER_CONNECTIONS</code> instead</li> </ul>"},{"location":"infrastructure/infra-env/#web_timeout","title":"WEB_TIMEOUT","text":"<ul> <li>Time to wait to send the web request, worker that exceeds that time will be killed and restarted.</li> </ul>"},{"location":"infrastructure/infra-env/#default_1","title":"Default","text":"<p>29</p>"},{"location":"infrastructure/infra-env/#references_1","title":"References","text":"<ul> <li>Gunicorn documentation.</li> </ul>"},{"location":"infrastructure/infra-env/#where-it-is-used_1","title":"Where it is used","text":"<ul> <li><code>scripts/dyno/web.sh</code></li> </ul>"},{"location":"infrastructure/infra-env/#web_workers","title":"WEB_WORKERS","text":"<p>Number of workers that respond to web requests.</p>"},{"location":"infrastructure/infra-env/#default_2","title":"Default","text":"<p>2</p>"},{"location":"infrastructure/infra-env/#references_2","title":"References","text":"<ul> <li>Gunicorn documentation.</li> </ul>"},{"location":"infrastructure/infra-env/#where-it-is-used_2","title":"Where it is used","text":"<ul> <li><code>scripts/dyno/web.sh</code></li> </ul>"},{"location":"infrastructure/infra-env/#web_worker_class","title":"WEB_WORKER_CLASS","text":"<p>Worker to be used within <code>Gunicorn</code>.</p>"},{"location":"infrastructure/infra-env/#default_3","title":"Default","text":"<p>gevent</p>"},{"location":"infrastructure/infra-env/#references_3","title":"References","text":"<ul> <li>Gunicorn documentation.</li> </ul>"},{"location":"infrastructure/infra-env/#log_level","title":"LOG_LEVEL","text":"<p>Define the minimum log level to show.</p>"},{"location":"infrastructure/infra-env/#default_4","title":"Default","text":"<p>INFO</p>"},{"location":"infrastructure/infra-env/#where-it-is-used_3","title":"Where it is used","text":"<ul> <li><code>scripts/dyno/celeryworker.sh</code></li> <li><code>breathecode/settings.py</code></li> </ul>"},{"location":"infrastructure/infra-env/#celery_min_workers","title":"CELERY_MIN_WORKERS","text":"<p>Minimum workers to be up.</p>"},{"location":"infrastructure/infra-env/#default_5","title":"Default","text":"<p>2</p>"},{"location":"infrastructure/infra-env/#references_4","title":"References","text":"<ul> <li>Celery documentation.</li> </ul>"},{"location":"infrastructure/infra-env/#where-it-is-used_4","title":"Where it is used","text":"<ul> <li><code>scripts/dyno/celeryworker.sh</code></li> </ul>"},{"location":"infrastructure/infra-env/#celery_max_workers","title":"CELERY_MAX_WORKERS","text":"<p>Maximum workers to be up.</p>"},{"location":"infrastructure/infra-env/#default_6","title":"Default","text":"<p>2</p>"},{"location":"infrastructure/infra-env/#references_5","title":"References","text":"<ul> <li>Celery documentation.</li> </ul>"},{"location":"infrastructure/infra-env/#where-it-is-used_5","title":"Where it is used","text":"<ul> <li><code>scripts/dyno/celeryworker.sh</code></li> </ul>"},{"location":"infrastructure/infra-env/#celery_prefetch_multiplier","title":"CELERY_PREFETCH_MULTIPLIER","text":"<p>Number of messages that will be accepted by each worker.</p>"},{"location":"infrastructure/infra-env/#default_7","title":"Default","text":"<p>4</p>"},{"location":"infrastructure/infra-env/#references_6","title":"References","text":"<ul> <li>Celery documentation.</li> </ul>"},{"location":"infrastructure/infra-env/#where-it-is-used_6","title":"Where it is used","text":"<ul> <li><code>scripts/dyno/celeryworker.sh</code></li> </ul>"},{"location":"infrastructure/infra-env/#celery_pool","title":"CELERY_POOL","text":"<p>Worker class that will manage the concurrency.</p>"},{"location":"infrastructure/infra-env/#default_8","title":"Default","text":"<p>prefork</p>"},{"location":"infrastructure/infra-env/#references_7","title":"References","text":"<ul> <li>Celery documentation.</li> </ul>"},{"location":"infrastructure/infra-env/#where-it-is-used_7","title":"Where it is used","text":"<ul> <li><code>scripts/dyno/celeryworker.sh</code></li> </ul>"},{"location":"infrastructure/journal/","title":"Journal","text":""},{"location":"infrastructure/journal/#notes","title":"Notes","text":"<ul> <li>RPM: request per minute.</li> <li><code>/v1/admissions/cohort/all</code>: a light endpoint cached.</li> <li><code>/v1/admissions/syllabus/version</code>: a heavy endpoint cached.</li> </ul>"},{"location":"infrastructure/journal/#01122024","title":"01/12/2024","text":"<ul> <li><code>[dev]</code> switch <code>WEB_WORKER_CLASS</code> from <code>gevent</code> to <code>uvicorn.workers.UvicornWorker</code>.</li> <li><code>[dev]</code> switch <code>WEB_WORKERS</code> from <code>1</code> to <code>2</code>.</li> <li><code>[dev]</code> switch <code>WEB_WORKER_CONNECTION</code> from <code>120</code> to <code>160</code>.</li> </ul> <p>Side effects:</p> <ul> <li>Support to async in Django.</li> <li>Memory up from 265MB to 437MB.</li> <li><code>/v1/admissions/cohort/all</code> and <code>/v1/admissions/syllabus/version</code> changed from 35 RPM both to 133 RPM #1 and 31 RPM #2, this should change with each attempt.</li> </ul>"},{"location":"infrastructure/journal/#01152024","title":"01/15/2024","text":"<ul> <li><code>[all]</code> <code>django_minify_html</code> was added to the middlewares.</li> <li><code>[prod]</code> <code>make_charges</code> frequency changed from <code>every 10 minutes</code> to <code>Daily at 12:00 AM UTC</code>.</li> </ul>"},{"location":"infrastructure/journal/#01162024","title":"01/16/2024","text":"<ul> <li><code>[prod]</code> set <code>CELERY_DYNOS</code> to <code>2</code>.</li> <li><code>[prod]</code> set <code>CELERY_MAX_WORKERS</code> to <code>3</code>.</li> <li><code>[dev]</code> switch <code>CELERY_MAX_WORKERS</code> from <code>1</code> to <code>2</code>.</li> </ul>"},{"location":"infrastructure/journal/#01172024","title":"01/17/2024","text":"<ul> <li><code>[all]</code> <code>STATIC_BUCKET</code> setted.</li> </ul> <p>Side effects:</p> <ul> <li><code>/v1/admissions/cohort/all</code> changed from 133 RPM both to 145 - 170 (one time) RPM, this should change with each attempt.</li> </ul>"},{"location":"infrastructure/journal/#01242024","title":"01/24/2024","text":"<ul> <li><code>[prod]</code> preboot was enabled.</li> <li><code>[prod]</code> switch <code>WEB_WORKER_CLASS</code> from <code>gevent</code> to <code>uvicorn.workers.UvicornWorker</code>.</li> <li><code>[prod]</code> switch <code>LOG_LEVEL</code> from <code>DEBUG</code> to <code>WARNING</code>.</li> <li><code>[prod]</code> set <code>WEB_MAX_REQUESTS</code> to <code>6000</code>.</li> <li><code>[prod]</code> set <code>WEB_MAX_REQUESTS_JITTER</code> to <code>3000</code>.</li> <li><code>[dev]</code> set <code>WEB_MAX_REQUESTS</code> to <code>100</code>.</li> <li><code>[dev]</code> set <code>WEB_MAX_REQUESTS_JITTER</code> to <code>50</code>.</li> </ul> <p>Side effects:</p> <ul> <li>In dev, this prevents the server could getting out of memory.</li> <li>In prod, this helps to have sufficient memory to add a third worker.</li> <li>If the server would have 1000 requests each 10 minutes, this would restart the worker each 60-90 minutes.</li> </ul>"},{"location":"infrastructure/journal/#01252024","title":"01/25/2024","text":"<ul> <li><code>[prod]</code> switch <code>WEB_MAX_REQUESTS</code> from <code>6000</code> to <code>3000</code>.</li> <li><code>[prod]</code> switch <code>WEB_MAX_REQUESTS_JITTER</code> from <code>3000</code> to <code>1500</code>.</li> </ul> <p>Reasons for the change:</p> <ul> <li>Web worker was reaching 841 MB ram.</li> </ul>"},{"location":"infrastructure/journal/#-09092024","title":"-09/09/2024","text":"<ul> <li><code>[all]</code> <code>GOOGLE_SECRET</code> setted.</li> <li><code>[dev]</code> <code>GOOGLE_CLIENT_ID</code> setted.</li> <li><code>[all]</code> <code>GOOGLE_REDIRECT_URL</code> setted.</li> </ul>"},{"location":"infrastructure/journal/#11092024","title":"11/09/2024","text":"<ul> <li><code>[all]</code> <code>GOOGLE_CLIENT_SECRET</code> setted.</li> </ul> <p>Why:</p> <ul> <li>To enable the oauth flow for the Google Meet API.</li> </ul>"},{"location":"infrastructure/journal/#30092024","title":"30/09/2024","text":"<ul> <li><code>[prod]</code> set <code>GOOGLE_WEBHOOK_TOPIC</code> to <code>webhook</code>.</li> <li><code>[dev]</code> set <code>GOOGLE_WEBHOOK_TOPIC</code> to <code>webhook-test</code>.</li> </ul> <p>Why:</p> <ul> <li>Google doesn't support webhooks directly, it uses its Pub/Sub service.</li> </ul>"},{"location":"infrastructure/journal/#06102024","title":"06/10/2024","text":"<ul> <li><code>[dev]</code> <code>HEROKU_POSTGRESQL_TEAL</code> was replaced by <code>HEROKU_POSTGRESQL_GOLD</code>.</li> </ul>"},{"location":"infrastructure/journal/#29012025","title":"29/01/2025","text":"<ul> <li><code>[dev]</code> switch <code>CELERY_CONCURRENCY</code> from <code>8</code> to <code>4</code>.</li> </ul> <p>Why:</p> <ul> <li>To reduce the memory usage of the celery workers.</li> </ul>"},{"location":"infrastructure/web/","title":"Web","text":""},{"location":"infrastructure/web/#studies","title":"Studies","text":"<ul> <li>Django workers</li> <li>HTTP client</li> </ul>"},{"location":"infrastructure/web/#setup","title":"Setup","text":""},{"location":"infrastructure/web/#worker","title":"Worker","text":"<p>Gunicorn + Uvicorn.</p>"},{"location":"infrastructure/web/#http-client","title":"HTTP client","text":""},{"location":"infrastructure/web/#sync","title":"Sync","text":"<p>Requests.</p>"},{"location":"infrastructure/web/#async","title":"Async","text":"<p>AIOHTTP.</p>"},{"location":"infrastructure/web/#next-step","title":"Next step","text":""},{"location":"infrastructure/web/#strategy-about-blocking-code","title":"Strategy about blocking code","text":"<ol> <li>All blocking code will be split in db and others.</li> <li>Make a <code>v2</code> to all endpoints with blocking code from the category others.</li> <li>All new endpoints that use blocking code must use async functions.</li> <li>All blocking code from the category db is sync, I think that forcing a massive migration should be a bit useless, django just wrote a wrapper.</li> </ol>"},{"location":"infrastructure/web/#study-async-replacements-to-the-actual-libs","title":"Study async replacements to the actual libs","text":"<p>Sometimes the async libs work significantly faster than sync libraries, it is necessary to collect those cases and use those libs, you must take into consideration that some codes are faster using sync code.</p>"},{"location":"infrastructure/web/#see-how-progress-uvicorn","title":"See how progress Uvicorn","text":"<p>Uvicorn is the most stable worker, if it fails we must study how do works Hypercorn with Evloop.</p>"},{"location":"infrastructure/studies/django-workers/","title":"Better Django worker","text":"<p>This article is based fundamentally on which option is better in efficiency and features, we are covering three libraries because they were popular choices by the community.</p>"},{"location":"infrastructure/studies/django-workers/#collected-workers","title":"Collected workers","text":""},{"location":"infrastructure/studies/django-workers/#gevent","title":"Gevent","text":"<p>Gevent patches many system libraries to become cooperative and it does that the worker works as if this were asynchronous but over WSGI, but this does not allow running asynchronous code.</p>"},{"location":"infrastructure/studies/django-workers/#uvicorn","title":"Uvicorn","text":"<p>Uvicorn is an ASGI implementation for Python, it is known as a faster worker until now.</p>"},{"location":"infrastructure/studies/django-workers/#hypercorn","title":"Hypercorn","text":"<p>Hypercorn is an ASGI implementation for Python, it is a good option compared with Uvicorn.</p>"},{"location":"infrastructure/studies/django-workers/#source-of-truth","title":"Source of Truth","text":"<p>I needed to see how should impact the blocking code to the web worker, I wrote <code>Gevent vs Uvicorn vs Hypercorn</code> to cover this purpose, this is the next charset of <code>Requests vs HTTPX vs AIOHTTP</code>.</p>"},{"location":"infrastructure/studies/django-workers/#source","title":"Source","text":"<ul> <li>Requests vs HTTPX vs AIOHTTP</li> <li>Gevent vs Uvicorn vs Hypercorn</li> </ul>"},{"location":"infrastructure/studies/django-workers/#result","title":"Result","text":"<ul> <li>Requests vs HTTPX vs AIOHTTP</li> <li>Web worker tests</li> <li>Emulating cache</li> </ul>"},{"location":"infrastructure/studies/django-workers/#which-was-the-conclusions","title":"Which was the conclusions","text":"<p>Should be fine read this first, it was the results:</p> <p>Gevent:</p> <ul> <li>Stability: good</li> <li>Blocking code: it is bad, it gets worse the longer it lasts.</li> <li>Non-blocking code: it is the better option.</li> <li>Async support: no.</li> <li>Best HTTP sync client: requests, HTTPX performs bad, maybe its performance is degraded by the patch.</li> <li>Best HTTP async client: not compatible.</li> </ul> <p>Uvicorn:</p> <ul> <li>Statibility: good</li> <li>Blocking code: Good.</li> <li>Non-blocking code: regular.</li> <li>Async support: yes.</li> <li>Best HTTP sync client: requests, HTTPX performs bad, maybe its performance is degraded by the patch.</li> <li>Best HTTP async client: AIOHTTP is good.</li> </ul> <p>Hypercorn + Asyncio:</p> <ul> <li>Stability: bad, I could configure it properly.</li> <li>Blocking code: weak.</li> <li>Non-blocking code: regular.</li> <li>Async support: yes.</li> <li>Best HTTP sync client: requests, HTTPX performs bad, maybe its performance is degraded by the patch.</li> <li>Best HTTP async client: AIOHTTP is good.</li> </ul> <p>Hypercorn + Evloop:</p> <ul> <li>Stability: bad, I could configure it properly.</li> <li>Blocking code: Best performance, with fails.</li> <li>Non-blocking code: regular.</li> <li>Async support: yes.</li> <li>Best HTTP sync client: requests, HTTPX perform bad, maybe its performance is degraded by the patch.</li> <li>Best HTTP async client: AIOHTTP is good.</li> </ul> <p>Hypercorn + Trio:</p> <ul> <li>Stability: no supported yet</li> </ul>"},{"location":"infrastructure/studies/django-workers/#notes","title":"Notes","text":"<ul> <li>RPS are requests per second.</li> <li>Requests do not support asynchronous code, so you cannot use wait with it.</li> </ul>"},{"location":"infrastructure/studies/django-workers/#making-requests-within-the-web-worker","title":"Making requests within the web worker","text":"Library Gevent Uvicorn Hypercorn + Asyncio Hypercorn + Evloop Sync JSON 30913.89 RPS 4061.19 RPS 3753.90 RPS 4929.08 RPS Async JSON 3464.25 RPS 3270.73 RPS 4533.80 RPS Sync query JSON 11498.22 RPS 1845.01 RPS 1691.03 RPS 1969.74 RPS Async query JSON 1997.32 RPS 1565.80 RPS 2148.56 RPS Sync query HTML 7113.50 RPS 1590.24 RPS 1189.28 RPS 1577.94 RPS Async query HTML 1749.29 RPS 1382.19 RPS 1792.08 RPS Sync blocking 1s 1861.80 RPS 1819.99 RPS 1747.01 RPS 1769.52 RPS Async blocking 1s 1805.06 RPS 1676.20 RPS 1712.17 RPS Sync blocking 3s 635.14 RPS 631.95 RPS 585.55 RPS 578.60 RPS Async blocking 3s 1592.22 RPS 1476.54 RPS 1395.52 RPS Sync blocking 10s 181.38 RPS 181.37 RPS 181.43 RPS 152.51 RPS Async blocking 10s 90.72 RPS 37.97 RPS 29.12 RPS Sync Brotli 414.45 RPS 295.72 RPS 314.35 RPS 324.34 RPS Async Brotli 158.04 RPS 142.45 RPS 193.18 RPS Sync Request 38.50 RPS 25.08 RPS 22.04 RPS 16.01 RPS Async Request 0.00 RPS 0.00 RPS 0.00 RPS Sync HTTPX 0.50 RPS 0.00 RPS 0.00 RPS 0.00 RPS Async HTTPX 42.81 RPS 17.74 RPS 17.42 RPS Async AIOHTTP 35.07 RPS 23.40 RPS 45.29 RPS Sync Fake Redis hit 26658.00 RPS 5654.22 RPS 3251.49 RPS 4327.30 RPS Async Fake Redis hit 6295.06 RPS 3735.66 RPS 4035.76 RPS Sync Fake Redis set 9669.09 RPS 4366.79 RPS 3236.40 RPS 3676.91 RPS Async Fake Redis set 3806.02 RPS 3399.52 RPS 3713.74 RPS"},{"location":"infrastructure/studies/http-clients/","title":"Better HTTP client","text":"<p>This article is based fundamentally on which option is better in efficiency and features, we are covering tree libraries because them was a popular choice by the community.</p>"},{"location":"infrastructure/studies/http-clients/#collected-http-clients","title":"Collected HTTP clients","text":""},{"location":"infrastructure/studies/http-clients/#request","title":"Request","text":"<p>Requests is a library that focuses on a synchronous way to write code, it is the most popular choice but lacks asynchronous compatibility.</p>"},{"location":"infrastructure/studies/http-clients/#httpx","title":"HTTPX","text":"<p>HTTPX is a library that is synchronous and asynchronous, this library is the most versatile of them, and it supports HTTP2.</p>"},{"location":"infrastructure/studies/http-clients/#aiohttp","title":"AIOHTTP","text":"<p>AIOHTTP is a library focused on asynchronous code, and many people claim that it is a faster library.</p>"},{"location":"infrastructure/studies/http-clients/#source-of-truth","title":"Source of Truth","text":"<p>To see how these libraries perform about each other I wrote <code>Requests vs HTTPX vs AIOHTTP</code>, and then I needed to see how should impact the blocking code to the web worker, I wrote <code>Gevent vs Uvicorn vs Hypercorn</code> to cover this purpose</p>"},{"location":"infrastructure/studies/http-clients/#source","title":"Source","text":"<ul> <li>Requests vs HTTPX vs AIOHTTP</li> <li>Gevent vs Uvicorn vs Hypercorn</li> </ul>"},{"location":"infrastructure/studies/http-clients/#result","title":"Result","text":"<ul> <li>Requests vs HTTPX vs AIOHTTP, 1000 requests</li> <li>Requests vs HTTPX vs AIOHTTP, 20 urls</li> <li>Effects of using blocking code</li> </ul>"},{"location":"infrastructure/studies/http-clients/#which-was-the-conclusions","title":"Which was the conclusions","text":"<p>Requests and AIOHTTP were the most stable over all web workers, I could not get HTTPX to work with those settings. HTTPX is theoretically better than Requests but I cannot replicate it. AIOHTTP was from 4 to 10 times faster than Requests, and it does not block the execution flow. You can follow this topic here.</p>"},{"location":"infrastructure/studies/http-clients/#notes","title":"Notes","text":"<ul> <li>RPS are requests per second.</li> <li>Requests do not support asynchronous code, so you cannot use wait with it.</li> <li>All requests were tested within 22 seconds.</li> </ul>"},{"location":"infrastructure/studies/http-clients/#visit-httpswwwgooglecom-1000-times","title":"Visit https://www.google.com 1000 times","text":"Library Sync Async Requests 48.43s HTTPX 19.02s 37.86s AIOHTTP 13.03s"},{"location":"infrastructure/studies/http-clients/#visit-20-sites","title":"Visit 20 sites","text":"Library Sync Async Requests 7.15s HTTPX 4.37s 2.28s AIOHTTP 0.72s"},{"location":"infrastructure/studies/http-clients/#making-requests-within-the-web-worker","title":"Making requests within the web worker","text":"Library Gevent Uvicorn Hypercorn + Asyncio Hypercorn + Evloop Sync Requests 40.12 RPS 27.72 RPS 16.47 RPS 16.20 RPS Async Requests 0.00 RPS 0.00 RPS 0.00 RPS Sync HTTPX 0.41 RPS 3.58 RPS 0.00 RPS 0.00 RPS Async HTTPX 0.00 RPS 21.83 RPS 18.61 RPS Async AIOHTTP 24.18 RPS 18.73 RPS 37.26 RPS"},{"location":"installation/fixtures/","title":"Fixtures","text":"<p>Fixtures are fake data ideal for development.</p>"},{"location":"installation/fixtures/#saving-new-fixtures","title":"Saving new fixtures","text":"<pre><code>python manage.py dumpdata auth &gt; ./breathecode/authenticate/fixtures/users.json\n</code></pre>"},{"location":"installation/fixtures/#loading-all-fixtures","title":"Loading all fixtures","text":"<pre><code>poetry run python manage.py loaddata breathecode/*/fixtures/dev_*.json\n</code></pre>"},{"location":"notifications/notification-registry/","title":"Notification Registry","text":"<p>The Notification Registry is a centralized system for managing and previewing email, Slack, SMS, and other notification templates used throughout the BreatheCode platform.</p>"},{"location":"notifications/notification-registry/#overview","title":"Overview","text":"<p>The notification system consists of:</p> <ol> <li>JSON Registry Files: Individual JSON files in <code>breathecode/notify/registry/</code> that define each notification's metadata</li> <li>EmailManager: A singleton class that loads and manages notification templates</li> <li>API Endpoints: REST endpoints for listing, viewing, and previewing notifications (requires <code>read_notification</code> capability)</li> <li>Template Files: Django templates in various app <code>templates/</code> directories</li> </ol>"},{"location":"notifications/notification-registry/#architecture","title":"Architecture","text":""},{"location":"notifications/notification-registry/#registry-structure","title":"Registry Structure","text":"<p>Each notification is defined in a separate JSON file located at:</p> <pre><code>breathecode/notify/registry/{slug}.json\n</code></pre> <p>The file name must match the <code>slug</code> field inside the JSON.</p>"},{"location":"notifications/notification-registry/#json-file-format","title":"JSON File Format","text":"<pre><code>{\n    \"slug\": \"pick_password\",\n    \"name\": \"Pick Password\",\n    \"description\": \"Sent when user requests a password reset\",\n    \"category\": \"authentication\",\n    \"channels\": {\n        \"email\": {\n            \"template_path\": \"pick_password\",\n            \"default_subject\": \"Reset your password\"\n        },\n        \"slack\": {\n            \"template_path\": \"pick_password\",\n            \"default_subject\": null\n        }\n    },\n    \"variables\": [\n        {\n            \"name\": \"LINK\",\n            \"description\": \"URL to password reset page with token\",\n            \"source\": \"Generated from API_URL + token\",\n            \"example\": \"https://api.4geeks.com/v1/auth/password/reset?token=abc123\",\n            \"required\": true\n        }\n    ]\n}\n</code></pre>"},{"location":"notifications/notification-registry/#field-descriptions","title":"Field Descriptions","text":"Field Type Description <code>slug</code> string Unique identifier, must match filename (without .json) <code>name</code> string Human-readable name <code>description</code> string Detailed description of when this notification is sent <code>category</code> string Category for grouping (authentication, academy, feedback, monitoring, general) <code>channels</code> object Available channels and their configurations <code>channels.{channel}.template_path</code> string Path to template files (without extension) <code>channels.{channel}.default_subject</code> string Default subject line (email only) <code>variables</code> array List of template variables <code>variables[].name</code> string Variable name as used in template <code>variables[].description</code> string Human-readable description <code>variables[].source</code> string Where/how the variable is generated <code>variables[].example</code> string Example value <code>variables[].required</code> boolean Whether variable must be provided"},{"location":"notifications/notification-registry/#available-notifications","title":"Available Notifications","text":""},{"location":"notifications/notification-registry/#authentication-category","title":"Authentication Category","text":""},{"location":"notifications/notification-registry/#pick_password","title":"pick_password","text":"<ul> <li>Description: Sent when user requests a password reset or needs to set their password</li> <li>Channels: email</li> <li>Variables: <code>LINK</code>, <code>subject</code></li> </ul>"},{"location":"notifications/notification-registry/#verify_email","title":"verify_email","text":"<ul> <li>Description: Email verification for new user accounts</li> <li>Channels: email</li> <li>Variables: <code>LINK</code>, <code>subject</code></li> </ul>"},{"location":"notifications/notification-registry/#academy-category","title":"Academy Category","text":""},{"location":"notifications/notification-registry/#academy_invite","title":"academy_invite","text":"<ul> <li>Description: Sent when a user is invited to join an academy</li> <li>Channels: email</li> <li>Variables: <code>user.first_name</code>, <code>LINK</code>, <code>invites</code></li> </ul>"},{"location":"notifications/notification-registry/#welcome_academy","title":"welcome_academy","text":"<ul> <li>Description: Welcome email sent to new academy members</li> <li>Channels: email</li> <li>Variables: <code>FIRST_NAME</code>, <code>LINK</code>, <code>subject</code></li> </ul>"},{"location":"notifications/notification-registry/#feedback-category","title":"Feedback Category","text":""},{"location":"notifications/notification-registry/#nps_survey","title":"nps_survey","text":"<ul> <li>Description: Net Promoter Score survey request</li> <li>Channels: email, slack</li> <li>Variables: <code>SUBJECT</code>, <code>MESSAGE</code>, <code>LINK</code>, <code>BUTTON</code></li> </ul>"},{"location":"notifications/notification-registry/#monitoring-category","title":"Monitoring Category","text":""},{"location":"notifications/notification-registry/#diagnostic","title":"diagnostic","text":"<ul> <li>Description: System monitoring diagnostic reports</li> <li>Channels: email</li> <li>Variables: <code>subject</code>, <code>details</code>, <code>button</code></li> </ul>"},{"location":"notifications/notification-registry/#general-category","title":"General Category","text":""},{"location":"notifications/notification-registry/#message","title":"message","text":"<ul> <li>Description: Generic notification template for custom messages</li> <li>Channels: email</li> <li>Variables: <code>SUBJECT</code>, <code>MESSAGE</code>, <code>BUTTON</code>, <code>LINK</code>, <code>BUTTON_TARGET</code>, <code>GO_BACK</code>, <code>URL_BACK</code></li> </ul>"},{"location":"notifications/notification-registry/#variable-types","title":"Variable Types","text":"<p>The system provides three types of variables:</p>"},{"location":"notifications/notification-registry/#1-default-variables","title":"1. Default Variables","text":"<p>Always available in all templates:</p> <ul> <li><code>API_URL</code>: Base API URL from environment</li> <li><code>COMPANY_NAME</code>: Company name from environment</li> <li><code>COMPANY_CONTACT_URL</code>: Contact URL from environment</li> <li><code>COMPANY_LEGAL_NAME</code>: Legal company name from environment</li> <li><code>COMPANY_ADDRESS</code>: Company address from environment</li> <li><code>style__success</code>: Success color (#99ccff)</li> <li><code>style__danger</code>: Danger color (#ffcccc)</li> <li><code>style__secondary</code>: Secondary color (#ededed)</li> </ul>"},{"location":"notifications/notification-registry/#2-template-specific-variables","title":"2. Template-Specific Variables","text":"<p>Defined in each notification's JSON file, specific to that template.</p>"},{"location":"notifications/notification-registry/#3-academy-specific-variables","title":"3. Academy-Specific Variables","text":"<p>Automatically included when an academy context is provided:</p> <ul> <li><code>COMPANY_INFO_EMAIL</code>: Academy feedback email</li> <li><code>COMPANY_LEGAL_NAME</code>: Academy legal name or name</li> <li><code>COMPANY_LOGO</code>: Academy logo URL</li> <li><code>COMPANY_NAME</code>: Academy name</li> </ul>"},{"location":"notifications/notification-registry/#api-endpoints","title":"API Endpoints","text":"<p>All endpoints require the <code>read_notification</code> capability (available to admin and country_manager roles).</p>"},{"location":"notifications/notification-registry/#list-all-notifications","title":"List All Notifications","text":"<pre><code>GET /v1/messaging/academy/template\n</code></pre> <p>Query Parameters: - <code>category</code> (optional): Filter by category - <code>search</code> (optional): Search in name/description - <code>channel</code> (optional): Filter by channel availability</p> <p>Response: <pre><code>{\n    \"templates\": [\n        {\n            \"slug\": \"pick_password\",\n            \"name\": \"Pick Password\",\n            \"description\": \"...\",\n            \"category\": \"authentication\",\n            \"channels\": {...},\n            \"variables\": [...]\n        }\n    ],\n    \"categories\": [\"authentication\", \"academy\", \"feedback\"],\n    \"total\": 7\n}\n</code></pre></p>"},{"location":"notifications/notification-registry/#get-notification-details","title":"Get Notification Details","text":"<pre><code>GET /v1/messaging/academy/template/{slug}\n</code></pre> <p>Response: <pre><code>{\n    \"slug\": \"pick_password\",\n    \"name\": \"Pick Password\",\n    \"description\": \"...\",\n    \"category\": \"authentication\",\n    \"channels\": {...},\n    \"variables\": [...]\n}\n</code></pre></p>"},{"location":"notifications/notification-registry/#preview-notification-template","title":"Preview Notification Template","text":"<pre><code>GET /v1/messaging/academy/template/{slug}/preview\n</code></pre> <p>Headers: - <code>Academy</code> (required): Academy ID from request headers (validated by capable_of decorator)</p> <p>Query Parameters: - <code>channels</code> (optional): Comma-separated list of channels to preview (e.g., \"email,slack\")</p> <p>Response: <pre><code>{\n    \"slug\": \"pick_password\",\n    \"name\": \"Pick Password\",\n    \"description\": \"...\",\n    \"category\": \"authentication\",\n    \"channels\": {\n        \"email\": {\n            \"html\": \"{% extends \\\"base.html\\\" %}...\",\n            \"text\": \"You are seen this email...\",\n            \"subject\": \"Reset your password\"\n        }\n    },\n    \"variables\": {\n        \"default\": {\n            \"API_URL\": \"https://api.4geeks.com\",\n            \"COMPANY_NAME\": \"4Geeks\"\n        },\n        \"template_specific\": {\n            \"LINK\": {\n                \"description\": \"URL to password reset page\",\n                \"source\": \"Generated from API_URL + token\",\n                \"example\": \"https://api.4geeks.com/...\",\n                \"required\": true\n            }\n        },\n        \"academy_specific\": {\n            \"COMPANY_LOGO\": \"https://...\"\n        }\n    }\n}\n</code></pre></p>"},{"location":"notifications/notification-registry/#usage-examples","title":"Usage Examples","text":""},{"location":"notifications/notification-registry/#using-curl","title":"Using curl","text":"<pre><code># List all notifications\ncurl -H \"Authorization: Token YOUR_TOKEN\" \\\n  https://api.4geeks.com/v1/messaging/academy/template\n\n# Get specific notification\ncurl -H \"Authorization: Token YOUR_TOKEN\" \\\n  https://api.4geeks.com/v1/messaging/academy/template/pick_password\n\n# Preview with academy branding (academy ID from header)\ncurl -H \"Authorization: Token YOUR_TOKEN\" \\\n  -H \"Academy: 1\" \\\n  \"https://api.4geeks.com/v1/messaging/academy/template/pick_password/preview\"\n</code></pre>"},{"location":"notifications/notification-registry/#using-javascriptaxios","title":"Using JavaScript/Axios","text":"<pre><code>// List all authentication notifications\nconst response = await axios.get(\n  '/v1/messaging/academy/template',\n  {\n    params: { category: 'authentication' },\n    headers: { Authorization: `Token ${token}` }\n  }\n);\n\n// Preview notification (academy ID in header)\nconst preview = await axios.get(\n  `/v1/messaging/academy/template/pick_password/preview`,\n  {\n    params: { channels: 'email' },\n    headers: { \n      Authorization: `Token ${token}`,\n      Academy: '1'\n    }\n  }\n);\n\n// Access template source\nconsole.log(preview.data.channels.email.html);\nconsole.log(preview.data.variables.template_specific);\n</code></pre>"},{"location":"notifications/notification-registry/#adding-new-notifications","title":"Adding New Notifications","text":""},{"location":"notifications/notification-registry/#step-1-create-template-files","title":"Step 1: Create Template Files","text":"<p>Create Django templates in the appropriate app's <code>templates/</code> directory:</p> <pre><code>breathecode/authenticate/templates/\n  - my_notification.html\n  - my_notification.txt\n  - my_notification.slack (optional)\n  - my_notification.sms (optional)\n</code></pre>"},{"location":"notifications/notification-registry/#step-2-create-json-registry-file","title":"Step 2: Create JSON Registry File","text":"<p>Create <code>breathecode/notify/registry/my_notification.json</code>:</p> <pre><code>{\n    \"slug\": \"my_notification\",\n    \"name\": \"My Notification\",\n    \"description\": \"Description of when this is sent\",\n    \"category\": \"authentication\",\n    \"channels\": {\n        \"email\": {\n            \"template_path\": \"my_notification\",\n            \"default_subject\": \"Subject Line\"\n        }\n    },\n    \"variables\": [\n        {\n            \"name\": \"VARIABLE_NAME\",\n            \"description\": \"What this variable contains\",\n            \"source\": \"How it's generated\",\n            \"example\": \"Example value\",\n            \"required\": true\n        }\n    ]\n}\n</code></pre>"},{"location":"notifications/notification-registry/#step-3-verify-registration","title":"Step 3: Verify Registration","text":"<p>The EmailManager automatically loads all JSON files on startup. Verify your notification appears:</p> <pre><code>curl -H \"Authorization: Token YOUR_TOKEN\" \\\n  https://api.4geeks.com/v1/messaging/academy/template | grep my_notification\n</code></pre>"},{"location":"notifications/notification-registry/#best-practices","title":"Best Practices","text":"<ol> <li>Naming: Use snake_case for slugs, matching the template file names</li> <li>Categories: Use existing categories when possible (authentication, academy, feedback, monitoring, general)</li> <li>Documentation: Provide clear descriptions and examples for all variables</li> <li>Template Paths: Path should match the template location without extension</li> <li>Required Fields: Mark variables as required only if the template breaks without them</li> <li>Examples: Use realistic example values that help understand the variable's format</li> </ol>"},{"location":"notifications/notification-registry/#troubleshooting","title":"Troubleshooting","text":""},{"location":"notifications/notification-registry/#notification-not-appearing","title":"Notification Not Appearing","text":"<ol> <li>Check that the JSON file is in <code>breathecode/notify/registry/</code></li> <li>Verify the filename matches the <code>slug</code> field (e.g., <code>pick_password.json</code> for slug <code>pick_password</code>)</li> <li>Validate the JSON syntax (use a JSON validator)</li> <li>Check server logs for parsing errors</li> </ol>"},{"location":"notifications/notification-registry/#template-not-loading","title":"Template Not Loading","text":"<ol> <li>Verify template files exist with correct names</li> <li>Check the <code>template_path</code> in the JSON matches the template filename (without extension)</li> <li>Ensure templates are in a valid templates directory</li> </ol>"},{"location":"notifications/notification-registry/#permission-denied","title":"Permission Denied","text":"<p>The API endpoints require the <code>read_notification</code> capability, which is only assigned to: - <code>admin</code> role - <code>country_manager</code> role</p>"},{"location":"notifications/notification-registry/#security","title":"Security","text":"<ul> <li>All endpoints require authentication</li> <li>The <code>read_notification</code> capability is required</li> <li>Academy-specific variables only included when user has academy access</li> <li>Template source code is exposed intentionally for preview purposes</li> <li>No sensitive data should be in template defaults</li> </ul>"},{"location":"notifications/notification-registry/#related-documentation","title":"Related Documentation","text":"<ul> <li>Authentication System</li> <li>Notification Models</li> <li>Email Actions</li> </ul>"},{"location":"payments/","title":"Payments Module","text":"<p>The payments module handles all subscription, billing, and payment-related functionality.</p>"},{"location":"payments/#features","title":"Features","text":""},{"location":"payments/#subscription-seats","title":"Subscription Seats","text":"<p>Team-based subscriptions where one owner can share access with multiple team members.</p> <ul> <li>Quick Start Guide - Simple introduction for beginners</li> <li>API Documentation - Detailed endpoint reference</li> <li>OpenAPI Spec - Machine-readable API definition</li> <li>Postman Collection - Ready-to-use API tests</li> </ul>"},{"location":"payments/#key-concepts","title":"Key Concepts","text":"<ul> <li>Subscriptions: Recurring payment plans</li> <li>Billing Teams: Groups that share subscription access</li> <li>Seats: Individual team member access</li> <li>Auto-Recharge: Automatic balance top-up</li> <li>Consumables: Services that can be consumed (mentorship, events, etc.)</li> <li>Consumption Strategy: How consumables are distributed (PER_TEAM vs PER_SEAT)</li> <li>is_team_allowed: Flag that determines consumable allocation:</li> <li><code>False</code>: Consumables go to subscription owner (personal)</li> <li><code>True</code>: Consumables go to team/seats (shared or per-seat)</li> </ul>"},{"location":"payments/#getting-started","title":"Getting Started","text":"<ol> <li>Read the Subscription Seats Guide to understand the basics</li> <li>Review the API Documentation for implementation details</li> <li>Import the Postman Collection to test endpoints</li> </ol> <p>File Locations: - Postman Collection: <code>openapi/subscription-seats/postman_collection.json</code> - OpenAPI Spec: <code>openapi/subscription-seats/openapi.yaml</code></p>"},{"location":"payments/#architecture","title":"Architecture","text":""},{"location":"payments/#per_team-strategy-shared-pool","title":"PER_TEAM Strategy (Shared Pool)","text":"<pre><code>User (Owner)\n  \u2514\u2500 Subscription\n      \u251c\u2500 Owner Consumables (is_team_allowed=False)\n      \u2502   \u251c\u2500 10 personal mentorship hours\n      \u2502   \u2514\u2500 5 personal event tickets\n      \u2502\n      \u2514\u2500 Billing Team\n          \u251c\u2500 Team Consumables (is_team_allowed=True, SHARED)\n          \u2502   \u251c\u2500 100 mentorship hours\n          \u2502   \u251c\u2500 50 event tickets\n          \u2502   \u2514\u2500 Auto-recharge enabled\n          \u2502\n          \u2514\u2500 Seats (Members)\n              \u251c\u2500 Member A (can use team consumables)\n              \u251c\u2500 Member B (can use team consumables)\n              \u2514\u2500 Member C (can use team consumables)\n</code></pre> <p>How it works: - Owner gets personal consumables (<code>is_team_allowed=False</code>) - Team has a shared pool of consumables (<code>is_team_allowed=True</code>) - Any team member can consume from the shared pool - When pool runs low, auto-recharge tops it up - Owner pays for all consumption</p> <p>Service Item Flag: - <code>is_team_allowed=False</code> \u2192 Consumables issued to owner only - <code>is_team_allowed=True</code> \u2192 Consumables issued to team pool</p> <p>Example: <pre><code>Team has 100 mentorship hours\n- Member A uses 30 hours \u2192 70 hours left\n- Member B uses 40 hours \u2192 30 hours left\n- Member C uses 20 hours \u2192 10 hours left\n- Auto-recharge adds 50 hours \u2192 60 hours left\n</code></pre></p>"},{"location":"payments/#per_seat-strategy-individual-allocation","title":"PER_SEAT Strategy (Individual Allocation)","text":"<pre><code>User (Owner)\n  \u2514\u2500 Subscription\n      \u251c\u2500 Owner Consumables (is_team_allowed=False)\n      \u2502   \u251c\u2500 10 personal mentorship hours\n      \u2502   \u2514\u2500 5 personal event tickets\n      \u2502\n      \u2514\u2500 Billing Team\n          \u251c\u2500 Seat 1 (Member A)\n          \u2502   \u2514\u2500 Consumables (is_team_allowed=True, individual)\n          \u2502       \u251c\u2500 10 mentorship hours\n          \u2502       \u2514\u2500 5 event tickets\n          \u2502\n          \u251c\u2500 Seat 2 (Member B)\n          \u2502   \u2514\u2500 Consumables (is_team_allowed=True, individual)\n          \u2502       \u251c\u2500 10 mentorship hours\n          \u2502       \u2514\u2500 5 event tickets\n          \u2502\n          \u2514\u2500 Seat 3 (Member C)\n              \u2514\u2500 Consumables (is_team_allowed=True, individual)\n                  \u251c\u2500 20 mentorship hours (2x multiplier)\n                  \u2514\u2500 10 event tickets (2x multiplier)\n</code></pre> <p>How it works: - Owner gets personal consumables (<code>is_team_allowed=False</code>) - Each seat has individual allocation (<code>is_team_allowed=True</code>) - Members can only use their own consumables - Seat multiplier determines allocation (2x = double) - Owner pays for all seats</p> <p>Service Item Flag: - <code>is_team_allowed=False</code> \u2192 Consumables issued to owner only - <code>is_team_allowed=True</code> \u2192 Consumables issued to each seat individually</p> <p>Example: <pre><code>Member A (1x seat):\n- Gets 10 mentorship hours\n- Uses 8 hours \u2192 2 hours left\n- Cannot use Member B's hours\n\nMember C (2x seat):\n- Gets 20 mentorship hours (2x multiplier)\n- Uses 15 hours \u2192 5 hours left\n- Cannot share with others\n</code></pre></p>"},{"location":"payments/#comparison","title":"Comparison","text":"Feature PER_TEAM PER_SEAT Owner Consumables <code>is_team_allowed=False</code> (personal) <code>is_team_allowed=False</code> (personal) Team Consumables <code>is_team_allowed=True</code> (shared pool) <code>is_team_allowed=True</code> (per seat) Flexibility High (anyone can use) Low (fixed per member) Recharge Manual or Auto (team level) Manual or Auto (per seat) Auto-Recharge \u2705 Supported \u2705 Supported (per seat) Seat Multiplier Not used Determines allocation Use Case Small teams, flexible usage Large teams, fair distribution Example Startup with 3 devs Enterprise with 50 employees"},{"location":"payments/#related-modules","title":"Related Modules","text":"<ul> <li>Provisioning: Manages consumable allocation</li> <li>Monitoring: Tracks usage and spending</li> <li>Notify: Sends payment notifications</li> </ul>"},{"location":"payments/auto-recharge-architecture/","title":"Auto-Recharge Architecture","text":"<p>Detailed architecture diagrams and technical implementation of the auto-recharge system.</p>"},{"location":"payments/auto-recharge-architecture/#component-architecture","title":"Component Architecture","text":""},{"location":"payments/auto-recharge-architecture/#subscriptionbillingteam-model","title":"SubscriptionBillingTeam Model","text":"<p>Fields: - <code>auto_recharge_enabled</code>: bool - <code>recharge_threshold_amount</code>: decimal - <code>recharge_amount</code>: decimal - <code>max_period_spend</code>: decimal (optional)</p> <p>Methods: - <code>get_current_monthly_period_dates()</code> \u2192 (start, end) - <code>get_current_period_spend()</code> \u2192 float - <code>can_auto_recharge(amount, lang)</code> \u2192 (bool, str)</p> <p>Relationship: Has many Consumables</p>"},{"location":"payments/auto-recharge-architecture/#consumable-model","title":"Consumable Model","text":"<p>Fields: - <code>subscription_billing_team</code>: FK (nullable) - <code>user</code>: FK (null for team consumables) - <code>how_many</code>: int (-1 = unlimited) - <code>service_item</code>: FK</p> <p>Relationship: References AcademyService via service_item</p>"},{"location":"payments/auto-recharge-architecture/#academyservice-model","title":"AcademyService Model","text":"<p>Fields: - <code>academy</code>: FK - <code>service</code>: FK - <code>price_per_unit</code>: decimal</p> <p>Purpose: Provides pricing for balance calculations</p>"},{"location":"payments/auto-recharge-architecture/#signal-flow","title":"Signal Flow","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502   User Action    \u2502\n\u2502  (Consume API)   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502\n         \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  consume_service.send(instance=consumable, how_many=X)      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502\n         \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n         \u2502                                                      \u2502\n         \u25bc                                                      \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 consume_service_receiver\u2502                    \u2502 check_consumable_balance \u2502\n\u2502  (Update how_many)      \u2502                    \u2502  _for_auto_recharge      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                                                          \u2502\n                                                          \u2502 1. Check team exists\n                                                          \u2502 2. Check auto_recharge_enabled\n                                                          \u2502 3. Check spending limit\n                                                          \u2502 4. Calculate balance\n                                                          \u2502    (using AcademyService pricing)\n                                                          \u2502\n                                                          \u25bc\n                                               \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                                               \u2502 Balance &lt; threshold? \u2502\n                                               \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                                                          \u2502 Yes\n                                                          \u25bc\n                                               \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                                               \u2502 consumable_balance_low   \u2502\n                                               \u2502  .send(team, amount)     \u2502\n                                               \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                                                          \u2502\n                                                          \u25bc\n                                               \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                                               \u2502 trigger_auto_recharge    \u2502\n                                               \u2502  _task receiver          \u2502\n                                               \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                                                          \u2502\n                                                          \u25bc\n                                               \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                                               \u2502 process_auto_recharge    \u2502\n                                               \u2502  .delay(team_id, amount) \u2502\n                                               \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                                                          \u2502\n                                                          \u25bc\n                                                    [Celery Queue]\n                                                          \u2502\n                                                          \u25bc\n                                               \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                                               \u2502  Celery Worker           \u2502\n                                               \u2502  + Redis Lock            \u2502\n                                               \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                                                          \u2502\n                                                          \u251c\u2500 Create consumables\n                                                          \u251c\u2500 Create invoice\n                                                          \u2514\u2500 Send notification\n</code></pre>"},{"location":"payments/auto-recharge-architecture/#decision-tree","title":"Decision Tree","text":"<pre><code>                    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                    \u2502 Consumable consumed \u2502\n                    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                               \u2502\n                               \u25bc\n                    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                    \u2502 Has billing team?    \u2502\n                    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                          Yes  \u2502  No \u2192 END\n                               \u25bc\n                    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                    \u2502 Auto-recharge        \u2502\n                    \u2502 enabled?             \u2502\n                    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                          Yes  \u2502  No \u2192 END\n                               \u25bc\n                    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                    \u2502 Monthly limit set?   \u2502\n                    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                          Yes  \u2502  No \u2192 Skip to balance check\n                               \u25bc\n                    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                    \u2502 Current \u2265 limit?     \u2502\n                    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                          Yes  \u2502  No\n                               \u2502   \u2502\n                          END \u2190\u2518   \u2502\n                                   \u25bc\n                    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                    \u2502 Calculate balance    \u2502\n                    \u2502 (AcademyService      \u2502\n                    \u2502  pricing)            \u2502\n                    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                               \u2502\n                               \u25bc\n                    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                    \u2502 Unlimited (-1)?      \u2502\n                    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                          Yes  \u2502  No\n                               \u2502   \u2502\n                          END \u2190\u2518   \u2502\n                                   \u25bc\n                    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                    \u2502 Balance &lt; threshold? \u2502\n                    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                          Yes  \u2502  No \u2192 END\n                               \u25bc\n                    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                    \u2502 Would exceed limit?  \u2502\n                    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                          Yes  \u2502  No\n                               \u2502   \u2502\n                    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                    \u2502 Adjust amount        \u2502\n                    \u2502 (partial or full)    \u2502\n                    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                               \u2502\n                               \u25bc\n                    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                    \u2502 Emit signal          \u2502\n                    \u2502 \u2192 Trigger task       \u2502\n                    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"payments/auto-recharge-architecture/#recharge-process-celery-task","title":"Recharge Process (Celery Task)","text":"<p>Steps:</p> <p>0. Acquire Redis Lock - Key: <code>\"auto_recharge:team:{team_id}\"</code> - Timeout: 300 seconds - Blocking: False (fail fast if locked)</p> <p>1. Fetch Team - Get SubscriptionBillingTeam by ID - Verify auto_recharge_enabled still true</p> <p>2. Validate Spending Limit - Get current_period_spend (from invoices) - Check &lt; max_period_spend - Adjust recharge_amount if needed</p> <p>3. Find Service Items - Query team-allowed services from subscription - Filter by is_team_allowed=True</p> <p>4. Create Consumables - For each service item:   - Get AcademyService pricing   - Calculate units (amount / price_per_unit)   - Create Consumable(user=None, subscription_billing_team=team, how_many=units) - Log creation</p> <p>5. Create Invoice (TODO) - Invoice.objects.create(user=subscription.user, amount=total_spent, subscription_billing_team=team) - Spending tracked via invoices</p> <p>6. Send Notification - Email to subscription.user - Include: amount, balance, limit, currency</p> <p>7. Release Lock &amp; Return - lock.release() - Return result dict</p>"},{"location":"payments/auto-recharge-architecture/#data-flow-example","title":"Data Flow Example","text":""},{"location":"payments/auto-recharge-architecture/#initial-state","title":"Initial State","text":"<pre><code>Team ID: 123\nSubscription Currency: USD\n\u251c\u2500 auto_recharge_enabled: True\n\u251c\u2500 recharge_threshold_amount: $10\n\u251c\u2500 recharge_amount: $20\n\u251c\u2500 max_period_spend: $100\n\u251c\u2500 current_period_spend: $40 (from invoices)\n\u2514\u2500 Team Consumables:\n    \u251c\u2500 Mentorship: 5 hours \u00d7 $2/hour = $10\n    \u2514\u2500 Events: 2 tickets \u00d7 $1/ticket = $2\n    Total Balance: $12\n</code></pre>"},{"location":"payments/auto-recharge-architecture/#user-consumes-5-mentorship-hours","title":"User Consumes 5 Mentorship Hours","text":"<pre><code>consume_service.send(consumable, how_many=5)\n\nBalance Calculation:\n  Before: 5 hours \u00d7 $2 = $10\n  After:  0 hours \u00d7 $2 = $0\n  Total:  $0 + $2 = $2\n\nCheck: $2 &lt; $10 (threshold) \u2713\nCheck: $40 + $20 = $60 &lt; $100 (limit) \u2713\n\u2192 Trigger recharge\n</code></pre>"},{"location":"payments/auto-recharge-architecture/#recharge-process","title":"Recharge Process","text":"<pre><code>process_auto_recharge.delay(team_id=123, recharge_amount=20)\n\n1. Acquire lock: \"auto_recharge:team:123\"\n2. Find services: Mentorship, Events\n3. Distribute $20:\n   - Mentorship: $10 \u2192 5 hours\n   - Events: $10 \u2192 10 tickets\n4. Create invoice: $20\n5. Send email\n6. Release lock\n</code></pre>"},{"location":"payments/auto-recharge-architecture/#final-state","title":"Final State","text":"<pre><code>Team ID: 123\n\u251c\u2500 auto_recharge_enabled: True\n\u251c\u2500 recharge_threshold_amount: $10\n\u251c\u2500 recharge_amount: $20\n\u251c\u2500 max_period_spend: $100\n\u251c\u2500 current_period_spend: $60 ($40 + $20 from invoice)\n\u2514\u2500 Team Consumables:\n    \u251c\u2500 Mentorship: 5 hours \u00d7 $2/hour = $10\n    \u2514\u2500 Events: 12 tickets \u00d7 $1/ticket = $12\n    Total Balance: $22\n</code></pre>"},{"location":"payments/auto-recharge-architecture/#integration-points","title":"Integration Points","text":""},{"location":"payments/auto-recharge-architecture/#external-integrations","title":"External Integrations","text":"<p>Django Signals (Capy Core Emisors) - consume_service (trigger) - consumable_balance_low (emit)</p> <p>Celery (Task Manager Plugin) - Task queue (RabbitMQ) - Workers (process_auto_recharge) - Priority: NOTIFICATION</p> <p>Redis - Distributed locks - Key: <code>\"auto_recharge:team:{id}\"</code></p> <p>Email Service (Notify Actions) - notify_actions.send_email_message() - Template: \"auto_recharge_completed\"</p> <p>Payment Gateway (Stripe) - stripe.pay() method - Creates Invoice model</p> <p>Database Models - SubscriptionBillingTeam (config) - Consumable (balance) - ServiceItem (team-allowed flag) - AcademyService (pricing) - Invoice (spending tracking)</p>"},{"location":"payments/auto-recharge-architecture/#error-handling","title":"Error Handling","text":""},{"location":"payments/auto-recharge-architecture/#error-scenarios","title":"Error Scenarios","text":"<p>Lock Already Acquired - AbortTask(\"Auto-recharge already in progress\") - Log warning (safe to ignore)</p> <p>Team Not Found - AbortTask(\"Team {id} not found\") - Log error</p> <p>Auto-Recharge Disabled - AbortTask(\"Auto-recharge disabled\") - Log warning</p> <p>Period Limit Reached - AbortTask(\"Period spending limit reached\") - Log warning</p> <p>No Team Service Items - AbortTask(\"No team-allowed services\") - Log warning</p> <p>AcademyService Not Found - Skip service (continue with others) - Log warning</p> <p>Notification Failure - Log warning (non-critical) - Continue (task succeeds)</p>"},{"location":"payments/auto-recharge-architecture/#performance-considerations","title":"Performance Considerations","text":""},{"location":"payments/auto-recharge-architecture/#signal-receiver-optimization","title":"Signal Receiver Optimization","text":"<pre><code># Lightweight check in receiver\ndef check_consumable_balance_for_auto_recharge(...):\n    # Quick checks first (avoid DB queries if possible)\n    if not instance.subscription_billing_team:\n        return  # Fast exit\n\n    team = instance.subscription_billing_team\n    if not team.auto_recharge_enabled:\n        return  # Fast exit\n\n    # Only calculate balance if needed\n    # Uses select_related() for efficiency\n</code></pre>"},{"location":"payments/auto-recharge-architecture/#celery-task-optimization","title":"Celery Task Optimization","text":"<pre><code># Heavy processing in async task\n@task(bind=True, priority=TaskPriority.NOTIFICATION)\ndef process_auto_recharge(...):\n    # Redis lock prevents concurrent execution\n    # select_related() reduces DB queries\n    # Bulk operations where possible\n</code></pre>"},{"location":"payments/auto-recharge-architecture/#database-queries","title":"Database Queries","text":"<ul> <li>Use <code>select_related()</code> for foreign keys</li> <li>Use <code>prefetch_related()</code> for reverse relations</li> <li>Aggregate queries for balance calculation</li> <li>Index on <code>subscription_billing_team</code> field</li> </ul>"},{"location":"payments/auto-recharge-architecture/#security-measures","title":"Security Measures","text":"<p>1. Owner-Only Modification - API endpoint validates <code>request.user == subscription.user</code> - Admin requires staff permissions</p> <p>2. Spending Limits - <code>max_period_spend</code> prevents runaway costs - Partial recharge when approaching limit</p> <p>3. Redis Lock - Prevents race conditions - Timeout prevents stuck locks (5 min)</p> <p>4. Invoice Audit Trail - All recharges create invoices - Spending calculated from invoices (not model fields)</p> <p>5. Input Validation - Serializer validates amounts (min_value=0) - Decimal precision enforced - Null handling for optional fields</p>"},{"location":"payments/auto-recharge/","title":"Auto-Recharge System","text":"<p>The auto-recharge system automatically replenishes team consumables when the balance runs low, ensuring uninterrupted service access.</p>"},{"location":"payments/auto-recharge/#overview","title":"Overview","text":"<p>When a billing team's consumable balance falls below a configured threshold, the system automatically:</p> <ol> <li>Purchases new consumables</li> <li>Charges the subscription owner</li> <li>Sends a notification</li> <li>Respects monthly spending limits</li> </ol>"},{"location":"payments/auto-recharge/#key-features","title":"Key Features","text":""},{"location":"payments/auto-recharge/#configurable-thresholds","title":"Configurable Thresholds","text":"<ul> <li>Recharge Threshold: Balance level that triggers recharge (e.g., $10)</li> <li>Recharge Amount: How much to add when triggered (e.g., $20)</li> <li>Monthly Limit: Optional spending cap per period (e.g., $100/month)</li> </ul>"},{"location":"payments/auto-recharge/#real-time-monitoring","title":"Real-Time Monitoring","text":"<ul> <li>Monitors every consumable consumption via Django signals</li> <li>Calculates team balance in subscription currency</li> <li>Uses <code>AcademyService</code> pricing for accurate valuation</li> </ul>"},{"location":"payments/auto-recharge/#spending-control","title":"Spending Control","text":"<ul> <li>Tracks spending per monthly period (based on <code>subscription.paid_at</code>)</li> <li>Automatically resets each period</li> <li>Supports partial recharge to stay within limits</li> </ul>"},{"location":"payments/auto-recharge/#async-processing","title":"Async Processing","text":"<ul> <li>Uses Celery tasks for non-blocking operation</li> <li>Redis lock prevents concurrent recharges</li> <li>Email notifications to subscription owner</li> </ul>"},{"location":"payments/auto-recharge/#quick-start","title":"Quick Start","text":""},{"location":"payments/auto-recharge/#enable-auto-recharge","title":"Enable Auto-Recharge","text":"<p>Via API: <pre><code>PUT /v2/payments/subscription/123/billing-team\nContent-Type: application/json\n\n{\n  \"auto_recharge_enabled\": true,\n  \"recharge_threshold_amount\": \"10.00\",\n  \"recharge_amount\": \"20.00\",\n  \"max_period_spend\": \"100.00\"\n}\n</code></pre></p> <p>Via Python: <pre><code>from breathecode.payments.models import SubscriptionBillingTeam\n\nteam = SubscriptionBillingTeam.objects.get(subscription_id=123)\nteam.auto_recharge_enabled = True\nteam.recharge_threshold_amount = 10.00  # In subscription currency\nteam.recharge_amount = 20.00\nteam.max_period_spend = 100.00  # Optional\nteam.save()\n</code></pre></p>"},{"location":"payments/auto-recharge/#check-current-status","title":"Check Current Status","text":"<pre><code>GET /v2/payments/subscription/123/billing-team\n</code></pre> <p>Response: <pre><code>{\n  \"id\": 1,\n  \"auto_recharge_enabled\": true,\n  \"recharge_threshold_amount\": \"10.00\",\n  \"recharge_amount\": \"20.00\",\n  \"max_period_spend\": \"100.00\",\n  \"current_period_spend\": 45.00,\n  \"period_start\": \"2025-01-15T00:00:00Z\",\n  \"period_end\": \"2025-02-15T00:00:00Z\",\n  \"currency\": \"USD\"\n}\n</code></pre></p>"},{"location":"payments/auto-recharge/#how-it-works","title":"How It Works","text":""},{"location":"payments/auto-recharge/#flow-diagram","title":"Flow Diagram","text":"<p>Step-by-step process:</p> <ol> <li>User consumes service</li> <li>consume_service signal emitted</li> <li>check_consumable_balance_for_auto_recharge</li> <li>Calculate team balance (in subscription currency)</li> <li>Balance &lt; threshold?</li> <li>No \u2192 End</li> <li>Yes \u2192 Continue</li> <li>Check monthly spending limit</li> <li>Within limit?</li> <li>No \u2192 Log warning, End</li> <li>Yes \u2192 Continue</li> <li>Emit consumable_balance_low signal</li> <li>trigger_auto_recharge_task</li> <li>Schedule process_auto_recharge.delay()</li> <li>Celery Task with Redis Lock<ul> <li>Create team consumables</li> <li>Track spending via invoices</li> <li>Send notification</li> </ul> </li> </ol>"},{"location":"payments/auto-recharge/#example-scenario","title":"Example Scenario","text":"<p>Initial State: <pre><code>Team Balance: $12 (in USD)\nThreshold: $10\nRecharge Amount: $20\nMonthly Limit: $100\nCurrent Period Spend: $40\n</code></pre></p> <p>User Consumes Service: <pre><code>1. User consumes 5 mentorship hours\n2. Balance: $12 \u2192 $7\n3. $7 &lt; $10 (threshold) \u2713\n4. $40 + $20 = $60 &lt; $100 (limit) \u2713\n5. Trigger auto-recharge\n</code></pre></p> <p>Recharge Process: <pre><code>1. Acquire Redis lock (prevent concurrent recharges)\n2. Create consumables worth $20\n3. Create invoice for $20\n4. Send email to owner\n5. Release lock\n</code></pre></p> <p>Final State: <pre><code>Team Balance: $27 ($7 + $20)\nCurrent Period Spend: $60 ($40 + $20)\n</code></pre></p>"},{"location":"payments/auto-recharge/#configuration","title":"Configuration","text":""},{"location":"payments/auto-recharge/#model-fields","title":"Model Fields","text":"<p>SubscriptionBillingTeam: <pre><code>auto_recharge_enabled = BooleanField(default=False)\nrecharge_threshold_amount = DecimalField(default=10.00)\nrecharge_amount = DecimalField(default=20.00)\nmax_period_spend = DecimalField(null=True, blank=True)\n</code></pre></p>"},{"location":"payments/auto-recharge/#currency-handling","title":"Currency Handling","text":"<p>All amounts are in the subscription's currency: <pre><code>subscription = team.subscription\ncurrency = subscription.currency  # e.g., Currency(code='USD')\n\n# Balance calculated using AcademyService pricing\nacademy_service = AcademyService.objects.get(\n    academy=subscription.academy,\n    service=consumable.service_item.service\n)\nbalance_amount += consumable.how_many * academy_service.price_per_unit\n</code></pre></p>"},{"location":"payments/auto-recharge/#monthly-period-calculation","title":"Monthly Period Calculation","text":"<p>Spending periods are monthly from <code>subscription.paid_at</code> day: <pre><code># Example: paid_at = Jan 15\n# Periods: Jan 15-Feb 15, Feb 15-Mar 15, Mar 15-Apr 15, etc.\n\nperiod_start, period_end = team.get_current_monthly_period_dates()\ncurrent_spend = team.get_current_period_spend()\n</code></pre></p>"},{"location":"payments/auto-recharge/#advanced-topics","title":"Advanced Topics","text":""},{"location":"payments/auto-recharge/#partial-recharge","title":"Partial Recharge","text":"<p>When recharge would exceed monthly limit, the system performs a partial recharge:</p> <pre><code>available_budget = max_period_spend - current_period_spend\nif recharge_amount &gt; available_budget:\n    # Partial recharge\n    actual_recharge = available_budget\nelse:\n    # Full recharge\n    actual_recharge = recharge_amount\n</code></pre>"},{"location":"payments/auto-recharge/#unlimited-consumables","title":"Unlimited Consumables","text":"<p>Consumables with <code>how_many=-1</code> (unlimited) don't trigger auto-recharge:</p> <pre><code>if consumable.how_many == -1:\n    balance_amount = -1  # Unlimited\n    return  # Skip auto-recharge check\n</code></pre>"},{"location":"payments/auto-recharge/#race-condition-prevention","title":"Race Condition Prevention","text":"<p>Redis lock ensures only one recharge happens at a time:</p> <pre><code>lock_key = f\"auto_recharge:team:{team_id}\"\nlock = redis_client.lock(lock_key, timeout=300)\n\nif not lock.acquire(blocking=False):\n    raise AbortTask(\"Auto-recharge already in progress\")\n\ntry:\n    # Process recharge\nfinally:\n    lock.release()\n</code></pre>"},{"location":"payments/auto-recharge/#spending-tracking","title":"Spending Tracking","text":"<p>Spending is tracked via invoices, not model fields:</p> <pre><code># Get spending from invoices (not a model field)\ndef get_current_period_spend(self) -&gt; float:\n    period_start, period_end = self.get_current_monthly_period_dates()\n\n    invoices = Invoice.objects.filter(\n        user=subscription.user,\n        status=Invoice.Status.PAID,\n        created_at__gte=period_start,\n        created_at__lt=period_end\n    )\n\n    return float(invoices.aggregate(total=Sum(\"amount\"))[\"total\"] or 0)\n</code></pre>"},{"location":"payments/auto-recharge/#troubleshooting","title":"Troubleshooting","text":""},{"location":"payments/auto-recharge/#auto-recharge-not-triggering","title":"Auto-Recharge Not Triggering","text":"<p>Check:</p> <ol> <li><code>auto_recharge_enabled = True</code></li> <li>Balance actually below threshold</li> <li>Monthly limit not exceeded</li> <li>Celery workers running</li> <li>Redis available</li> </ol> <p>Debug: <pre><code>team = SubscriptionBillingTeam.objects.get(id=123)\nprint(f\"Enabled: {team.auto_recharge_enabled}\")\nprint(f\"Balance: {team.get_team_balance()}\")\nprint(f\"Threshold: {team.recharge_threshold_amount}\")\nprint(f\"Period Spend: {team.get_current_period_spend()}\")\nprint(f\"Period Limit: {team.max_period_spend}\")\n</code></pre></p>"},{"location":"payments/auto-recharge/#monthly-limit-reached","title":"Monthly Limit Reached","text":"<p>Error: \"Billing period spending limit reached\"</p> <p>Solution:</p> <ul> <li>Wait for next billing period</li> <li>Increase <code>max_period_spend</code></li> <li>Manually add consumables</li> </ul>"},{"location":"payments/auto-recharge/#concurrent-recharge-attempts","title":"Concurrent Recharge Attempts","text":"<p>Error: \"Auto-recharge already in progress\"</p> <p>Cause: Multiple consumptions triggered recharge simultaneously</p> <p>Solution: Redis lock handles this automatically - one succeeds, others abort safely</p>"},{"location":"payments/auto-recharge/#testing","title":"Testing","text":""},{"location":"payments/auto-recharge/#unit-tests","title":"Unit Tests","text":"<pre><code>poetry run pytest breathecode/payments/tests/ --nomigrations -k auto_recharge\n</code></pre>"},{"location":"payments/auto-recharge/#manual-testing","title":"Manual Testing","text":"<pre><code># 1. Enable auto-recharge\nteam.auto_recharge_enabled = True\nteam.recharge_threshold_amount = 10.00\nteam.save()\n\n# 2. Consume services until balance &lt; threshold\n# 3. Check Celery logs for task execution\n# 4. Verify new consumables created\n# 5. Check invoice created\n</code></pre>"},{"location":"payments/auto-recharge/#related-documentation","title":"Related Documentation","text":"<ul> <li>Subscription Seats Guide - Overview of team features</li> <li>API Documentation - API endpoints</li> <li>Architecture Diagrams - Detailed diagrams</li> </ul>"},{"location":"payments/auto-recharge/#migration-notes","title":"Migration Notes","text":""},{"location":"payments/auto-recharge/#from-old-field-names","title":"From Old Field Names","text":"<p>If migrating from older versions:</p> <pre><code># Old (deprecated)\nrecharge_threshold_dollars \u2192 recharge_threshold_amount\nrecharge_amount_dollars \u2192 recharge_amount\nmax_monthly_spend_dollars \u2192 max_period_spend\ncurrent_month_spend_dollars \u2192 (removed, calculated from invoices)\nlast_recharge_reset_at \u2192 (removed, not needed)\n</code></pre>"},{"location":"payments/auto-recharge/#database-migration","title":"Database Migration","text":"<pre><code>poetry run python manage.py makemigrations payments\npoetry run python manage.py migrate payments\n</code></pre>"},{"location":"payments/auto-recharge/#security-considerations","title":"Security Considerations","text":"<ol> <li>Owner-Only Access: Only subscription owner can modify auto-recharge settings</li> <li>Spending Limits: Mandatory for production to prevent abuse</li> <li>Redis Lock: Prevents race conditions and double-charging</li> <li>Invoice Tracking: All recharges create invoices for audit trail</li> <li>Validation: Amount limits enforced at serializer level</li> </ol>"},{"location":"payments/auto-recharge/#performance-notes","title":"Performance Notes","text":"<ul> <li>Signal receivers are lightweight (quick balance check)</li> <li>Heavy processing done in Celery task (async)</li> <li>Redis lock timeout: 5 minutes max</li> <li>Balance calculation optimized with <code>select_related()</code></li> </ul>"},{"location":"payments/how-to-configure-stripe/","title":"Configure Stripe for Academy","text":"<p>Step-by-step guide on how to set up the necessary Stripe credentials so that an academy can have its own Stripe payment method.</p>"},{"location":"payments/how-to-configure-stripe/#en","title":"EN:","text":"<ol> <li> <p>Access the admin at https://breathecode.herokuapp.com/admin/payments/academypaymentsettings and, if an <code>Academy Payment Settings</code> does not exist for the academy in question, create a new one</p> </li> <li> <p>Assign the academy</p> </li> <li> <p>Go to Stripe and sign in or create an account (make sure you are not in a test environment, normally a notice appears at the top indicating that you are)</p> </li> <li> <p>In the Home tab, copy the secret key and paste it into the <code>Stripe api key</code> field in the admin</p> </li> <li> <p>Also copy the publishable key and paste it into the <code>Stripe publishable key</code> field</p> </li> <li> <p>Sign in or create an account on Postman and then enter this collection</p> </li> <li> <p>Enter the Create webhook endpoint request, go to the Authorization tab, and in the <code>Token</code> field, insert the Stripe secret key, then click Send</p> </li> <li> <p>Return to Stripe and in the dashboard click on Developers in the lower left, then on Webhooks. Upon refreshing, the created webhook will appear, enter it</p> </li> <li> <p>Copy the key in the Signing secret section on the right side, return to the admin and paste it into the <code>Stripe webhook secret</code> field</p> </li> <li> <p>Save, and the academy configuration will have been created</p> </li> </ol>"},{"location":"payments/how-to-configure-stripe/#es","title":"ES:","text":"<ol> <li> <p>Acceder al admin en https://breathecode.herokuapp.com/admin/payments/academypaymentsettings y, en caso de que no exista un <code>Academy Payment Settings</code> con la academia en cuesti\u00f3n, crear uno nuevo</p> </li> <li> <p>Asignar la academia</p> </li> <li> <p>Ir a Stripe e iniciar sesi\u00f3n o crear una cuenta (aseg\u00farate de no estar en un entorno de prueba, normalmente aparece un aviso en la parte superior indicando que lo est\u00e1s)</p> </li> <li> <p>En la pesta\u00f1a Inicio, copiar la clave secreta y pegarla en el campo <code>Stripe api key</code> del admin</p> </li> <li> <p>Copiar tambi\u00e9n la clave publicable y pegarla en el campo <code>Stripe publishable key</code></p> </li> <li> <p>Iniciar sesi\u00f3n o crearse una cuenta en Postman y luego entrar a esta colecci\u00f3n</p> </li> <li> <p>Entrar en la request Create webhook endpoint, ir a la pesta\u00f1a Authorization, y en el campo <code>Token</code>, insertar la clave secreta de Stripe, luego hacer click en Send</p> </li> <li> <p>Volver a Stripe y en el dashboard hacer click en Desarrolladores en la parte inferior izquierda, luego en Webhooks. Al resfrescar aparecer\u00e1 el webhook creado, entrar en \u00e9l</p> </li> <li> <p>Copiar la clave en la secci\u00f3n Clave secreta de firma del lado derecho, volver al admin y pegarla en el campo <code>Stripe webhook secret</code></p> </li> <li> <p>Guardar, y la configuraci\u00f3n de la academia se habr\u00e1 creado</p> </li> </ol>"},{"location":"payments/subscription-seats-api/","title":"API Documentation &amp; Postman Collection","text":""},{"location":"payments/subscription-seats-api/#overview","title":"Overview","text":"<p>This directory contains comprehensive API documentation for the 4Geeks Subscription &amp; Seats API in two formats: - OpenAPI 3.0 Specification (<code>openapi.yaml</code>) - Postman Collection (<code>postman_collection.json</code>)</p>"},{"location":"payments/subscription-seats-api/#files","title":"Files","text":""},{"location":"payments/subscription-seats-api/#1-openapiyaml","title":"1. openapi.yaml","text":"<p>OpenAPI 3.0 specification that can be imported into: - Postman - Swagger UI - Insomnia - Any OpenAPI-compatible tool</p>"},{"location":"payments/subscription-seats-api/#2-postman_collectionjson","title":"2. postman_collection.json","text":"<p>Ready-to-use Postman collection with: - Pre-configured requests - Environment variables - Test scripts - Request examples</p>"},{"location":"payments/subscription-seats-api/#import-to-postman","title":"Import to Postman","text":""},{"location":"payments/subscription-seats-api/#method-1-import-openapi-file","title":"Method 1: Import OpenAPI File","text":"<ol> <li>Open Postman</li> <li>Click Import button (top left)</li> <li>Select File tab</li> <li>Choose <code>openapi.yaml</code></li> <li>Click Import</li> </ol>"},{"location":"payments/subscription-seats-api/#method-2-import-postman-collection","title":"Method 2: Import Postman Collection","text":"<ol> <li>Open Postman</li> <li>Click Import button (top left)</li> <li>Select File tab</li> <li>Choose <code>postman_collection.json</code></li> <li>Click Import</li> </ol>"},{"location":"payments/subscription-seats-api/#setup-environment-variables","title":"Setup Environment Variables","text":"<p>After importing, set up your environment:</p> <ol> <li>Click Environments (left sidebar)</li> <li>Create new environment: 4Geeks API</li> <li>Add variables:</li> </ol> Variable Description Example <code>base_url</code> API base URL <code>https://breathecode.herokuapp.com</code> <code>user_token_1</code> Owner token <code>eyJhbGc...</code> <code>user_token_2</code> Second user token <code>eyJhbGc...</code> <code>academy_id</code> Academy ID <code>1</code> <code>academy_slug</code> Academy slug <code>4geeks</code> <code>plan_slug</code> Plan slug <code>4geeks-premium</code> <code>subscription_id</code> Subscription ID (auto-set) <code>123</code> <code>bag_token</code> Bag token (auto-set) <code>bag_abc123</code>"},{"location":"payments/subscription-seats-api/#getting-tokens","title":"Getting Tokens","text":"<p>Set environment variables before running fttest:</p> <pre><code>export FTT_API_URL=\"https://breathecode.herokuapp.com\"\nexport FTT_USER_TOKEN1=\"your_token_here\"\nexport FTT_USER_TOKEN2=\"second_user_token\"\nexport FTT_ACADEMY=\"1\"\nexport FTT_ACADEMY_SLUG=\"4geeks\"\n</code></pre>"},{"location":"payments/subscription-seats-api/#api-flows","title":"API Flows","text":""},{"location":"payments/subscription-seats-api/#flow-1-pay-per_seat-plan","title":"Flow 1: Pay PER_SEAT Plan","text":"<pre><code>1. Get Plan Details\n   GET /v1/payments/plan/{plan_slug}\n\n2. Preview Plan with Seats\n   POST /v1/payments/checking\n   Body: {\"type\": \"PREVIEW\", \"plans\": [1], \"team_seats\": 3}\n\n3. Create Bag\n   POST /v1/payments/checking\n   Body: {\"type\": \"BAG\", \"plans\": [1], \"team_seats\": 3}\n   \u2192 Saves bag_token\n\n4. Add Payment Card\n   PUT /v1/payments/card\n   Body: {\"card_number\": \"4242...\", \"cvc\": \"123\", ...}\n\n5. Pay Plan\n   POST /v1/payments/pay\n   Body: {\"token\": \"{{bag_token}}\", \"chosen_period\": \"MONTH\"}\n\n6. Get My Subscriptions\n   GET /v1/payments/me/subscription\n   \u2192 Note subscription_id\n\n7. Get My Consumables\n   GET /v1/provisioning/me/consumables\n</code></pre>"},{"location":"payments/subscription-seats-api/#flow-2-manage-seats","title":"Flow 2: Manage Seats","text":"<pre><code>1. Get Seats\n   GET /v2/payments/subscription/{subscription_id}/billing-team/seat\n\n2. Add Seat\n   PUT /v2/payments/subscription/{subscription_id}/billing-team/seat\n   Body: {\"add_seats\": [{\"email\": \"...\"}]}\n\n3. Replace Seat\n   PUT /v2/payments/subscription/{subscription_id}/billing-team/seat\n   Body: {\"replace_seats\": [{\"from_email\": \"...\", \"to_email\": \"...\"}]}\n\n4. Delete Seat\n   DELETE /v2/payments/subscription/{subscription_id}/billing-team/seat/{seat_id}\n### Flow 3: Consumable Checkout\n\n1. Get My Subscriptions\n   GET /v1/payments/me/subscription\n\n2. Consumable Checkout (Add Seats)\n   POST /v2/payments/consumable/checkout\n   Body: {\"service\": \"seat-service\", \"how_many\": 3, \"subscription\": 123}\n\n3. Get Billing Team\n   GET /v2/payments/subscription/{subscription_id}/billing-team\n\n4. Get Seats\n   GET /v2/payments/subscription/{subscription_id}/billing-team/seat\n\n**Response**: 200 OK\n```json\n{\n  \"id\": 1,\n  \"subscription\": 123,\n  \"seats_limit\": 3,\n  \"consumption_strategy\": \"PER_SEAT\"\n}\n</code></pre>"},{"location":"payments/subscription-seats-api/#flow-3-consumable-checkout","title":"Flow 3: Consumable Checkout","text":"<ol> <li> <p>Get My Subscriptions    GET /v1/payments/me/subscription</p> </li> <li> <p>Consumable Checkout (Add Seats)    POST /v2/payments/consumable/checkout    Body: {\"service\": \"seat-service\", \"how_many\": 3, \"subscription\": 123}</p> </li> <li> <p>Get Billing Team    GET /v2/payments/subscription/{subscription_id}/billing-team</p> </li> <li> <p>Get Seats    GET /v2/payments/subscription/{subscription_id}/billing-team/seat</p> </li> </ol> <p>Response: 200 OK</p> <pre><code>POST /v1/payments/checking\nAuthorization: Bearer {{user_token_1}}\nContent-Type: application/json\n\n{\n  \"type\": \"PREVIEW\",\n  \"plans\": [1],\n  \"team_seats\": 3\n}\n</code></pre> <p>Response: <pre><code>{\n  \"amount\": 149.00,\n  \"seat_service_item\": {\n    \"id\": 10,\n    \"how_many\": 3\n  }\n}\n</code></pre></p>"},{"location":"payments/subscription-seats-api/#add-seat","title":"Add Seat","text":"<pre><code>PUT /v2/payments/subscription/123/billing-team/seat\nAuthorization: Bearer {{user_token_1}}\nContent-Type: application/json\n\n{\n  \"add_seats\": [\n    {\n      \"email\": \"lord@valomero.com\",\n      \"first_name\": \"Lord\",\n      \"last_name\": \"Valomero\"\n    }\n  ]\n}\n</code></pre> <p>Response: <pre><code>[\n  {\n    \"id\": 1,\n    \"user\": 456,\n    \"email\": \"owner@example.com\",\n    \"is_active\": true\n  },\n  {\n    \"id\": 2,\n    \"user\": null,\n    \"email\": \"lord@valomero.com\",\n    \"is_active\": true\n  }\n]\n</code></pre></p>"},{"location":"payments/subscription-seats-api/#enable-auto-recharge","title":"Enable Auto-Recharge","text":"<pre><code>PATCH /v2/payments/subscription/123/billing-team\nAuthorization: Bearer {{user_token_1}}\nContent-Type: application/json\n\n{\n  \"auto_recharge_enabled\": true,\n  \"recharge_threshold_amount\": \"10.00\",\n  \"recharge_amount\": \"20.00\",\n  \"max_monthly_spend\": \"100.00\"\n}\n</code></pre> <p>Response: <pre><code>{\n  \"id\": 1,\n  \"subscription\": 123,\n  \"name\": \"Team 123\",\n  \"seats_limit\": 3,\n  \"consumption_strategy\": \"PER_TEAM\",\n  \"auto_recharge_enabled\": true,\n  \"recharge_threshold_amount\": \"10.00\",\n  \"recharge_amount\": \"20.00\",\n  \"max_monthly_spend\": \"100.00\",\n  \"current_month_spend\": \"0.00\",\n  \"last_recharge_reset_at\": null\n}\n</code></pre></p>"},{"location":"payments/subscription-seats-api/#testing-with-postman","title":"Testing with Postman","text":""},{"location":"payments/subscription-seats-api/#1-run-complete-flow","title":"1. Run Complete Flow","text":"<ol> <li>Set environment variables</li> <li>Run requests in order from 2. Payment Flow folder</li> <li>Check responses and auto-set variables</li> <li>Continue with 4. Seat Management</li> </ol>"},{"location":"payments/subscription-seats-api/#2-test-auto-recharge","title":"2. Test Auto-Recharge","text":"<ol> <li>Complete payment flow</li> <li>Enable auto-recharge via 3. Billing Team &amp; Auto-Recharge</li> <li>Consume services via 6. Assets</li> <li>Check consumables via 5. Consumables</li> </ol>"},{"location":"payments/subscription-seats-api/#3-test-per_seat-vs-per_team","title":"3. Test PER_SEAT vs PER_TEAM","text":"<p>PER_SEAT: - Use plan: <code>4geeks-premium</code> - Consumables have <code>subscription_seat</code> set - Each seat holder gets isolated consumables</p> <p>PER_TEAM: - Use plan: <code>hack-30-machines-in-30-days</code> - Consumables have <code>user: null</code>, <code>subscription_billing_team</code> set - All team members share consumables</p>"},{"location":"payments/subscription-seats-api/#postman-scripts","title":"Postman Scripts","text":"<p>The collection includes test scripts that automatically:</p>"},{"location":"payments/subscription-seats-api/#extract-bag-token","title":"Extract Bag Token","text":"<pre><code>const response = pm.response.json();\npm.collectionVariables.set('bag_token', response.token);\n</code></pre>"},{"location":"payments/subscription-seats-api/#extract-subscription-id","title":"Extract Subscription ID","text":"<pre><code>const response = pm.response.json();\nif (response.subscriptions &amp;&amp; response.subscriptions.length &gt; 0) {\n  pm.collectionVariables.set('subscription_id', response.subscriptions[0].id);\n}\n</code></pre>"},{"location":"payments/subscription-seats-api/#swagger-ui","title":"Swagger UI","text":"<p>To view the API in Swagger UI:</p> <ol> <li>Go to https://editor.swagger.io/</li> <li>Click File \u2192 Import file</li> <li>Select <code>openapi.yaml</code></li> <li>Explore endpoints with interactive documentation</li> </ol>"},{"location":"payments/subscription-seats-api/#insomnia","title":"Insomnia","text":"<p>To import into Insomnia:</p> <ol> <li>Open Insomnia</li> <li>Click Create \u2192 Import From \u2192 File</li> <li>Select <code>openapi.yaml</code></li> <li>Configure environment variables</li> </ol>"},{"location":"payments/subscription-seats-api/#curl-examples","title":"cURL Examples","text":""},{"location":"payments/subscription-seats-api/#get-plan","title":"Get Plan","text":"<pre><code>curl -X GET \"https://breathecode.herokuapp.com/v1/payments/plan/4geeks-premium\" \\\n  -H \"Authorization: Bearer $FTT_USER_TOKEN1\"\n</code></pre>"},{"location":"payments/subscription-seats-api/#preview-plan","title":"Preview Plan","text":"<pre><code>curl -X POST \"https://breathecode.herokuapp.com/v1/payments/checking\" \\\n  -H \"Authorization: Bearer $FTT_USER_TOKEN1\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"type\":\"PREVIEW\",\"plans\":[1],\"team_seats\":3}'\n</code></pre>"},{"location":"payments/subscription-seats-api/#add-seat_1","title":"Add Seat","text":"<pre><code>curl -X PUT \"https://breathecode.herokuapp.com/v2/payments/subscription/123/billing-team/seat\" \\\n  -H \"Authorization: Bearer $FTT_USER_TOKEN1\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"add_seats\":[{\"email\":\"lord@valomero.com\"}]}'\n</code></pre>"},{"location":"payments/subscription-seats-api/#troubleshooting","title":"Troubleshooting","text":""},{"location":"payments/subscription-seats-api/#401-unauthorized","title":"401 Unauthorized","text":"<ul> <li>Check token is valid</li> <li>Ensure <code>Authorization: Bearer &lt;token&gt;</code> header is set</li> <li>Verify token hasn't expired</li> </ul>"},{"location":"payments/subscription-seats-api/#404-not-found","title":"404 Not Found","text":"<ul> <li>Check <code>subscription_id</code> is set correctly</li> <li>Verify plan slug exists</li> <li>Ensure academy ID is correct</li> </ul>"},{"location":"payments/subscription-seats-api/#400-bad-request","title":"400 Bad Request","text":"<ul> <li>Validate request body matches schema</li> <li>Check required fields are present</li> <li>Verify data types (integers, strings, etc.)</li> </ul>"},{"location":"payments/subscription-seats-api/#subscription-not-created","title":"Subscription Not Created","text":"<ul> <li>Wait 10-30 seconds after payment</li> <li>Check Celery workers are running</li> <li>Poll <code>/v1/payments/me/subscription</code> endpoint</li> </ul>"},{"location":"payments/subscription-seats-api/#related-documentation","title":"Related Documentation","text":"<ul> <li>README_pay_per_seat.md: PER_SEAT flow details</li> <li>README_pay_per_team.md: PER_TEAM flow details</li> <li>README_consumable_checkout_per_seat.md: Consumable checkout (PER_SEAT)</li> <li>README_consumable_checkout_per_team.md: Consumable checkout (PER_TEAM)</li> <li>AUTO_RECHARGE_IMPLEMENTATION.md: Auto-recharge system</li> </ul>"},{"location":"payments/subscription-seats-api/#support","title":"Support","text":"<p>For issues or questions: - Check README files for detailed flow documentation - Review OpenAPI schema for request/response formats - Run functional tests: <code>poetry run python3 -m scripts.fttests subscription_seats:&lt;test_name&gt;</code></p>"},{"location":"payments/subscription-seats-guide/","title":"Subscription Seats - Quick Start Guide","text":"<p>This guide explains how subscription seats work in simple terms.</p>"},{"location":"payments/subscription-seats-guide/#what-are-subscription-seats","title":"What Are Subscription Seats?","text":"<p>Subscription seats allow a team owner to share their subscription with other users. Think of it like buying a Netflix family plan - one person pays, but multiple people can use it.</p>"},{"location":"payments/subscription-seats-guide/#key-concepts","title":"Key Concepts","text":"<ul> <li>Subscription Owner: The person who pays for the subscription</li> <li>Billing Team: A group of users who share the subscription</li> <li>Seat: Access granted to one team member</li> <li>Auto-Recharge: Automatic top-up when balance runs low (both strategies)</li> <li>Consumption Strategy: How consumables are distributed (PER_TEAM or PER_SEAT)</li> <li>is_team_allowed: Service flag that determines who gets consumables:</li> <li><code>False</code> = Owner only (personal consumables)</li> <li><code>True</code> = Team/Seats (shared or per-seat consumables)</li> </ul>"},{"location":"payments/subscription-seats-guide/#consumption-strategies","title":"Consumption Strategies","text":""},{"location":"payments/subscription-seats-guide/#per_team-shared-pool","title":"PER_TEAM (Shared Pool) \ud83e\udd1d","text":"<p>Team members share a common pool of consumables.</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  Subscription Owner (Pays)                  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n               \u2502\n               \u251c\u2500 Owner Consumables (is_team_allowed=False)\n               \u2502  \u251c\u2500 10 personal mentorship hours\n               \u2502  \u2514\u2500 5 personal event tickets\n               \u2502\n               \u2514\u2500 Billing Team\n                  \u251c\u2500 Team Consumables (is_team_allowed=True, SHARED)\n                  \u2502  \u251c\u2500 100 mentorship hours\n                  \u2502  \u2514\u2500 50 event tickets\n                  \u2502\n                  \u2514\u2500 Team Members\n                     \u251c\u2500 Member A (uses from shared pool)\n                     \u251c\u2500 Member B (uses from shared pool)\n                     \u2514\u2500 Member C (uses from shared pool)\n</code></pre> <p>Best for: - Small teams (3-10 people) - Flexible usage patterns - Collaborative environments - Startups and agencies</p> <p>How consumables are allocated: - Services with <code>is_team_allowed=False</code> \u2192 Owner gets personal consumables - Services with <code>is_team_allowed=True</code> \u2192 Team gets shared pool</p> <p>Example: <pre><code>Owner: 10 personal hours (is_team_allowed=False)\nTeam Pool: 100 shared hours (is_team_allowed=True)\n\nDay 1: Team pool has 100 hours\n- Member A uses 30 hours \u2192 70 left\n- Member B uses 40 hours \u2192 30 left\n- Balance low \u2192 Auto-recharge adds 50 \u2192 80 left\n\nOwner's 10 personal hours remain untouched\n</code></pre></p>"},{"location":"payments/subscription-seats-guide/#per_seat-individual-allocation","title":"PER_SEAT (Individual Allocation) \ud83d\udc64","text":"<p>Each team member gets their own allocation of consumables.</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  Subscription Owner (Pays)                  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n               \u2502\n               \u251c\u2500 Owner Consumables (is_team_allowed=False)\n               \u2502  \u251c\u2500 10 personal mentorship hours\n               \u2502  \u2514\u2500 5 personal event tickets\n               \u2502\n               \u2514\u2500 Billing Team\n                  \u251c\u2500 Seat 1 (Member A)\n                  \u2502  \u2514\u2500 Consumables (is_team_allowed=True, individual)\n                  \u2502     \u251c\u2500 10 hours\n                  \u2502     \u2514\u2500 5 tickets\n                  \u2502\n                  \u251c\u2500 Seat 2 (Member B)\n                  \u2502  \u2514\u2500 Consumables (is_team_allowed=True, individual)\n                  \u2502     \u251c\u2500 10 hours\n                  \u2502     \u2514\u2500 5 tickets\n                  \u2502\n                  \u2514\u2500 Seat 3 (Member C, 2x multiplier)\n                     \u2514\u2500 Consumables (is_team_allowed=True, individual)\n                        \u251c\u2500 20 hours (2x)\n                        \u2514\u2500 10 tickets (2x)\n</code></pre> <p>Best for: - Large teams (10+ people) - Fair distribution required - Enterprise environments - Predictable usage per person</p> <p>How consumables are allocated: - Services with <code>is_team_allowed=False</code> \u2192 Owner gets personal consumables - Services with <code>is_team_allowed=True</code> \u2192 Each seat gets individual consumables</p> <p>Example: <pre><code>Owner: 10 personal hours (is_team_allowed=False)\n\nMember A (1x seat): Gets 10 hours (is_team_allowed=True)\n- Uses 8 hours \u2192 2 hours left\n- Cannot use other members' hours\n\nMember C (2x seat): Gets 20 hours (is_team_allowed=True, 2x multiplier)\n- Uses 15 hours \u2192 5 hours left\n- Cannot share with others\n\nOwner's 10 personal hours remain separate\n</code></pre></p>"},{"location":"payments/subscription-seats-guide/#comparison-table","title":"Comparison Table","text":"Feature PER_TEAM \ud83e\udd1d PER_SEAT \ud83d\udc64 Owner Consumables <code>is_team_allowed=False</code> (personal) <code>is_team_allowed=False</code> (personal) Team Consumables <code>is_team_allowed=True</code> (shared pool) <code>is_team_allowed=True</code> (per seat) Flexibility High Low Recharge Manual or Auto (team) Manual or Auto (per seat) Auto-Recharge \u2705 Team level \u2705 Per seat level Seat Multiplier Not used Determines allocation Best For Small teams Large teams Example 5-person startup 50-person company"},{"location":"payments/subscription-seats-guide/#basic-workflow","title":"Basic Workflow","text":""},{"location":"payments/subscription-seats-guide/#1-create-a-subscription","title":"1. Create a Subscription","text":"<p>First, the owner creates a subscription with a plan that supports teams.</p> <pre><code>POST /v1/payments/checking\n{\n  \"type\": \"PREVIEW\",\n  \"plans\": [1],\n  \"team_seats\": 3\n}\n</code></pre>"},{"location":"payments/subscription-seats-guide/#2-get-billing-team-info","title":"2. Get Billing Team Info","text":"<p>Check the team configuration:</p> <pre><code>GET /v2/payments/subscription/123/billing-team\n</code></pre> <p>Response: <pre><code>{\n  \"id\": 1,\n  \"subscription\": 123,\n  \"name\": \"Team 123\",\n  \"seats_limit\": 3,\n  \"seats_count\": 2,\n  \"auto_recharge_enabled\": true,\n  \"recharge_threshold_amount\": \"10.00\",\n  \"recharge_amount\": \"20.00\",\n  \"max_period_spend\": \"100.00\",\n  \"current_period_spend\": 45.00,\n  \"currency\": \"USD\"\n}\n</code></pre></p>"},{"location":"payments/subscription-seats-guide/#3-add-team-members","title":"3. Add Team Members","text":"<p>Add users to the team:</p> <pre><code>PUT /v2/payments/subscription/123/billing-team/seat\n{\n  \"add_seats\": [\n    {\n      \"email\": \"member@example.com\",\n    }\n  ]\n}\n</code></pre>"},{"location":"payments/subscription-seats-guide/#4-team-members-use-services","title":"4. Team Members Use Services","text":"<p>When team members consume services (mentorship, events), it's deducted from the shared team balance.</p>"},{"location":"payments/subscription-seats-guide/#auto-recharge-feature","title":"Auto-Recharge Feature","text":"<p>Auto-recharge automatically tops up the team balance when it runs low.</p>"},{"location":"payments/subscription-seats-guide/#how-it-works","title":"How It Works","text":"<ol> <li>Threshold: When balance falls below $10 (configurable)</li> <li>Recharge: Automatically add $20 (configurable)</li> <li>Limit: Maximum $100 per month (configurable)</li> </ol>"},{"location":"payments/subscription-seats-guide/#configure-auto-recharge","title":"Configure Auto-Recharge","text":"<pre><code>PUT /v2/payments/subscription/123/billing-team\n{\n  \"auto_recharge_enabled\": true,\n  \"recharge_threshold_amount\": \"10.00\",\n  \"recharge_amount\": \"20.00\",\n  \"max_period_spend\": \"100.00\"\n}\n</code></pre>"},{"location":"payments/subscription-seats-guide/#example-scenario","title":"Example Scenario","text":"<pre><code>Day 1:  Balance = $50\nDay 5:  Team uses $42 \u2192 Balance = $8 (below $10 threshold)\n        \u2192 Auto-recharge triggers\n        \u2192 Add $20\n        \u2192 New balance = $28\nDay 10: Team uses $15 \u2192 Balance = $13\n        (Above threshold, no recharge)\n</code></pre>"},{"location":"payments/subscription-seats-guide/#common-operations","title":"Common Operations","text":""},{"location":"payments/subscription-seats-guide/#view-all-seats","title":"View All Seats","text":"<pre><code>GET /v2/payments/subscription/123/billing-team/seat\n</code></pre>"},{"location":"payments/subscription-seats-guide/#remove-a-seat","title":"Remove a Seat","text":"<pre><code>DELETE /v2/payments/subscription/123/billing-team/seat/456\n</code></pre>"},{"location":"payments/subscription-seats-guide/#replace-a-seat","title":"Replace a Seat","text":"<p>Transfer a seat from one user to another:</p> <pre><code>PUT /v2/payments/subscription/123/billing-team/seat\n{\n  \"replace_seats\": [\n    {\n      \"from_email\": \"old@example.com\",\n      \"to_email\": \"new@example.com\"\n    }\n  ]\n}\n</code></pre>"},{"location":"payments/subscription-seats-guide/#important-notes","title":"Important Notes","text":""},{"location":"payments/subscription-seats-guide/#permissions","title":"Permissions","text":"<ul> <li>Only the subscription owner can manage seats</li> <li>Team members can only consume services</li> </ul>"},{"location":"payments/subscription-seats-guide/#billing","title":"Billing","text":"<ul> <li>Owner pays for all team consumption</li> <li>Charges appear on owner's invoice</li> <li>Monthly spending limits protect from overspending</li> </ul>"},{"location":"payments/subscription-seats-guide/#consumption","title":"Consumption","text":"<ul> <li>Team shares a common balance</li> <li>Each member can consume based on their seat multiplier</li> <li>Unlimited consumables (how_many = -1) don't trigger auto-recharge</li> </ul>"},{"location":"payments/subscription-seats-guide/#troubleshooting","title":"Troubleshooting","text":""},{"location":"payments/subscription-seats-guide/#only-the-owner-can-manage-team","title":"\"Only the owner can manage team\"","text":"<p>Problem: You're not the subscription owner.</p> <p>Solution: Only the person who created the subscription can add/remove seats.</p>"},{"location":"payments/subscription-seats-guide/#billing-period-limit-reached","title":"\"Billing period limit reached\"","text":"<p>Problem: Team hit the monthly spending limit.</p> <p>Solution: Wait for next billing period or increase <code>max_period_spend</code>.</p>"},{"location":"payments/subscription-seats-guide/#no-budget-available-for-recharge","title":"\"No budget available for recharge\"","text":"<p>Problem: Auto-recharge would exceed monthly limit.</p> <p>Solution: Increase <code>max_period_spend</code> or wait for next billing period.</p>"},{"location":"payments/subscription-seats-guide/#next-steps","title":"Next Steps","text":"<ul> <li>Full API Documentation</li> <li>OpenAPI Specification</li> <li>Postman Collection</li> </ul>"},{"location":"payments/subscription-seats-guide/#testing-development","title":"Testing &amp; Development","text":""},{"location":"payments/subscription-seats-guide/#import-postman-collection","title":"Import Postman Collection","text":"<p>File Location: <code>openapi/subscription-seats/postman_collection.json</code></p> <p>Steps: 1. Open Postman 2. Click \"Import\" button 3. Select file: <code>openapi/subscription-seats/postman_collection.json</code> 4. Set environment variables:    - <code>base_url</code>: <code>https://breathecode.herokuapp.com</code> (or your local URL)    - <code>user_token_1</code>: Your authentication token    - <code>user_token_2</code>: Second user token (for testing)</p>"},{"location":"payments/subscription-seats-guide/#use-openapi-spec","title":"Use OpenAPI Spec","text":"<p>File Location: <code>openapi/subscription-seats/openapi.yaml</code></p> <p>View in Swagger Editor: 1. Go to editor.swagger.io 2. File \u2192 Import File 3. Select: <code>openapi/subscription-seats/openapi.yaml</code></p> <p>Generate API Client: <pre><code># Python client\nopenapi-generator-cli generate \\\n  -i openapi/subscription-seats/openapi.yaml \\\n  -g python \\\n  -o client/python/\n\n# TypeScript client\nopenapi-generator-cli generate \\\n  -i openapi/subscription-seats/openapi.yaml \\\n  -g typescript-axios \\\n  -o client/typescript/\n</code></pre></p>"},{"location":"payments/subscription-seats-guide/#need-help","title":"Need Help?","text":"<ul> <li>Check the API Reference for detailed endpoint documentation</li> <li>Review the OpenAPI spec for request/response schemas</li> <li>Import the Postman collection to test endpoints</li> <li>See Payments Overview for architecture comparison</li> </ul>"},{"location":"program-manager/blocking-users/","title":"Blocking Users","text":""},{"location":"program-manager/blocking-users/#blocking-users-from-mentorship-services","title":"Blocking Users from Mentorship Services","text":"<p>This document explains how program managers can block users from accessing mentorship services in different scenarios.</p>"},{"location":"program-manager/blocking-users/#overview","title":"Overview","text":"<p>The system allows blocking users from specific services based on different scopes. The blocking configuration uses service identifiers (like <code>\"mentorship-service\"</code>) to determine which service the blocks apply to. When a user is related to any of the blocking scopes for a service, they will be blocked from accessing that service.</p> <p>The blocking scopes are:</p> <ol> <li>Block from everywhere (platform-wide for the service)</li> <li>Block from specific academy (when user is in that academy)</li> <li>Block from specific cohort (when user is in that cohort)</li> <li>Block from specific mentorship service (when user tries to access that specific service)</li> </ol>"},{"location":"program-manager/blocking-users/#configuration","title":"Configuration","text":"<p>The blocking configuration is managed in the <code>breathecode/payments/flags.py</code> file through the <code>blocked_user_ids</code> dictionary.</p>"},{"location":"program-manager/blocking-users/#structure","title":"Structure","text":"<pre><code>blocked_user_ids = {\n    \"mentorship-service\": {  # Service identifier\n        # Users blocked from this service across the entire platform\n        \"from_everywhere\": [],\n        # Users blocked from this service when in specific academies\n        \"from_academy\": [],\n        # Users blocked from this service when in specific cohorts\n        \"from_cohort\": [],\n        # Users blocked from specific instances of this service\n        \"from_mentorship_service\": []\n    }\n}\n</code></pre>"},{"location":"program-manager/blocking-users/#how-to-block-users","title":"How to Block Users","text":""},{"location":"program-manager/blocking-users/#1-block-user-platform-wide","title":"1. Block User Platform-wide","text":"<p>To block a user from accessing a specific service type across the entire platform:</p> <ol> <li>Add the user's ID to the <code>from_everywhere</code> list under the appropriate service identifier:</li> </ol> <pre><code>blocked_user_ids = {\n    \"mentorship-service\": {  # Service to block\n        \"from_everywhere\": [123],  # User ID will be blocked from all mentorship services\n        ...\n    }\n}\n</code></pre>"},{"location":"program-manager/blocking-users/#2-block-user-from-service-in-specific-academy","title":"2. Block User from Service in Specific Academy","text":"<p>To block a user from accessing a service type when they are in a specific academy:</p> <ol> <li>Add a tuple containing the user's ID and academy slug to the <code>from_academy</code> list:</li> </ol> <pre><code>blocked_user_ids = {\n    \"mentorship-service\": {  # Service to block\n        \"from_academy\": [(123, \"downtown-miami\")],  # User 123 can't access mentorship services in downtown-miami academy\n        ...\n    }\n}\n</code></pre>"},{"location":"program-manager/blocking-users/#3-block-user-from-service-in-specific-cohort","title":"3. Block User from Service in Specific Cohort","text":"<p>To block a user from accessing a service type when they are in a specific cohort:</p> <ol> <li>Add a tuple containing the user's ID and cohort slug to the <code>from_cohort</code> list:</li> </ol> <pre><code>blocked_user_ids = {\n    \"mentorship-service\": {  # Service to block\n        \"from_cohort\": [(123, \"4geeks-fs-1\")],  # User 123 can't access mentorship services in 4geeks-fs-1 cohort\n        ...\n    }\n}\n</code></pre>"},{"location":"program-manager/blocking-users/#4-block-user-from-specific-service-instance","title":"4. Block User from Specific Service Instance","text":"<p>To block a user from accessing a specific instance of a service:</p> <ol> <li>Add a tuple containing the user's ID and service slug to the <code>from_mentorship_service</code> list:</li> </ol> <pre><code>blocked_user_ids = {\n    \"mentorship-service\": {  # Service type\n        \"from_mentorship_service\": [(123, \"geekpal-1-1\")],  # User 123 can't access the geekpal-1-1 service specifically\n        ...\n    }\n}\n</code></pre>"},{"location":"program-manager/blocking-users/#checking-block-status","title":"Checking Block Status","text":"<p>Users can check their block status for different services by making a GET request to the <code>/v1/payments/me/service/blocked</code> endpoint. The response will indicate if they are blocked and from where:</p> <pre><code>{\n  \"mentorship-service\": {\n    // Service identifier\n    \"from_everywhere\": 1, // Not blocked platform-wide\n    \"from_academy\": [(1, \"academy-slug\")], // Blocked in these academies\n    \"from_cohort\": [(1, \"cohort-slug\")], // Blocked in these cohorts\n    \"from_mentorship_service\": [(1, \"service-slug\")] // Blocked from these specific services\n  }\n}\n</code></pre>"},{"location":"program-manager/blocking-users/#important-notes","title":"Important Notes","text":"<ol> <li>Blocking is enforced through the <code>payments.can_access</code> feature flag.</li> <li>When a user is blocked, they will receive a 403 error with the message \"You have been blocked from accessing this mentorship service\".</li> <li>Blocks are evaluated based on the user's relationships:</li> <li>If they are in a blocked academy</li> <li>If they are in a blocked cohort</li> <li>If they try to access a specifically blocked service</li> <li>If they are blocked platform-wide</li> <li>Program managers should keep track of blocked users and review blocks periodically.</li> <li>Changes to the blocking configuration require a deployment to take effect.</li> </ol>"},{"location":"program-manager/blocking-users/#best-practices","title":"Best Practices","text":"<ol> <li>Document the reason for blocking each user</li> <li>Use the most specific blocking scope appropriate for the situation</li> <li>Regularly review blocked users to ensure blocks are still necessary</li> <li>Maintain a separate list of blocked users and reasons outside the code</li> <li>Consider implementing a temporary blocking mechanism for short-term blocks</li> </ol>"},{"location":"security/authentication-class/","title":"Authentication classes","text":""},{"location":"security/authentication-class/#expiringtokenauthentication","title":"<code>ExpiringTokenAuthentication</code>","text":"<p>it's the default authentication class implemented in 4Geeks.</p> <p>ExpiringTokenAuthentication is integral to the security of our Django web application. Its main purpose is to handle user authentication, i.e., verifying that a user is who they claim to be.</p> <pre><code>GET /v1/resource/path HTTP/1.1\nHost: www.example.com\nAuthorization: Token your_token_here\n</code></pre> <p>The ExpiringTokenAuthentication class within it provides a specific type of token-based authentication. Unlike simple token-based authentication where tokens remain valid indefinitely, this class ensures that tokens expire after a certain period (24 hours in this case). This means that even if an attacker manages to get hold of a token, they can only use it for a limited time.</p> <p>Upon receiving a request, the system checks the provided token, confirms it's valid and hasn't expired, and identifies the user associated with the token. If any of these checks fail, an AuthenticationFailed exception is raised, denying access.</p> <pre><code>POST /v1/auth/login HTTP/1.1\nHost: www.example.com\nContent-Type: application/json\n\n{\n  \"username\": \"john.doe\",\n  \"password\": \"supersecretpassword\"\n}\n</code></pre>"},{"location":"security/capabilities/","title":"Capabilities","text":"<p>Authenticated users must belong to at least one academy with a specific role, each role has a series of capabilities that specify what any user with that role will be \"capable\" of doing.</p> <pre><code>ExpiringTokenAuthentication -&gt; @capable_of -&gt; view\n</code></pre> <p>Authenticated methods must be decorated with the <code>@capable_of</code> decorator in increase security validation. For example:</p> <pre><code>    from breathecode.utils import capable_of\n\n    @capable_of('crud_member')\n    def post(self, request, academy_id=None):\n        serializer = StaffPOSTSerializer(data=request.data)\n        if serializer.is_valid():\n            serializer.save()\n            return Response(serializer.data, status=status.HTTP_201_CREATED)\n        return Response(serializer.errors, status=status.HTTP_400_BAD_REQUEST)\n</code></pre> <p>Any view decorated with the @capable_of must be used passing an academy id either:</p> <ol> <li>Anywhere on the endpoint url, E.g: <code>path('academy/&lt;int:academy_id&gt;/member', MemberView.as_view()),</code></li> <li>Or on the request header using the <code>Academy</code> header.</li> </ol>"},{"location":"security/capabilities/#available-capabilities","title":"Available capabilities:","text":"<p>This list is alive, it will grow and vary over time:</p> <pre><code>CAPABILITIES = [\n    {\n        'slug': 'read_my_academy',\n        'description': 'Read your academy information'\n    },\n    {\n        'slug': 'crud_my_academy',\n        'description': 'Read, or update your academy information (very high level, almost the academy admin)'\n    },\n    {\n        'slug': 'crud_member',\n        'description': 'Create, update or delete academy members (very high level, almost the academy admin)'\n    },\n    {\n        'slug': 'read_member',\n        'description': 'Read academy staff member information'\n    },\n    {\n        'slug': 'crud_student',\n        'description': 'Create, update or delete students'\n    },\n    {\n        'slug': 'read_student',\n        'description': 'Read student information'\n    },\n    {\n        'slug': 'read_invite',\n        'description': 'Read invites from users'\n    },\n    {\n        'slug': 'crud_invite',\n        'description': 'Create, update or delete invites from users'\n    },\n    {\n        'slug': 'invite_resend',\n        'description': 'Resent invites for user academies'\n    },\n    {\n        'slug': 'read_assignment',\n        'description': 'Read assignment information'\n    },\n    {\n        'slug':\n        'read_assignment_sensitive_details',\n        'description':\n        'The mentor in residence is allowed to see aditional info about the task, like the \"delivery url\"'\n    },\n    {\n        'slug': 'read_shortlink',\n        'description': 'Access the list of marketing shortlinks'\n    },\n    {\n        'slug': 'crud_shortlink',\n        'description': 'Create, update and delete marketing short links'\n    },\n    {\n        'slug': 'crud_assignment',\n        'description': 'Update assignments'\n    },\n    {\n        'slug': 'task_delivery_details',\n        'description': 'Get delivery URL for a task, that url can be sent to students for delivery'\n    },\n    {\n        'slug': 'read_certificate',\n        'description': 'List and read all academy certificates'\n    },\n    {\n        'slug': 'crud_certificate',\n        'description': 'Create, update or delete student certificates'\n    },\n    {\n        'slug': 'read_layout',\n        'description': 'Read layouts to generate new certificates'\n    },\n    {\n        'slug': 'read_syllabus',\n        'description': 'List and read syllabus information'\n    },\n    {\n        'slug': 'crud_syllabus',\n        'description': 'Create, update or delete syllabus versions'\n    },\n    {\n        'slug': 'read_organization',\n        'description': 'Read academy organization details'\n    },\n    {\n        'slug': 'crud_organization',\n        'description': 'Update, create or delete academy organization details'\n    },\n    {\n        'slug': 'read_event',\n        'description': 'List and retrieve event information'\n    },\n    {\n        'slug': 'crud_event',\n        'description': 'Create, update or delete event information'\n    },\n    {\n        'slug': 'read_all_cohort',\n        'description': 'List all the cohorts or single cohort information'\n    },\n    {\n        'slug': 'read_single_cohort',\n        'description': 'single cohort information related to a user'\n    },\n    {\n        'slug': 'crud_cohort',\n        'description': 'Create, update or delete cohort info'\n    },\n    {\n        'slug': 'read_eventcheckin',\n        'description': 'List and read all the event_checkins'\n    },\n    {\n        'slug': 'read_survey',\n        'description': 'List all the nps answers'\n    },\n    {\n        'slug': 'crud_survey',\n        'description': 'Create, update or delete surveys'\n    },\n    {\n        'slug': 'read_nps_answers',\n        'description': 'List all the nps answers'\n    },\n    {\n        'slug': 'read_lead',\n        'description': 'List all the leads'\n    },\n    {\n        'slug': 'read_won_lead',\n        'description': 'List all the won leads'\n    },\n    {\n        'slug': 'crud_lead',\n        'description': 'Create, update or delete academy leads'\n    },\n    {\n        'slug': 'read_review',\n        'description': 'Read review for a particular academy'\n    },\n    {\n        'slug': 'crud_review',\n        'description': 'Create, update or delete academy reviews'\n    },\n    {\n        'slug': 'read_media',\n        'description': 'List all the medias'\n    },\n    {\n        'slug': 'crud_media',\n        'description': 'Create, update or delete academy medias'\n    },\n    {\n        'slug': 'read_media_resolution',\n        'description': 'List all the medias resolutions'\n    },\n    {\n        'slug': 'crud_media_resolution',\n        'description': 'Create, update or delete academy media resolutions'\n    },\n    {\n        'slug': 'read_cohort_activity',\n        'description': 'Read low level activity in a cohort (attendancy, etc.)'\n    },\n    {\n        'slug': 'generate_academy_token',\n        'description': 'Create a new token only to be used by the academy'\n    },\n    {\n        'slug': 'get_academy_token',\n        'description': 'Read the academy token'\n    },\n    {\n        'slug': 'send_reset_password',\n        'description': 'Generate a temporal token and resend forgot password link'\n    },\n    {\n        'slug': 'read_activity',\n        'description': 'List all the user activities'\n    },\n    {\n        'slug': 'crud_activity',\n        'description': 'Create, update or delete a user activities'\n    },\n    {\n        'slug': 'read_assignment',\n        'description': 'List all the assignments'\n    },\n    {\n        'slug': 'crud_assignment',\n        'description': 'Create, update or delete a assignment'\n    },\n    {\n        'slug':\n        'classroom_activity',\n        'description':\n        'To report student activities during the classroom or cohorts (Specially meant for teachers)'\n    },\n    {\n        'slug': 'academy_reporting',\n        'description': 'Get detailed reports about the academy activity'\n    },\n    {\n        'slug': 'generate_temporal_token',\n        'description': 'Generate a temporal token to reset github credential or forgot password'\n    },\n    {\n        'slug': 'read_mentorship_service',\n        'description': 'Get all mentorship services from one academy'\n    },\n    {\n        'slug': 'crud_mentorship_service',\n        'description': 'Create, delete or update all mentorship services from one academy'\n    },\n    {\n        'slug': 'read_mentorship_mentor',\n        'description': 'Get all mentorship mentors from one academy'\n    },\n    {\n        'slug': 'crud_mentorship_mentor',\n        'description': 'Create, delete or update all mentorship mentors from one academy'\n    },\n    {\n        'slug': 'read_mentorship_session',\n        'description': 'Get all session from one academy'\n    },\n    {\n        'slug': 'crud_mentorship_session',\n        'description': 'Create, delete or update all session from one academy'\n    },\n    {\n        'slug': 'crud_freelancer_bill',\n        'description': 'Create, delete or update all freelancer bills from one academy'\n    },\n    {\n        'slug': 'read_freelancer_bill',\n        'description': 'Read all all freelancer bills from one academy'\n    },\n    {\n        'slug': 'crud_mentorship_bill',\n        'description': 'Create, delete or update all mentroship bills from one academy'\n    },\n    {\n        'slug': 'read_mentorship_bill',\n        'description': 'Read all mentroship bills from one academy'\n    },\n    {\n        'slug': 'read_asset',\n        'description': 'Read all academy registry assets'\n    },\n    {\n        'slug': 'crud_asset',\n        'description': 'Update, create and delete registry assets'\n    },\n    {\n        'slug': 'read_tag',\n        'description': 'Read marketing tags and their details'\n    },\n    {\n        'slug': 'crud_tag',\n        'description': 'Update, create and delete a marketing tag and its details'\n    },\n    {\n        'slug': 'get_gitpod_user',\n        'description': 'List gitpod user the academy is consuming'\n    },\n    {\n        'slug': 'update_gitpod_user',\n        'description': 'Update gitpod user expiration based on available information'\n    },\n    {\n        'slug': 'read_technology',\n        'description': 'Read asset technologies'\n    },\n    {\n        'slug': 'crud_technology',\n        'description': 'Update, create and delete asset technologies'\n    },\n    {\n        'slug': 'read_keyword',\n        'description': 'Read SEO keywords'\n    },\n    {\n        'slug': 'crud_keyword',\n        'description': 'Update, create and delete SEO keywords'\n    },\n    {\n        'slug': 'read_keywordcluster',\n        'description': 'Update, create and delete asset technologies'\n    },\n    {\n        'slug': 'crud_keywordcluster',\n        'description': 'Update, create and delete asset technologies'\n    },\n]\n</code></pre>"},{"location":"security/introduction/","title":"Introduction","text":""},{"location":"security/introduction/#authentication","title":"Authentication","text":"<p>Authentication is the process of verifying the identity of a user, system, or client. When a user attempts to access a system or application, they must provide credentials to prove their identity. This can include entering a username and password, presenting a digital certificate, or even providing biometric data like a fingerprint.</p>"},{"location":"security/introduction/#authorization","title":"Authorization","text":"<p>Authorization is the process that comes after authentication and it determines what permissions an authenticated user has within a system. This means defining what actions a user is allowed to perform, what resources they are allowed to access, and what operations they are able to execute.</p>"},{"location":"security/schema-link/","title":"Schema link","text":"<p>It's custom authorization schema that share a key between 2 servers, it's used when you can't block microservices by ip, both servers authorize what actions can perform its pair, if both apps does not belongs to the same company you must include additionally an agreement layer.</p>"},{"location":"security/schema-link/#when-user-must-sign-an-agreement","title":"<code>When user must sign an agreement?</code>","text":"<p>When both servers does not belong to the same company, it's mandatory.</p>"},{"location":"security/schema-link/#how-is-build-that-agreement","title":"<code>How is build that agreement?</code>","text":"<p>It's builded as a collection of scopes that represent what's authorized server can do with your data.</p>"},{"location":"security/schema-link/#whats-scope","title":"<code>What's scope?</code>","text":"<p>In the context of OAuth, OpenID Connect, and many authentication/authorization systems, \"scope\" refers to the permissions that are associated with a particular token.</p>"},{"location":"security/schema-link/#how-to-link-both-servers","title":"<code>How to link both servers?</code>","text":"<p>Each server must register the other server in its database, it must share the same algorithm, strategy, keys and schema, and the key can't be shared, because during the keys rotations many of them will breaks.</p>"},{"location":"security/schema-link/#objects","title":"Objects","text":""},{"location":"security/schema-link/#token","title":"<code>Token</code>","text":"<p>This object represent the json payload.</p> <ul> <li><code>sub</code>: The \"subject\" claim in a JWT. This usually represents the principal entity (typically a user) for which the JWT is intended. In this case, user_id would be the identifier of the user in the context of your system.</li> <li><code>iss</code>: The \"issuer\" claim in a JWT. This represents the entity that generated and signed the JWT. In this case, it's being read from an environment variable API_URL, with a default value of 'http://localhost:8000'.</li> <li><code>app</code>: This is a custom claim you've defined. It appears to specify the name of the application generating the token, in this case '4geeks'.</li> <li><code>aud</code>: The \"audience\" claim. This represents the intended recipients of the JWT. In this case, it's app.slug, presumably the identifier for an application that should accept this token.</li> <li><code>exp</code>: The \"expiration time\" claim. This is the time after which the JWT should no longer be accepted. It's calculated as the current time now plus a certain number of minutes determined by JWT_LIFETIME.</li> <li><code>iat</code>: The \"issued at\" claim. This represents the time at which the JWT was issued. It's the current time now minus one second (to ensure the token is valid immediately on issuance).</li> <li><code>typ</code>: The \"type\" claim. It's a hint about the type of token. In this case, it's 'JWT' to indicate that this is a JSON Web Token.</li> </ul>"},{"location":"security/schema-link/#app","title":"<code>App</code>","text":"<p>This object represent the app on your database, this object must be cached.</p> <ul> <li><code>id</code>: The unique identifier for the application. This is often used as a reference to the application in the system.</li> <li><code>private_key</code>: This is a cryptographic key that is kept secret and only known to the application. This can be used for things like signing tokens or encrypting data.</li> <li><code>public_key</code>: This is the counterpart to the private key. It can be freely shared and is often used to verify tokens signed with the private key, or decrypt data encrypted with the private key.</li> <li><code>algorithm</code>: This refers to the algorithm used for cryptographic operations. This could be a specific type of symmetric or asymmetric encryption, or a digital signature algorithm.</li> <li><code>strategy</code>: This could refer to a particular strategy used for authentication or authorization in your system.</li> <li><code>schema</code>: This could be the structure or format that the app's data follows. In the context of databases, a schema defines how data is organized and how relationships are enforced.</li> <li><code>require_an_agreement</code>: This is likely a Boolean value (True/False) indicating whether the user needs to agree to certain terms before using the application.</li> <li><code>webhook_url</code>: Webhooks provide a way for applications to get real-time data updates. This URL is likely where the application will send HTTP requests when certain events occur.</li> <li><code>redirect_url</code>: In OAuth or similar authentication/authorization flows, this is the URL where users are redirected after they authorize the application. This URL often includes a code or token as a query parameter, which the application can exchange for an access token.</li> <li><code>app_url</code>: This is likely the URL where the actual application can be accessed by users.</li> </ul>"},{"location":"security/schema-link/#using-json-web-token","title":"Using Json Web Token","text":"<p>JWT stands for JSON Web Token. It is a standard (RFC 7519) for creating access tokens that assert some number of claims. For example, a server could generate a token that has the claim \"logged in as admin\" and provide that to a client. The client could then use that token to prove that it's logged in as admin.</p> <p>A JWT is composed of three parts: a header, a payload, and a signature. These parts are separated by dots (.) and are Base64Url encoded.</p> <ul> <li> <p><code>Header</code>: The header typically consists of two parts: the type of the token, which is JWT, and the signing algorithm being used, such as HMAC SHA256 or RSA.</p> </li> <li> <p><code>Payload</code>: The second part of the token is the payload, which contains the claims. Claims are statements about an entity (typically, the user) and additional metadata. There are three types of claims: registered, public, and private claims.</p> </li> <li> <p><code>Signature</code>: To create the signature part you have to take the encoded header, the encoded payload, a secret, the algorithm specified in the header, and sign that.</p> </li> </ul> <p>The resulting string is three Base64-URL strings concatenated with dots. The string is compact, URL-safe, and can be conveniently passed in HTML and HTTP environments.</p>"},{"location":"security/schema-link/#params","title":"<code>Params</code>","text":"<ul> <li><code>Token</code>: JWT token.</li> <li><code>App</code>: App's slug that sign this token.</li> </ul> <pre><code>GET /data HTTP/1.1\nHost: api.example.com\nAuthorization: Link App={App},Token={Token}\n</code></pre>"},{"location":"security/schema-link/#using-signature","title":"Using Signature","text":"<p>It's a mechanism that validates the authenticity and integrity of data. It provides a way to verify that the data came from a specific source and has not been altered in transit.</p>"},{"location":"security/schema-link/#params_1","title":"<code>Params</code>","text":"<ul> <li>App: it represents a unique identifier for the app making the request. This is included in the header so the server knows which application is making the request.</li> <li>Token: A nonce is a random or semi-random number that is generated for a specific use, typically to avoid replay attacks. In this case, it's a sign that refer to a signature generated using a cryptographic algorithm.</li> <li>SignedHeaders: This part of the header includes the list of HTTP headers that are included in the signature. These are joined into a string separated by semicolons.</li> <li>Date: This is the timestamp when the request is made. It's often used to ensure that a request is not replayed (that is, sent again by an attacker).</li> </ul> <pre><code>GET /api/resource HTTP/1.1\nHost: www.example.com\nAuthorization: Signature App={App},Nonce={Token},SignedHeaders={header1};{header2};{header3},Date={Date}\n</code></pre>"},{"location":"security/schema-link/#code","title":"Code","text":""},{"location":"security/schema-link/#sender-code","title":"<code>Sender Code</code>","text":"<p>Service is a requests wrapper that manage the authorization header, it use the authorization strategy specified in the app object.</p> <pre><code># Make an action over multiple users\ns = Service(app.id)\nrequest = s.get('v1/auth/user')\ndata = request.json()\nprint(data)\n\n# Make an action over a specify user\ns = Service(app.id, user.id)\nrequest = s.get('v1/auth/user')\ndata = request.json()\nprint(data)\n\n# Force Json Web Token as authorization strategy\ns = Service(app.id)\nrequest = s.get('v1/auth/user', mode='JWT')\ndata = request.json()\nprint(data)\n\n# Force Json Web Token as authorization strategy\ns = Service(app.id)\nrequest = s.get('v1/auth/user', mode='SIGNATURE')\ndata = request.json()\nprint(data)\n</code></pre>"},{"location":"security/schema-link/#receiver","title":"Receiver","text":"<p>Protect a endpoint to access to it having these scopes, like the sender, @scope get <code>mode</code> as argument.</p> <pre><code>@api_view(['POST'])\n@permission_classes([AllowAny])\n@scope(['action_name1:data_name1', 'action_name2:data_name2', ...])\ndef endpoint(request, app: dict, token: dict):\n    handler = self.extensions(request)\n    lang = get_user_language(request)\n\n    extra = {}\n    if app.require_an_agreement:\n        extra['appuseragreement__app__id'] = app.id\n\n    if token.sub:\n        extra['id'] = token.sub\n\n    if user_id:\n        if token.sub and token.sub != user_id:\n            raise ValidationException(translation(lang,\n                                                    en='This user does not have access to this resource',\n                                                    es='Este usuario no tiene acceso a este recurso'),\n                                        code=403,\n                                        slug='user-with-no-access',\n                                        silent=True)\n\n        if 'id' not in extra:\n            extra['id'] = user_id\n\n        user = User.objects.filter(**extra).first()\n        if not user:\n            raise ValidationException(translation(lang, en='User not found', es='Usuario no encontrado'),\n                                        code=404,\n                                        slug='user-not-found',\n                                        silent=True)\n\n        serializer = AppUserSerializer(user, many=False)\n        return Response(serializer.data)\n\n    # test this path\n    items = User.objects.filter(**extra)\n    items = handler.queryset(items)\n    serializer = AppUserSerializer(items, many=True)\n\n    return handler.response(serializer.data)\n</code></pre>"},{"location":"services/google_cloud/google-cloud-functions/","title":"Google Cloud Functions","text":""},{"location":"services/google_cloud/google-cloud-functions/#write-a-http-function","title":"Write a HTTP function","text":"<p>https://cloud.google.com/functions/docs/writing/http</p>"},{"location":"services/google_cloud/google-cloud-functions/#see-active-functions","title":"See active functions","text":"<p>https://console.cloud.google.com/functions/list</p>"},{"location":"services/google_cloud/google-cloud-functions/#testing-function","title":"Testing function","text":"<p>https://cloud.google.com/functions/docs/testing/test-http#functions-testing-http-integration-python</p>"},{"location":"services/google_cloud/google-cloud-functions/#list-functions","title":"List functions","text":"Name Activator Resource Repository process-zap HTTP process-zap screenshots HTTP screenshots jefer94/screenshots resize-image HTTP resize-image breatheco-de/gcloud-resize-image thumbnail-generator Bucket media-breathecode breatheco-de/gcloud-thumbnail-generator thumbnail-generator-dev Bucket media-breathecode-dev breatheco-de/gcloud-thumbnail-generator"},{"location":"services/google_cloud/storage/","title":"Storage","text":""},{"location":"services/google_cloud/storage/#breathecode.services.google_cloud.storage.Storage","title":"<code>Storage</code>","text":"<p>Google Cloud Storage</p> Source code in <code>breathecode/services/google_cloud/storage.py</code> <pre><code>class Storage:\n    \"\"\"Google Cloud Storage\"\"\"\n\n    client: storage.Client\n\n    def __init__(self) -&gt; None:\n        credentials.resolve_credentials()\n        self.client = self._get_client()\n\n    @circuit\n    def _get_client(self) -&gt; storage.Client:\n        \"\"\"Get Google Cloud Storage client\n\n        Returns:\n            storage.Client: Google Cloud Storage client\n        \"\"\"\n        return storage.Client()\n\n    def file(self, bucket_name: str, file_name: str) -&gt; File:\n        \"\"\"Get File object\n\n        Args:\n            bucket_name (str): Name of bucket in Google Cloud Storage\n            file_name (str): Name of blob in Google Cloud Bucket\n\n        Returns:\n            File: File object\n        \"\"\"\n        bucket = self.client.bucket(bucket_name)\n        return File(bucket, file_name)\n\n    def generate_download_signed_url(self, bucket_name: str, file_name: str, expiration_hours: int = 1) -&gt; str:\n        \"\"\"Generate a signed URL for downloading a file\n\n        Args:\n            bucket_name (str): Name of bucket in Google Cloud Storage\n            file_name (str): Name of blob in Google Cloud Bucket\n            expiration_hours (int): Hours until the URL expires (default: 1, max: 24)\n\n        Returns:\n            str: Signed URL for downloading the file\n        \"\"\"\n        from datetime import timedelta\n\n        expiration_hours = min(expiration_hours, 24)  # Max 24 hours\n        cloud_file = self.file(bucket_name, file_name)\n        return cloud_file.generate_signed_url(expiration=timedelta(hours=expiration_hours))\n</code></pre>"},{"location":"services/google_cloud/storage/#breathecode.services.google_cloud.storage.Storage.file","title":"<code>file(bucket_name, file_name)</code>","text":"<p>Get File object</p> <p>Parameters:</p> Name Type Description Default <code>bucket_name</code> <code>str</code> <p>Name of bucket in Google Cloud Storage</p> required <code>file_name</code> <code>str</code> <p>Name of blob in Google Cloud Bucket</p> required <p>Returns:</p> Name Type Description <code>File</code> <code>File</code> <p>File object</p> Source code in <code>breathecode/services/google_cloud/storage.py</code> <pre><code>def file(self, bucket_name: str, file_name: str) -&gt; File:\n    \"\"\"Get File object\n\n    Args:\n        bucket_name (str): Name of bucket in Google Cloud Storage\n        file_name (str): Name of blob in Google Cloud Bucket\n\n    Returns:\n        File: File object\n    \"\"\"\n    bucket = self.client.bucket(bucket_name)\n    return File(bucket, file_name)\n</code></pre>"},{"location":"services/google_cloud/storage/#breathecode.services.google_cloud.storage.Storage.generate_download_signed_url","title":"<code>generate_download_signed_url(bucket_name, file_name, expiration_hours=1)</code>","text":"<p>Generate a signed URL for downloading a file</p> <p>Parameters:</p> Name Type Description Default <code>bucket_name</code> <code>str</code> <p>Name of bucket in Google Cloud Storage</p> required <code>file_name</code> <code>str</code> <p>Name of blob in Google Cloud Bucket</p> required <code>expiration_hours</code> <code>int</code> <p>Hours until the URL expires (default: 1, max: 24)</p> <code>1</code> <p>Returns:</p> Name Type Description <code>str</code> <code>str</code> <p>Signed URL for downloading the file</p> Source code in <code>breathecode/services/google_cloud/storage.py</code> <pre><code>def generate_download_signed_url(self, bucket_name: str, file_name: str, expiration_hours: int = 1) -&gt; str:\n    \"\"\"Generate a signed URL for downloading a file\n\n    Args:\n        bucket_name (str): Name of bucket in Google Cloud Storage\n        file_name (str): Name of blob in Google Cloud Bucket\n        expiration_hours (int): Hours until the URL expires (default: 1, max: 24)\n\n    Returns:\n        str: Signed URL for downloading the file\n    \"\"\"\n    from datetime import timedelta\n\n    expiration_hours = min(expiration_hours, 24)  # Max 24 hours\n    cloud_file = self.file(bucket_name, file_name)\n    return cloud_file.generate_signed_url(expiration=timedelta(hours=expiration_hours))\n</code></pre>"},{"location":"services/slack%20integration/icons/","title":"Icons","text":"<p>The following icons are being used for the slack integrations https://www.pngrepo.com/collection/soft-colored-ui-icons/1</p>"},{"location":"signals/quickstart/","title":"Quickstart","text":""},{"location":"signals/quickstart/#signals","title":"Signals","text":"<p>The official documentation for django signals can be found here.</p> <p>At 4Geeks, signals are similar concept to \"events\", we use signals as custom \"events\" that can notify important things that happen in one app to all the other app's (if they are listening).</p> <p>For example: When a student drops from a cohort</p> <p>There is a signal to notify when a <code>student educational status gets updated</code>, this is useful because other application may react to it. Here is the signal being initialized, here is being triggered/dispatched when a student gets saved and this is an example where the signal is being received on the breathecode.marketing.app to trigger some additional tasks within the system.</p>"},{"location":"signals/quickstart/#when-to-use-a-signal","title":"When to use a signal","text":"<p>Inside the breathecode team, we see signals for asynchronous processing of any side effects, we try to focus on them for communication between apps only.</p>"},{"location":"signals/quickstart/#declare-a-new-signal","title":"Declare a new signal","text":"<p>You have many examples that you can find inside the code, each breathecode app has a file <code>signals.py</code> that contains all the signals dispatched by that app. If the file does not exist within one of the apps, and you need to create a signal for that app, you can create the file yourself.</p> <p>If you wanted to create a signal for when a cohort is saved, you should start by initializing it inside <code>breathecode/admissions/signals.py</code> like this:</p> <pre><code>from django.dispatch import Signal\n\ncohort_saved = Signal()\n</code></pre>"},{"location":"signals/quickstart/#dispatching-a-signal","title":"Dispatching a signal","text":"<p>All the initialized signals are available on the same application <code>signals.py</code> file, if the signal you want to dispatch is not there, you should probably declare a new one.</p> <p>After the signal is initialized, it can be dispatched anywhere withing the same app, for example inside a serializer create method like this:</p> <pre><code>from .signals import cohort_saved\n\nclass CohortSerializer(CohortSerializerMixin):\n\n    def create(self, validated_data):\n        cohort = Cohort.objects.create(**validated_data, **self.context)\n        cohort_saved.send_robust(instance=self, sender=CohortUser)\n        return cohort\n</code></pre>"},{"location":"signals/quickstart/#receiving-a-signal","title":"Receiving a signal","text":"<p>All django applications can subscribe to receive a signal, even if those signals are coming from another app, but you should always add your receiving code inside the receivers.py of the app that will react to the signal.</p> <p>The following code will receive the <code>cohort_saved</code> signal and print on the screen if its being created or updated.</p> <p>Note: Its a good idea to always connect receivers to tasks, that way you can asynconosly pospone any processing that you will do after the cohort its created.</p> <pre><code>from breathecode.admissions.signals import student_edu_status_updated, cohort_saved\nfrom .models import FormEntry, ActiveCampaignAcademy\nfrom .tasks import add_cohort_task_to_student, add_cohort_slug_as_acp_tag\n\n@receiver(cohort_saved, sender=Cohort)\ndef cohort_post_save(sender, instance, created, *args, **kwargs):\n    if created:\n        print(f\"The cohort {instance.id} was just created\")\n        # you can call a task from task.py here.\n    else:\n        print(f\"The cohort {instance.id} was just updated\")\n</code></pre>"},{"location":"supervisors/quickstart/","title":"Supervisors Documentation","text":""},{"location":"supervisors/quickstart/#overview","title":"Overview","text":"<p>The Supervisors system in the <code>breathecode</code> Django application provides automated quality assurance by periodically monitoring the system for issues and triggering corrective actions. Supervisors are implemented as Python functions decorated with <code>@supervisor</code>, which run at specified intervals to detect issues (e.g., data inconsistencies). Detected issues are stored as <code>SupervisorIssue</code> objects and handled by functions decorated with <code>@issue</code>. The system uses Celery for asynchronous task execution and a Django management command to schedule supervisors and issue handlers.</p> <p>This documentation covers the supervisors defined in <code>breathecode/payments/supervisors.py</code>, their triggering mechanism, and how to extend or maintain the system.</p>"},{"location":"supervisors/quickstart/#purpose","title":"Purpose","text":"<p>Supervisors ensure data integrity and compliance with business rules by: - Identifying issues such as orphaned team members (active <code>TeamMember</code> objects without associated <code>Consumable</code> objects) or subscriptions exceeding team size limits. - Creating <code>SupervisorIssue</code> records for detected problems. - Triggering issue handlers to resolve problems (e.g., creating missing consumables or notifying users). - Retrying failed resolutions with configurable attempts and delays.</p>"},{"location":"supervisors/quickstart/#components","title":"Components","text":""},{"location":"supervisors/quickstart/#models","title":"Models","text":"<ul> <li><code>Supervisor</code> (in <code>breathecode.monitoring.models</code>):</li> <li>Tracks metadata for each supervisor function.</li> <li>Fields:<ul> <li><code>task_module</code>: The Python module containing the supervisor (e.g., <code>breathecode.payments.supervisors</code>).</li> <li><code>task_name</code>: The supervisor function name (e.g., <code>supervise_orphaned_team_members</code>).</li> <li><code>delta</code>: The interval between runs (e.g., <code>timedelta(hours=2)</code>).</li> <li><code>ran_at</code>: The last execution time (<code>datetime</code>).</li> </ul> </li> <li><code>SupervisorIssue</code> (in <code>breathecode.monitoring.models</code>):</li> <li>Stores detected issues for processing by issue handlers.</li> <li>Fields:<ul> <li><code>supervisor</code>: Foreign key to the <code>Supervisor</code> instance.</li> <li><code>error</code>: The issue description (e.g., <code>Team member 123 (user@example.com) has no consumables</code>).</li> <li><code>code</code>: The issue handler code (e.g., <code>fix-orphaned-team-member</code>).</li> <li><code>params</code>: Parameters for the issue handler (e.g., <code>{'team_member_id': 123}</code>).</li> <li><code>ran_at</code>: When the issue was detected (<code>datetime</code>).</li> <li><code>occurrences</code>: Number of times the issue was detected.</li> <li><code>fixed</code>: When the issue was resolved (<code>datetime</code>, nullable).</li> <li><code>attempts</code>: Number of resolution attempts.</li> </ul> </li> </ul>"},{"location":"supervisors/quickstart/#decorators","title":"Decorators","text":"<ul> <li><code>@supervisor(delta, auto=True, raises=False)</code> (in <code>breathecode.utils.decorators</code>):</li> <li>Registers a supervisor function to run periodically.</li> <li>Parameters:<ul> <li><code>delta</code>: Interval between runs (e.g., <code>timedelta(hours=2)</code>). Defaults to 1 hour if <code>None</code>.</li> <li><code>auto</code>: If <code>True</code>, automatically runs the supervisor (unused in provided code).</li> <li><code>raises</code>: If <code>True</code>, raises exceptions (unused in provided code).</li> </ul> </li> <li>Functionality:<ul> <li>Adds the supervisor to the global <code>paths</code> set as <code>(module, name, delta)</code>.</li> <li>Creates or updates a <code>Supervisor</code> model instance.</li> <li>Wraps the supervisor function to process yielded issues, creating <code>SupervisorIssue</code> objects.</li> <li>Supports both synchronous and asynchronous supervisors (using <code>async_wrapper</code> for async generators).</li> </ul> </li> <li><code>@issue(code, attempts, delta)</code>:</li> <li>Associates a function with an issue <code>code</code> for handling specific issues.</li> <li>Parameters:<ul> <li><code>code</code>: The issue identifier (e.g., <code>fix-orphaned-team-member</code>).</li> <li><code>attempts</code>: Maximum retry attempts (e.g., 3).</li> <li><code>delta</code>: Delay between retries (e.g., <code>timedelta(minutes=30)</code>).</li> </ul> </li> <li>Functionality:<ul> <li>Executes the handler with <code>params</code> from the <code>SupervisorIssue</code>.</li> <li>Retries if the handler returns <code>None</code> or raises an exception, up to <code>attempts</code> times.</li> </ul> </li> </ul>"},{"location":"supervisors/quickstart/#management-command","title":"Management Command","text":"<ul> <li>Command: <code>python manage.py run_supervisors</code> (assumed name, located in <code>breathecode/monitoring/management/commands/run_supervisors.py</code>).</li> <li>Functionality:</li> <li>Deletes <code>SupervisorIssue</code> objects older than 7 days.</li> <li>Registers all supervisors from the <code>paths</code> set as <code>Supervisor</code> model instances.</li> <li>Schedules supervisors that are due to run using <code>run_supervisor.delay(supervisor_id)</code>.</li> <li>Schedules issue handlers for unresolved issues using <code>fix_issue.delay(issue_id)</code>.</li> </ul>"},{"location":"supervisors/quickstart/#celery-tasks","title":"Celery Tasks","text":"<ul> <li><code>run_supervisor</code> (in <code>breathecode.monitoring.tasks</code>):</li> <li>Executes a supervisor function by <code>Supervisor</code> ID.</li> <li>Updates <code>ran_at</code> to <code>timezone.now()</code>.</li> <li><code>fix_issue</code> (in <code>breathecode.monitoring.tasks</code>):</li> <li>Calls the <code>@issue</code> handler for a <code>SupervisorIssue</code> based on its <code>code</code>.</li> <li>Passes <code>params</code> to the handler.</li> <li>Updates <code>attempts</code> and <code>fixed</code> fields.</li> </ul>"},{"location":"supervisors/quickstart/#supervisors-in-breathecodepaymentssupervisorspy","title":"Supervisors in <code>breathecode/payments/supervisors.py</code>","text":""},{"location":"supervisors/quickstart/#supervise_orphaned_team_members","title":"<code>supervise_orphaned_team_members</code>","text":"<ul> <li>Purpose: Identifies active <code>TeamMember</code> objects without associated <code>Consumable</code> objects.</li> <li>Interval: Every 2 hours (<code>delta=timedelta(hours=2)</code>).</li> <li>Logic:</li> <li>Queries <code>TeamMember</code> objects where:<ul> <li><code>status=TeamMember.Status.ACTIVE</code></li> <li><code>user</code> is not null</li> <li><code>joined_at</code> is not null</li> <li>No <code>Consumable</code> exists for the <code>TeamMember</code></li> </ul> </li> <li>Yields an issue for each orphaned member:     <pre><code>{\n    'code': 'fix-orphaned-team-member',\n    'message': f'Team member {member.id} ({member.email}) has no consumables',\n    'params': {'team_member_id': member.id}\n}\n</code></pre></li> </ul>"},{"location":"supervisors/quickstart/#supervise_team_member_limits","title":"<code>supervise_team_member_limits</code>","text":"<ul> <li>Purpose: Identifies <code>Subscription</code> objects with more active <code>TeamMember</code> objects than allowed by their <code>ServiceItem.max_team_members</code>.</li> <li>Interval: Every 6 hours (<code>delta=timedelta(hours=6)</code>).</li> <li>Logic:</li> <li>Queries <code>ServiceItem</code> objects with <code>is_team_allowed=True</code>.</li> <li>For each <code>ServiceItem</code>, finds <code>Subscription</code> objects where the count of active <code>TeamMember</code> objects (via <code>Consumable</code>) exceeds <code>max_team_members</code>.</li> <li>Yields an issue for each violation:     <pre><code>{\n    'code': 'fix-team-size-exceeded',\n    'message': f'Subscription {subscription.id} has {subscription.active_team_count} team members, max allowed: {service_item.max_team_members}',\n    'params': {\n        'subscription_id': subscription.id,\n        'service_item_id': service_item.id,\n        'current_count': subscription.active_team_count,\n        'max_allowed': service_item.max_team_members\n    }\n}\n</code></pre></li> </ul>"},{"location":"supervisors/quickstart/#issue-handlers","title":"Issue Handlers","text":""},{"location":"supervisors/quickstart/#fix_orphaned_team_memberteam_member_id-int","title":"<code>fix_orphaned_team_member(team_member_id: int)</code>","text":"<ul> <li>Code: <code>fix-orphaned-team-member</code></li> <li>Attempts: 3</li> <li>Retry Delay: 30 minutes (<code>timedelta(minutes=30)</code>)</li> <li>Logic:</li> <li>Checks if the <code>TeamMember</code> exists and is active.</li> <li>If consumables already exist, marks as resolved.</li> <li>Calls <code>create_team_member_consumables(team_member)</code> to create missing consumables.</li> <li>Returns <code>True</code> if resolved, <code>None</code> to retry on error.</li> <li>Logging:</li> <li>Success: <code>logger.info(f\"Fixed orphaned team member {team_member_id}\")</code></li> <li>Failure: <code>logger.error(f\"Failed to fix orphaned team member {team_member_id}: {e}\")</code></li> </ul>"},{"location":"supervisors/quickstart/#fix_team_size_exceededsubscription_id-int-service_item_id-int-current_count-int-max_allowed-int","title":"<code>fix_team_size_exceeded(subscription_id: int, service_item_id: int, current_count: int, max_allowed: int)</code>","text":"<ul> <li>Code: <code>fix-team-size-exceeded</code></li> <li>Attempts: 2</li> <li>Retry Delay: 1 hour (<code>timedelta(hours=1)</code>)</li> <li>Logic:</li> <li>Checks if the <code>Subscription</code> and <code>ServiceItem</code> exist.</li> <li>Sends an email notification to the subscription owner using <code>send_email_message</code>.</li> <li>Returns <code>True</code> if the notification is sent, <code>None</code> to retry on error.</li> <li>Logging:</li> <li>Success: <code>logger.warning(f\"Notified user about team size exceeded: subscription {subscription_id}\")</code></li> <li>Failure: <code>logger.error(f\"Failed to handle team size exceeded for subscription {subscription_id}: {e}\")</code></li> </ul>"},{"location":"supervisors/quickstart/#triggering-mechanism","title":"Triggering Mechanism","text":"<p>Supervisors are triggered via the <code>run_supervisors</code> management command, which is typically run periodically (e.g., via a cron job or Celery Beat). The process is as follows:</p> <ol> <li>Command Execution:</li> <li>Run <code>python manage.py run_supervisors</code>.</li> <li>Deletes <code>SupervisorIssue</code> objects older than 7 days.</li> <li>Registers all supervisors from the <code>paths</code> set as <code>Supervisor</code> model instances.</li> <li> <p>Calls <code>run_supervisors()</code> and <code>fix_issues()</code>.</p> </li> <li> <p>Supervisor Scheduling:</p> </li> <li><code>run_supervisors</code> queries all <code>Supervisor</code> objects.</li> <li>For each supervisor, checks if it\u2019s due to run (<code>ran_at is None</code> or <code>now - delta &gt; ran_at</code>).</li> <li>Schedules eligible supervisors via <code>run_supervisor.delay(supervisor_id)</code> (a Celery task).</li> <li> <p>Logs: <code>Supervisor breathecode.payments.supervisors.supervise_orphaned_team_members scheduled</code>.</p> </li> <li> <p>Supervisor Execution:</p> </li> <li>The <code>run_supervisor</code> task:<ul> <li>Retrieves the <code>Supervisor</code> by ID.</li> <li>Imports and runs the supervisor function (e.g., <code>supervise_orphaned_team_members</code>).</li> <li>Updates <code>ran_at = timezone.now()</code>.</li> </ul> </li> <li> <p>The supervisor yields issue dictionaries, which the <code>@supervisor</code> decorator\u2019s <code>wrapper</code> converts to <code>SupervisorIssue</code> objects:</p> <ul> <li><code>supervisor</code>: Links to the <code>Supervisor</code> instance.</li> <li><code>error</code>: Issue message.</li> <li><code>code</code>: Issue handler code.</li> <li><code>params</code>: Parameters for the handler.</li> <li><code>ran_at</code>: Detection time.</li> <li><code>occurrences</code>: Incremented for recurring issues.</li> </ul> </li> <li> <p>Issue Handling:</p> </li> <li><code>fix_issues</code> queries <code>SupervisorIssue</code> objects where <code>fixed=None</code> and <code>attempts &lt; 3</code>.</li> <li>Schedules <code>fix_issue.delay(issue_id)</code> for each issue.</li> <li> <p>The <code>fix_issue</code> task:</p> <ul> <li>Retrieves the <code>SupervisorIssue</code>.</li> <li>Calls the <code>@issue</code> handler based on the <code>code</code> (e.g., <code>fix_orphaned_team_member</code>).</li> <li>Updates <code>attempts</code> and <code>fixed</code> if resolved.</li> <li>Retries if <code>None</code> is returned, up to the handler\u2019s <code>attempts</code> limit.</li> </ul> </li> <li> <p>Scheduling:</p> </li> <li>The command should be run periodically (e.g., every 5 minutes via cron or Celery Beat):      <pre><code>*/5 * * * * python manage.py run_supervisors\n</code></pre></li> <li>This ensures supervisors run at their specified intervals (2 hours for <code>supervise_orphaned_team_members</code>, 6 hours for <code>supervise_team_member_limits</code>).</li> </ol>"},{"location":"supervisors/quickstart/#example-flow","title":"Example Flow","text":"<ol> <li>9:00 AM: Run <code>python manage.py run_supervisors</code>.</li> <li>Deletes old issues.</li> <li>Registers supervisors in <code>Supervisor</code>.</li> <li>Schedules <code>supervise_orphaned_team_members</code> (due immediately).</li> <li>run_supervisor Task:</li> <li>Runs <code>supervise_orphaned_team_members</code>, finds <code>TeamMember</code> ID 123 without consumables.</li> <li>Creates a <code>SupervisorIssue</code> with <code>code='fix-orphaned-team-member'</code>, <code>params={'team_member_id': 123}</code>.</li> <li>fix_issues:</li> <li>Schedules <code>fix_issue.delay(issue_id)</code> for the issue.</li> <li><code>fix_orphaned_team_member</code> creates consumables and marks the issue as resolved.</li> <li>11:00 AM: Next run checks if <code>supervise_orphaned_team_members</code> is due again.</li> </ol>"},{"location":"supervisors/quickstart/#best-practices","title":"Best Practices","text":"<ul> <li>Idempotency: Ensure issue handlers (e.g., <code>create_team_member_consumables</code>) are idempotent to avoid duplicate actions.</li> <li>Performance:</li> <li>Add indexes to optimize queries:     <pre><code>class TeamMember(models.Model):\n    status = models.CharField(max_length=20, choices=TeamMember.Status.choices)\n    user = models.ForeignKey('auth.User', on_delete=models.CASCADE)\n    joined_at = models.DateTimeField()\n    class Meta:\n        indexes = [\n            models.Index(fields=['status', 'user', 'joined_at']),\n        ]\n</code></pre> <pre><code>class Consumable(models.Model):\n    team_member = models.ForeignKey('TeamMember', on_delete=models.CASCADE, null=True)\n    service_item = models.ForeignKey('ServiceItem', on_delete=models.CASCADE)\n    class Meta:\n        indexes = [\n            models.Index(fields=['team_member']),\n        ]\n</code></pre></li> <li>Batch <code>SupervisorIssue</code> creation for large datasets:     <pre><code>issues = [\n    SupervisorIssue(\n        supervisor=instance,\n        error=f'Team member {member.id} ({member.email}) has no consumables',\n        code='fix-orphaned-team-member',\n        params={'team_member_id': member.id},\n        ran_at=timezone.now()\n    )\n    for member in orphaned_members\n]\nSupervisorIssue.objects.bulk_create(issues)\n</code></pre></li> <li>Monitoring: Add metrics (e.g., via <code>statsd</code>) to track supervisor runs and issue resolutions.</li> <li>Retry Consistency: Align <code>fix_issues</code> retry limit with <code>@issue</code> <code>attempts</code> (e.g., <code>fix_team_size_exceeded</code> has <code>attempts=2</code>, but <code>fix_issues</code> assumes 3).</li> </ul>"},{"location":"supervisors/quickstart/#troubleshooting","title":"Troubleshooting","text":"<ul> <li>Supervisor Not Running: Check if the command is scheduled (e.g., via cron or Celery Beat) and if Celery workers are active.</li> <li>Issues Not Resolved: Verify <code>fix_issue</code> task is running and the <code>@issue</code> handler\u2019s <code>code</code> matches the <code>SupervisorIssue.code</code>.</li> <li>Performance Issues: Profile queries and add indexes as needed.</li> <li>Logging: Check logs (<code>logger.info</code>, <code>logger.error</code>) for errors in <code>fix_orphaned_team_member</code> or <code>fix_team_size_exceeded</code>.</li> </ul>"},{"location":"supervisors/quickstart/#extending-the-system","title":"Extending the System","text":"<p>To add a new supervisor: 1. Define the supervisor function in <code>breathecode/payments/supervisors.py</code>:    <pre><code>@supervisor(delta=timedelta(hours=4))\ndef supervise_new_condition():\n    for item in SomeModel.objects.filter(some_condition=True):\n        yield {\n            'code': 'fix-new-condition',\n            'message': f'Issue with {item.id}',\n            'params': {'item_id': item.id}\n        }\n</code></pre> 2. Define the issue handler:    <pre><code>@issue(code='fix-new-condition', attempts=3, delta=timedelta(minutes=30))\ndef fix_new_condition(item_id: int):\n    try:\n        item = SomeModel.objects.get(id=item_id)\n        # Fix logic\n        logger.info(f\"Fixed item {item_id}\")\n        return True\n    except Exception as e:\n        logger.error(f\"Failed to fix item {item_id}: {e}\")\n        return None\n</code></pre> 3. Ensure the management command is run periodically.</p>"},{"location":"testing/parametrize/","title":"Multiple parameters","text":"<p>This is the function to be tested, it receive x bits and convert it to an integer.</p> <pre><code>def bytes_to_integer(*bit: int):\n    how_many = len(bit)\n    result = 0\n\n    for i in range(how_many):\n        offset = 2**(how_many - 1 - i)\n        result += bit[i] * offset\n\n    return result\n</code></pre> <p>This have 16 possible values, we can build all cases providing the bit 3 and 4 as 00, 01, 10, 11 in row, and in each iteration set the bit 1 and 2 starting from 00 until 11, like it where in the following table.</p> Decimal 4-bit Binary 0 0000 1 0001 2 0010 3 0011 4 0100 5 0101 6 0110 7 0111 8 1000 9 1001 10 1010 11 1011 12 1100 13 1101 14 1110 15 1111 <p>So, the bit 1 have a value of 8, the bit 2 is 4, the bit 3 is 2, and the bit 1 is 1 or 0, it can sum each component and check if the result is ok.</p> <pre><code>@pytest.mark.parametrize('bit1,bit2,res1', [(0, 0, 0), (0, 1, 4), (1, 0, 8), (1, 1, 12)])\n@pytest.mark.parametrize('bit3,bit4,res2', [(0, 0, 0), (0, 1, 1), (1, 0, 2), (1, 1, 3)])\ndef test_bytes_to_integer(bit1, bit2, bit3, bit4, res1, res2):\n    number = bytes_to_integer(bit1, bit2, bit3, bit4)\n    assert number == res1 + res2\n</code></pre> <p>This test will be executed 16 times with each row in the table, this avoid to write the test 16 times or use random values that should generate a random behavior, this case pass each one of the case have a significant overhead when the tests are running, it's recommended when the functionality is core or important in the api.</p>"},{"location":"testing/running-tests/","title":"Running tests","text":""},{"location":"testing/running-tests/#run-a-test-file","title":"Run a test file","text":"<pre><code>poetry run test breathecode/payments/tests/urls/tests_me_service_slug_consumptionsession_hash.py\n</code></pre>"},{"location":"testing/running-tests/#pytest-options","title":"Pytest options","text":"<ul> <li><code>-v</code>: verbose</li> <li><code>-vv</code>: more verbose</li> <li><code>-s</code>: don't capture the stdout, useful when the test execution won't end.</li> <li><code>-k</code>: only run test methods and classes that match the pattern or substring.</li> </ul>"},{"location":"testing/running-tests/#run-tests-in-parallel","title":"Run tests in parallel","text":"<pre><code>poetry run test:parallel\n</code></pre>"},{"location":"testing/running-tests/#run-tests-in-parallel-in-a-module","title":"Run tests in parallel in a module","text":"<pre><code>poetry run test:parallel ./breathecode/\n</code></pre>"},{"location":"testing/running-tests/#run-coverage-in-parallel","title":"Run coverage in parallel","text":"<pre><code>poetry run test:coverage\n</code></pre>"},{"location":"testing/running-tests/#run-coverage-in-parallel-in-a-module","title":"Run coverage in parallel in a module","text":"<pre><code>poetry run test:coverage breathecode.admissions\n</code></pre>"},{"location":"testing/mixins/bc-cache/","title":"bc.cache","text":""},{"location":"testing/mixins/bc-cache/#breathecode.tests.mixins.breathecode_mixin.cache.Cache","title":"<code>Cache</code>","text":"<p>Mixin with the purpose of cover all the related with cache</p> Source code in <code>breathecode/tests/mixins/breathecode_mixin/cache.py</code> <pre><code>class Cache:\n    \"\"\"Mixin with the purpose of cover all the related with cache\"\"\"\n\n    clear = CacheMixin.clear_cache\n    _parent: APITestCase\n    _bc: interfaces.BreathecodeInterface\n\n    def __init__(self, parent, bc: interfaces.BreathecodeInterface) -&gt; None:\n        self._parent = parent\n        self._bc = bc\n</code></pre>"},{"location":"testing/mixins/bc-check/","title":"bc.check","text":""},{"location":"testing/mixins/bc-check/#breathecode.tests.mixins.breathecode_mixin.check.Check","title":"<code>Check</code>","text":"<p>Mixin with the purpose of cover all the related with the custom asserts</p> Source code in <code>breathecode/tests/mixins/breathecode_mixin/check.py</code> <pre><code>class Check:\n    \"\"\"Mixin with the purpose of cover all the related with the custom asserts\"\"\"\n\n    sha256 = Sha256Mixin.assertHash\n    token = TokenMixin.assertToken\n    _parent: APITestCase\n    _bc: interfaces.BreathecodeInterface\n\n    def __init__(self, parent, bc: interfaces.BreathecodeInterface) -&gt; None:\n        self._parent = parent\n        self._bc = bc\n\n    def datetime_in_range(self, start: datetime, end: datetime, date: datetime) -&gt; None:\n        \"\"\"\n        Check if a range if between start and end argument.\n\n        Usage:\n\n        ```py\n        from django.utils import timezone\n\n        start = timezone.now()\n        in_range = timezone.now()\n        end = timezone.now()\n        out_of_range = timezone.now()\n\n        # pass because this datetime is between start and end\n        self.bc.check.datetime_in_range(start, end, in_range)  # \ud83d\udfe2\n\n        # fail because this datetime is not between start and end\n        self.bc.check.datetime_in_range(start, end, out_of_range)  # \ud83d\udd34\n        ```\n        \"\"\"\n\n        self._parent.assertLess(start, date)\n        self._parent.assertGreater(end, date)\n\n    def partial_equality(self, first: dict | list[dict], second: dict | list[dict]) -&gt; None:\n        \"\"\"\n        Fail if the two objects are partially unequal as determined by the '==' operator.\n\n        Usage:\n\n        ```py\n        obj1 = {'key1': 1, 'key2': 2}\n        obj2 = {'key2': 2, 'key3': 1}\n        obj3 = {'key2': 2}\n\n        # it's fail because the key3 is not in the obj1\n        self.bc.check.partial_equality(obj1, obj2)  # \ud83d\udd34\n\n        # it's fail because the key1 is not in the obj2\n        self.bc.check.partial_equality(obj2, obj1)  # \ud83d\udd34\n\n        # it's pass because the key2 exists in the obj1\n        self.bc.check.partial_equality(obj1, obj3)  # \ud83d\udfe2\n\n        # it's pass because the key2 exists in the obj2\n        self.bc.check.partial_equality(obj2, obj3)  # \ud83d\udfe2\n\n        # it's fail because the key1 is not in the obj3\n        self.bc.check.partial_equality(obj3, obj1)  # \ud83d\udd34\n\n        # it's fail because the key3 is not in the obj3\n        self.bc.check.partial_equality(obj3, obj2)  # \ud83d\udd34\n        ```\n        \"\"\"\n\n        assert type(first) == type(second)\n\n        if isinstance(first, list):\n            assert len(first) == len(second)\n\n            original = []\n\n            for i in range(0, len(first)):\n                original.append(self._fill_partial_equality(first[i], second[i]))\n\n        else:\n            original = self._fill_partial_equality(first, second)\n\n        self._parent.assertEqual(original, second)\n\n    def calls(self, first: list[call], second: list[call]) -&gt; None:\n        \"\"\"\n        Fail if the two objects are partially unequal as determined by the '==' operator.\n\n        Usage:\n\n        ```py\n        self.bc.check.calls(mock.call_args_list, [call(1, 2, a=3, b=4)])\n        ```\n        \"\"\"\n\n        is_unittest = hasattr(self._parent, \"assertEqual\")\n\n        if is_unittest:\n            self._parent.assertEqual(\n                len(first), len(second), msg=f\"Does not have same length\\n\\n{first}\\n\\n!=\\n\\n{second}\"\n            )\n\n            for i in range(0, len(first)):\n                self._parent.assertEqual(first[i].args, second[i].args, msg=f\"args in index {i} does not match\")\n                self._parent.assertEqual(first[i].kwargs, second[i].kwargs, msg=f\"kwargs in index {i} does not match\")\n\n        else:\n            assert len(first) == len(second), f\"not have same length than {first}\\n{second}\"\n\n            for i in range(0, len(first)):\n                assert first[i].args == second[i].args, f\"args in index {i} does not match\"\n                assert first[i].kwargs == second[i].kwargs, f\"kwargs in index {i} does not match\"\n\n    def _fill_partial_equality(self, first: dict, second: dict) -&gt; dict:\n        original = {}\n\n        for key in second.keys():\n            original[key] = second[key]\n\n        return original\n\n    def queryset_of(self, query: Any, model: Model) -&gt; None:\n        \"\"\"\n        Check if the first argument is a queryset of a models provided as second argument.\n\n        Usage:\n\n        ```py\n        from breathecode.admissions.models import Cohort, Academy\n\n        self.bc.database.create(cohort=1)\n\n        collection = []\n        queryset = Cohort.objects.filter()\n\n        # pass because the first argument is a QuerySet and it's type Cohort\n        self.bc.check.queryset_of(queryset, Cohort)  # \ud83d\udfe2\n\n        # fail because the first argument is a QuerySet and it is not type Academy\n        self.bc.check.queryset_of(queryset, Academy)  # \ud83d\udd34\n\n        # fail because the first argument is not a QuerySet\n        self.bc.check.queryset_of(collection, Academy)  # \ud83d\udd34\n        ```\n        \"\"\"\n\n        if not isinstance(query, QuerySet):\n            self._parent.fail(\"The first argument is not a QuerySet\")\n\n        if query.model != model:\n            self._parent.fail(f\"The QuerySet is type {query.model.__name__} instead of {model.__name__}\")\n\n    def queryset_with_pks(self, query: Any, pks: list[int]) -&gt; None:\n        \"\"\"\n        Check if the queryset have the following primary keys.\n\n        Usage:\n\n        ```py\n        from breathecode.admissions.models import Cohort, Academy\n\n        self.bc.database.create(cohort=1)\n\n        collection = []\n        queryset = Cohort.objects.filter()\n\n        # pass because the QuerySet has the primary keys 1\n        self.bc.check.queryset_with_pks(queryset, [1])  # \ud83d\udfe2\n\n        # fail because the QuerySet has the primary keys 1 but the second argument is empty\n        self.bc.check.queryset_with_pks(queryset, [])  # \ud83d\udd34\n        ```\n        \"\"\"\n\n        if not isinstance(query, QuerySet):\n            self._parent.fail(\"The first argument is not a QuerySet\")\n\n        assert [x.pk for x in query] == pks\n\n    def list_with_pks(self, query: Any, pks: list[int]) -&gt; None:\n        \"\"\"\n        Check if the list have the following primary keys.\n\n        Usage:\n\n        ```py\n        from breathecode.admissions.models import Cohort, Academy\n\n        model = self.bc.database.create(cohort=1)\n\n        collection = [model.cohort]\n\n        # pass because the QuerySet has the primary keys 1\n        self.bc.check.list_with_pks(collection, [1])  # \ud83d\udfe2\n\n        # fail because the QuerySet has the primary keys 1 but the second argument is empty\n        self.bc.check.list_with_pks(collection, [])  # \ud83d\udd34\n        ```\n        \"\"\"\n\n        if not isinstance(query, list):\n            self._parent.fail(\"The first argument is not a list\")\n\n        self._parent.assertEqual([x.pk for x in query], pks)\n\n    def count_queries(self, n, db=\"default\", verbose=False):\n        queries = [query[\"sql\"] for query in connections[db].queries]\n\n        if not verbose:\n            self._parent.assertEqual(n, len(queries), \"different number of queries, use verbose=True to see more info\")\n\n        if verbose and n != len(queries):\n            result = \"\\n\"\n            result += \"---------------- Queries ----------------\\n\\n\"\n            for query in connections[db].queries:\n                result += f'{query[\"time\"]} {query[\"sql\"]}\\n\\n'\n            result += \"----------------- Count -----------------\\n\\n\"\n            result += f\"Queries: {len(connections[db].queries)}\\n\\n\"\n            result += \"-----------------------------------------\\n\\n\"\n            self._parent.fail(result)\n\n    @contextmanager\n    def raises(self, expected_exception, expected_message):\n        try:\n            yield\n        except expected_exception as e:\n            assert str(e) == expected_message, f\"Expected '{expected_message}', but got '{str(e)}'\"\n        except Exception as e:\n            pytest.fail(f\"Expected {expected_exception} but it was not raised.\")\n</code></pre>"},{"location":"testing/mixins/bc-check/#breathecode.tests.mixins.breathecode_mixin.check.Check.calls","title":"<code>calls(first, second)</code>","text":"<p>Fail if the two objects are partially unequal as determined by the '==' operator.</p> <p>Usage:</p> <pre><code>self.bc.check.calls(mock.call_args_list, [call(1, 2, a=3, b=4)])\n</code></pre> Source code in <code>breathecode/tests/mixins/breathecode_mixin/check.py</code> <pre><code>def calls(self, first: list[call], second: list[call]) -&gt; None:\n    \"\"\"\n    Fail if the two objects are partially unequal as determined by the '==' operator.\n\n    Usage:\n\n    ```py\n    self.bc.check.calls(mock.call_args_list, [call(1, 2, a=3, b=4)])\n    ```\n    \"\"\"\n\n    is_unittest = hasattr(self._parent, \"assertEqual\")\n\n    if is_unittest:\n        self._parent.assertEqual(\n            len(first), len(second), msg=f\"Does not have same length\\n\\n{first}\\n\\n!=\\n\\n{second}\"\n        )\n\n        for i in range(0, len(first)):\n            self._parent.assertEqual(first[i].args, second[i].args, msg=f\"args in index {i} does not match\")\n            self._parent.assertEqual(first[i].kwargs, second[i].kwargs, msg=f\"kwargs in index {i} does not match\")\n\n    else:\n        assert len(first) == len(second), f\"not have same length than {first}\\n{second}\"\n\n        for i in range(0, len(first)):\n            assert first[i].args == second[i].args, f\"args in index {i} does not match\"\n            assert first[i].kwargs == second[i].kwargs, f\"kwargs in index {i} does not match\"\n</code></pre>"},{"location":"testing/mixins/bc-check/#breathecode.tests.mixins.breathecode_mixin.check.Check.datetime_in_range","title":"<code>datetime_in_range(start, end, date)</code>","text":"<p>Check if a range if between start and end argument.</p> <p>Usage:</p> <pre><code>from django.utils import timezone\n\nstart = timezone.now()\nin_range = timezone.now()\nend = timezone.now()\nout_of_range = timezone.now()\n\n# pass because this datetime is between start and end\nself.bc.check.datetime_in_range(start, end, in_range)  # \ud83d\udfe2\n\n# fail because this datetime is not between start and end\nself.bc.check.datetime_in_range(start, end, out_of_range)  # \ud83d\udd34\n</code></pre> Source code in <code>breathecode/tests/mixins/breathecode_mixin/check.py</code> <pre><code>def datetime_in_range(self, start: datetime, end: datetime, date: datetime) -&gt; None:\n    \"\"\"\n    Check if a range if between start and end argument.\n\n    Usage:\n\n    ```py\n    from django.utils import timezone\n\n    start = timezone.now()\n    in_range = timezone.now()\n    end = timezone.now()\n    out_of_range = timezone.now()\n\n    # pass because this datetime is between start and end\n    self.bc.check.datetime_in_range(start, end, in_range)  # \ud83d\udfe2\n\n    # fail because this datetime is not between start and end\n    self.bc.check.datetime_in_range(start, end, out_of_range)  # \ud83d\udd34\n    ```\n    \"\"\"\n\n    self._parent.assertLess(start, date)\n    self._parent.assertGreater(end, date)\n</code></pre>"},{"location":"testing/mixins/bc-check/#breathecode.tests.mixins.breathecode_mixin.check.Check.list_with_pks","title":"<code>list_with_pks(query, pks)</code>","text":"<p>Check if the list have the following primary keys.</p> <p>Usage:</p> <pre><code>from breathecode.admissions.models import Cohort, Academy\n\nmodel = self.bc.database.create(cohort=1)\n\ncollection = [model.cohort]\n\n# pass because the QuerySet has the primary keys 1\nself.bc.check.list_with_pks(collection, [1])  # \ud83d\udfe2\n\n# fail because the QuerySet has the primary keys 1 but the second argument is empty\nself.bc.check.list_with_pks(collection, [])  # \ud83d\udd34\n</code></pre> Source code in <code>breathecode/tests/mixins/breathecode_mixin/check.py</code> <pre><code>def list_with_pks(self, query: Any, pks: list[int]) -&gt; None:\n    \"\"\"\n    Check if the list have the following primary keys.\n\n    Usage:\n\n    ```py\n    from breathecode.admissions.models import Cohort, Academy\n\n    model = self.bc.database.create(cohort=1)\n\n    collection = [model.cohort]\n\n    # pass because the QuerySet has the primary keys 1\n    self.bc.check.list_with_pks(collection, [1])  # \ud83d\udfe2\n\n    # fail because the QuerySet has the primary keys 1 but the second argument is empty\n    self.bc.check.list_with_pks(collection, [])  # \ud83d\udd34\n    ```\n    \"\"\"\n\n    if not isinstance(query, list):\n        self._parent.fail(\"The first argument is not a list\")\n\n    self._parent.assertEqual([x.pk for x in query], pks)\n</code></pre>"},{"location":"testing/mixins/bc-check/#breathecode.tests.mixins.breathecode_mixin.check.Check.partial_equality","title":"<code>partial_equality(first, second)</code>","text":"<p>Fail if the two objects are partially unequal as determined by the '==' operator.</p> <p>Usage:</p> <pre><code>obj1 = {'key1': 1, 'key2': 2}\nobj2 = {'key2': 2, 'key3': 1}\nobj3 = {'key2': 2}\n\n# it's fail because the key3 is not in the obj1\nself.bc.check.partial_equality(obj1, obj2)  # \ud83d\udd34\n\n# it's fail because the key1 is not in the obj2\nself.bc.check.partial_equality(obj2, obj1)  # \ud83d\udd34\n\n# it's pass because the key2 exists in the obj1\nself.bc.check.partial_equality(obj1, obj3)  # \ud83d\udfe2\n\n# it's pass because the key2 exists in the obj2\nself.bc.check.partial_equality(obj2, obj3)  # \ud83d\udfe2\n\n# it's fail because the key1 is not in the obj3\nself.bc.check.partial_equality(obj3, obj1)  # \ud83d\udd34\n\n# it's fail because the key3 is not in the obj3\nself.bc.check.partial_equality(obj3, obj2)  # \ud83d\udd34\n</code></pre> Source code in <code>breathecode/tests/mixins/breathecode_mixin/check.py</code> <pre><code>def partial_equality(self, first: dict | list[dict], second: dict | list[dict]) -&gt; None:\n    \"\"\"\n    Fail if the two objects are partially unequal as determined by the '==' operator.\n\n    Usage:\n\n    ```py\n    obj1 = {'key1': 1, 'key2': 2}\n    obj2 = {'key2': 2, 'key3': 1}\n    obj3 = {'key2': 2}\n\n    # it's fail because the key3 is not in the obj1\n    self.bc.check.partial_equality(obj1, obj2)  # \ud83d\udd34\n\n    # it's fail because the key1 is not in the obj2\n    self.bc.check.partial_equality(obj2, obj1)  # \ud83d\udd34\n\n    # it's pass because the key2 exists in the obj1\n    self.bc.check.partial_equality(obj1, obj3)  # \ud83d\udfe2\n\n    # it's pass because the key2 exists in the obj2\n    self.bc.check.partial_equality(obj2, obj3)  # \ud83d\udfe2\n\n    # it's fail because the key1 is not in the obj3\n    self.bc.check.partial_equality(obj3, obj1)  # \ud83d\udd34\n\n    # it's fail because the key3 is not in the obj3\n    self.bc.check.partial_equality(obj3, obj2)  # \ud83d\udd34\n    ```\n    \"\"\"\n\n    assert type(first) == type(second)\n\n    if isinstance(first, list):\n        assert len(first) == len(second)\n\n        original = []\n\n        for i in range(0, len(first)):\n            original.append(self._fill_partial_equality(first[i], second[i]))\n\n    else:\n        original = self._fill_partial_equality(first, second)\n\n    self._parent.assertEqual(original, second)\n</code></pre>"},{"location":"testing/mixins/bc-check/#breathecode.tests.mixins.breathecode_mixin.check.Check.queryset_of","title":"<code>queryset_of(query, model)</code>","text":"<p>Check if the first argument is a queryset of a models provided as second argument.</p> <p>Usage:</p> <pre><code>from breathecode.admissions.models import Cohort, Academy\n\nself.bc.database.create(cohort=1)\n\ncollection = []\nqueryset = Cohort.objects.filter()\n\n# pass because the first argument is a QuerySet and it's type Cohort\nself.bc.check.queryset_of(queryset, Cohort)  # \ud83d\udfe2\n\n# fail because the first argument is a QuerySet and it is not type Academy\nself.bc.check.queryset_of(queryset, Academy)  # \ud83d\udd34\n\n# fail because the first argument is not a QuerySet\nself.bc.check.queryset_of(collection, Academy)  # \ud83d\udd34\n</code></pre> Source code in <code>breathecode/tests/mixins/breathecode_mixin/check.py</code> <pre><code>def queryset_of(self, query: Any, model: Model) -&gt; None:\n    \"\"\"\n    Check if the first argument is a queryset of a models provided as second argument.\n\n    Usage:\n\n    ```py\n    from breathecode.admissions.models import Cohort, Academy\n\n    self.bc.database.create(cohort=1)\n\n    collection = []\n    queryset = Cohort.objects.filter()\n\n    # pass because the first argument is a QuerySet and it's type Cohort\n    self.bc.check.queryset_of(queryset, Cohort)  # \ud83d\udfe2\n\n    # fail because the first argument is a QuerySet and it is not type Academy\n    self.bc.check.queryset_of(queryset, Academy)  # \ud83d\udd34\n\n    # fail because the first argument is not a QuerySet\n    self.bc.check.queryset_of(collection, Academy)  # \ud83d\udd34\n    ```\n    \"\"\"\n\n    if not isinstance(query, QuerySet):\n        self._parent.fail(\"The first argument is not a QuerySet\")\n\n    if query.model != model:\n        self._parent.fail(f\"The QuerySet is type {query.model.__name__} instead of {model.__name__}\")\n</code></pre>"},{"location":"testing/mixins/bc-check/#breathecode.tests.mixins.breathecode_mixin.check.Check.queryset_with_pks","title":"<code>queryset_with_pks(query, pks)</code>","text":"<p>Check if the queryset have the following primary keys.</p> <p>Usage:</p> <pre><code>from breathecode.admissions.models import Cohort, Academy\n\nself.bc.database.create(cohort=1)\n\ncollection = []\nqueryset = Cohort.objects.filter()\n\n# pass because the QuerySet has the primary keys 1\nself.bc.check.queryset_with_pks(queryset, [1])  # \ud83d\udfe2\n\n# fail because the QuerySet has the primary keys 1 but the second argument is empty\nself.bc.check.queryset_with_pks(queryset, [])  # \ud83d\udd34\n</code></pre> Source code in <code>breathecode/tests/mixins/breathecode_mixin/check.py</code> <pre><code>def queryset_with_pks(self, query: Any, pks: list[int]) -&gt; None:\n    \"\"\"\n    Check if the queryset have the following primary keys.\n\n    Usage:\n\n    ```py\n    from breathecode.admissions.models import Cohort, Academy\n\n    self.bc.database.create(cohort=1)\n\n    collection = []\n    queryset = Cohort.objects.filter()\n\n    # pass because the QuerySet has the primary keys 1\n    self.bc.check.queryset_with_pks(queryset, [1])  # \ud83d\udfe2\n\n    # fail because the QuerySet has the primary keys 1 but the second argument is empty\n    self.bc.check.queryset_with_pks(queryset, [])  # \ud83d\udd34\n    ```\n    \"\"\"\n\n    if not isinstance(query, QuerySet):\n        self._parent.fail(\"The first argument is not a QuerySet\")\n\n    assert [x.pk for x in query] == pks\n</code></pre>"},{"location":"testing/mixins/bc-database/","title":"bc.database","text":""},{"location":"testing/mixins/bc-database/#breathecode.tests.mixins.breathecode_mixin.database.Database","title":"<code>Database</code>","text":"<p>Mixin with the purpose of cover all the related with the database</p> Source code in <code>breathecode/tests/mixins/breathecode_mixin/database.py</code> <pre><code>class Database:\n    \"\"\"Mixin with the purpose of cover all the related with the database\"\"\"\n\n    _cache: dict[str, Model] = {}\n    _parent: APITestCase\n    _bc: interfaces.BreathecodeInterface\n    how_many = 0\n\n    def __init__(self, parent, bc: interfaces.BreathecodeInterface) -&gt; None:\n        self._parent = parent\n        self._bc = bc\n\n    def reset_queries(self):\n        reset_queries()\n\n    # @override_settings(DEBUG=True)\n    def get_queries(self, db=\"default\"):\n        return [query[\"sql\"] for query in connections[db].queries]\n\n    # @override_settings(DEBUG=True)\n    def print_queries(self, db=\"default\"):\n        print()\n        print(\"---------------- Queries ----------------\\n\")\n        for query in connections[db].queries:\n            print(f'{query[\"time\"]} {query[\"sql\"]}\\n')\n\n        print(\"----------------- Count -----------------\\n\")\n        print(f\"Queries: {len(connections[db].queries)}\\n\")\n        print(\"-----------------------------------------\\n\")\n\n    @classmethod\n    def get_model(cls, path: str) -&gt; Model:\n        \"\"\"\n        Return the model matching the given app_label and model_name.\n\n        As a shortcut, app_label may be in the form &lt;app_label&gt;.&lt;model_name&gt;.\n\n        model_name is case-insensitive.\n\n        Raise LookupError if no application exists with this label, or no\n        model exists with this name in the application. Raise ValueError if\n        called with a single argument that doesn't contain exactly one dot.\n\n        Usage:\n\n        ```py\n        # class breathecode.admissions.models.Cohort\n        Cohort = self.bc.database.get_model('admissions.Cohort')\n        ```\n\n        Keywords arguments:\n        - path(`str`): path to a model, for example `admissions.CohortUser`.\n        \"\"\"\n\n        if path in cls._cache:\n            return cls._cache[path]\n\n        app_label, model_name = path.split(\".\")\n        cls._cache[path] = apps.get_model(app_label, model_name)\n\n        return cls._cache[path]\n\n    def list_of(self, path: str, dict: bool = True) -&gt; list[Model | dict[str, Any]]:\n        \"\"\"\n        This is a wrapper for `Model.objects.filter()`, get a list of values of models as `list[dict]` if\n        `dict=True` else get a list of `Model` instances.\n\n        Usage:\n\n        ```py\n        # get all the Cohort as list of dict\n        self.bc.database.get('admissions.Cohort')\n\n        # get all the Cohort as list of instances of model\n        self.bc.database.get('admissions.Cohort', dict=False)\n        ```\n\n        Keywords arguments:\n        - path(`str`): path to a model, for example `admissions.CohortUser`.\n        - dict(`bool`): if true return dict of values of model else return model instance.\n        \"\"\"\n\n        model = Database.get_model(path)\n        result = model.objects.filter()\n\n        if dict:\n            result = [ModelsMixin.remove_dinamics_fields(self, data.__dict__.copy()) for data in result]\n\n        return result\n\n    @database_sync_to_async\n    def async_list_of(self, path: str, dict: bool = True) -&gt; list[Model | dict[str, Any]]:\n        \"\"\"\n        This is a wrapper for `Model.objects.filter()`, get a list of values of models as `list[dict]` if\n        `dict=True` else get a list of `Model` instances.\n\n        Keywords arguments:\n        - path(`str`): path to a model, for example `admissions.CohortUser`.\n        - dict(`bool`): if true return dict of values of model else return model instance.\n        \"\"\"\n\n        return self.list_of(path, dict)\n\n    @sync_to_async\n    def alist_of(self, path: str, dict: bool = True) -&gt; list[Model | dict[str, Any]]:\n        \"\"\"\n        This is a wrapper for `Model.objects.filter()`, get a list of values of models as `list[dict]` if\n        `dict=True` else get a list of `Model` instances.\n\n        Keywords arguments:\n        - path(`str`): path to a model, for example `admissions.CohortUser`.\n        - dict(`bool`): if true return dict of values of model else return model instance.\n        \"\"\"\n\n        return self.list_of(path, dict)\n\n    def delete(self, path: str, pk: Optional[int | str] = None) -&gt; tuple[int, dict[str, int]]:\n        \"\"\"\n        This is a wrapper for `Model.objects.filter(pk=pk).delete()`, delete a element if `pk` is provided else\n        all the entries.\n\n        Usage:\n\n        ```py\n        # create 19110911 cohorts \ud83e\uddbe\n        self.bc.database.create(cohort=19110911)\n\n        # exists 19110911 cohorts \ud83e\uddbe\n        self.assertEqual(self.bc.database.count('admissions.Cohort'), 19110911)\n\n        # remove all the cohorts\n        self.bc.database.delete(10)\n\n        # exists 19110910 cohorts\n        self.assertEqual(self.bc.database.count('admissions.Cohort'), 19110910)\n        ```\n\n        # remove all the cohorts\n        self.bc.database.delete()\n\n        # exists 0 cohorts\n        self.assertEqual(self.bc.database.count('admissions.Cohort'), 0)\n        ```\n\n        Keywords arguments:\n        - path(`str`): path to a model, for example `admissions.CohortUser`.\n        - pk(`str | int`): primary key of model.\n        \"\"\"\n\n        lookups = {\"pk\": pk} if pk else {}\n\n        model = Database.get_model(path)\n        return model.objects.filter(**lookups).delete()\n\n    def get(self, path: str, pk: int | str, dict: bool = True) -&gt; Model | dict[str, Any]:\n        \"\"\"\n        This is a wrapper for `Model.objects.filter(pk=pk).first()`, get the values of model as `dict` if\n        `dict=True` else get the `Model` instance.\n\n        Usage:\n\n        ```py\n        # get the Cohort with the pk 1 as dict\n        self.bc.database.get('admissions.Cohort', 1)\n\n        # get the Cohort with the pk 1 as instance of model\n        self.bc.database.get('admissions.Cohort', 1, dict=False)\n        ```\n\n        Keywords arguments:\n        - path(`str`): path to a model, for example `admissions.CohortUser`.\n        - pk(`str | int`): primary key of model.\n        - dict(`bool`): if true return dict of values of model else return model instance.\n        \"\"\"\n        model = Database.get_model(path)\n        result = model.objects.filter(pk=pk).first()\n\n        if dict:\n            result = ModelsMixin.remove_dinamics_fields(self, result.__dict__.copy())\n\n        return result\n\n    @database_sync_to_async\n    def async_get(self, path: str, pk: int | str, dict: bool = True) -&gt; Model | dict[str, Any]:\n        \"\"\"\n        This is a wrapper for `Model.objects.filter(pk=pk).first()`, get the values of model as `dict` if\n        `dict=True` else get the `Model` instance.\n\n        Keywords arguments:\n        - path(`str`): path to a model, for example `admissions.CohortUser`.\n        - pk(`str | int`): primary key of model.\n        - dict(`bool`): if true return dict of values of model else return model instance.\n        \"\"\"\n\n        return self.get(path, pk, dict)\n\n    def count(self, path: str) -&gt; int:\n        \"\"\"\n        This is a wrapper for `Model.objects.count()`, get how many instances of this `Model` are saved.\n\n        Usage:\n\n        ```py\n        self.bc.database.count('admissions.Cohort')\n        ```\n\n        Keywords arguments:\n        - path(`str`): path to a model, for example `admissions.CohortUser`.\n        \"\"\"\n        model = Database.get_model(path)\n        return model.objects.count()\n\n    @database_sync_to_async\n    def async_count(self, path: str) -&gt; int:\n        \"\"\"\n        This is a wrapper for `Model.objects.count()`, get how many instances of this `Model` are saved.\n\n        Keywords arguments:\n        - path(`str`): path to a model, for example `admissions.CohortUser`.\n        \"\"\"\n\n        return self.count(path)\n\n    @cache\n    def _get_models(self) -&gt; list[Model]:\n        values = {}\n        for key in apps.app_configs:\n            values[key] = apps.get_app_config(key).get_models()\n        return values\n\n    def camel_case_to_snake_case(self, name):\n        name = re.sub(\"(.)([A-Z][a-z]+)\", r\"\\1_\\2\", name)\n        return re.sub(\"([a-z0-9])([A-Z])\", r\"\\1_\\2\", name).lower()\n\n    def _get_model_field_info(self, model, key):\n        attr = getattr(model, key)\n        meta = vars(attr)[\"field\"].related_model._meta\n        model = vars(attr)[\"field\"].related_model\n        blank = attr.field.blank\n        null = attr.field.null\n\n        result = {\n            \"field\": key,\n            \"blank\": blank,\n            \"null\": null,\n            \"app_name\": meta.app_label,\n            \"model_name\": meta.object_name,\n            \"handler\": attr,\n            \"model\": model,\n        }\n\n        if hasattr(attr, \"through\"):\n            result[\"custom_through\"] = \"_\" not in attr.through.__name__\n            result[\"through_fields\"] = attr.rel.through_fields\n\n        return result\n\n    @cache\n    def _get_models_descriptors(self) -&gt; list[Model]:\n        values = {}\n        apps = self._get_models()\n\n        for app_key in apps:\n            values[app_key] = {}\n            models = apps[app_key]\n            for model in models:\n                values[app_key][model.__name__] = {}\n                values[app_key][model.__name__][\"meta\"] = {\n                    \"app_name\": model._meta.app_label,\n                    \"model_name\": model._meta.object_name,\n                    \"model\": model,\n                }\n\n                values[app_key][model.__name__][\"to_one\"] = [\n                    self._get_model_field_info(model, x)\n                    for x in dir(model)\n                    if isinstance(getattr(model, x), ForwardManyToOneDescriptor)\n                ]\n\n                values[app_key][model.__name__][\"to_many\"] = [\n                    self._get_model_field_info(model, x)\n                    for x in dir(model)\n                    if isinstance(getattr(model, x), ManyToManyDescriptor)\n                ]\n\n        return values\n\n    @cache\n    def _get_models_dependencies(self) -&gt; list[Model]:\n        values = {}\n        descriptors = self._get_models_descriptors()\n        for app_key in descriptors:\n            for descriptor_key in descriptors[app_key]:\n                descriptor = descriptors[app_key][descriptor_key]\n\n                if app_key not in values:\n                    values[app_key] = set()\n\n                primary_values = values[app_key][\"primary\"] if \"primary\" in values[app_key] else []\n                secondary_values = values[app_key][\"secondary\"] if \"secondary\" in values[app_key] else []\n\n                values[app_key] = {\n                    \"primary\": {\n                        *primary_values,\n                        *[\n                            x[\"app_name\"]\n                            for x in descriptor[\"to_one\"]\n                            if x[\"app_name\"] != app_key and x[\"null\"] == False\n                        ],\n                        *[\n                            x[\"app_name\"]\n                            for x in descriptor[\"to_many\"]\n                            if x[\"app_name\"] != app_key and x[\"null\"] == False\n                        ],\n                    },\n                    \"secondary\": {\n                        *secondary_values,\n                        *[\n                            x[\"app_name\"]\n                            for x in descriptor[\"to_one\"]\n                            if x[\"app_name\"] != app_key and x[\"null\"] == True\n                        ],\n                        *[\n                            x[\"app_name\"]\n                            for x in descriptor[\"to_many\"]\n                            if x[\"app_name\"] != app_key and x[\"null\"] == True\n                        ],\n                    },\n                }\n\n        return values\n\n    def _sort_models_handlers(\n        self,\n        dependencies_resolved=None,\n        primary_values=None,\n        secondary_values=None,\n        primary_dependencies=None,\n        secondary_dependencies=None,\n        consume_primary=True,\n    ) -&gt; list[Model]:\n\n        dependencies_resolved = dependencies_resolved or set()\n        primary_values = primary_values or []\n        secondary_values = secondary_values or []\n\n        if not primary_dependencies and not secondary_dependencies:\n            dependencies = self._get_models_dependencies()\n\n            primary_dependencies = {}\n            for x in dependencies:\n                primary_dependencies[x] = dependencies[x][\"primary\"]\n\n            secondary_dependencies = {}\n            for x in dependencies:\n                secondary_dependencies[x] = dependencies[x][\"secondary\"]\n\n        for dependency in dependencies_resolved:\n            for key in primary_dependencies:\n\n                if dependency in primary_dependencies[key]:\n                    primary_dependencies[key].remove(dependency)\n\n        primary_found = [\n            x\n            for x in [y for y in primary_dependencies if y not in dependencies_resolved]\n            if len(primary_dependencies[x]) == 0\n        ]\n\n        for x in primary_found:\n            dependencies_resolved.add(x)\n\n        secondary_found = [\n            x\n            for x in [y for y in secondary_dependencies if y not in dependencies_resolved]\n            if len(secondary_dependencies[x]) == 0\n        ]\n\n        if consume_primary and primary_found:\n            primary_values.append(primary_found)\n\n        elif not consume_primary and secondary_found:\n            secondary_values.append(secondary_found)\n\n        for x in primary_found:\n            del primary_dependencies[x]\n\n            for dependency in primary_dependencies:\n                if x in primary_dependencies[dependency]:\n                    primary_dependencies[dependency].remove(x)\n\n        if primary_dependencies:\n            return self._sort_models_handlers(\n                dependencies_resolved,\n                primary_values,\n                secondary_values,\n                primary_dependencies,\n                secondary_dependencies,\n                consume_primary=True,\n            )\n\n        if secondary_dependencies:\n            return primary_values, [x for x in secondary_dependencies if len(secondary_dependencies[x])]\n\n        return primary_values, secondary_values\n\n    @cache\n    def _get_models_handlers(self) -&gt; list[Model]:\n        arguments = {}\n        arguments_banned = set()\n        order, deferred = self._sort_models_handlers()\n        descriptors = self._get_models_descriptors()\n\n        def manage_model(models, descriptor, *args, **kwargs):\n            model_field_name = self.camel_case_to_snake_case(descriptor[\"meta\"][\"model_name\"])\n            app_name = descriptor[\"meta\"][\"app_name\"]\n            model_name = descriptor[\"meta\"][\"model_name\"]\n\n            if model_field_name in kwargs and f\"{app_name}__{model_field_name}\" in kwargs:\n                raise Exception(\n                    f\"Exists many apps with the same model name `{model_name}`, please use \"\n                    f\"`{app_name}__{model_field_name}` instead of `{model_field_name}`\"\n                )\n\n            arg = False\n            if f\"{app_name}__{model_field_name}\" in kwargs:\n                arg = kwargs[f\"{app_name}__{model_field_name}\"]\n\n            elif model_field_name in kwargs:\n                arg = kwargs[model_field_name]\n\n            if not model_field_name in models and is_valid(arg):\n                kargs = {}\n\n                for x in descriptor[\"to_one\"]:\n                    related_model_field_name = self.camel_case_to_snake_case(x[\"model_name\"])\n                    if related_model_field_name in models:\n                        kargs[x[\"field\"]] = just_one(models[related_model_field_name])\n\n                without_through = [x for x in descriptor[\"to_many\"] if x[\"custom_through\"] == False]\n                for x in without_through:\n                    related_model_field_name = self.camel_case_to_snake_case(x[\"model_name\"])\n\n                    if related_model_field_name in models:\n                        kargs[x[\"field\"]] = get_list(models[related_model_field_name])\n\n                models[model_field_name] = create_models(arg, f\"{app_name}.{model_name}\", **kargs)\n\n                with_through = [\n                    x for x in descriptor[\"to_many\"] if x[\"custom_through\"] == True and not x[\"field\"].endswith(\"_set\")\n                ]\n                for x in with_through:\n                    related_model_field_name = self.camel_case_to_snake_case(x[\"model_name\"])\n                    if related_model_field_name in models:\n\n                        for item in get_list(models[related_model_field_name]):\n                            through_current = x[\"through_fields\"][0]\n                            through_related = x[\"through_fields\"][1]\n                            through_args = {through_current: models[model_field_name], through_related: item}\n\n                            x[\"handler\"].through.objects.create(**through_args)\n\n            return models\n\n        def link_deferred_model(models, descriptor, *args, **kwargs):\n            model_field_name = self.camel_case_to_snake_case(descriptor[\"meta\"][\"model_name\"])\n            app_name = descriptor[\"meta\"][\"app_name\"]\n            model_name = descriptor[\"meta\"][\"model_name\"]\n\n            if model_field_name in kwargs and f\"{app_name}__{model_field_name}\" in kwargs:\n                raise Exception(\n                    f\"Exists many apps with the same model name `{model_name}`, please use \"\n                    f\"`{app_name}__{model_field_name}` instead of `{model_field_name}`\"\n                )\n\n            if model_field_name in models:\n                items = (\n                    models[model_field_name]\n                    if isinstance(models[model_field_name], list)\n                    else [models[model_field_name]]\n                )\n                for m in items:\n\n                    for x in descriptor[\"to_one\"]:\n                        related_model_field_name = self.camel_case_to_snake_case(x[\"model_name\"])\n                        model_exists = related_model_field_name in models\n                        is_list = isinstance(models[model_field_name], list) if model_exists else False\n                        if model_exists and not is_list and not getattr(models[model_field_name], x[\"field\"]):\n                            setattr(m, x[\"field\"], just_one(models[related_model_field_name]))\n\n                        if model_exists and is_list:\n                            for y in models[model_field_name]:\n                                if getattr(y, x[\"field\"]):\n                                    setattr(m, x[\"field\"], just_one(models[related_model_field_name]))\n\n                    for x in descriptor[\"to_many\"]:\n                        related_model_field_name = self.camel_case_to_snake_case(x[\"model_name\"])\n                        if related_model_field_name in models and not getattr(models[model_field_name], x[\"field\"]):\n                            setattr(m, x[\"field\"], get_list(models[related_model_field_name]))\n\n                    setattr(m, \"__mixer__\", None)\n                    m.save()\n\n            return models\n\n        def wrapper(*args, **kwargs):\n            models = {}\n            for generation_round in order:\n                for app_key in generation_round:\n                    for descriptor_key in descriptors[app_key]:\n                        descriptor = descriptors[app_key][descriptor_key]\n                        attr = self.camel_case_to_snake_case(descriptor[\"meta\"][\"model_name\"])\n\n                        models = manage_model(models, descriptor, *args, **kwargs)\n\n                        if app_key not in arguments:\n                            arguments[app_key] = {}\n                            arguments[attr] = ...\n\n                        else:\n                            arguments_banned.add(attr)\n\n                        arguments[f\"{app_key}__{attr}\"] = ...\n\n            for generation_round in order:\n                for app_key in generation_round:\n                    for descriptor_key in descriptors[app_key]:\n                        descriptor = descriptors[app_key][descriptor_key]\n                        attr = self.camel_case_to_snake_case(descriptor[\"meta\"][\"model_name\"])\n\n                        models = link_deferred_model(models, descriptor, *args, **kwargs)\n\n                        if app_key not in arguments:\n                            arguments[app_key] = {}\n                            arguments[attr] = ...\n\n                        else:\n                            arguments_banned.add(attr)\n\n                        arguments[f\"{app_key}__{attr}\"] = ...\n\n            return AttrDict(**models)\n\n        return wrapper\n\n    def create_v2(self, *args, **kwargs) -&gt; dict[str, Model | list[Model]]:\n        \"\"\"\n        Unstable version of mixin that create all models, do not use this.\n        \"\"\"\n        models = self._get_models_handlers()(*args, **kwargs)\n        return models\n\n    def create_v3(self, **models) -&gt; dict[str, Model | list[Model]]:\n        \"\"\"\n        Unstable version of mixin that create all models, do not use this.\n        \"\"\"\n        return DatabaseV3.create(**models)\n\n    def create(self, *args, **kwargs) -&gt; dict[str, Model | list[Model]]:\n        \"\"\"\n        Create one o many instances of models and return it like a dict of models.\n\n        Usage:\n\n        ```py\n        # create three users\n        self.bc.database.create(user=3)\n\n        # create one user with a specific first name\n        user = {'first_name': 'Lacey'}\n        self.bc.database.create(user=user)\n\n        # create two users with a specific first name and last name\n        users = [\n            {'first_name': 'Lacey', 'last_name': 'Sturm'},\n            {'first_name': 'The', 'last_name': 'Warning'},\n        ]\n        self.bc.database.create(user=users)\n\n        # create two users with the same first name\n        user = {'first_name': 'Lacey'}\n        self.bc.database.create(user=(2, user))\n\n        # setting up manually the relationships\n        cohort_user = {'cohort_id': 2}\n        self.bc.database.create(cohort=2, cohort_user=cohort_user)\n        ```\n\n        It get the model name as snake case, you can pass a `bool`, `int`, `dict`, `tuple`, `list[dict]` or\n        `list[tuple]`.\n\n        Behavior for type of argument:\n\n        - `bool`: if it is true generate a instance of a model.\n        - `int`: generate a instance of a model n times, if `n` &gt; 1 this is a list.\n        - `dict`: generate a instance of a model, this pass to mixer.blend custom values to the model.\n        - `tuple`: one element need to be a int and the other be a dict, generate a instance of a model n times,\n        if `n` &gt; 1 this is a list, this pass to mixer.blend custom values to the model.\n        - `list[dict]`: generate a instance of a model n times, if `n` &gt; 1 this is a list,\n        this pass to mixer.blend custom values to the model.\n        - `list[tuple]`: generate a instance of a model n times, if `n` &gt; 1 this is a list for each element,\n        this pass to mixer.blend custom values to the model.\n\n        Keywords arguments deprecated:\n        - models: this arguments is use to implement inheritance, receive as argument the output of other\n        `self.bc.database.create()` execution.\n        - authenticate: create a user and use `APITestCase.client.force_authenticate(user=models['user'])` to\n        get credentials.\n        \"\"\"\n\n        # TODO: remove it in a future\n        if self._parent:\n            return GenerateModelsMixin.generate_models(self._parent, _new_implementation=True, *args, **kwargs)\n\n        return GenerateModelsMixin().generate_models(_new_implementation=True, *args, **kwargs)\n\n    @database_sync_to_async\n    def async_create(self, *args, **kwargs) -&gt; dict[str, Model | list[Model]]:\n        \"\"\"\n        This is a wrapper for `Model.objects.count()`, get how many instances of this `Model` are saved.\n\n        Keywords arguments:\n        - path(`str`): path to a model, for example `admissions.CohortUser`.\n        \"\"\"\n\n        return self.create(*args, **kwargs)\n\n    @sync_to_async\n    def acreate(self, *args, **kwargs) -&gt; dict[str, Model | list[Model]]:\n        \"\"\"\n        This is a wrapper for `Model.objects.count()`, get how many instances of this `Model` are saved.\n\n        Keywords arguments:\n        - path(`str`): path to a model, for example `admissions.CohortUser`.\n        \"\"\"\n\n        return self.create(*args, **kwargs)\n</code></pre>"},{"location":"testing/mixins/bc-database/#breathecode.tests.mixins.breathecode_mixin.database.Database.acreate","title":"<code>acreate(*args, **kwargs)</code>","text":"<p>This is a wrapper for <code>Model.objects.count()</code>, get how many instances of this <code>Model</code> are saved.</p> <p>Keywords arguments: - path(<code>str</code>): path to a model, for example <code>admissions.CohortUser</code>.</p> Source code in <code>breathecode/tests/mixins/breathecode_mixin/database.py</code> <pre><code>@sync_to_async\ndef acreate(self, *args, **kwargs) -&gt; dict[str, Model | list[Model]]:\n    \"\"\"\n    This is a wrapper for `Model.objects.count()`, get how many instances of this `Model` are saved.\n\n    Keywords arguments:\n    - path(`str`): path to a model, for example `admissions.CohortUser`.\n    \"\"\"\n\n    return self.create(*args, **kwargs)\n</code></pre>"},{"location":"testing/mixins/bc-database/#breathecode.tests.mixins.breathecode_mixin.database.Database.alist_of","title":"<code>alist_of(path, dict=True)</code>","text":"<p>This is a wrapper for <code>Model.objects.filter()</code>, get a list of values of models as <code>list[dict]</code> if <code>dict=True</code> else get a list of <code>Model</code> instances.</p> <p>Keywords arguments: - path(<code>str</code>): path to a model, for example <code>admissions.CohortUser</code>. - dict(<code>bool</code>): if true return dict of values of model else return model instance.</p> Source code in <code>breathecode/tests/mixins/breathecode_mixin/database.py</code> <pre><code>@sync_to_async\ndef alist_of(self, path: str, dict: bool = True) -&gt; list[Model | dict[str, Any]]:\n    \"\"\"\n    This is a wrapper for `Model.objects.filter()`, get a list of values of models as `list[dict]` if\n    `dict=True` else get a list of `Model` instances.\n\n    Keywords arguments:\n    - path(`str`): path to a model, for example `admissions.CohortUser`.\n    - dict(`bool`): if true return dict of values of model else return model instance.\n    \"\"\"\n\n    return self.list_of(path, dict)\n</code></pre>"},{"location":"testing/mixins/bc-database/#breathecode.tests.mixins.breathecode_mixin.database.Database.async_count","title":"<code>async_count(path)</code>","text":"<p>This is a wrapper for <code>Model.objects.count()</code>, get how many instances of this <code>Model</code> are saved.</p> <p>Keywords arguments: - path(<code>str</code>): path to a model, for example <code>admissions.CohortUser</code>.</p> Source code in <code>breathecode/tests/mixins/breathecode_mixin/database.py</code> <pre><code>@database_sync_to_async\ndef async_count(self, path: str) -&gt; int:\n    \"\"\"\n    This is a wrapper for `Model.objects.count()`, get how many instances of this `Model` are saved.\n\n    Keywords arguments:\n    - path(`str`): path to a model, for example `admissions.CohortUser`.\n    \"\"\"\n\n    return self.count(path)\n</code></pre>"},{"location":"testing/mixins/bc-database/#breathecode.tests.mixins.breathecode_mixin.database.Database.async_create","title":"<code>async_create(*args, **kwargs)</code>","text":"<p>This is a wrapper for <code>Model.objects.count()</code>, get how many instances of this <code>Model</code> are saved.</p> <p>Keywords arguments: - path(<code>str</code>): path to a model, for example <code>admissions.CohortUser</code>.</p> Source code in <code>breathecode/tests/mixins/breathecode_mixin/database.py</code> <pre><code>@database_sync_to_async\ndef async_create(self, *args, **kwargs) -&gt; dict[str, Model | list[Model]]:\n    \"\"\"\n    This is a wrapper for `Model.objects.count()`, get how many instances of this `Model` are saved.\n\n    Keywords arguments:\n    - path(`str`): path to a model, for example `admissions.CohortUser`.\n    \"\"\"\n\n    return self.create(*args, **kwargs)\n</code></pre>"},{"location":"testing/mixins/bc-database/#breathecode.tests.mixins.breathecode_mixin.database.Database.async_get","title":"<code>async_get(path, pk, dict=True)</code>","text":"<p>This is a wrapper for <code>Model.objects.filter(pk=pk).first()</code>, get the values of model as <code>dict</code> if <code>dict=True</code> else get the <code>Model</code> instance.</p> <p>Keywords arguments: - path(<code>str</code>): path to a model, for example <code>admissions.CohortUser</code>. - pk(<code>str | int</code>): primary key of model. - dict(<code>bool</code>): if true return dict of values of model else return model instance.</p> Source code in <code>breathecode/tests/mixins/breathecode_mixin/database.py</code> <pre><code>@database_sync_to_async\ndef async_get(self, path: str, pk: int | str, dict: bool = True) -&gt; Model | dict[str, Any]:\n    \"\"\"\n    This is a wrapper for `Model.objects.filter(pk=pk).first()`, get the values of model as `dict` if\n    `dict=True` else get the `Model` instance.\n\n    Keywords arguments:\n    - path(`str`): path to a model, for example `admissions.CohortUser`.\n    - pk(`str | int`): primary key of model.\n    - dict(`bool`): if true return dict of values of model else return model instance.\n    \"\"\"\n\n    return self.get(path, pk, dict)\n</code></pre>"},{"location":"testing/mixins/bc-database/#breathecode.tests.mixins.breathecode_mixin.database.Database.async_list_of","title":"<code>async_list_of(path, dict=True)</code>","text":"<p>This is a wrapper for <code>Model.objects.filter()</code>, get a list of values of models as <code>list[dict]</code> if <code>dict=True</code> else get a list of <code>Model</code> instances.</p> <p>Keywords arguments: - path(<code>str</code>): path to a model, for example <code>admissions.CohortUser</code>. - dict(<code>bool</code>): if true return dict of values of model else return model instance.</p> Source code in <code>breathecode/tests/mixins/breathecode_mixin/database.py</code> <pre><code>@database_sync_to_async\ndef async_list_of(self, path: str, dict: bool = True) -&gt; list[Model | dict[str, Any]]:\n    \"\"\"\n    This is a wrapper for `Model.objects.filter()`, get a list of values of models as `list[dict]` if\n    `dict=True` else get a list of `Model` instances.\n\n    Keywords arguments:\n    - path(`str`): path to a model, for example `admissions.CohortUser`.\n    - dict(`bool`): if true return dict of values of model else return model instance.\n    \"\"\"\n\n    return self.list_of(path, dict)\n</code></pre>"},{"location":"testing/mixins/bc-database/#breathecode.tests.mixins.breathecode_mixin.database.Database.count","title":"<code>count(path)</code>","text":"<p>This is a wrapper for <code>Model.objects.count()</code>, get how many instances of this <code>Model</code> are saved.</p> <p>Usage:</p> <pre><code>self.bc.database.count('admissions.Cohort')\n</code></pre> <p>Keywords arguments: - path(<code>str</code>): path to a model, for example <code>admissions.CohortUser</code>.</p> Source code in <code>breathecode/tests/mixins/breathecode_mixin/database.py</code> <pre><code>def count(self, path: str) -&gt; int:\n    \"\"\"\n    This is a wrapper for `Model.objects.count()`, get how many instances of this `Model` are saved.\n\n    Usage:\n\n    ```py\n    self.bc.database.count('admissions.Cohort')\n    ```\n\n    Keywords arguments:\n    - path(`str`): path to a model, for example `admissions.CohortUser`.\n    \"\"\"\n    model = Database.get_model(path)\n    return model.objects.count()\n</code></pre>"},{"location":"testing/mixins/bc-database/#breathecode.tests.mixins.breathecode_mixin.database.Database.create","title":"<code>create(*args, **kwargs)</code>","text":"<p>Create one o many instances of models and return it like a dict of models.</p> <p>Usage:</p> <pre><code># create three users\nself.bc.database.create(user=3)\n\n# create one user with a specific first name\nuser = {'first_name': 'Lacey'}\nself.bc.database.create(user=user)\n\n# create two users with a specific first name and last name\nusers = [\n    {'first_name': 'Lacey', 'last_name': 'Sturm'},\n    {'first_name': 'The', 'last_name': 'Warning'},\n]\nself.bc.database.create(user=users)\n\n# create two users with the same first name\nuser = {'first_name': 'Lacey'}\nself.bc.database.create(user=(2, user))\n\n# setting up manually the relationships\ncohort_user = {'cohort_id': 2}\nself.bc.database.create(cohort=2, cohort_user=cohort_user)\n</code></pre> <p>It get the model name as snake case, you can pass a <code>bool</code>, <code>int</code>, <code>dict</code>, <code>tuple</code>, <code>list[dict]</code> or <code>list[tuple]</code>.</p> <p>Behavior for type of argument:</p> <ul> <li><code>bool</code>: if it is true generate a instance of a model.</li> <li><code>int</code>: generate a instance of a model n times, if <code>n</code> &gt; 1 this is a list.</li> <li><code>dict</code>: generate a instance of a model, this pass to mixer.blend custom values to the model.</li> <li><code>tuple</code>: one element need to be a int and the other be a dict, generate a instance of a model n times, if <code>n</code> &gt; 1 this is a list, this pass to mixer.blend custom values to the model.</li> <li><code>list[dict]</code>: generate a instance of a model n times, if <code>n</code> &gt; 1 this is a list, this pass to mixer.blend custom values to the model.</li> <li><code>list[tuple]</code>: generate a instance of a model n times, if <code>n</code> &gt; 1 this is a list for each element, this pass to mixer.blend custom values to the model.</li> </ul> <p>Keywords arguments deprecated: - models: this arguments is use to implement inheritance, receive as argument the output of other <code>self.bc.database.create()</code> execution. - authenticate: create a user and use <code>APITestCase.client.force_authenticate(user=models['user'])</code> to get credentials.</p> Source code in <code>breathecode/tests/mixins/breathecode_mixin/database.py</code> <pre><code>def create(self, *args, **kwargs) -&gt; dict[str, Model | list[Model]]:\n    \"\"\"\n    Create one o many instances of models and return it like a dict of models.\n\n    Usage:\n\n    ```py\n    # create three users\n    self.bc.database.create(user=3)\n\n    # create one user with a specific first name\n    user = {'first_name': 'Lacey'}\n    self.bc.database.create(user=user)\n\n    # create two users with a specific first name and last name\n    users = [\n        {'first_name': 'Lacey', 'last_name': 'Sturm'},\n        {'first_name': 'The', 'last_name': 'Warning'},\n    ]\n    self.bc.database.create(user=users)\n\n    # create two users with the same first name\n    user = {'first_name': 'Lacey'}\n    self.bc.database.create(user=(2, user))\n\n    # setting up manually the relationships\n    cohort_user = {'cohort_id': 2}\n    self.bc.database.create(cohort=2, cohort_user=cohort_user)\n    ```\n\n    It get the model name as snake case, you can pass a `bool`, `int`, `dict`, `tuple`, `list[dict]` or\n    `list[tuple]`.\n\n    Behavior for type of argument:\n\n    - `bool`: if it is true generate a instance of a model.\n    - `int`: generate a instance of a model n times, if `n` &gt; 1 this is a list.\n    - `dict`: generate a instance of a model, this pass to mixer.blend custom values to the model.\n    - `tuple`: one element need to be a int and the other be a dict, generate a instance of a model n times,\n    if `n` &gt; 1 this is a list, this pass to mixer.blend custom values to the model.\n    - `list[dict]`: generate a instance of a model n times, if `n` &gt; 1 this is a list,\n    this pass to mixer.blend custom values to the model.\n    - `list[tuple]`: generate a instance of a model n times, if `n` &gt; 1 this is a list for each element,\n    this pass to mixer.blend custom values to the model.\n\n    Keywords arguments deprecated:\n    - models: this arguments is use to implement inheritance, receive as argument the output of other\n    `self.bc.database.create()` execution.\n    - authenticate: create a user and use `APITestCase.client.force_authenticate(user=models['user'])` to\n    get credentials.\n    \"\"\"\n\n    # TODO: remove it in a future\n    if self._parent:\n        return GenerateModelsMixin.generate_models(self._parent, _new_implementation=True, *args, **kwargs)\n\n    return GenerateModelsMixin().generate_models(_new_implementation=True, *args, **kwargs)\n</code></pre>"},{"location":"testing/mixins/bc-database/#breathecode.tests.mixins.breathecode_mixin.database.Database.create_v2","title":"<code>create_v2(*args, **kwargs)</code>","text":"<p>Unstable version of mixin that create all models, do not use this.</p> Source code in <code>breathecode/tests/mixins/breathecode_mixin/database.py</code> <pre><code>def create_v2(self, *args, **kwargs) -&gt; dict[str, Model | list[Model]]:\n    \"\"\"\n    Unstable version of mixin that create all models, do not use this.\n    \"\"\"\n    models = self._get_models_handlers()(*args, **kwargs)\n    return models\n</code></pre>"},{"location":"testing/mixins/bc-database/#breathecode.tests.mixins.breathecode_mixin.database.Database.create_v3","title":"<code>create_v3(**models)</code>","text":"<p>Unstable version of mixin that create all models, do not use this.</p> Source code in <code>breathecode/tests/mixins/breathecode_mixin/database.py</code> <pre><code>def create_v3(self, **models) -&gt; dict[str, Model | list[Model]]:\n    \"\"\"\n    Unstable version of mixin that create all models, do not use this.\n    \"\"\"\n    return DatabaseV3.create(**models)\n</code></pre>"},{"location":"testing/mixins/bc-database/#breathecode.tests.mixins.breathecode_mixin.database.Database.delete","title":"<code>delete(path, pk=None)</code>","text":"<p>This is a wrapper for <code>Model.objects.filter(pk=pk).delete()</code>, delete a element if <code>pk</code> is provided else all the entries.</p> <p>Usage:</p> <pre><code># create 19110911 cohorts \ud83e\uddbe\nself.bc.database.create(cohort=19110911)\n\n# exists 19110911 cohorts \ud83e\uddbe\nself.assertEqual(self.bc.database.count('admissions.Cohort'), 19110911)\n\n# remove all the cohorts\nself.bc.database.delete(10)\n\n# exists 19110910 cohorts\nself.assertEqual(self.bc.database.count('admissions.Cohort'), 19110910)\n</code></pre>"},{"location":"testing/mixins/bc-database/#breathecode.tests.mixins.breathecode_mixin.database.Database.delete--remove-all-the-cohorts","title":"remove all the cohorts","text":"<p>self.bc.database.delete()</p>"},{"location":"testing/mixins/bc-database/#breathecode.tests.mixins.breathecode_mixin.database.Database.delete--exists-0-cohorts","title":"exists 0 cohorts","text":"<p>self.assertEqual(self.bc.database.count('admissions.Cohort'), 0) ```</p> <p>Keywords arguments: - path(<code>str</code>): path to a model, for example <code>admissions.CohortUser</code>. - pk(<code>str | int</code>): primary key of model.</p> Source code in <code>breathecode/tests/mixins/breathecode_mixin/database.py</code> <pre><code>def delete(self, path: str, pk: Optional[int | str] = None) -&gt; tuple[int, dict[str, int]]:\n    \"\"\"\n    This is a wrapper for `Model.objects.filter(pk=pk).delete()`, delete a element if `pk` is provided else\n    all the entries.\n\n    Usage:\n\n    ```py\n    # create 19110911 cohorts \ud83e\uddbe\n    self.bc.database.create(cohort=19110911)\n\n    # exists 19110911 cohorts \ud83e\uddbe\n    self.assertEqual(self.bc.database.count('admissions.Cohort'), 19110911)\n\n    # remove all the cohorts\n    self.bc.database.delete(10)\n\n    # exists 19110910 cohorts\n    self.assertEqual(self.bc.database.count('admissions.Cohort'), 19110910)\n    ```\n\n    # remove all the cohorts\n    self.bc.database.delete()\n\n    # exists 0 cohorts\n    self.assertEqual(self.bc.database.count('admissions.Cohort'), 0)\n    ```\n\n    Keywords arguments:\n    - path(`str`): path to a model, for example `admissions.CohortUser`.\n    - pk(`str | int`): primary key of model.\n    \"\"\"\n\n    lookups = {\"pk\": pk} if pk else {}\n\n    model = Database.get_model(path)\n    return model.objects.filter(**lookups).delete()\n</code></pre>"},{"location":"testing/mixins/bc-database/#breathecode.tests.mixins.breathecode_mixin.database.Database.get","title":"<code>get(path, pk, dict=True)</code>","text":"<p>This is a wrapper for <code>Model.objects.filter(pk=pk).first()</code>, get the values of model as <code>dict</code> if <code>dict=True</code> else get the <code>Model</code> instance.</p> <p>Usage:</p> <pre><code># get the Cohort with the pk 1 as dict\nself.bc.database.get('admissions.Cohort', 1)\n\n# get the Cohort with the pk 1 as instance of model\nself.bc.database.get('admissions.Cohort', 1, dict=False)\n</code></pre> <p>Keywords arguments: - path(<code>str</code>): path to a model, for example <code>admissions.CohortUser</code>. - pk(<code>str | int</code>): primary key of model. - dict(<code>bool</code>): if true return dict of values of model else return model instance.</p> Source code in <code>breathecode/tests/mixins/breathecode_mixin/database.py</code> <pre><code>def get(self, path: str, pk: int | str, dict: bool = True) -&gt; Model | dict[str, Any]:\n    \"\"\"\n    This is a wrapper for `Model.objects.filter(pk=pk).first()`, get the values of model as `dict` if\n    `dict=True` else get the `Model` instance.\n\n    Usage:\n\n    ```py\n    # get the Cohort with the pk 1 as dict\n    self.bc.database.get('admissions.Cohort', 1)\n\n    # get the Cohort with the pk 1 as instance of model\n    self.bc.database.get('admissions.Cohort', 1, dict=False)\n    ```\n\n    Keywords arguments:\n    - path(`str`): path to a model, for example `admissions.CohortUser`.\n    - pk(`str | int`): primary key of model.\n    - dict(`bool`): if true return dict of values of model else return model instance.\n    \"\"\"\n    model = Database.get_model(path)\n    result = model.objects.filter(pk=pk).first()\n\n    if dict:\n        result = ModelsMixin.remove_dinamics_fields(self, result.__dict__.copy())\n\n    return result\n</code></pre>"},{"location":"testing/mixins/bc-database/#breathecode.tests.mixins.breathecode_mixin.database.Database.get_model","title":"<code>get_model(path)</code>  <code>classmethod</code>","text":"<p>Return the model matching the given app_label and model_name.</p> <p>As a shortcut, app_label may be in the form .. <p>model_name is case-insensitive.</p> <p>Raise LookupError if no application exists with this label, or no model exists with this name in the application. Raise ValueError if called with a single argument that doesn't contain exactly one dot.</p> <p>Usage:</p> <pre><code># class breathecode.admissions.models.Cohort\nCohort = self.bc.database.get_model('admissions.Cohort')\n</code></pre> <p>Keywords arguments: - path(<code>str</code>): path to a model, for example <code>admissions.CohortUser</code>.</p> Source code in <code>breathecode/tests/mixins/breathecode_mixin/database.py</code> <pre><code>@classmethod\ndef get_model(cls, path: str) -&gt; Model:\n    \"\"\"\n    Return the model matching the given app_label and model_name.\n\n    As a shortcut, app_label may be in the form &lt;app_label&gt;.&lt;model_name&gt;.\n\n    model_name is case-insensitive.\n\n    Raise LookupError if no application exists with this label, or no\n    model exists with this name in the application. Raise ValueError if\n    called with a single argument that doesn't contain exactly one dot.\n\n    Usage:\n\n    ```py\n    # class breathecode.admissions.models.Cohort\n    Cohort = self.bc.database.get_model('admissions.Cohort')\n    ```\n\n    Keywords arguments:\n    - path(`str`): path to a model, for example `admissions.CohortUser`.\n    \"\"\"\n\n    if path in cls._cache:\n        return cls._cache[path]\n\n    app_label, model_name = path.split(\".\")\n    cls._cache[path] = apps.get_model(app_label, model_name)\n\n    return cls._cache[path]\n</code></pre>"},{"location":"testing/mixins/bc-database/#breathecode.tests.mixins.breathecode_mixin.database.Database.list_of","title":"<code>list_of(path, dict=True)</code>","text":"<p>This is a wrapper for <code>Model.objects.filter()</code>, get a list of values of models as <code>list[dict]</code> if <code>dict=True</code> else get a list of <code>Model</code> instances.</p> <p>Usage:</p> <pre><code># get all the Cohort as list of dict\nself.bc.database.get('admissions.Cohort')\n\n# get all the Cohort as list of instances of model\nself.bc.database.get('admissions.Cohort', dict=False)\n</code></pre> <p>Keywords arguments: - path(<code>str</code>): path to a model, for example <code>admissions.CohortUser</code>. - dict(<code>bool</code>): if true return dict of values of model else return model instance.</p> Source code in <code>breathecode/tests/mixins/breathecode_mixin/database.py</code> <pre><code>def list_of(self, path: str, dict: bool = True) -&gt; list[Model | dict[str, Any]]:\n    \"\"\"\n    This is a wrapper for `Model.objects.filter()`, get a list of values of models as `list[dict]` if\n    `dict=True` else get a list of `Model` instances.\n\n    Usage:\n\n    ```py\n    # get all the Cohort as list of dict\n    self.bc.database.get('admissions.Cohort')\n\n    # get all the Cohort as list of instances of model\n    self.bc.database.get('admissions.Cohort', dict=False)\n    ```\n\n    Keywords arguments:\n    - path(`str`): path to a model, for example `admissions.CohortUser`.\n    - dict(`bool`): if true return dict of values of model else return model instance.\n    \"\"\"\n\n    model = Database.get_model(path)\n    result = model.objects.filter()\n\n    if dict:\n        result = [ModelsMixin.remove_dinamics_fields(self, data.__dict__.copy()) for data in result]\n\n    return result\n</code></pre>"},{"location":"testing/mixins/bc-datetime/","title":"bc.datetime","text":""},{"location":"testing/mixins/bc-datetime/#breathecode.tests.mixins.breathecode_mixin.datetime.Datetime","title":"<code>Datetime</code>","text":"<p>Mixin with the purpose of cover all the related with datetime</p> Source code in <code>breathecode/tests/mixins/breathecode_mixin/datetime.py</code> <pre><code>class Datetime:\n    \"\"\"Mixin with the purpose of cover all the related with datetime\"\"\"\n\n    to_iso_string = DatetimeMixin.datetime_to_iso\n    from_iso_string = DatetimeMixin.iso_to_datetime\n    now = DatetimeMixin.datetime_now\n    _parent: APITestCase\n    _bc: interfaces.BreathecodeInterface\n\n    def __init__(self, parent, bc: interfaces.BreathecodeInterface) -&gt; None:\n        self._parent = parent\n        self._bc = bc\n\n    def from_timedelta(self, delta=timedelta(seconds=0)) -&gt; str:\n        \"\"\"\n        Transform from timedelta to the totals seconds in str.\n\n        Usage:\n\n        ```py\n        from datetime import timedelta\n        delta = timedelta(seconds=777)\n        self.bc.datetime.from_timedelta(delta)  # equals to '777.0'\n        ```\n        \"\"\"\n\n        return str(delta.total_seconds())\n\n    def to_datetime_integer(self, timezone: str, date: datetime) -&gt; int:\n        \"\"\"\n        Transform datetime to datetime integer.\n\n        Usage:\n\n        ```py\n        utc_now = timezone.now()\n\n        # date\n        date = datetime.datetime(2022, 3, 21, 2, 51, 55, 068)\n\n        # equals to 202203210751\n        self.bc.datetime.to_datetime_integer('america/new_york', date)\n        ```\n        \"\"\"\n\n        return DatetimeInteger.from_datetime(timezone, date)\n</code></pre>"},{"location":"testing/mixins/bc-datetime/#breathecode.tests.mixins.breathecode_mixin.datetime.Datetime.from_timedelta","title":"<code>from_timedelta(delta=timedelta(seconds=0))</code>","text":"<p>Transform from timedelta to the totals seconds in str.</p> <p>Usage:</p> <pre><code>from datetime import timedelta\ndelta = timedelta(seconds=777)\nself.bc.datetime.from_timedelta(delta)  # equals to '777.0'\n</code></pre> Source code in <code>breathecode/tests/mixins/breathecode_mixin/datetime.py</code> <pre><code>def from_timedelta(self, delta=timedelta(seconds=0)) -&gt; str:\n    \"\"\"\n    Transform from timedelta to the totals seconds in str.\n\n    Usage:\n\n    ```py\n    from datetime import timedelta\n    delta = timedelta(seconds=777)\n    self.bc.datetime.from_timedelta(delta)  # equals to '777.0'\n    ```\n    \"\"\"\n\n    return str(delta.total_seconds())\n</code></pre>"},{"location":"testing/mixins/bc-datetime/#breathecode.tests.mixins.breathecode_mixin.datetime.Datetime.to_datetime_integer","title":"<code>to_datetime_integer(timezone, date)</code>","text":"<p>Transform datetime to datetime integer.</p> <p>Usage:</p> <pre><code>utc_now = timezone.now()\n\n# date\ndate = datetime.datetime(2022, 3, 21, 2, 51, 55, 068)\n\n# equals to 202203210751\nself.bc.datetime.to_datetime_integer('america/new_york', date)\n</code></pre> Source code in <code>breathecode/tests/mixins/breathecode_mixin/datetime.py</code> <pre><code>def to_datetime_integer(self, timezone: str, date: datetime) -&gt; int:\n    \"\"\"\n    Transform datetime to datetime integer.\n\n    Usage:\n\n    ```py\n    utc_now = timezone.now()\n\n    # date\n    date = datetime.datetime(2022, 3, 21, 2, 51, 55, 068)\n\n    # equals to 202203210751\n    self.bc.datetime.to_datetime_integer('america/new_york', date)\n    ```\n    \"\"\"\n\n    return DatetimeInteger.from_datetime(timezone, date)\n</code></pre>"},{"location":"testing/mixins/bc-fake/","title":"bc.fake","text":"<p>Represents a instance of Faker you can learn about it in their webside</p>"},{"location":"testing/mixins/bc-format/","title":"bc.format","text":""},{"location":"testing/mixins/bc-format/#breathecode.tests.mixins.breathecode_mixin.format.Format","title":"<code>Format</code>","text":"<p>Mixin with the purpose of cover all the related with format or parse something</p> Source code in <code>breathecode/tests/mixins/breathecode_mixin/format.py</code> <pre><code>class Format:\n    \"\"\"Mixin with the purpose of cover all the related with format or parse something\"\"\"\n\n    _parent: APITestCase\n    _bc: interfaces.BreathecodeInterface\n    ENCODE = ENCODE\n\n    def __init__(self, parent, bc: interfaces.BreathecodeInterface) -&gt; None:\n        self._parent = parent\n        self._bc = bc\n\n    def call(self, *args: Any, **kwargs: Any) -&gt; str:\n        \"\"\"\n        Wraps a call into it and return its args and kwargs.\n\n        example:\n\n        ```py\n        args, kwargs = self.bc.format.call(2, 3, 4, a=1, b=2, c=3)\n\n        assert args == (2, 3, 4)\n        assert kwargs == {'a': 1, 'b': 2, 'c': 3}\n        ```\n        \"\"\"\n\n        return args, kwargs\n\n    def querystring(self, query: dict) -&gt; str:\n        \"\"\"\n        Build a querystring from a given dict.\n        \"\"\"\n\n        return urllib.parse.urlencode(query)\n\n    def queryset(self, query: dict) -&gt; str:\n        \"\"\"\n        Build a QuerySet from a given dict.\n        \"\"\"\n\n        return Q(**query)\n\n    # remove lang from args\n    def lookup(self, lang: str, overwrite: dict = dict(), **kwargs: dict | tuple) -&gt; dict[str, Any]:\n        \"\"\"\n        Generate from lookups the values in test side to be used in querystring.\n\n        example:\n\n        ```py\n        query = self.bc.format.lookup(\n            'en',\n            strings={\n                'exact': [\n                    'remote_meeting_url',\n                ],\n            },\n            bools={\n                'is_null': ['ended_at'],\n            },\n            datetimes={\n                'gte': ['starting_at'],\n                'lte': ['ending_at'],\n            },\n            slugs=[\n                'cohort_time_slot__cohort',\n                'cohort_time_slot__cohort__academy',\n                'cohort_time_slot__cohort__syllabus_version__syllabus',\n            ],\n            overwrite={\n                'cohort': 'cohort_time_slot__cohort',\n                'academy': 'cohort_time_slot__cohort__academy',\n                'syllabus': 'cohort_time_slot__cohort__syllabus_version__syllabus',\n                'start': 'starting_at',\n                'end': 'ending_at',\n                'upcoming': 'ended_at',\n            },\n        )\n\n        url = reverse_lazy('events:me_event_liveclass') + '?' + self.bc.format.querystring(query)\n\n        # this test avoid to pass a invalid param to ORM\n        response = self.client.get(url)\n        ```\n        \"\"\"\n\n        result = {}\n\n        # foreign\n        ids = kwargs.get(\"ids\", tuple())\n        slugs = kwargs.get(\"slugs\", tuple())\n\n        # fields\n        ints = kwargs.get(\"ints\", dict())\n        strings = kwargs.get(\"strings\", dict())\n        datetimes = kwargs.get(\"datetimes\", dict())\n        bools = kwargs.get(\"bools\", dict())\n\n        # opts\n        custom_fields = kwargs.get(\"custom_fields\", dict())\n\n        # serialize foreign\n        ids = tuple(ids)\n        slugs = tuple(slugs)\n\n        overwrite = dict([(v, k) for k, v in overwrite.items()])\n\n        # foreign\n\n        for field in ids:\n            if field == \"\":\n                result[\"id\"] = field.integer(\"exact\")\n                continue\n\n            name = overwrite.get(field, field)\n            result[name] = Field.id(\"\")\n\n        for field in slugs:\n            if field == \"\":\n                result[\"id\"] = Field.integer(\"exact\")\n                result[\"slug\"] = Field.string(\"exact\")\n                continue\n\n            name = overwrite.get(field, field)\n            result[name] = Field.slug(\"\")\n\n        # fields\n\n        for mode in ints:\n            for field in ints[mode]:\n                name = overwrite.get(field, field)\n                result[name] = Field.int(mode)\n\n        for mode in strings:\n            for field in strings[mode]:\n                name = overwrite.get(field, field)\n                result[name] = Field.string(mode)\n\n        for mode in datetimes:\n            for field in datetimes[mode]:\n                name = overwrite.get(field, field)\n                result[name] = Field.datetime(mode)\n\n        for mode in bools:\n            for field in bools[mode]:\n                name = overwrite.get(field, field)\n                result[name] = Field.bool(mode)\n\n        # custom fields\n\n        for field in custom_fields:\n            name = overwrite.get(field, field)\n            result[name] = custom_fields[field]()\n\n        return result\n\n    def table(self, arg: QuerySet) -&gt; dict[str, Any] | list[dict[str, Any]]:\n        \"\"\"\n        Convert a QuerySet in a list.\n\n        Usage:\n\n        ```py\n        model = self.bc.database.create(user=1, group=1)\n\n        self.bc.format.model(model.user.groups.all())  # = [{...}]\n        ```\n        \"\"\"\n\n        return [ModelsMixin.remove_dinamics_fields(self, data.__dict__.copy()) for data in arg]\n\n    def to_dict(self, arg: Any) -&gt; dict[str, Any] | list[dict[str, Any]]:\n        \"\"\"\n        Parse the object to a `dict` or `list[dict]`.\n\n        Usage:\n\n        ```py\n        # setup the database, model.user is instance of dict and model.cohort\n        # is instance list of dicts\n        model = self.bc.database.create(user=1, cohort=2)\n\n        # Parsing one model to a dict\n        self.bc.format.to_dict(model.user)  # = {...}\n\n        # Parsing many models to a list of dict (infered from the type of\n        # argument)\n        self.bc.format.to_dict(model.cohort)  # = [{...}, {...}]\n        ```\n        \"\"\"\n\n        if isinstance(arg, list) or isinstance(arg, QuerySet):\n            return [self._one_to_dict(x) for x in arg]\n\n        return self._one_to_dict(arg)\n\n    def to_decimal_string(self, decimal: int | float) -&gt; str:\n        \"\"\"\n        Parse a number to the django representation of a decimal.\n\n        Usage:\n\n        ```py\n        self.bc.format.to_decimal(1)  # returns '1.000000000000000'\n        ```\n        \"\"\"\n        return \"%.15f\" % round(decimal, 15)\n\n    def _one_to_dict(self, arg) -&gt; dict[str, Any]:\n        \"\"\"Parse the object to a `dict`\"\"\"\n\n        if isinstance(arg, Model):\n            raw = ModelsMixin.remove_dinamics_fields(None, vars(arg)).copy()\n\n            def normalize(value):\n                if isinstance(value, datetime) and value.tzinfo is not None:\n                    # Normalize tzinfo to the stdlib UTC singleton to avoid mixer UTCZone vs datetime.timezone.utc\n                    # mismatches across the test suite.\n                    return value.astimezone(py_timezone.utc)\n\n                if isinstance(value, dict):\n                    return {k: normalize(v) for k, v in value.items()}\n\n                if isinstance(value, list):\n                    return [normalize(v) for v in value]\n\n                return value\n\n            return normalize(raw)\n\n        if isinstance(arg, dict):\n            return arg.copy()\n\n        raise NotImplementedError(f\"{arg.__name__} is not implemented yet\")\n\n    def describe_models(self, models: dict[str, Model]) -&gt; str:\n        \"\"\"\n        Describe the models.\n\n        Usage:\n\n        ```py\n        # setup the database\n        model = self.bc.database.create(user=1, cohort=1)\n\n        # print the docstring to the corresponding test\n        self.bc.format.describe_models(model)\n        ```\n        \"\"\"\n\n        title_spaces = \" \" * 8\n        model_spaces = \" \" * 10\n        result = {}\n\n        for key in models:\n            model = models[key]\n\n            if isinstance(model, list):\n                for v in model:\n                    name, obj = self._describe_model(v)\n                    result[name] = obj\n\n            else:\n                name, obj = self._describe_model(model)\n                result[name] = obj\n\n        print(title_spaces + \"Descriptions of models are being generated:\")\n\n        for line in yaml.dump(result).split(\"\\n\"):\n            if not line.startswith(\" \"):\n                print()\n\n            print(model_spaces + line)\n\n        # This make sure the element are being printed and prevent `describe_models` are pushed to dev branch\n        assert False\n\n    # TODO: this method is buggy in the line `if not hasattr(model, key)`\n    def _describe_model(self, model: Model):\n        pk_name = self._get_pk_name(model)\n        attrs = dir(model)\n        result = {}\n\n        for key in attrs:\n            if key.startswith(\"_\"):\n                continue\n\n            if key == \"DoesNotExist\":\n                continue\n\n            if key == \"MultipleObjectsReturned\":\n                continue\n\n            if key.startswith(\"get_next_\"):\n                continue\n\n            if key.startswith(\"get_previous_\"):\n                continue\n\n            if key.endswith(\"_set\"):\n                continue\n\n            if not hasattr(model, key):\n                continue\n\n            attr = getattr(model, key)\n\n            if attr.__class__.__name__ == \"method\":\n                continue\n\n            if isinstance(attr, Model):\n                result[key] = f\"{attr.__class__.__name__}({self._get_pk_name(attr)}={self._repr_pk(attr.pk)})\"\n\n            elif attr.__class__.__name__ == \"ManyRelatedManager\":\n                instances = [\n                    f\"{attr.model.__name__}({self._get_pk_name(x)}={self._repr_pk(x.pk)})\" for x in attr.get_queryset()\n                ]\n                result[key] = instances\n\n        return (f\"{model.__class__.__name__}({pk_name}={self._repr_pk(model.pk)})\", result)\n\n    def _repr_pk(self, pk: str | int) -&gt; int | str:\n        if isinstance(pk, int):\n            return pk\n\n        return f'\"{pk}\"'\n\n    def _get_pk_name(self, model: Model):\n        from django.db.models.fields import Field, SlugField\n\n        attrs = [\n            x\n            for x in dir(model)\n            if hasattr(model.__class__, x)\n            and (\n                isinstance(getattr(model.__class__, x), SlugField) or isinstance(getattr(model.__class__, x), SlugField)\n            )\n            and getattr(model.__class__, x).primary_key\n        ]\n\n        for key in dir(model):\n            if (\n                hasattr(model.__class__, key)\n                and hasattr(getattr(model.__class__, key), \"field\")\n                and getattr(model.__class__, key).field.primary_key\n            ):\n                return key\n\n        return \"pk\"\n\n    def from_base64(self, hash: str | bytes) -&gt; str:\n        \"\"\"\n        Transform a base64 hash to string.\n        \"\"\"\n\n        if isinstance(hash, str):\n            hash = hash.encode()\n\n        return base64.b64decode(hash).decode(ENCODE)\n\n    def to_base64(self, string: str | bytes) -&gt; str:\n        \"\"\"\n        Transform a base64 hash to string.\n        \"\"\"\n\n        if isinstance(string, str):\n            string = string.encode()\n\n        return base64.b64encode(string).decode(ENCODE)\n\n    def to_querystring(self, params: dict) -&gt; str:\n        \"\"\"\n        Transform dict to querystring\n        \"\"\"\n\n        return urllib.parse.urlencode(params)\n\n    def from_bytes(self, s: bytes, encode: str = ENCODE) -&gt; str:\n        \"\"\"\n        Transform bytes to a string.\n        \"\"\"\n\n        return s.decode(encode)\n</code></pre>"},{"location":"testing/mixins/bc-format/#breathecode.tests.mixins.breathecode_mixin.format.Format.call","title":"<code>call(*args, **kwargs)</code>","text":"<p>Wraps a call into it and return its args and kwargs.</p> <p>example:</p> <pre><code>args, kwargs = self.bc.format.call(2, 3, 4, a=1, b=2, c=3)\n\nassert args == (2, 3, 4)\nassert kwargs == {'a': 1, 'b': 2, 'c': 3}\n</code></pre> Source code in <code>breathecode/tests/mixins/breathecode_mixin/format.py</code> <pre><code>def call(self, *args: Any, **kwargs: Any) -&gt; str:\n    \"\"\"\n    Wraps a call into it and return its args and kwargs.\n\n    example:\n\n    ```py\n    args, kwargs = self.bc.format.call(2, 3, 4, a=1, b=2, c=3)\n\n    assert args == (2, 3, 4)\n    assert kwargs == {'a': 1, 'b': 2, 'c': 3}\n    ```\n    \"\"\"\n\n    return args, kwargs\n</code></pre>"},{"location":"testing/mixins/bc-format/#breathecode.tests.mixins.breathecode_mixin.format.Format.describe_models","title":"<code>describe_models(models)</code>","text":"<p>Describe the models.</p> <p>Usage:</p> <pre><code># setup the database\nmodel = self.bc.database.create(user=1, cohort=1)\n\n# print the docstring to the corresponding test\nself.bc.format.describe_models(model)\n</code></pre> Source code in <code>breathecode/tests/mixins/breathecode_mixin/format.py</code> <pre><code>def describe_models(self, models: dict[str, Model]) -&gt; str:\n    \"\"\"\n    Describe the models.\n\n    Usage:\n\n    ```py\n    # setup the database\n    model = self.bc.database.create(user=1, cohort=1)\n\n    # print the docstring to the corresponding test\n    self.bc.format.describe_models(model)\n    ```\n    \"\"\"\n\n    title_spaces = \" \" * 8\n    model_spaces = \" \" * 10\n    result = {}\n\n    for key in models:\n        model = models[key]\n\n        if isinstance(model, list):\n            for v in model:\n                name, obj = self._describe_model(v)\n                result[name] = obj\n\n        else:\n            name, obj = self._describe_model(model)\n            result[name] = obj\n\n    print(title_spaces + \"Descriptions of models are being generated:\")\n\n    for line in yaml.dump(result).split(\"\\n\"):\n        if not line.startswith(\" \"):\n            print()\n\n        print(model_spaces + line)\n\n    # This make sure the element are being printed and prevent `describe_models` are pushed to dev branch\n    assert False\n</code></pre>"},{"location":"testing/mixins/bc-format/#breathecode.tests.mixins.breathecode_mixin.format.Format.from_base64","title":"<code>from_base64(hash)</code>","text":"<p>Transform a base64 hash to string.</p> Source code in <code>breathecode/tests/mixins/breathecode_mixin/format.py</code> <pre><code>def from_base64(self, hash: str | bytes) -&gt; str:\n    \"\"\"\n    Transform a base64 hash to string.\n    \"\"\"\n\n    if isinstance(hash, str):\n        hash = hash.encode()\n\n    return base64.b64decode(hash).decode(ENCODE)\n</code></pre>"},{"location":"testing/mixins/bc-format/#breathecode.tests.mixins.breathecode_mixin.format.Format.from_bytes","title":"<code>from_bytes(s, encode=ENCODE)</code>","text":"<p>Transform bytes to a string.</p> Source code in <code>breathecode/tests/mixins/breathecode_mixin/format.py</code> <pre><code>def from_bytes(self, s: bytes, encode: str = ENCODE) -&gt; str:\n    \"\"\"\n    Transform bytes to a string.\n    \"\"\"\n\n    return s.decode(encode)\n</code></pre>"},{"location":"testing/mixins/bc-format/#breathecode.tests.mixins.breathecode_mixin.format.Format.lookup","title":"<code>lookup(lang, overwrite=dict(), **kwargs)</code>","text":"<p>Generate from lookups the values in test side to be used in querystring.</p> <p>example:</p> <pre><code>query = self.bc.format.lookup(\n    'en',\n    strings={\n        'exact': [\n            'remote_meeting_url',\n        ],\n    },\n    bools={\n        'is_null': ['ended_at'],\n    },\n    datetimes={\n        'gte': ['starting_at'],\n        'lte': ['ending_at'],\n    },\n    slugs=[\n        'cohort_time_slot__cohort',\n        'cohort_time_slot__cohort__academy',\n        'cohort_time_slot__cohort__syllabus_version__syllabus',\n    ],\n    overwrite={\n        'cohort': 'cohort_time_slot__cohort',\n        'academy': 'cohort_time_slot__cohort__academy',\n        'syllabus': 'cohort_time_slot__cohort__syllabus_version__syllabus',\n        'start': 'starting_at',\n        'end': 'ending_at',\n        'upcoming': 'ended_at',\n    },\n)\n\nurl = reverse_lazy('events:me_event_liveclass') + '?' + self.bc.format.querystring(query)\n\n# this test avoid to pass a invalid param to ORM\nresponse = self.client.get(url)\n</code></pre> Source code in <code>breathecode/tests/mixins/breathecode_mixin/format.py</code> <pre><code>def lookup(self, lang: str, overwrite: dict = dict(), **kwargs: dict | tuple) -&gt; dict[str, Any]:\n    \"\"\"\n    Generate from lookups the values in test side to be used in querystring.\n\n    example:\n\n    ```py\n    query = self.bc.format.lookup(\n        'en',\n        strings={\n            'exact': [\n                'remote_meeting_url',\n            ],\n        },\n        bools={\n            'is_null': ['ended_at'],\n        },\n        datetimes={\n            'gte': ['starting_at'],\n            'lte': ['ending_at'],\n        },\n        slugs=[\n            'cohort_time_slot__cohort',\n            'cohort_time_slot__cohort__academy',\n            'cohort_time_slot__cohort__syllabus_version__syllabus',\n        ],\n        overwrite={\n            'cohort': 'cohort_time_slot__cohort',\n            'academy': 'cohort_time_slot__cohort__academy',\n            'syllabus': 'cohort_time_slot__cohort__syllabus_version__syllabus',\n            'start': 'starting_at',\n            'end': 'ending_at',\n            'upcoming': 'ended_at',\n        },\n    )\n\n    url = reverse_lazy('events:me_event_liveclass') + '?' + self.bc.format.querystring(query)\n\n    # this test avoid to pass a invalid param to ORM\n    response = self.client.get(url)\n    ```\n    \"\"\"\n\n    result = {}\n\n    # foreign\n    ids = kwargs.get(\"ids\", tuple())\n    slugs = kwargs.get(\"slugs\", tuple())\n\n    # fields\n    ints = kwargs.get(\"ints\", dict())\n    strings = kwargs.get(\"strings\", dict())\n    datetimes = kwargs.get(\"datetimes\", dict())\n    bools = kwargs.get(\"bools\", dict())\n\n    # opts\n    custom_fields = kwargs.get(\"custom_fields\", dict())\n\n    # serialize foreign\n    ids = tuple(ids)\n    slugs = tuple(slugs)\n\n    overwrite = dict([(v, k) for k, v in overwrite.items()])\n\n    # foreign\n\n    for field in ids:\n        if field == \"\":\n            result[\"id\"] = field.integer(\"exact\")\n            continue\n\n        name = overwrite.get(field, field)\n        result[name] = Field.id(\"\")\n\n    for field in slugs:\n        if field == \"\":\n            result[\"id\"] = Field.integer(\"exact\")\n            result[\"slug\"] = Field.string(\"exact\")\n            continue\n\n        name = overwrite.get(field, field)\n        result[name] = Field.slug(\"\")\n\n    # fields\n\n    for mode in ints:\n        for field in ints[mode]:\n            name = overwrite.get(field, field)\n            result[name] = Field.int(mode)\n\n    for mode in strings:\n        for field in strings[mode]:\n            name = overwrite.get(field, field)\n            result[name] = Field.string(mode)\n\n    for mode in datetimes:\n        for field in datetimes[mode]:\n            name = overwrite.get(field, field)\n            result[name] = Field.datetime(mode)\n\n    for mode in bools:\n        for field in bools[mode]:\n            name = overwrite.get(field, field)\n            result[name] = Field.bool(mode)\n\n    # custom fields\n\n    for field in custom_fields:\n        name = overwrite.get(field, field)\n        result[name] = custom_fields[field]()\n\n    return result\n</code></pre>"},{"location":"testing/mixins/bc-format/#breathecode.tests.mixins.breathecode_mixin.format.Format.queryset","title":"<code>queryset(query)</code>","text":"<p>Build a QuerySet from a given dict.</p> Source code in <code>breathecode/tests/mixins/breathecode_mixin/format.py</code> <pre><code>def queryset(self, query: dict) -&gt; str:\n    \"\"\"\n    Build a QuerySet from a given dict.\n    \"\"\"\n\n    return Q(**query)\n</code></pre>"},{"location":"testing/mixins/bc-format/#breathecode.tests.mixins.breathecode_mixin.format.Format.querystring","title":"<code>querystring(query)</code>","text":"<p>Build a querystring from a given dict.</p> Source code in <code>breathecode/tests/mixins/breathecode_mixin/format.py</code> <pre><code>def querystring(self, query: dict) -&gt; str:\n    \"\"\"\n    Build a querystring from a given dict.\n    \"\"\"\n\n    return urllib.parse.urlencode(query)\n</code></pre>"},{"location":"testing/mixins/bc-format/#breathecode.tests.mixins.breathecode_mixin.format.Format.table","title":"<code>table(arg)</code>","text":"<p>Convert a QuerySet in a list.</p> <p>Usage:</p> <pre><code>model = self.bc.database.create(user=1, group=1)\n\nself.bc.format.model(model.user.groups.all())  # = [{...}]\n</code></pre> Source code in <code>breathecode/tests/mixins/breathecode_mixin/format.py</code> <pre><code>def table(self, arg: QuerySet) -&gt; dict[str, Any] | list[dict[str, Any]]:\n    \"\"\"\n    Convert a QuerySet in a list.\n\n    Usage:\n\n    ```py\n    model = self.bc.database.create(user=1, group=1)\n\n    self.bc.format.model(model.user.groups.all())  # = [{...}]\n    ```\n    \"\"\"\n\n    return [ModelsMixin.remove_dinamics_fields(self, data.__dict__.copy()) for data in arg]\n</code></pre>"},{"location":"testing/mixins/bc-format/#breathecode.tests.mixins.breathecode_mixin.format.Format.to_base64","title":"<code>to_base64(string)</code>","text":"<p>Transform a base64 hash to string.</p> Source code in <code>breathecode/tests/mixins/breathecode_mixin/format.py</code> <pre><code>def to_base64(self, string: str | bytes) -&gt; str:\n    \"\"\"\n    Transform a base64 hash to string.\n    \"\"\"\n\n    if isinstance(string, str):\n        string = string.encode()\n\n    return base64.b64encode(string).decode(ENCODE)\n</code></pre>"},{"location":"testing/mixins/bc-format/#breathecode.tests.mixins.breathecode_mixin.format.Format.to_decimal_string","title":"<code>to_decimal_string(decimal)</code>","text":"<p>Parse a number to the django representation of a decimal.</p> <p>Usage:</p> <pre><code>self.bc.format.to_decimal(1)  # returns '1.000000000000000'\n</code></pre> Source code in <code>breathecode/tests/mixins/breathecode_mixin/format.py</code> <pre><code>def to_decimal_string(self, decimal: int | float) -&gt; str:\n    \"\"\"\n    Parse a number to the django representation of a decimal.\n\n    Usage:\n\n    ```py\n    self.bc.format.to_decimal(1)  # returns '1.000000000000000'\n    ```\n    \"\"\"\n    return \"%.15f\" % round(decimal, 15)\n</code></pre>"},{"location":"testing/mixins/bc-format/#breathecode.tests.mixins.breathecode_mixin.format.Format.to_dict","title":"<code>to_dict(arg)</code>","text":"<p>Parse the object to a <code>dict</code> or <code>list[dict]</code>.</p> <p>Usage:</p> <pre><code># setup the database, model.user is instance of dict and model.cohort\n# is instance list of dicts\nmodel = self.bc.database.create(user=1, cohort=2)\n\n# Parsing one model to a dict\nself.bc.format.to_dict(model.user)  # = {...}\n\n# Parsing many models to a list of dict (infered from the type of\n# argument)\nself.bc.format.to_dict(model.cohort)  # = [{...}, {...}]\n</code></pre> Source code in <code>breathecode/tests/mixins/breathecode_mixin/format.py</code> <pre><code>def to_dict(self, arg: Any) -&gt; dict[str, Any] | list[dict[str, Any]]:\n    \"\"\"\n    Parse the object to a `dict` or `list[dict]`.\n\n    Usage:\n\n    ```py\n    # setup the database, model.user is instance of dict and model.cohort\n    # is instance list of dicts\n    model = self.bc.database.create(user=1, cohort=2)\n\n    # Parsing one model to a dict\n    self.bc.format.to_dict(model.user)  # = {...}\n\n    # Parsing many models to a list of dict (infered from the type of\n    # argument)\n    self.bc.format.to_dict(model.cohort)  # = [{...}, {...}]\n    ```\n    \"\"\"\n\n    if isinstance(arg, list) or isinstance(arg, QuerySet):\n        return [self._one_to_dict(x) for x in arg]\n\n    return self._one_to_dict(arg)\n</code></pre>"},{"location":"testing/mixins/bc-format/#breathecode.tests.mixins.breathecode_mixin.format.Format.to_querystring","title":"<code>to_querystring(params)</code>","text":"<p>Transform dict to querystring</p> Source code in <code>breathecode/tests/mixins/breathecode_mixin/format.py</code> <pre><code>def to_querystring(self, params: dict) -&gt; str:\n    \"\"\"\n    Transform dict to querystring\n    \"\"\"\n\n    return urllib.parse.urlencode(params)\n</code></pre>"},{"location":"testing/mixins/bc-random/","title":"bc.random","text":""},{"location":"testing/mixins/bc-random/#breathecode.tests.mixins.breathecode_mixin.random.Random","title":"<code>Random</code>","text":"<p>Mixin with the purpose of cover all the related with the custom asserts</p> Source code in <code>breathecode/tests/mixins/breathecode_mixin/random.py</code> <pre><code>class Random:\n    \"\"\"Mixin with the purpose of cover all the related with the custom asserts\"\"\"\n\n    _parent: APITestCase\n    _bc: interfaces.BreathecodeInterface\n\n    def __init__(self, parent, bc: interfaces.BreathecodeInterface) -&gt; None:\n        self._parent = parent\n        self._bc = bc\n\n    def image(self, width: int = 10, height: int = 10, ext=\"png\") -&gt; tuple[TextIOWrapper, str]:\n        \"\"\"\n        Generate a random image.\n\n        Usage:\n\n        ```py\n        # generate a random image with width of 20px and height of 10px\n        file, filename = self.bc.random.image(20, 10)\n        ```\n        \"\"\"\n\n        size = (width, height)\n        filename = fake.slug() + f\".{ext}\"\n        image = Image.new(\"RGB\", size)\n        arr = np.random.randint(low=0, high=255, size=(size[1], size[0]))\n\n        image = Image.fromarray(arr.astype(\"uint8\"))\n        image.save(filename, IMAGE_TYPES[ext])\n\n        file = open(filename, \"rb\")\n\n        self._bc.garbage_collector.register_image(file)\n\n        return file, filename\n\n    def file(self) -&gt; tuple[TextIOWrapper, str]:\n        \"\"\"\n        Generate a random file.\n\n        Usage:\n\n        ```py\n        # generate a random file\n        file, filename = self.bc.random.file()\n        ```\n        \"\"\"\n\n        ext = self.string(lower=True, size=2)\n\n        file = tempfile.NamedTemporaryFile(suffix=f\".{ext}\", delete=False)\n        file.write(os.urandom(1024))\n\n        self._bc.garbage_collector.register_file(file)\n\n        return file, file.name\n\n    def string(self, lower=False, upper=False, symbol=False, number=False, size=0) -&gt; str:\n        chars = \"\"\n\n        if lower:\n            chars = chars + string.ascii_lowercase\n\n        if upper:\n            chars = chars + string.ascii_uppercase\n\n        if symbol:\n            chars = chars + string.punctuation\n\n        if number:\n            chars = chars + string.digits\n\n        return \"\".join(random.choices(chars, k=size))\n</code></pre>"},{"location":"testing/mixins/bc-random/#breathecode.tests.mixins.breathecode_mixin.random.Random.file","title":"<code>file()</code>","text":"<p>Generate a random file.</p> <p>Usage:</p> <pre><code># generate a random file\nfile, filename = self.bc.random.file()\n</code></pre> Source code in <code>breathecode/tests/mixins/breathecode_mixin/random.py</code> <pre><code>def file(self) -&gt; tuple[TextIOWrapper, str]:\n    \"\"\"\n    Generate a random file.\n\n    Usage:\n\n    ```py\n    # generate a random file\n    file, filename = self.bc.random.file()\n    ```\n    \"\"\"\n\n    ext = self.string(lower=True, size=2)\n\n    file = tempfile.NamedTemporaryFile(suffix=f\".{ext}\", delete=False)\n    file.write(os.urandom(1024))\n\n    self._bc.garbage_collector.register_file(file)\n\n    return file, file.name\n</code></pre>"},{"location":"testing/mixins/bc-random/#breathecode.tests.mixins.breathecode_mixin.random.Random.image","title":"<code>image(width=10, height=10, ext='png')</code>","text":"<p>Generate a random image.</p> <p>Usage:</p> <pre><code># generate a random image with width of 20px and height of 10px\nfile, filename = self.bc.random.image(20, 10)\n</code></pre> Source code in <code>breathecode/tests/mixins/breathecode_mixin/random.py</code> <pre><code>def image(self, width: int = 10, height: int = 10, ext=\"png\") -&gt; tuple[TextIOWrapper, str]:\n    \"\"\"\n    Generate a random image.\n\n    Usage:\n\n    ```py\n    # generate a random image with width of 20px and height of 10px\n    file, filename = self.bc.random.image(20, 10)\n    ```\n    \"\"\"\n\n    size = (width, height)\n    filename = fake.slug() + f\".{ext}\"\n    image = Image.new(\"RGB\", size)\n    arr = np.random.randint(low=0, high=255, size=(size[1], size[0]))\n\n    image = Image.fromarray(arr.astype(\"uint8\"))\n    image.save(filename, IMAGE_TYPES[ext])\n\n    file = open(filename, \"rb\")\n\n    self._bc.garbage_collector.register_image(file)\n\n    return file, filename\n</code></pre>"},{"location":"testing/mixins/bc-request/","title":"bc.request","text":""},{"location":"testing/mixins/bc-request/#breathecode.tests.mixins.breathecode_mixin.request.Request","title":"<code>Request</code>","text":"<p>Mixin with the purpose of cover all the related with the request</p> Source code in <code>breathecode/tests/mixins/breathecode_mixin/request.py</code> <pre><code>class Request:\n    \"\"\"Mixin with the purpose of cover all the related with the request\"\"\"\n\n    _parent: APITestCase\n\n    def __init__(self, parent, bc) -&gt; None:\n        self._parent = parent\n        self._bc = bc\n\n    def set_headers(self, **kargs: str) -&gt; None:\n        \"\"\"\n        Set headers.\n\n        ```py\n        # It set the headers with:\n        #   Academy: 1\n        #   ThingOfImportance: potato\n        self.bc.request.set_headers(academy=1, thing_of_importance='potato')\n        ```\n        \"\"\"\n        warn(\n            \"Use rest_framework.test.APIClient instead. Example: client.get(..., headers={...})\",\n            DeprecationWarning,\n            stacklevel=2,\n        )\n\n        headers = {}\n\n        items = [\n            index\n            for index in kargs\n            if kargs[index] and (isinstance(kargs[index], str) or isinstance(kargs[index], int))\n        ]\n\n        for index in items:\n            headers[f\"HTTP_{index.upper()}\"] = str(kargs[index])\n\n        self._parent.client.credentials(**headers)\n\n    def authenticate(self, user) -&gt; None:\n        \"\"\"\n        Forces authentication in a request inside a APITestCase.\n\n        Usage:\n\n        ```py\n        # setup the database\n        model = self.bc.database.create(user=1)\n\n        # that setup the request to use the credential of user passed\n        self.client.force_authenticate(model.user)\n        ```\n\n        Keywords arguments:\n\n        - user: a instance of user model `breathecode.authenticate.models.User`\n        \"\"\"\n        warn(\"Use `client.manual_authentication` instead\", DeprecationWarning, stacklevel=2)\n        self._parent.client.force_authenticate(user=user)\n\n    def manual_authentication(self, user) -&gt; None:\n        \"\"\"\n        Generate a manual authentication using a token, this method is more slower than `authenticate`.\n\n        ```py\n        # setup the database\n        model = self.bc.database.create(user=1)\n\n        # that setup the request to use the credential with tokens of user passed\n        self.bc.request.manual_authentication(model.user)\n        ```\n\n        Keywords arguments:\n\n        - user: a instance of user model `breathecode.authenticate.models.User`.\n        \"\"\"\n        from breathecode.authenticate.models import Token\n\n        warn(\"Use `client.credentials` instead\", DeprecationWarning, stacklevel=2)\n\n        token = Token.objects.create(user=user)\n        self._parent.client.credentials(HTTP_AUTHORIZATION=f\"Token {token.key}\")\n\n    def sign_jwt_link(\n        self, app, user_id: Optional[int] = None, reverse: bool = False, client: Optional[APIClient] = None\n    ):\n        \"\"\"\n        Set Json Web Token in the request.\n\n        Usage:\n\n        ```py\n        # setup the database\n        model = self.bc.database.create(app=1, user=1)\n\n        # that setup the request to use the credential of user passed\n        self.bc.request.authenticate(model.app, model.user.id)\n        ```\n\n        Keywords arguments:\n\n        - user: a instance of user model `breathecode.authenticate.models.User`\n        \"\"\"\n        from datetime import datetime, timedelta\n\n        from django.utils import timezone\n\n        now = timezone.now()\n\n        if not client:\n            client = self._parent.client\n\n        # https://datatracker.ietf.org/doc/html/rfc7519#section-4\n        payload = {\n            \"sub\": str(user_id or \"\"),\n            \"iss\": os.getenv(\"API_URL\", \"http://localhost:8000\"),\n            \"app\": app.slug,\n            \"aud\": \"breathecode\",\n            \"exp\": datetime.timestamp(now + timedelta(minutes=2)),\n            \"iat\": datetime.timestamp(now) - 1,\n            \"typ\": \"JWT\",\n        }\n\n        if reverse:\n            payload[\"aud\"] = app.slug\n            payload[\"app\"] = \"breathecode\"\n\n        if app.algorithm == \"HMAC_SHA256\":\n\n            token = jwt.encode(payload, bytes.fromhex(app.private_key), algorithm=\"HS256\")\n\n        elif app.algorithm == \"HMAC_SHA512\":\n            token = jwt.encode(payload, bytes.fromhex(app.private_key), algorithm=\"HS512\")\n\n        elif app.algorithm == \"ED25519\":\n            token = jwt.encode(payload, bytes.fromhex(app.private_key), algorithm=\"EdDSA\")\n\n        else:\n            raise Exception(\"Algorithm not implemented\")\n\n        client.credentials(HTTP_AUTHORIZATION=f\"Link App={app.slug},Token={token}\")\n</code></pre>"},{"location":"testing/mixins/bc-request/#breathecode.tests.mixins.breathecode_mixin.request.Request.authenticate","title":"<code>authenticate(user)</code>","text":"<p>Forces authentication in a request inside a APITestCase.</p> <p>Usage:</p> <pre><code># setup the database\nmodel = self.bc.database.create(user=1)\n\n# that setup the request to use the credential of user passed\nself.client.force_authenticate(model.user)\n</code></pre> <p>Keywords arguments:</p> <ul> <li>user: a instance of user model <code>breathecode.authenticate.models.User</code></li> </ul> Source code in <code>breathecode/tests/mixins/breathecode_mixin/request.py</code> <pre><code>def authenticate(self, user) -&gt; None:\n    \"\"\"\n    Forces authentication in a request inside a APITestCase.\n\n    Usage:\n\n    ```py\n    # setup the database\n    model = self.bc.database.create(user=1)\n\n    # that setup the request to use the credential of user passed\n    self.client.force_authenticate(model.user)\n    ```\n\n    Keywords arguments:\n\n    - user: a instance of user model `breathecode.authenticate.models.User`\n    \"\"\"\n    warn(\"Use `client.manual_authentication` instead\", DeprecationWarning, stacklevel=2)\n    self._parent.client.force_authenticate(user=user)\n</code></pre>"},{"location":"testing/mixins/bc-request/#breathecode.tests.mixins.breathecode_mixin.request.Request.manual_authentication","title":"<code>manual_authentication(user)</code>","text":"<p>Generate a manual authentication using a token, this method is more slower than <code>authenticate</code>.</p> <pre><code># setup the database\nmodel = self.bc.database.create(user=1)\n\n# that setup the request to use the credential with tokens of user passed\nself.bc.request.manual_authentication(model.user)\n</code></pre> <p>Keywords arguments:</p> <ul> <li>user: a instance of user model <code>breathecode.authenticate.models.User</code>.</li> </ul> Source code in <code>breathecode/tests/mixins/breathecode_mixin/request.py</code> <pre><code>def manual_authentication(self, user) -&gt; None:\n    \"\"\"\n    Generate a manual authentication using a token, this method is more slower than `authenticate`.\n\n    ```py\n    # setup the database\n    model = self.bc.database.create(user=1)\n\n    # that setup the request to use the credential with tokens of user passed\n    self.bc.request.manual_authentication(model.user)\n    ```\n\n    Keywords arguments:\n\n    - user: a instance of user model `breathecode.authenticate.models.User`.\n    \"\"\"\n    from breathecode.authenticate.models import Token\n\n    warn(\"Use `client.credentials` instead\", DeprecationWarning, stacklevel=2)\n\n    token = Token.objects.create(user=user)\n    self._parent.client.credentials(HTTP_AUTHORIZATION=f\"Token {token.key}\")\n</code></pre>"},{"location":"testing/mixins/bc-request/#breathecode.tests.mixins.breathecode_mixin.request.Request.set_headers","title":"<code>set_headers(**kargs)</code>","text":"<p>Set headers.</p> <pre><code># It set the headers with:\n#   Academy: 1\n#   ThingOfImportance: potato\nself.bc.request.set_headers(academy=1, thing_of_importance='potato')\n</code></pre> Source code in <code>breathecode/tests/mixins/breathecode_mixin/request.py</code> <pre><code>def set_headers(self, **kargs: str) -&gt; None:\n    \"\"\"\n    Set headers.\n\n    ```py\n    # It set the headers with:\n    #   Academy: 1\n    #   ThingOfImportance: potato\n    self.bc.request.set_headers(academy=1, thing_of_importance='potato')\n    ```\n    \"\"\"\n    warn(\n        \"Use rest_framework.test.APIClient instead. Example: client.get(..., headers={...})\",\n        DeprecationWarning,\n        stacklevel=2,\n    )\n\n    headers = {}\n\n    items = [\n        index\n        for index in kargs\n        if kargs[index] and (isinstance(kargs[index], str) or isinstance(kargs[index], int))\n    ]\n\n    for index in items:\n        headers[f\"HTTP_{index.upper()}\"] = str(kargs[index])\n\n    self._parent.client.credentials(**headers)\n</code></pre>"},{"location":"testing/mixins/bc-request/#breathecode.tests.mixins.breathecode_mixin.request.Request.sign_jwt_link","title":"<code>sign_jwt_link(app, user_id=None, reverse=False, client=None)</code>","text":"<p>Set Json Web Token in the request.</p> <p>Usage:</p> <pre><code># setup the database\nmodel = self.bc.database.create(app=1, user=1)\n\n# that setup the request to use the credential of user passed\nself.bc.request.authenticate(model.app, model.user.id)\n</code></pre> <p>Keywords arguments:</p> <ul> <li>user: a instance of user model <code>breathecode.authenticate.models.User</code></li> </ul> Source code in <code>breathecode/tests/mixins/breathecode_mixin/request.py</code> <pre><code>def sign_jwt_link(\n    self, app, user_id: Optional[int] = None, reverse: bool = False, client: Optional[APIClient] = None\n):\n    \"\"\"\n    Set Json Web Token in the request.\n\n    Usage:\n\n    ```py\n    # setup the database\n    model = self.bc.database.create(app=1, user=1)\n\n    # that setup the request to use the credential of user passed\n    self.bc.request.authenticate(model.app, model.user.id)\n    ```\n\n    Keywords arguments:\n\n    - user: a instance of user model `breathecode.authenticate.models.User`\n    \"\"\"\n    from datetime import datetime, timedelta\n\n    from django.utils import timezone\n\n    now = timezone.now()\n\n    if not client:\n        client = self._parent.client\n\n    # https://datatracker.ietf.org/doc/html/rfc7519#section-4\n    payload = {\n        \"sub\": str(user_id or \"\"),\n        \"iss\": os.getenv(\"API_URL\", \"http://localhost:8000\"),\n        \"app\": app.slug,\n        \"aud\": \"breathecode\",\n        \"exp\": datetime.timestamp(now + timedelta(minutes=2)),\n        \"iat\": datetime.timestamp(now) - 1,\n        \"typ\": \"JWT\",\n    }\n\n    if reverse:\n        payload[\"aud\"] = app.slug\n        payload[\"app\"] = \"breathecode\"\n\n    if app.algorithm == \"HMAC_SHA256\":\n\n        token = jwt.encode(payload, bytes.fromhex(app.private_key), algorithm=\"HS256\")\n\n    elif app.algorithm == \"HMAC_SHA512\":\n        token = jwt.encode(payload, bytes.fromhex(app.private_key), algorithm=\"HS512\")\n\n    elif app.algorithm == \"ED25519\":\n        token = jwt.encode(payload, bytes.fromhex(app.private_key), algorithm=\"EdDSA\")\n\n    else:\n        raise Exception(\"Algorithm not implemented\")\n\n    client.credentials(HTTP_AUTHORIZATION=f\"Link App={app.slug},Token={token}\")\n</code></pre>"},{"location":"testing/mixins/bc/","title":"bc","text":""},{"location":"testing/mixins/bc/#breathecode.tests.mixins.breathecode_mixin.breathecode.Breathecode","title":"<code>Breathecode</code>","text":"<p>               Bases: <code>BreathecodeInterface</code></p> <p>Collection of mixins for testing purposes</p> Source code in <code>breathecode/tests/mixins/breathecode_mixin/breathecode.py</code> <pre><code>class Breathecode(BreathecodeInterface):\n    \"\"\"Collection of mixins for testing purposes\"\"\"\n\n    cache: Cache\n    random: Random\n    datetime: Datetime\n    request: Request\n    database: Database\n    check: Check\n    format: Format\n    fake: Faker\n    garbage_collector: GarbageCollector\n    _parent: APITestCase\n\n    def __init__(self, parent) -&gt; None:\n        self._parent = parent\n\n        self.cache = Cache(parent, self)\n        self.random = Random(parent, self)\n        self.datetime = Datetime(parent, self)\n        self.request = Request(parent, self)\n        self.database = Database(parent, self)\n        self.check = Check(parent, self)\n        self.format = Format(parent, self)\n        self.garbage_collector = GarbageCollector(parent, self)\n        self.fake = fake\n\n    def help(self, *args) -&gt; None:\n        \"\"\"\n        Print a list of mixin with a tree style (command of Linux).\n\n        Usage:\n\n        ```py\n        # this print a tree with all the mixins\n        self.bc.help()\n\n        # this print just the docs of corresponding method\n        self.bc.help('bc.datetime.now')\n        ```\n        \"\"\"\n\n        if args:\n            for arg in args:\n                self._get_doctring(arg)\n\n        else:\n            self._help_tree()\n\n        # prevent left a `self.bc.help()` in the code\n        assert False\n\n    def _get_doctring(self, path: str) -&gt; None:\n        parts_of_path = path.split(\".\")\n        current_path = \"\"\n        current = None\n\n        for part_of_path in parts_of_path:\n            if not current:\n                if not hasattr(self._parent, part_of_path):\n                    current_path += f\".{part_of_path}\"\n                    break\n\n                current = getattr(self._parent, part_of_path)\n\n            else:\n                if not hasattr(current, part_of_path):\n                    current_path += f\".{part_of_path}\"\n                    current = None\n                    break\n\n                current = getattr(current, part_of_path)\n\n        if current:\n            from unittest.mock import patch, MagicMock\n\n            if callable(current):\n                print(f\"self.{path}{print_arguments(current)}:\")\n            else:\n                print(f\"self.{path}:\")\n\n            print()\n\n            with patch(\"sys.stdout.write\", MagicMock()) as mock:\n                help(current)\n\n            for args, _ in mock.call_args_list:\n                if args[0] == \"\\n\":\n                    print()\n                lines = args[0].split(\"\\n\")\n\n                for line in lines[3:-1]:\n                    print(f\"    {line}\")\n\n        else:\n            print(f\"self.{path}:\")\n            print()\n            print(f\"    self{current_path} not exists.\")\n\n        print()\n\n    def _help_tree(self, level: int = 0, parent: Optional[dict] = None, last_item: bool = False) -&gt; list[str]:\n        \"\"\"Print a list of mixin with a tree style (command of Linux)\"\"\"\n\n        result: list[str] = []\n\n        if not parent:\n            result.append(\"bc\")\n\n        parent = [x for x in dir(parent or self) if not x.startswith(\"_\")]\n\n        if last_item:\n            starts = \"    \" + (\"\u2502   \" * (level - 1))\n\n        else:\n            starts = \"\u2502   \" * level\n\n        for key in parent:\n            item = getattr(self, key)\n\n            if callable(item):\n                result.append(f\"{starts}\u251c\u2500\u2500 {key}{print_arguments(item)}\")\n\n            else:\n                result.append(f\"{starts}\u251c\u2500\u2500 {key}\")\n\n                last_item = parent.index(key) == len(parent) - 1\n                result = [*result, *Breathecode._help_tree(item, level + 1, item, last_item)]\n\n        result[-1] = result[-1].replace(\"  \u251c\u2500\u2500 \", \"  \u2514\u2500\u2500 \")\n        result[-1] = result[-1].replace(r\"\u251c\u2500\u2500 ([a-zA-Z0-9]+)$\", r\"\u2514\u2500\u2500 \\1\")\n\n        for n in range(len(result) - 1, -1, -1):\n            if result[n][0] == \"\u251c\":\n                result[n] = re.sub(r\"^\u251c\", r\"\u2514\", result[n])\n                break\n\n        if level == 0:\n            print(\"\\n\".join(result))\n\n        return result\n</code></pre>"},{"location":"testing/mixins/bc/#breathecode.tests.mixins.breathecode_mixin.breathecode.Breathecode.help","title":"<code>help(*args)</code>","text":"<p>Print a list of mixin with a tree style (command of Linux).</p> <p>Usage:</p> <pre><code># this print a tree with all the mixins\nself.bc.help()\n\n# this print just the docs of corresponding method\nself.bc.help('bc.datetime.now')\n</code></pre> Source code in <code>breathecode/tests/mixins/breathecode_mixin/breathecode.py</code> <pre><code>def help(self, *args) -&gt; None:\n    \"\"\"\n    Print a list of mixin with a tree style (command of Linux).\n\n    Usage:\n\n    ```py\n    # this print a tree with all the mixins\n    self.bc.help()\n\n    # this print just the docs of corresponding method\n    self.bc.help('bc.datetime.now')\n    ```\n    \"\"\"\n\n    if args:\n        for arg in args:\n            self._get_doctring(arg)\n\n    else:\n        self._help_tree()\n\n    # prevent left a `self.bc.help()` in the code\n    assert False\n</code></pre>"},{"location":"testing/mocks/mock-requests/","title":"Mock requests","text":"<p>Mocks for <code>requests</code> module</p>"},{"location":"testing/mocks/mock-requests/#breathecode.tests.mocks.requests.apply_requests_delete_mock","title":"<code>apply_requests_delete_mock(endpoints=None)</code>","text":"<p>Apply a mock to <code>requests.delete</code>.</p> <p>Usage:</p> <pre><code>import requests\nfrom unittest.mock import patch, call\nfrom breathecode.tests.mocks import apply_requests_delete_mock\nfrom breathecode.is_doesnt_exists import get_eventbrite_description_for_event\n\n@patch('requests.delete', apply_requests_delete_mock([\n    204,\n    'https://www.eventbriteapi.com/v3/events/1/structured_content/',\n    None,\n]))\ndef test_xyz():\n    delete_eventbrite_descriptions_for_event(1)\n\n    assert requests.delete.call_args_list == [\n        call('https://www.eventbriteapi.com/v3/events/1/structured_content/',\n            headers={'Authorization': f'Bearer 1234567890'},\n            data=None),\n    ]\n</code></pre> Source code in <code>breathecode/tests/mocks/requests/__init__.py</code> <pre><code>def apply_requests_delete_mock(endpoints=None):\n    \"\"\"\n    Apply a mock to `requests.delete`.\n\n    Usage:\n\n    ```py\n    import requests\n    from unittest.mock import patch, call\n    from breathecode.tests.mocks import apply_requests_delete_mock\n    from breathecode.is_doesnt_exists import get_eventbrite_description_for_event\n\n    @patch('requests.delete', apply_requests_delete_mock([\n        204,\n        'https://www.eventbriteapi.com/v3/events/1/structured_content/',\n        None,\n    ]))\n    def test_xyz():\n        delete_eventbrite_descriptions_for_event(1)\n\n        assert requests.delete.call_args_list == [\n            call('https://www.eventbriteapi.com/v3/events/1/structured_content/',\n                headers={'Authorization': f'Bearer 1234567890'},\n                data=None),\n        ]\n    ```\n    \"\"\"\n\n    if endpoints is None:\n        endpoints = []\n\n    return apply_requests_mock(\"DELETE\", endpoints)\n</code></pre>"},{"location":"testing/mocks/mock-requests/#breathecode.tests.mocks.requests.apply_requests_get_mock","title":"<code>apply_requests_get_mock(endpoints=None)</code>","text":"<p>Apply a mock to <code>requests.get</code>.</p> <p>Usage:</p> <pre><code>import requests\nfrom unittest.mock import patch, call\nfrom breathecode.tests.mocks import apply_requests_get_mock\nfrom breathecode.is_doesnt_exists import get_eventbrite_description_for_event\n\n@patch('requests.get', apply_requests_get_mock([\n    200,\n    'https://www.eventbriteapi.com/v3/events/1/structured_content/',\n    { 'data': { ... } },\n]))\ndef test_xyz():\n    get_eventbrite_descriptions_for_event(1)\n\n    assert requests.get.call_args_list == [\n        call('https://www.eventbriteapi.com/v3/events/1/structured_content/',\n            headers={'Authorization': f'Bearer 1234567890'},\n            data=None),\n    ]\n</code></pre> Source code in <code>breathecode/tests/mocks/requests/__init__.py</code> <pre><code>def apply_requests_get_mock(endpoints=None):\n    \"\"\"\n    Apply a mock to `requests.get`.\n\n    Usage:\n\n    ```py\n    import requests\n    from unittest.mock import patch, call\n    from breathecode.tests.mocks import apply_requests_get_mock\n    from breathecode.is_doesnt_exists import get_eventbrite_description_for_event\n\n    @patch('requests.get', apply_requests_get_mock([\n        200,\n        'https://www.eventbriteapi.com/v3/events/1/structured_content/',\n        { 'data': { ... } },\n    ]))\n    def test_xyz():\n        get_eventbrite_descriptions_for_event(1)\n\n        assert requests.get.call_args_list == [\n            call('https://www.eventbriteapi.com/v3/events/1/structured_content/',\n                headers={'Authorization': f'Bearer 1234567890'},\n                data=None),\n        ]\n    ```\n    \"\"\"\n\n    if endpoints is None:\n        endpoints = []\n\n    return apply_requests_mock(\"GET\", endpoints)\n</code></pre>"},{"location":"testing/mocks/mock-requests/#breathecode.tests.mocks.requests.apply_requests_head_mock","title":"<code>apply_requests_head_mock(endpoints=None)</code>","text":"<p>Apply a mock to <code>requests.head</code>.</p> <p>Usage:</p> <pre><code>import requests\nfrom unittest.mock import patch, call\nfrom breathecode.tests.mocks import apply_requests_head_mock\nfrom breathecode.is_doesnt_exists import get_eventbrite_description_for_event\n\n@patch('requests.head', apply_requests_head_mock([\n    200,\n    'https://www.eventbriteapi.com/v3/events/1/structured_content/',\n    None,\n]))\ndef test_xyz():\n    get_meta_for_eventbrite_description_for_event(1)\n\n    assert requests.head.call_args_list == [\n        call('https://www.eventbriteapi.com/v3/events/1/structured_content/',\n            headers={'Authorization': f'Bearer 1234567890'},\n            data=None),\n    ]\n</code></pre> Source code in <code>breathecode/tests/mocks/requests/__init__.py</code> <pre><code>def apply_requests_head_mock(endpoints=None):\n    \"\"\"\n    Apply a mock to `requests.head`.\n\n    Usage:\n\n    ```py\n    import requests\n    from unittest.mock import patch, call\n    from breathecode.tests.mocks import apply_requests_head_mock\n    from breathecode.is_doesnt_exists import get_eventbrite_description_for_event\n\n    @patch('requests.head', apply_requests_head_mock([\n        200,\n        'https://www.eventbriteapi.com/v3/events/1/structured_content/',\n        None,\n    ]))\n    def test_xyz():\n        get_meta_for_eventbrite_description_for_event(1)\n\n        assert requests.head.call_args_list == [\n            call('https://www.eventbriteapi.com/v3/events/1/structured_content/',\n                headers={'Authorization': f'Bearer 1234567890'},\n                data=None),\n        ]\n    ```\n    \"\"\"\n\n    if endpoints is None:\n        endpoints = []\n\n    return apply_requests_mock(\"HEAD\", endpoints)\n</code></pre>"},{"location":"testing/mocks/mock-requests/#breathecode.tests.mocks.requests.apply_requests_mock","title":"<code>apply_requests_mock(method='get', endpoints=None)</code>","text":"<p>Apply Storage Blob Mock</p> Source code in <code>breathecode/tests/mocks/requests/__init__.py</code> <pre><code>def apply_requests_mock(method=\"get\", endpoints=None):\n    \"\"\"Apply Storage Blob Mock\"\"\"\n\n    if endpoints is None:\n        endpoints = []\n\n    method = method.lower()\n    REQUESTS_INSTANCES[method] = request_mock(endpoints)\n    return REQUESTS_INSTANCES[method]\n</code></pre>"},{"location":"testing/mocks/mock-requests/#breathecode.tests.mocks.requests.apply_requests_patch_mock","title":"<code>apply_requests_patch_mock(endpoints=None)</code>","text":"<p>Apply a mock to <code>requests.patch</code>.</p> <p>Usage:</p> <pre><code>import requests\nfrom unittest.mock import patch, call\nfrom breathecode.tests.mocks import apply_requests_patch_mock\nfrom breathecode.is_doesnt_exists import get_eventbrite_description_for_event\n\n@patch('requests.patch', apply_requests_patch_mock([\n    200,\n    'https://www.eventbriteapi.com/v3/events/1/structured_content/',\n    None,\n]))\ndef test_xyz():\n    patch_eventbrite_descriptions_for_event(1)\n\n    assert requests.patch.call_args_list == [\n        call('https://www.eventbriteapi.com/v3/events/1/structured_content/',\n            headers={'Authorization': f'Bearer 1234567890'},\n            data=None),\n    ]\n</code></pre> Source code in <code>breathecode/tests/mocks/requests/__init__.py</code> <pre><code>def apply_requests_patch_mock(endpoints=None):\n    \"\"\"\n    Apply a mock to `requests.patch`.\n\n    Usage:\n\n    ```py\n    import requests\n    from unittest.mock import patch, call\n    from breathecode.tests.mocks import apply_requests_patch_mock\n    from breathecode.is_doesnt_exists import get_eventbrite_description_for_event\n\n    @patch('requests.patch', apply_requests_patch_mock([\n        200,\n        'https://www.eventbriteapi.com/v3/events/1/structured_content/',\n        None,\n    ]))\n    def test_xyz():\n        patch_eventbrite_descriptions_for_event(1)\n\n        assert requests.patch.call_args_list == [\n            call('https://www.eventbriteapi.com/v3/events/1/structured_content/',\n                headers={'Authorization': f'Bearer 1234567890'},\n                data=None),\n        ]\n    ```\n    \"\"\"\n\n    if endpoints is None:\n        endpoints = []\n\n    return apply_requests_mock(\"PATCH\", endpoints)\n</code></pre>"},{"location":"testing/mocks/mock-requests/#breathecode.tests.mocks.requests.apply_requests_post_mock","title":"<code>apply_requests_post_mock(endpoints=None)</code>","text":"<p>Apply a mock to <code>requests.post</code>.</p> <p>Usage:</p> <pre><code>import requests\nfrom unittest.mock import patch, call\nfrom breathecode.tests.mocks import apply_requests_post_mock\nfrom breathecode.is_doesnt_exists import get_eventbrite_description_for_event\n\n@patch('requests.post', apply_requests_post_mock([\n    201,\n    'https://www.eventbriteapi.com/v3/events/1/structured_content/',\n    { 'data': { ... } },\n]))\ndef test_xyz():\n    post_eventbrite_descriptions_for_event(1)\n\n    assert requests.post.call_args_list == [\n        call('https://www.eventbriteapi.com/v3/events/1/structured_content/',\n            headers={'Authorization': f'Bearer 1234567890'},\n            data=None),\n    ]\n</code></pre> Source code in <code>breathecode/tests/mocks/requests/__init__.py</code> <pre><code>def apply_requests_post_mock(endpoints=None):\n    \"\"\"\n    Apply a mock to `requests.post`.\n\n    Usage:\n\n    ```py\n    import requests\n    from unittest.mock import patch, call\n    from breathecode.tests.mocks import apply_requests_post_mock\n    from breathecode.is_doesnt_exists import get_eventbrite_description_for_event\n\n    @patch('requests.post', apply_requests_post_mock([\n        201,\n        'https://www.eventbriteapi.com/v3/events/1/structured_content/',\n        { 'data': { ... } },\n    ]))\n    def test_xyz():\n        post_eventbrite_descriptions_for_event(1)\n\n        assert requests.post.call_args_list == [\n            call('https://www.eventbriteapi.com/v3/events/1/structured_content/',\n                headers={'Authorization': f'Bearer 1234567890'},\n                data=None),\n        ]\n    ```\n    \"\"\"\n\n    if endpoints is None:\n        endpoints = []\n\n    return apply_requests_mock(\"POST\", endpoints)\n</code></pre>"},{"location":"testing/mocks/mock-requests/#breathecode.tests.mocks.requests.apply_requests_put_mock","title":"<code>apply_requests_put_mock(endpoints=None)</code>","text":"<p>Apply a mock to <code>requests.put</code>.</p> <p>Usage:</p> <pre><code>import requests\nfrom unittest.mock import patch, call\nfrom breathecode.tests.mocks import apply_requests_put_mock\nfrom breathecode.is_doesnt_exists import get_eventbrite_description_for_event\n\n@patch('requests.put', apply_requests_put_mock([\n    200,\n    'https://www.eventbriteapi.com/v3/events/1/structured_content/',\n    { 'data': { ... } },\n]))\ndef test_xyz():\n    put_eventbrite_descriptions_for_event(1)\n\n    assert requests.put.call_args_list == [\n        call('https://www.eventbriteapi.com/v3/events/1/structured_content/',\n            headers={'Authorization': f'Bearer 1234567890'},\n            data=None),\n    ]\n</code></pre> Source code in <code>breathecode/tests/mocks/requests/__init__.py</code> <pre><code>def apply_requests_put_mock(endpoints=None):\n    \"\"\"\n    Apply a mock to `requests.put`.\n\n    Usage:\n\n    ```py\n    import requests\n    from unittest.mock import patch, call\n    from breathecode.tests.mocks import apply_requests_put_mock\n    from breathecode.is_doesnt_exists import get_eventbrite_description_for_event\n\n    @patch('requests.put', apply_requests_put_mock([\n        200,\n        'https://www.eventbriteapi.com/v3/events/1/structured_content/',\n        { 'data': { ... } },\n    ]))\n    def test_xyz():\n        put_eventbrite_descriptions_for_event(1)\n\n        assert requests.put.call_args_list == [\n            call('https://www.eventbriteapi.com/v3/events/1/structured_content/',\n                headers={'Authorization': f'Bearer 1234567890'},\n                data=None),\n        ]\n    ```\n    \"\"\"\n\n    if endpoints is None:\n        endpoints = []\n\n    return apply_requests_mock(\"PUT\", endpoints)\n</code></pre>"},{"location":"testing/mocks/mock-requests/#breathecode.tests.mocks.requests.apply_requests_request_mock","title":"<code>apply_requests_request_mock(endpoints=None)</code>","text":"<p>Apply a mock to <code>requests.request</code>.</p> <p>Usage:</p> <pre><code>import requests\nfrom unittest.mock import patch, call\nfrom breathecode.tests.mocks import apply_requests_request_mock\nfrom breathecode.is_doesnt_exists import get_eventbrite_description_for_event\n\n@patch('requests.request', apply_requests_request_mock([\n    200,\n    'https://www.eventbriteapi.com/v3/events/1/structured_content/',\n    { 'data': { ... } },\n]))\ndef test_xyz():\n    get_eventbrite_description_for_event(1)\n\n    assert requests.request.call_args_list == [\n        call('GET',\n            'https://www.eventbriteapi.com/v3/events/1/structured_content/',\n            headers={'Authorization': f'Bearer 1234567890'},\n            data=None),\n    ]\n</code></pre> Source code in <code>breathecode/tests/mocks/requests/__init__.py</code> <pre><code>def apply_requests_request_mock(endpoints=None):\n    \"\"\"\n    Apply a mock to `requests.request`.\n\n    Usage:\n\n    ```py\n    import requests\n    from unittest.mock import patch, call\n    from breathecode.tests.mocks import apply_requests_request_mock\n    from breathecode.is_doesnt_exists import get_eventbrite_description_for_event\n\n    @patch('requests.request', apply_requests_request_mock([\n        200,\n        'https://www.eventbriteapi.com/v3/events/1/structured_content/',\n        { 'data': { ... } },\n    ]))\n    def test_xyz():\n        get_eventbrite_description_for_event(1)\n\n        assert requests.request.call_args_list == [\n            call('GET',\n                'https://www.eventbriteapi.com/v3/events/1/structured_content/',\n                headers={'Authorization': f'Bearer 1234567890'},\n                data=None),\n        ]\n    ```\n    \"\"\"\n\n    if endpoints is None:\n        endpoints = []\n\n    return apply_requests_mock(\"REQUEST\", endpoints)\n</code></pre>"},{"location":"testing/mocks/using-mocks/","title":"Using mocks","text":""},{"location":"testing/mocks/using-mocks/#mock-object","title":"Mock object","text":"<p>Mock objects are simulated objects that mimic the behavior of real objects in controlled ways, most often as part of a software testing initiative. A programmer typically creates a mock object to test the behavior of some other object, in much the same way that a car designer uses a crash test dummy to simulate the dynamic behavior of a human in vehicle impacts.</p>"},{"location":"testing/mocks/using-mocks/#how-to-apply-a-automatic-mock","title":"How to apply a automatic mock","text":""},{"location":"testing/mocks/using-mocks/#the-most-easier-way-to-create-a-mock","title":"<code>The most easier way to create a mock</code>","text":"<p>The decorator <code>@patch.object</code> is the best option to implement a mock</p> <pre><code>@patch.object(object_class_or_module, 'method_or_function_to_be_mocked', MagicMock())\n</code></pre>"},{"location":"testing/mocks/using-mocks/#this-is-the-code-to-test","title":"<code>This is the code to test</code>","text":"<pre><code># utils.py\nfrom .actions import shoot_gun, kenny_s_birth, show\n\ndef kenny_killer(kenny_id: int) -&gt; None:\n    # get the current kenny\n    kenny = Kenny.objects.filter(id=kenny_id).first()\n\n    # see - South Park - Coon and friends\n    if kenny:\n        shoot_gun(kenny)\n        kenny_number = kenny_s_birth()\n        show(kenny_number)\n</code></pre>"},{"location":"testing/mocks/using-mocks/#this-is-a-example-of-use-of-mocks","title":"<code>This is a example of use of mocks</code>","text":"<pre><code>from unittest.mock import MagicMock, call, patch\nfrom rest_framework.test import APITestCase\nfrom .models import Kenny\nfrom .utils import kenny_killer\n\nimport app.actions as actions\n\n# this is a wrapper that implement the kenny_s_birth static behavior to the test\ndef kenny_s_birth_mock(number: int):\n    def kenny_s_birth():\n        return number\n\n    # the side_effect is a function that manage the behavior of the mocked function\n    return MagicMock(side_effect=kenny_s_birth)\n\nclass KennyTestSuite(APITestCase):\n    # \ud83d\udd3d this function is automatically mocked\n    @patch.object(actions, 'shoot_gun', MagicMock())\n\n    # \ud83d\udd3d this function is manually mocked\n    @patch.object(actions, 'kenny_s_birth', kenny_s_birth_mock(1000))\n\n    # \ud83d\udd3d this function is automatically mocked\n    @patch.object(actions, 'show', MagicMock())\n\n    def test_kill_kenny(self):\n        kenny = Kenny()\n        kenny.save()\n\n        kenny_killer(kenny_id=1)\n\n        # shoot_gun() is called with a kenny instance\n        self.assertEqual(actions.shoot_gun.call_args_list, [call(kenny)])\n\n        # kenny_s_birth() is called with zero arguments\n        self.assertEqual(actions.kenny_s_birth.call_args_list, [call()])\n\n        # show is called\n        self.assertEqual(actions.show.call_args_list, [call(1)])\n</code></pre>"},{"location":"troubleshooting/check_task_status/","title":"Task Status Diagnostic Tool","text":"<p>This document explains the <code>check_task_status</code> management command, which helps diagnose issues with tasks that appear stuck in Celery Task Manager.</p>"},{"location":"troubleshooting/check_task_status/#overview","title":"Overview","text":"<p>The command was created to investigate issue #8696, where tasks appear as PENDING/SCHEDULED in the Django admin interface even though they may have been processed.</p>"},{"location":"troubleshooting/check_task_status/#features","title":"Features","text":"<ol> <li>Identifies tasks stuck in SCHEDULED status for extended periods</li> <li>Examines sample tasks for detailed investigation</li> <li>Verifies actual execution status by checking:</li> <li>Celery task state via AsyncResult</li> <li>Downstream effects of specific task types</li> <li>Checks for tasks stuck in other non-terminal states</li> <li>Generates recommendations based on findings</li> <li>Can save complete diagnostic output to a log file</li> </ol>"},{"location":"troubleshooting/check_task_status/#command-arguments","title":"Command Arguments","text":"Argument Type Default Description <code>--hours</code> int 906 Number of hours to look back for stuck tasks <code>--check-execution</code> flag False Enables verification of actual task execution <code>--limit</code> int 5 Maximum number of sample tasks to analyze per task type <code>--log-file</code> string None Path where to save the diagnostic log file"},{"location":"troubleshooting/check_task_status/#how-to-run","title":"How to Run","text":"<p>Basic usage:</p> <pre><code>python manage.py check_task_status\n</code></pre> <p>With all options:</p> <pre><code>python manage.py check_task_status --hours=24 --check-execution --limit=10 --log-file=/path/to/task_diagnosis.log\n</code></pre>"},{"location":"troubleshooting/check_task_status/#output-details","title":"Output Details","text":"<p>The command outputs:</p> <ol> <li>Summary of stuck tasks grouped by task module and name</li> <li>Task counts and maximum duration they've been stuck</li> <li>Sample of specific task instances with their:</li> <li>ID, arguments, last run timestamp</li> <li>Task ID for Celery correlation</li> <li>Status message and attempt count</li> <li>When <code>--check-execution</code> is used:</li> <li>Celery task state from AsyncResult</li> <li>Task-specific execution verification</li> <li>Evidence of downstream effects</li> <li>Tasks stuck in non-terminal states</li> <li>Recommendations for resolution</li> </ol>"},{"location":"troubleshooting/check_task_status/#example-output","title":"Example Output","text":"<pre><code>Analyzing tasks stuck for more than 906 hours:\n================================================================================\n\nTask: task_manager.django.tasks.execute_signal\nCount: 66597\nMax Hours Stuck: 906.60\n\nSample Tasks:\nID: 12345678\nArguments: {\"instance_id\": 98765, \"model_path\": \"breathecode.assignments.Task\", \"action\": \"status_updated\"}\nLast Run: 2025-02-15 10:23:45+00:00\nTask ID: 87d6f3a5-c612-49b3-9fe1-23456789abcd\nStatus Message: None\nAttempts: 2\n----------------------------------------\n\nTask: breathecode.notify.tasks.async_deliver_hook\nCount: 63090\nMax Hours Stuck: 906.50\n\nSample Tasks:\nID: 23456789\nArguments: {\"hook_id\": 12345, \"retry\": false}\nLast Run: 2025-02-16 08:45:12+00:00\nTask ID: 9e45f2a6-d723-48c4-8fd2-34567890bcde\nStatus Message: None\nAttempts: 3\n----------------------------------------\n\nOther potentially stuck tasks by status:\n================================================================================\n\nStatus: PENDING\nCount: 1234\n\nRecommendations:\n================================================================================\n\n1. Check Celery workers are running and processing tasks\n2. Verify Redis connection and queue status\n3. Look for any error patterns in the sample tasks\n4. Consider resetting stuck tasks or investigating specific task modules\n5. Check if the task_manager and actual task function are properly communicating status updates\n6. For tasks with successful Celery execution but pending TaskManager status, update the TaskManager database\n</code></pre>"},{"location":"troubleshooting/check_task_status/#task-specific-verification","title":"Task-Specific Verification","text":"<p>The command checks specific task types:</p> <ol> <li> <p><code>breathecode.assignments.tasks.async_learnpack_webhook</code>:</p> </li> <li> <p>Verifies if webhook status was updated in database</p> </li> <li> <p><code>breathecode.notify.tasks.async_deliver_hook</code>:</p> </li> <li>Checks if hook delivery completed successfully</li> </ol>"},{"location":"troubleshooting/check_task_status/#interpreting-results","title":"Interpreting Results","text":""},{"location":"troubleshooting/check_task_status/#possible-issues","title":"Possible Issues","text":"<ol> <li> <p>Task Execution Issues: Tasks are not being processed by Celery</p> </li> <li> <p>Celery workers may not be running</p> </li> <li> <p>Redis message broker might be disconnected or data lost</p> </li> <li> <p>Status Update Issues: Tasks are executed but status not updated</p> </li> <li>Database connection issues when updating status</li> <li>Task execution errors preventing status update</li> <li>Code issues in task functions not properly updating status</li> </ol>"},{"location":"troubleshooting/check_task_status/#recommended-actions","title":"Recommended Actions","text":"<p>Based on diagnostic results:</p> <ul> <li> <p>If tasks show successful execution but status not updated:</p> </li> <li> <p>Check the TaskManager status update code</p> </li> <li> <p>Run a one-time fix script to update the status of completed tasks</p> </li> <li> <p>If tasks have not executed:</p> </li> <li>Verify Celery worker status</li> <li>Check Redis connectivity and memory usage</li> <li>Examine Celery task queue for backlog</li> </ul>"},{"location":"troubleshooting/check_task_status/#progress-tracking","title":"Progress Tracking","text":"<p>The command includes progress indicators to help troubleshoot long-running checks:</p> <pre><code>[Line ~62] Starting task status check for tasks older than 906 hours...\n[Line ~65] Querying database for stuck tasks... This may take a moment\n[Line ~75] Database query complete. Processing results...\n[Line ~95] Processing complete. Found 245 stuck task types.\n[Line ~106] Analyzing task type 1/245: task_manager.django.tasks.execute_signal\n</code></pre> <p>These indicators help identify where the command might be hanging and track progress through large datasets.</p>"},{"location":"troubleshooting/check_task_status/#implementation-location","title":"Implementation Location","text":"<p>The command is located at:</p> <pre><code>breathecode/monitoring/management/commands/check_task_status.py\n</code></pre>"},{"location":"workflows/file-uploading/","title":"File uploading","text":""},{"location":"workflows/file-uploading/#steps","title":"Steps","text":"<ul> <li>Get operation type meta.</li> <li>Split file into chunks.</li> <li>Check if chunk lenght is less than <code>max_chunks</code> or <code>null</code>.</li> <li>Upload each chunk.</li> <li>Process the file and send the metadata if required.</li> <li>If the file is not processed automatically you should pass the file id to another endpoint.</li> </ul>"},{"location":"workflows/file-uploading/#notes","title":"Notes","text":"<ul> <li>For user uploading, use <code>/v2/media/me/chunk</code> and <code>/v2/media/me/chunk/upload</code>.</li> <li>For academy uploading, use <code>/v2/media/academy/chunk</code> and <code>/v2/media/academy/chunk/upload</code> with the <code>Academy</code> header.</li> <li>Status <code>TRANSFERRING</code> means that the file is being processed.</li> <li>Status <code>CREATED</code> means that the <code>file.id</code> must be provided to another endpoint for processing.</li> </ul>"},{"location":"workflows/file-uploading/#get-available-operation-types","title":"Get available operation types","text":""},{"location":"workflows/file-uploading/#request","title":"Request","text":"<pre><code>GET /v2/media/operationtype HTTP/1.1\nHost: breathecode.herokuapp.com\n</code></pre>"},{"location":"workflows/file-uploading/#response","title":"Response","text":"<pre><code>[\n\u00a0 \u00a0 \"media\",\n\u00a0 \u00a0 \"proof-of-payment\"\n]\n</code></pre>"},{"location":"workflows/file-uploading/#get-operation-type-meta","title":"Get operation type meta","text":""},{"location":"workflows/file-uploading/#request_1","title":"Request","text":"<pre><code>GET /v2/media/operationtype/media HTTP/1.1\nHost: breathecode.herokuapp.com\n</code></pre>"},{"location":"workflows/file-uploading/#response_1","title":"Response","text":"<pre><code>{\n\u00a0 \u00a0 \"chunk_size\": 10485760,\n\u00a0 \u00a0 \"max_chunks\": null\n}\n</code></pre>"},{"location":"workflows/file-uploading/#upload-chunk","title":"Upload chunk","text":""},{"location":"workflows/file-uploading/#request_2","title":"Request","text":"<pre><code>POST /v2/media/me/chunk HTTP/1.1\nHost: breathecode.herokuapp.com\nContent-Type: multipart/form-data; boundary=...\n\n{\n    \"operation_type\": \"media\",\n    \"total_chunks\": 3,\n    \"chunk\": chunk,\n    \"chunk_index\": 0\n}\n</code></pre>"},{"location":"workflows/file-uploading/#response_2","title":"Response","text":"<pre><code>{\n\u00a0 \u00a0 \"academy\": null,\n\u00a0 \u00a0 \"chunk_index\": 0,\n\u00a0 \u00a0 \"mime\": \"image/png\",\n\u00a0 \u00a0 \"name\": \"chunk.png\",\n\u00a0 \u00a0 \"operation_type\": \"media\",\n\u00a0 \u00a0 \"total_chunks\": 3,\n\u00a0 \u00a0 \"user\": 1\n}\n</code></pre>"},{"location":"workflows/file-uploading/#end-file-uploading-and-ask-for-processing","title":"End file uploading and ask for processing","text":""},{"location":"workflows/file-uploading/#request_3","title":"Request","text":"<pre><code>POST /v2/media/me/chunk/upload HTTP/1.1\nHost: breathecode.herokuapp.com\nContent-Type: application/json\n\n{\n    \"operation_type\": \"media\",\n    \"total_chunks\": 3,\n    \"filename\": \"chunk.png\",\n    \"mime\": \"image/png\",\n    \"meta\": \"{\\\"slug\\\":\\\"my-media\\\",\\\"name\\\":\\\"my-name\\\",\\\"categories\\\":[\\\"my-category\\\"],\\\"academy\\\":1}\"\n}\n</code></pre>"},{"location":"workflows/file-uploading/#response_3","title":"Response","text":"<pre><code>{\n\u00a0 \u00a0 \"id\": 1,\n\u00a0 \u00a0 \"academy\": null,\n\u00a0 \u00a0 \"mime\": \"image/png\",\n\u00a0 \u00a0 \"name\": \"a291e39ac495b2effd38d508417cd731\",\n\u00a0 \u00a0 \"operation_type\": \"media\",\n\u00a0 \u00a0 \"user\": 1,\n\u00a0 \u00a0 \"status\": \"TRANSFERRING\"\n}\n</code></pre>"}]}