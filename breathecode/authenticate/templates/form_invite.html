{% extends "form_base.html" %} {% block content %}
{% if WELCOME_VIDEO and WELCOME_VIDEO.url and WELCOME_VIDEO.preview_image %}
<!-- Video Welcome Modal -->
<div class="modal fade show" id="welcomeVideoModal" tabindex="-1" role="dialog" aria-labelledby="welcomeVideoModalLabel" aria-hidden="false" style="display: block;">
  <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="welcomeVideoModalLabel">Welcome Video</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close" onclick="closeWelcomeModal()">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body" style="padding: 0;">
        <div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
          {% if WELCOME_VIDEO.url|slice:":4" == "http" and (".mp4" in WELCOME_VIDEO.url|lower or ".webm" in WELCOME_VIDEO.url|lower or ".ogg" in WELCOME_VIDEO.url|lower or ".mov" in WELCOME_VIDEO.url|lower or "data:video" in WELCOME_VIDEO.url|lower) %}
          <!-- Direct video file URL - use video tag -->
          <video 
            src="{{ WELCOME_VIDEO.url }}" 
            style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: 0;"
            controls
            autoplay>
            Your browser does not support the video tag.
          </video>
          {% else %}
          <!-- Embed URL (YouTube, Vimeo, etc.) - use iframe -->
          <iframe 
            src="{{ WELCOME_VIDEO.url }}" 
            style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: 0;"
            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
            allowfullscreen>
          </iframe>
          {% endif %}
        </div>
      </div>
    </div>
  </div>
</div>
<div class="modal-backdrop fade show" id="welcomeVideoModalBackdrop"></div>

<style>
  #welcomeVideoModal {
    z-index: 1050;
  }
  #welcomeVideoModalBackdrop {
    z-index: 1040;
    background-color: rgba(0, 0, 0, 0.5);
  }
</style>

<script>
  function closeWelcomeModal() {
    var modal = document.getElementById('welcomeVideoModal');
    var backdrop = document.getElementById('welcomeVideoModalBackdrop');
    if (modal) {
      modal.classList.remove('show');
      modal.style.display = 'none';
    }
    if (backdrop) {
      backdrop.classList.remove('show');
      backdrop.style.display = 'none';
    }
  }
  
  // Close modal when clicking outside
  document.addEventListener('click', function(event) {
    var modal = document.getElementById('welcomeVideoModal');
    var backdrop = document.getElementById('welcomeVideoModalBackdrop');
    if (event.target === backdrop) {
      closeWelcomeModal();
    }
  });
</script>
{% endif %}

<h2 class="alert alert-light text-center">
  Welcome to {{ COMPANY_NAME|default:'4Geeks' }}!
</h2>
<p class="text-center">
  Please confirm the following form and you will be learning in no time!
</p>
<form method="post" class="container">
  {% if messages %} {% for message in messages %}
  <div class="alert {{ message.tags }}" role="alert">{{ message }}</div>
  {% endfor %} {% endif %} {% csrf_token %} {{ form }}
  <button class="btn btn-primary" type="submit">Confirm Sign Up</button>
</form>
{% endblock %}
